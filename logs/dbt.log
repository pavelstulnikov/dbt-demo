2021-12-03 23:28:12.743016 (MainThread): Running with dbt=0.21.0
2021-12-03 23:28:13.125556 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-12-03 23:28:13.140509 (MainThread): Tracking: tracking
2021-12-03 23:28:13.140686 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c29abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a7c8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a77fc70>]}
2021-12-03 23:28:13.140980 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=24
2021-12-03 23:28:13.141197 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2021-12-03 23:28:13.141340 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-12-03 23:28:13.143841 (Thread-12): Unable to do partial parsing because target/partial_parse.msgpack not found
2021-12-03 23:28:13.144063 (Thread-12): Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a7c8eb0>]}
2021-12-03 23:28:13.174530 (Thread-12): Parsing macros/catalog.sql
2021-12-03 23:28:13.176765 (Thread-12): Parsing macros/adapters.sql
2021-12-03 23:28:13.211435 (Thread-12): Parsing macros/materializations/merge.sql
2021-12-03 23:28:13.215260 (Thread-12): Parsing macros/materializations/table.sql
2021-12-03 23:28:13.218446 (Thread-12): Parsing macros/materializations/seed.sql
2021-12-03 23:28:13.222628 (Thread-12): Parsing macros/materializations/view.sql
2021-12-03 23:28:13.223946 (Thread-12): Parsing macros/materializations/incremental.sql
2021-12-03 23:28:13.232117 (Thread-12): Parsing macros/core.sql
2021-12-03 23:28:13.235679 (Thread-12): Parsing macros/materializations/test.sql
2021-12-03 23:28:13.242029 (Thread-12): Parsing macros/materializations/helpers.sql
2021-12-03 23:28:13.251512 (Thread-12): Parsing macros/materializations/view/view.sql
2021-12-03 23:28:13.258243 (Thread-12): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-03 23:28:13.262021 (Thread-12): Parsing macros/materializations/seed/seed.sql
2021-12-03 23:28:13.283418 (Thread-12): Parsing macros/materializations/snapshot/strategies.sql
2021-12-03 23:28:13.299985 (Thread-12): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-03 23:28:13.301601 (Thread-12): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-03 23:28:13.331136 (Thread-12): Parsing macros/materializations/table/table.sql
2021-12-03 23:28:13.338031 (Thread-12): Parsing macros/materializations/common/merge.sql
2021-12-03 23:28:13.351060 (Thread-12): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-03 23:28:13.369596 (Thread-12): Parsing macros/materializations/incremental/incremental.sql
2021-12-03 23:28:13.379129 (Thread-12): Parsing macros/materializations/incremental/helpers.sql
2021-12-03 23:28:13.380807 (Thread-12): Parsing macros/etc/get_custom_alias.sql
2021-12-03 23:28:13.382284 (Thread-12): Parsing macros/etc/datetime.sql
2021-12-03 23:28:13.390923 (Thread-12): Parsing macros/etc/query.sql
2021-12-03 23:28:13.392094 (Thread-12): Parsing macros/etc/where_subquery.sql
2021-12-03 23:28:13.392945 (Thread-13): handling status request
2021-12-03 23:28:13.394868 (Thread-12): Parsing macros/etc/get_custom_database.sql
2021-12-03 23:28:13.395170 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a755190>]}
2021-12-03 23:28:13.396783 (Thread-12): Parsing macros/etc/get_custom_schema.sql
2021-12-03 23:28:13.397428 (Thread-13): sending response (<Response 185 bytes [200 OK]>) to 10.0.19.103
2021-12-03 23:28:13.400470 (Thread-12): Parsing macros/etc/is_incremental.sql
2021-12-03 23:28:13.402595 (Thread-12): Parsing macros/adapters/common.sql
2021-12-03 23:28:13.448719 (Thread-14): handling status request
2021-12-03 23:28:13.457473 (Thread-12): Parsing macros/schema_tests/accepted_values.sql
2021-12-03 23:28:13.457795 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a712df0>]}
2021-12-03 23:28:13.460079 (Thread-12): Parsing macros/schema_tests/not_null.sql
2021-12-03 23:28:13.460553 (Thread-14): sending response (<Response 185 bytes [200 OK]>) to 10.0.2.25
2021-12-03 23:28:13.461818 (Thread-12): Parsing macros/schema_tests/relationships.sql
2021-12-03 23:28:13.463749 (Thread-12): Parsing macros/schema_tests/unique.sql
2021-12-03 23:28:13.500316 (Thread-15): handling status request
2021-12-03 23:28:13.520910 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a71cd90>]}
2021-12-03 23:28:13.526421 (Thread-15): sending response (<Response 163 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:13.633740 (Thread-16): handling status request
2021-12-03 23:28:13.649322 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a72d220>]}
2021-12-03 23:28:13.653241 (Thread-12): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-03 23:28:13.653735 (Thread-16): sending response (<Response 163 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:13.668266 (Thread-12): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-03 23:28:13.729060 (Thread-17): handling status request
2021-12-03 23:28:13.729263 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a758df0>]}
2021-12-03 23:28:13.729634 (Thread-17): sending response (<Response 163 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:13.743390 (Thread-12): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a750310>]}
2021-12-03 23:28:13.786003 (Thread-18): handling status request
2021-12-03 23:28:13.786201 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a65c640>]}
2021-12-03 23:28:13.786811 (Thread-18): sending response (<Response 11003 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:13.792666 (Thread-19): handling list request
2021-12-03 23:28:13.792848 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a65cd00>]}
2021-12-03 23:28:13.825739 (Thread-19): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a6a7310>]}
2021-12-03 23:28:13.825970 (Thread-19): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:28:13.829942 (Thread-19): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:28:13.830099 (Thread-19): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:28:13.830173 (Thread-19): No nodes selected!
2021-12-03 23:28:13.831557 (Thread-19): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:14.854312 (Thread-20): handling status request
2021-12-03 23:28:14.854604 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a73d370>]}
2021-12-03 23:28:14.855511 (Thread-20): sending response (<Response 11025 bytes [200 OK]>) to 10.0.3.73
2021-12-03 23:28:14.908141 (Thread-21): handling status request
2021-12-03 23:28:14.908354 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a757340>]}
2021-12-03 23:28:14.908925 (Thread-21): sending response (<Response 11025 bytes [200 OK]>) to 10.0.2.25
2021-12-03 23:28:40.932825 (Thread-22): handling status request
2021-12-03 23:28:40.933152 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a6d9c10>]}
2021-12-03 23:28:40.933893 (Thread-22): sending response (<Response 11003 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:40.942358 (Thread-23): handling list request
2021-12-03 23:28:40.942541 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca7f716d0>]}
2021-12-03 23:28:40.976965 (Thread-23): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a64d100>]}
2021-12-03 23:28:40.977185 (Thread-23): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:28:40.980649 (Thread-23): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:28:40.980804 (Thread-23): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:28:40.980875 (Thread-23): No nodes selected!
2021-12-03 23:28:40.982252 (Thread-23): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:54.215376 (Thread-24): handling status request
2021-12-03 23:28:54.217160 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a64d970>]}
2021-12-03 23:28:54.217919 (Thread-24): sending response (<Response 11025 bytes [200 OK]>) to 10.0.31.30
2021-12-03 23:28:56.552246 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-03 23:28:56.597376 (Thread-25): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-03 23:28:56.597677 (Thread-25): Partial parsing enabled, no changes found, skipping parsing
2021-12-03 23:28:56.602392 (Thread-25): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687e1b80>]}
2021-12-03 23:28:57.558141 (Thread-26): handling status request
2021-12-03 23:28:57.558423 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687e1b50>]}
2021-12-03 23:28:57.558877 (Thread-26): sending response (<Response 1209 bytes [200 OK]>) to 10.0.31.30
2021-12-03 23:28:57.612991 (Thread-27): handling status request
2021-12-03 23:28:57.613210 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687e1dc0>]}
2021-12-03 23:28:57.613615 (Thread-27): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:57.619674 (Thread-28): handling list request
2021-12-03 23:28:57.619868 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687cc160>]}
2021-12-03 23:28:57.651413 (Thread-28): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f174848-0115-4ff2-82cb-54b15fa6ae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a65c7c0>]}
2021-12-03 23:28:57.651633 (Thread-28): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:28:57.652351 (Thread-28): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:28:57.652503 (Thread-28): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:28:57.652575 (Thread-28): No nodes selected!
2021-12-03 23:28:57.653986 (Thread-28): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:57.711351 (Thread-29): handling status request
2021-12-03 23:28:57.711535 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3f174848-0115-4ff2-82cb-54b15fa6ae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687ccbb0>]}
2021-12-03 23:28:57.711881 (Thread-29): sending response (<Response 1209 bytes [200 OK]>) to 10.0.22.219
2021-12-03 23:29:08.391184 (Thread-30): handling status request
2021-12-03 23:29:08.393063 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3f174848-0115-4ff2-82cb-54b15fa6ae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a3190>]}
2021-12-03 23:29:08.393514 (Thread-30): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:29:08.401139 (Thread-31): handling list request
2021-12-03 23:29:08.401319 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3f174848-0115-4ff2-82cb-54b15fa6ae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a3370>]}
2021-12-03 23:29:08.433854 (Thread-31): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48db3141-2bfa-490e-afc3-322094d1824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a3e80>]}
2021-12-03 23:29:08.434066 (Thread-31): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:29:08.434809 (Thread-31): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:29:08.434951 (Thread-31): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:29:08.435022 (Thread-31): No nodes selected!
2021-12-03 23:29:08.436410 (Thread-31): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:32:26.541980 (Thread-32): handling status request
2021-12-03 23:32:26.544028 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '48db3141-2bfa-490e-afc3-322094d1824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a85e0>]}
2021-12-03 23:32:26.544507 (Thread-32): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:32:26.554329 (Thread-33): handling list request
2021-12-03 23:32:26.554525 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '48db3141-2bfa-490e-afc3-322094d1824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a8850>]}
2021-12-03 23:32:26.593093 (Thread-33): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88d4fe9b-8aca-4762-bf0a-868e04cf8452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687cccd0>]}
2021-12-03 23:32:26.593310 (Thread-33): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:32:26.597446 (Thread-33): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:32:26.597602 (Thread-33): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:32:26.597674 (Thread-33): No nodes selected!
2021-12-03 23:32:26.598998 (Thread-33): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:33:44.395738 (Thread-34): handling status request
2021-12-03 23:33:44.397754 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '88d4fe9b-8aca-4762-bf0a-868e04cf8452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a757610>]}
2021-12-03 23:33:44.422305 (Thread-34): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:33:44.427989 (Thread-35): handling list request
2021-12-03 23:33:44.428181 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '88d4fe9b-8aca-4762-bf0a-868e04cf8452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687ac2e0>]}
2021-12-03 23:33:44.461957 (Thread-35): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5423059-348c-4a08-be32-61775a04b1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687ae070>]}
2021-12-03 23:33:44.462176 (Thread-35): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:33:44.465949 (Thread-35): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:33:44.466105 (Thread-35): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:33:44.466179 (Thread-35): No nodes selected!
2021-12-03 23:33:44.467474 (Thread-35): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:33:52.892417 (Thread-36): handling status request
2021-12-03 23:33:52.892713 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f5423059-348c-4a08-be32-61775a04b1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687e1ee0>]}
2021-12-03 23:33:52.893180 (Thread-36): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:33:52.898620 (Thread-37): handling list request
2021-12-03 23:33:52.898814 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f5423059-348c-4a08-be32-61775a04b1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a3d60>]}
2021-12-03 23:33:52.927914 (Thread-37): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc437f71-348c-4589-bb61-177f0dc91327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687ae850>]}
2021-12-03 23:33:52.928136 (Thread-37): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:33:52.935003 (Thread-37): sending response (<Response 5009 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:34:32.850961 (Thread-38): handling status request
2021-12-03 23:34:32.851241 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bc437f71-348c-4589-bb61-177f0dc91327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b2040>]}
2021-12-03 23:34:32.851688 (Thread-38): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:34:32.866348 (Thread-39): handling list request
2021-12-03 23:34:32.866549 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bc437f71-348c-4589-bb61-177f0dc91327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b23d0>]}
2021-12-03 23:34:32.906388 (Thread-39): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '480ef9b4-5de6-4a8e-843a-c9509ca63ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687aed60>]}
2021-12-03 23:34:32.906616 (Thread-39): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:34:32.910470 (Thread-39): sending response (<Response 5009 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:34:33.380606 (Thread-40): handling status request
2021-12-03 23:34:33.380883 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '480ef9b4-5de6-4a8e-843a-c9509ca63ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b2f10>]}
2021-12-03 23:34:33.381329 (Thread-40): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:34:33.386148 (Thread-41): handling list request
2021-12-03 23:34:33.386341 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '480ef9b4-5de6-4a8e-843a-c9509ca63ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b20a0>]}
2021-12-03 23:34:33.415877 (Thread-41): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '111df46b-e6e6-47a8-bf70-c34951c31ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68747ac0>]}
2021-12-03 23:34:33.416106 (Thread-41): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:34:33.420040 (Thread-41): sending response (<Response 5009 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:35:00.084725 (Thread-42): handling status request
2021-12-03 23:35:00.085017 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '111df46b-e6e6-47a8-bf70-c34951c31ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b20a0>]}
2021-12-03 23:35:00.085458 (Thread-42): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:35:00.091269 (Thread-43): handling list request
2021-12-03 23:35:00.091456 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '111df46b-e6e6-47a8-bf70-c34951c31ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b2dc0>]}
2021-12-03 23:35:00.126233 (Thread-43): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68755730>]}
2021-12-03 23:35:00.126457 (Thread-43): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:35:00.136896 (Thread-43): sending response (<Response 5009 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:35:02.635347 (Thread-44): handling status request
2021-12-03 23:35:02.635613 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758040>]}
2021-12-03 23:35:02.636125 (Thread-44): sending response (<Response 1209 bytes [200 OK]>) to 10.0.0.217
2021-12-03 23:35:03.090817 (Thread-45): handling compile_sql request
2021-12-03 23:35:03.091111 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758310>]}
2021-12-03 23:35:05.056708 (Thread-45): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-03 23:35:05.067890 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:05.081554 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e215f1a-390d-4f43-a170-5595d40c487e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdfad1e80>]}
2021-12-03 23:35:05.081819 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:35:05.082186 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:05.082288 (Thread-1): Compiling rpc.my_new_project.request
2021-12-03 23:35:05.084009 (Thread-1): finished collecting timing info
2021-12-03 23:35:05.084133 (Thread-1): finished collecting timing info
2021-12-03 23:35:05.510240 (Thread-46): handling poll request
2021-12-03 23:35:05.510580 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687586a0>]}
2021-12-03 23:35:05.511686 (Thread-46): sending response (<Response 5279 bytes [200 OK]>) to 10.0.13.223
2021-12-03 23:35:22.999247 (Thread-47): handling status request
2021-12-03 23:35:22.999538 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758a90>]}
2021-12-03 23:35:23.000021 (Thread-47): sending response (<Response 1209 bytes [200 OK]>) to 10.0.26.3
2021-12-03 23:35:23.431194 (Thread-48): handling run_sql request
2021-12-03 23:35:23.431503 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758d60>]}
2021-12-03 23:35:25.382907 (Thread-48): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-03 23:35:25.394068 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:25.407830 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a027f31-611d-445a-9a95-6ae3b8665b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37ced1f70>]}
2021-12-03 23:35:25.408067 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:35:25.408465 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:25.408604 (Thread-1): Compiling rpc.my_new_project.request
2021-12-03 23:35:25.410369 (Thread-1): finished collecting timing info
2021-12-03 23:35:25.411027 (Thread-1): Using snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:25.411094 (Thread-1): On rpc.my_new_project.request: -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
limit 500
/* limit added automatically by dbt cloud */
2021-12-03 23:35:25.411149 (Thread-1): Opening a new connection, currently in state init
2021-12-03 23:35:25.805093 (Thread-49): handling poll request
2021-12-03 23:35:25.805376 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6876ed30>]}
2021-12-03 23:35:25.806195 (Thread-49): sending response (<Response 3477 bytes [200 OK]>) to 10.0.22.219
2021-12-03 23:35:26.962568 (Thread-1): Snowflake query id: 01a0b607-3200-95c3-0000-00008ef9191d
2021-12-03 23:35:26.962761 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.
2021-12-03 23:35:26.962895 (Thread-1): finished collecting timing info
2021-12-03 23:35:26.963045 (Thread-1): On rpc.my_new_project.request: Close
2021-12-03 23:35:27.271088 (Thread-50): handling poll request
2021-12-03 23:35:27.271431 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6876ea00>]}
2021-12-03 23:35:27.271936 (Thread-50): sending response (<Response 1714 bytes [200 OK]>) to 10.0.37.206
2021-12-03 23:35:27.442978 (Thread-1): Got an exception: Database Error
  002003 (02000): SQL compilation error:
  Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (02000): SQL compilation error:
  Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.
2021-12-03 23:35:27.443941 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.", 'raw_sql': "-- Use the `ref` function to select from other models\n\nselect *\nfrom {{ ref('my_first_dbt_model') }}\nwhere id = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': '-- Use the `ref` function to select from other models\n\nselect *\nfrom raw.dbt_pstulnikov.my_first_dbt_model\nwhere id = 1\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.", 'raw_sql': "-- Use the `ref` function to select from other models\n\nselect *\nfrom {{ ref('my_first_dbt_model') }}\nwhere id = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': '-- Use the `ref` function to select from other models\n\nselect *\nfrom raw.dbt_pstulnikov.my_first_dbt_model\nwhere id = 1\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-12-03 23:35:28.745239 (Thread-51): handling poll request
2021-12-03 23:35:28.745549 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687772e0>]}
2021-12-03 23:35:28.746169 (Thread-51): sending response (<Response 10159 bytes [200 OK]>) to 10.0.36.143
2021-12-03 23:39:58.001601 (Thread-52): handling status request
2021-12-03 23:39:58.003466 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68777760>]}
2021-12-03 23:39:58.004032 (Thread-52): sending response (<Response 1209 bytes [200 OK]>) to 10.0.26.3
2021-12-03 23:39:58.527367 (Thread-53): handling compile_sql request
2021-12-03 23:39:58.527648 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687779d0>]}
2021-12-03 23:40:00.478384 (Thread-53): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-03 23:40:00.488926 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:40:00.506156 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7414be6b-c40f-4667-a54f-66feacf8df67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10baa4de20>]}
2021-12-03 23:40:00.506388 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:40:00.506763 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:40:00.506865 (Thread-1): Compiling rpc.my_new_project.request
2021-12-03 23:40:00.508589 (Thread-1): finished collecting timing info
2021-12-03 23:40:00.508701 (Thread-1): finished collecting timing info
2021-12-03 23:40:00.922741 (Thread-54): handling poll request
2021-12-03 23:40:00.923041 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758040>]}
2021-12-03 23:40:00.924074 (Thread-54): sending response (<Response 5279 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:43:04.130980 (MainThread): Running with dbt=0.21.0
2021-12-05 22:43:04.490266 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-12-05 22:43:04.498802 (MainThread): Tracking: tracking
2021-12-05 22:43:04.499041 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fe626580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7207a8f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c92ec6a0>]}
2021-12-05 22:43:04.500216 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2021-12-05 22:43:04.504571 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2021-12-05 22:43:04.504725 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-12-05 22:43:04.554010 (Thread-12): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-05 22:43:04.554302 (Thread-12): Partial parsing enabled, no changes found, skipping parsing
2021-12-05 22:43:04.560095 (Thread-12): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c92a4d30>]}
2021-12-05 22:43:07.841226 (Thread-13): handling status request
2021-12-05 22:43:07.841526 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922a400>]}
2021-12-05 22:43:07.842123 (Thread-13): sending response (<Response 1209 bytes [200 OK]>) to 10.0.2.25
2021-12-05 22:43:07.852532 (Thread-14): handling status request
2021-12-05 22:43:07.855363 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922a670>]}
2021-12-05 22:43:07.855736 (Thread-14): sending response (<Response 1209 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:43:07.902324 (Thread-15): handling status request
2021-12-05 22:43:07.902535 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922a850>]}
2021-12-05 22:43:07.902884 (Thread-15): sending response (<Response 1209 bytes [200 OK]>) to 10.0.6.10
2021-12-05 22:43:07.907981 (Thread-16): handling ps request
2021-12-05 22:43:07.908171 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922a640>]}
2021-12-05 22:43:07.908528 (Thread-16): sending response (<Response 105 bytes [200 OK]>) to 10.0.0.217
2021-12-05 22:43:09.567763 (Thread-17): handling status request
2021-12-05 22:43:09.568068 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922aa30>]}
2021-12-05 22:43:09.568539 (Thread-17): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:43:09.574462 (Thread-18): handling list request
2021-12-05 22:43:09.574664 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922aa90>]}
2021-12-05 22:43:09.644219 (Thread-21): sending response (<Response 7310 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:43:09.645235 (Thread-22): sending response (<Response 214 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:43:10.997650 (Thread-23): handling status request
2021-12-05 22:43:10.997949 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f8f8dbf4-5270-4f1a-8f54-2c63aff9fe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c9256370>]}
2021-12-05 22:43:10.998423 (Thread-23): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:43:11.004059 (Thread-24): handling list request
2021-12-05 22:43:11.004257 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f8f8dbf4-5270-4f1a-8f54-2c63aff9fe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81c98b0>]}
2021-12-05 22:43:11.036537 (Thread-24): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5e85ce6-e2da-4ad1-9672-e48d8f9f74a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81d75e0>]}
2021-12-05 22:43:11.036768 (Thread-24): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:43:11.040886 (Thread-24): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:44:55.556751 (Thread-25): handling status request
2021-12-05 22:44:55.559266 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd5e85ce6-e2da-4ad1-9672-e48d8f9f74a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81991f0>]}
2021-12-05 22:44:55.559730 (Thread-25): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:44:55.571459 (Thread-26): handling list request
2021-12-05 22:44:55.571655 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd5e85ce6-e2da-4ad1-9672-e48d8f9f74a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81994c0>]}
2021-12-05 22:44:55.607174 (Thread-26): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb82495d-5468-4e69-8f40-fba5379126b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81998b0>]}
2021-12-05 22:44:55.607408 (Thread-26): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:44:55.617365 (Thread-26): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:00.653820 (Thread-27): handling status request
2021-12-05 22:45:00.654121 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bb82495d-5468-4e69-8f40-fba5379126b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81d7ca0>]}
2021-12-05 22:45:00.654571 (Thread-27): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:00.664436 (Thread-28): handling list request
2021-12-05 22:45:00.664672 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bb82495d-5468-4e69-8f40-fba5379126b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81d7f40>]}
2021-12-05 22:45:00.697074 (Thread-28): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57b04557-6659-4417-9f43-cbc4655e370c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81b05b0>]}
2021-12-05 22:45:00.697317 (Thread-28): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:00.701477 (Thread-28): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:25.455191 (Thread-29): handling status request
2021-12-05 22:45:25.455489 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '57b04557-6659-4417-9f43-cbc4655e370c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81c9e50>]}
2021-12-05 22:45:25.455950 (Thread-29): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:25.462065 (Thread-30): handling list request
2021-12-05 22:45:25.462264 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '57b04557-6659-4417-9f43-cbc4655e370c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8199f40>]}
2021-12-05 22:45:25.502703 (Thread-30): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11085b92-60d5-4b56-aaa7-8201d34a26df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bc040>]}
2021-12-05 22:45:25.502949 (Thread-30): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:25.506920 (Thread-30): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:30.357136 (Thread-31): handling status request
2021-12-05 22:45:30.357474 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11085b92-60d5-4b56-aaa7-8201d34a26df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bca60>]}
2021-12-05 22:45:30.357961 (Thread-31): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:30.364777 (Thread-32): handling list request
2021-12-05 22:45:30.365017 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11085b92-60d5-4b56-aaa7-8201d34a26df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bcc70>]}
2021-12-05 22:45:30.396345 (Thread-32): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '019abfb7-96e0-45db-8a98-1c2228421193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bc640>]}
2021-12-05 22:45:30.429746 (Thread-32): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:30.432940 (Thread-32): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:39.218786 (Thread-33): handling status request
2021-12-05 22:45:39.221043 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '019abfb7-96e0-45db-8a98-1c2228421193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81b0670>]}
2021-12-05 22:45:39.221523 (Thread-33): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:39.227743 (Thread-34): handling list request
2021-12-05 22:45:39.227944 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '019abfb7-96e0-45db-8a98-1c2228421193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c814cd60>]}
2021-12-05 22:45:39.255802 (Thread-34): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8156460>]}
2021-12-05 22:45:39.256146 (Thread-34): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:39.261789 (Thread-34): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:41.326649 (Thread-35): handling status request
2021-12-05 22:45:41.326939 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bc8b0>]}
2021-12-05 22:45:41.327383 (Thread-35): sending response (<Response 1209 bytes [200 OK]>) to 10.0.6.71
2021-12-05 22:45:41.757858 (Thread-36): handling run_sql request
2021-12-05 22:45:41.758161 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bcaf0>]}
2021-12-05 22:45:43.698967 (Thread-36): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:45:43.710015 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 22:45:43.722934 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68ed090a-4200-40f6-8919-6f1d1144ce30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6b37efa0>]}
2021-12-05 22:45:43.723168 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:43.723526 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 22:45:43.723627 (Thread-1): Compiling rpc.my_new_project.request
2021-12-05 22:45:43.724569 (Thread-1): finished collecting timing info
2021-12-05 22:45:43.725060 (Thread-1): Using snowflake connection "rpc.my_new_project.request".
2021-12-05 22:45:43.725120 (Thread-1): On rpc.my_new_project.request: select * from raw.stripe.payment
limit 500
/* limit added automatically by dbt cloud */
2021-12-05 22:45:43.725174 (Thread-1): Opening a new connection, currently in state init
2021-12-05 22:45:44.142245 (Thread-37): handling poll request
2021-12-05 22:45:44.142553 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81642e0>]}
2021-12-05 22:45:44.143375 (Thread-37): sending response (<Response 3385 bytes [200 OK]>) to 10.0.2.25
2021-12-05 22:45:45.650185 (Thread-38): handling poll request
2021-12-05 22:45:45.650501 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81643d0>]}
2021-12-05 22:45:45.650969 (Thread-38): sending response (<Response 399 bytes [200 OK]>) to 10.0.38.50
2021-12-05 22:45:46.084078 (Thread-1): SQL status: SUCCESS 120 in 2.36 seconds
2021-12-05 22:45:46.088882 (Thread-1): finished collecting timing info
2021-12-05 22:45:46.089073 (Thread-1): On rpc.my_new_project.request: Close
2021-12-05 22:45:47.143012 (Thread-39): handling poll request
2021-12-05 22:45:47.143327 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8164bb0>]}
2021-12-05 22:45:47.144996 (Thread-39): sending response (<Response 14398 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:45:57.244744 (Thread-40): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 22:45:57.245090 (Thread-40): Partial parsing: updated file: my_new_project://models/example/my_first_dbt_model.sql
2021-12-05 22:45:57.255181 (Thread-40): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:45:57.338506 (Thread-40): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8126550>]}
2021-12-05 22:45:58.031248 (Thread-41): handling status request
2021-12-05 22:45:58.031565 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c80be130>]}
2021-12-05 22:45:58.032103 (Thread-41): sending response (<Response 1546 bytes [200 OK]>) to 10.0.38.50
2021-12-05 22:45:58.038441 (Thread-42): handling status request
2021-12-05 22:45:58.038639 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c92ed310>]}
2021-12-05 22:45:58.039015 (Thread-42): sending response (<Response 1546 bytes [200 OK]>) to 10.0.3.73
2021-12-05 22:46:29.441069 (Thread-43): handling status request
2021-12-05 22:46:29.443467 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81262e0>]}
2021-12-05 22:46:29.443971 (Thread-43): sending response (<Response 1546 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:46:29.810187 (Thread-44): handling status request
2021-12-05 22:46:29.810431 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8126520>]}
2021-12-05 22:46:29.810872 (Thread-44): sending response (<Response 1546 bytes [200 OK]>) to 10.0.38.70
2021-12-05 22:46:29.883834 (Thread-45): handling cli_args request
2021-12-05 22:46:29.884057 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81268e0>]}
2021-12-05 22:46:29.895236 (Thread-45): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:46:31.814347 (Thread-45): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-05 22:46:31.850296 (MainThread): Partial parsing not enabled
2021-12-05 22:46:31.897789 (MainThread): Parsing macros/catalog.sql
2021-12-05 22:46:31.899714 (MainThread): Parsing macros/adapters.sql
2021-12-05 22:46:31.934128 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 22:46:31.937782 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 22:46:31.940986 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 22:46:31.945260 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 22:46:31.946499 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 22:46:31.954602 (MainThread): Parsing macros/core.sql
2021-12-05 22:46:31.958137 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 22:46:31.964425 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 22:46:31.973944 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 22:46:31.980597 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 22:46:31.984282 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 22:46:32.005768 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 22:46:32.021992 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 22:46:32.023533 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 22:46:32.053144 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 22:46:32.060075 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 22:46:32.073245 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 22:46:32.091855 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 22:46:32.101385 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 22:46:32.103050 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 22:46:32.104425 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 22:46:32.112343 (MainThread): Parsing macros/etc/query.sql
2021-12-05 22:46:32.113316 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 22:46:32.114949 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 22:46:32.116381 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 22:46:32.118740 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 22:46:32.120103 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 22:46:32.172675 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 22:46:32.174758 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 22:46:32.175836 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 22:46:32.177358 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 22:46:32.295373 (Thread-46): handling poll request
2021-12-05 22:46:32.295664 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8042400>]}
2021-12-05 22:46:32.296725 (Thread-46): sending response (<Response 9652 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:46:32.361464 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:46:32.373894 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:46:32.452080 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '494035c8-8b8a-4026-a2f5-c84f8f2d7aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbdb46280>]}
2021-12-05 22:46:32.483436 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '494035c8-8b8a-4026-a2f5-c84f8f2d7aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbdb464c0>]}
2021-12-05 22:46:32.483637 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:46:32.484763 (MainThread): 
2021-12-05 22:46:32.484965 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:46:32.485709 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 22:46:32.497621 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 22:46:32.497692 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 22:46:32.497747 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 22:46:33.899110 (Thread-47): handling poll request
2021-12-05 22:46:33.899437 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c807c400>]}
2021-12-05 22:46:33.900016 (Thread-47): sending response (<Response 4009 bytes [200 OK]>) to 10.0.26.3
2021-12-05 22:46:34.023082 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.53 seconds
2021-12-05 22:46:34.024954 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 22:46:34.477672 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:46:34.484444 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:46:34.484558 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 22:46:34.484625 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 22:46:35.380173 (Thread-48): handling poll request
2021-12-05 22:46:35.380484 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c807cb50>]}
2021-12-05 22:46:35.381030 (Thread-48): sending response (<Response 2221 bytes [200 OK]>) to 10.0.41.241
2021-12-05 22:46:35.887881 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.40 seconds
2021-12-05 22:46:35.889072 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 22:46:36.339771 (MainThread): 22:46:36 | Concurrency: 4 threads (target='default')
2021-12-05 22:46:36.339916 (MainThread): 22:46:36 | 
2021-12-05 22:46:36.341863 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 22:46:36.342140 (Thread-1): 22:46:36 | 1 of 2 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 22:46:36.342366 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:46:36.342466 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 22:46:36.345006 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:46:36.384669 (Thread-1): finished collecting timing info
2021-12-05 22:46:36.405055 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:46:36.446795 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:46:36.446875 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment;
2021-12-05 22:46:36.446936 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 22:46:36.874488 (Thread-49): handling poll request
2021-12-05 22:46:36.874779 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c80771c0>]}
2021-12-05 22:46:36.875385 (Thread-49): sending response (<Response 5643 bytes [200 OK]>) to 10.0.39.19
2021-12-05 22:46:37.713105 (Thread-1): Snowflake query id: 01a0c116-3200-95c4-0000-00008ef92959
2021-12-05 22:46:37.713237 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 2 at position 36 unexpected ';'.
2021-12-05 22:46:37.713372 (Thread-1): finished collecting timing info
2021-12-05 22:46:37.713479 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 22:46:38.243834 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 36 unexpected ';'.
  compiled SQL at target/run/my_new_project/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 36 unexpected ';'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 36 unexpected ';'.
  compiled SQL at target/run/my_new_project/models/example/my_first_dbt_model.sql
2021-12-05 22:46:38.244714 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494035c8-8b8a-4026-a2f5-c84f8f2d7aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbcd28130>]}
2021-12-05 22:46:38.245059 (Thread-1): 22:46:38 | 1 of 2 ERROR creating view model dbt_pstulnikov.my_first_dbt_model... [ERROR in 1.90s]
2021-12-05 22:46:38.245146 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 22:46:38.246243 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 22:46:38.246408 (Thread-3): 22:46:38 | 2 of 2 SKIP relation dbt_pstulnikov.my_second_dbt_model.............. [SKIP]
2021-12-05 22:46:38.246488 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 22:46:38.247704 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:46:38.247983 (MainThread): 22:46:38 | 
2021-12-05 22:46:38.248049 (MainThread): 22:46:38 | Finished running 2 view models in 5.76s.
2021-12-05 22:46:38.248096 (MainThread): Connection 'master' was properly closed.
2021-12-05 22:46:38.248135 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:46:38.300448 (MainThread): 
2021-12-05 22:46:38.300568 (MainThread): Completed with 1 error and 0 warnings:
2021-12-05 22:46:38.300625 (MainThread): 
2021-12-05 22:46:38.300676 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-12-05 22:46:38.300718 (MainThread):   001003 (42000): SQL compilation error:
2021-12-05 22:46:38.300754 (MainThread):   syntax error line 2 at position 36 unexpected ';'.
2021-12-05 22:46:38.300790 (MainThread):   compiled SQL at target/run/my_new_project/models/example/my_first_dbt_model.sql
2021-12-05 22:46:38.300833 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-12-05 22:46:38.389216 (Thread-50): handling poll request
2021-12-05 22:46:38.389522 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7c2c40>]}
2021-12-05 22:46:38.390264 (Thread-50): sending response (<Response 15551 bytes [200 OK]>) to 10.0.38.50
2021-12-05 22:46:39.917285 (Thread-51): handling poll request
2021-12-05 22:46:39.917608 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7c2be0>]}
2021-12-05 22:46:39.918560 (Thread-51): sending response (<Response 4340 bytes [200 OK]>) to 10.0.2.25
2021-12-05 22:46:40.810011 (Thread-52): handling status request
2021-12-05 22:46:40.810320 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7c2d00>]}
2021-12-05 22:46:40.810818 (Thread-52): sending response (<Response 1546 bytes [200 OK]>) to 10.0.3.73
2021-12-05 22:46:40.868720 (Thread-53): handling status request
2021-12-05 22:46:40.868959 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7c90d0>]}
2021-12-05 22:46:40.869366 (Thread-53): sending response (<Response 1546 bytes [200 OK]>) to 10.0.41.241
2021-12-05 22:46:56.982568 (Thread-54): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 22:46:56.982960 (Thread-54): Partial parsing: updated file: my_new_project://models/example/my_first_dbt_model.sql
2021-12-05 22:46:56.986706 (Thread-54): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:46:57.038384 (Thread-54): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6fff10>]}
2021-12-05 22:46:57.780284 (Thread-55): handling status request
2021-12-05 22:46:57.780647 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8199d00>]}
2021-12-05 22:46:57.781140 (Thread-55): sending response (<Response 1546 bytes [200 OK]>) to 10.0.0.217
2021-12-05 22:46:57.844244 (Thread-56): handling status request
2021-12-05 22:46:57.844477 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7aff10>]}
2021-12-05 22:46:57.844947 (Thread-56): sending response (<Response 1546 bytes [200 OK]>) to 10.0.39.19
2021-12-05 22:47:00.747125 (Thread-57): handling status request
2021-12-05 22:47:00.747448 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7afee0>]}
2021-12-05 22:47:00.747933 (Thread-57): sending response (<Response 1546 bytes [200 OK]>) to 10.0.38.70
2021-12-05 22:47:01.104209 (Thread-58): handling status request
2021-12-05 22:47:01.104553 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7af340>]}
2021-12-05 22:47:01.105052 (Thread-58): sending response (<Response 1546 bytes [200 OK]>) to 10.0.6.10
2021-12-05 22:47:01.183659 (Thread-59): handling cli_args request
2021-12-05 22:47:01.183904 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7af8e0>]}
2021-12-05 22:47:01.195135 (Thread-59): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:47:03.137299 (Thread-59): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.3
2021-12-05 22:47:03.175639 (MainThread): Partial parsing not enabled
2021-12-05 22:47:03.211345 (MainThread): Parsing macros/catalog.sql
2021-12-05 22:47:03.213309 (MainThread): Parsing macros/adapters.sql
2021-12-05 22:47:03.247353 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 22:47:03.250968 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 22:47:03.254206 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 22:47:03.258519 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 22:47:03.259747 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 22:47:03.267969 (MainThread): Parsing macros/core.sql
2021-12-05 22:47:03.271552 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 22:47:03.277877 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 22:47:03.287374 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 22:47:03.294138 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 22:47:03.297733 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 22:47:03.319701 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 22:47:03.336040 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 22:47:03.337597 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 22:47:03.367190 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 22:47:03.374148 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 22:47:03.387258 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 22:47:03.405771 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 22:47:03.415282 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 22:47:03.416997 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 22:47:03.418349 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 22:47:03.426261 (MainThread): Parsing macros/etc/query.sql
2021-12-05 22:47:03.427233 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 22:47:03.428877 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 22:47:03.430311 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 22:47:03.432673 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 22:47:03.434068 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 22:47:03.486819 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 22:47:03.488906 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 22:47:03.489982 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 22:47:03.491475 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 22:47:03.614659 (Thread-60): handling poll request
2021-12-05 22:47:03.614999 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc76c790>]}
2021-12-05 22:47:03.616055 (Thread-60): sending response (<Response 9652 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:47:03.675608 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:47:03.688584 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:47:03.767356 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90247053-ae40-4076-9a0a-64b8fad42b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83877c8a00>]}
2021-12-05 22:47:03.796627 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90247053-ae40-4076-9a0a-64b8fad42b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838c069070>]}
2021-12-05 22:47:03.796832 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:47:03.797909 (MainThread): 
2021-12-05 22:47:03.798118 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:47:03.798908 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 22:47:03.810884 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 22:47:03.810955 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 22:47:03.811011 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 22:47:05.097623 (Thread-61): handling poll request
2021-12-05 22:47:05.097938 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc773c10>]}
2021-12-05 22:47:05.126647 (Thread-61): sending response (<Response 4009 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:47:05.336302 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.53 seconds
2021-12-05 22:47:05.338213 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 22:47:05.797376 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:47:05.804397 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:47:05.804523 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 22:47:05.804593 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 22:47:06.597176 (Thread-62): handling poll request
2021-12-05 22:47:06.597536 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8119ac0>]}
2021-12-05 22:47:06.598080 (Thread-62): sending response (<Response 2221 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:47:07.094843 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.29 seconds
2021-12-05 22:47:07.096058 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 22:47:07.549925 (MainThread): 22:47:07 | Concurrency: 4 threads (target='default')
2021-12-05 22:47:07.550071 (MainThread): 22:47:07 | 
2021-12-05 22:47:07.552041 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 22:47:07.552328 (Thread-1): 22:47:07 | 1 of 2 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 22:47:07.552581 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:47:07.552683 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 22:47:07.555214 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:47:07.571712 (Thread-1): finished collecting timing info
2021-12-05 22:47:07.592218 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:47:07.608917 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:47:07.609004 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment
  );
2021-12-05 22:47:07.609063 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 22:47:08.156071 (Thread-63): handling poll request
2021-12-05 22:47:08.156385 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc726dc0>]}
2021-12-05 22:47:08.157055 (Thread-63): sending response (<Response 5648 bytes [200 OK]>) to 10.0.38.70
2021-12-05 22:47:09.138274 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2021-12-05 22:47:09.144905 (Thread-1): finished collecting timing info
2021-12-05 22:47:09.145041 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 22:47:09.606377 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90247053-ae40-4076-9a0a-64b8fad42b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838c05ab50>]}
2021-12-05 22:47:09.606817 (Thread-1): 22:47:09 | 1 of 2 OK created view model dbt_pstulnikov.my_first_dbt_model....... [SUCCESS 1 in 2.05s]
2021-12-05 22:47:09.606907 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 22:47:09.607794 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 22:47:09.608022 (Thread-3): 22:47:09 | 2 of 2 START view model dbt_pstulnikov.my_second_dbt_model........... [RUN]
2021-12-05 22:47:09.608271 (Thread-3): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:47:09.608347 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2021-12-05 22:47:09.611080 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 22:47:09.614076 (Thread-64): handling poll request
2021-12-05 22:47:09.614305 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc707be0>]}
2021-12-05 22:47:09.614880 (Thread-64): sending response (<Response 4882 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:47:09.621670 (Thread-3): finished collecting timing info
2021-12-05 22:47:09.623285 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 22:47:09.634657 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:47:09.634738 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
  );
2021-12-05 22:47:09.634797 (Thread-3): Opening a new connection, currently in state init
2021-12-05 22:47:11.027182 (Thread-3): SQL status: SUCCESS 1 in 1.39 seconds
2021-12-05 22:47:11.028607 (Thread-3): finished collecting timing info
2021-12-05 22:47:11.028749 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2021-12-05 22:47:11.049153 (Thread-65): handling poll request
2021-12-05 22:47:11.049435 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc765040>]}
2021-12-05 22:47:11.050021 (Thread-65): sending response (<Response 3649 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:47:11.488116 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90247053-ae40-4076-9a0a-64b8fad42b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8386948d30>]}
2021-12-05 22:47:11.488534 (Thread-3): 22:47:11 | 2 of 2 OK created view model dbt_pstulnikov.my_second_dbt_model...... [SUCCESS 1 in 1.88s]
2021-12-05 22:47:11.488626 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 22:47:11.490152 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:47:11.490435 (MainThread): 22:47:11 | 
2021-12-05 22:47:11.490502 (MainThread): 22:47:11 | Finished running 2 view models in 7.69s.
2021-12-05 22:47:11.490550 (MainThread): Connection 'master' was properly closed.
2021-12-05 22:47:11.490590 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:47:11.490625 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-12-05 22:47:11.547988 (MainThread): 
2021-12-05 22:47:11.548098 (MainThread): Completed successfully
2021-12-05 22:47:11.548160 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-12-05 22:47:12.487895 (Thread-66): handling poll request
2021-12-05 22:47:12.488208 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc765e20>]}
2021-12-05 22:47:12.489275 (Thread-66): sending response (<Response 9458 bytes [200 OK]>) to 10.0.6.71
2021-12-05 22:47:13.417524 (Thread-67): handling status request
2021-12-05 22:47:13.417850 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc766eb0>]}
2021-12-05 22:47:13.427676 (Thread-67): sending response (<Response 1546 bytes [200 OK]>) to 10.0.30.196
2021-12-05 22:47:13.459489 (Thread-68): handling status request
2021-12-05 22:47:13.459739 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc766fd0>]}
2021-12-05 22:47:13.460189 (Thread-68): sending response (<Response 1546 bytes [200 OK]>) to 10.0.3.73
2021-12-05 22:56:17.072861 (Thread-69): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-05 22:56:17.074922 (Thread-69): Partial parsing: added file: my_new_project://models/dim_customers.sql
2021-12-05 22:56:17.078484 (Thread-69): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:56:17.121262 (Thread-69): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc72efd0>]}
2021-12-05 22:56:18.112791 (Thread-70): handling status request
2021-12-05 22:56:18.113084 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc72ee50>]}
2021-12-05 22:56:18.113560 (Thread-70): sending response (<Response 1526 bytes [200 OK]>) to 10.0.30.196
2021-12-05 22:56:18.140045 (Thread-71): handling status request
2021-12-05 22:56:18.140245 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b6340>]}
2021-12-05 22:56:18.140627 (Thread-71): sending response (<Response 1526 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:56:44.460888 (Thread-72): handling status request
2021-12-05 22:56:44.461184 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b6520>]}
2021-12-05 22:56:44.461641 (Thread-72): sending response (<Response 1526 bytes [200 OK]>) to 10.0.2.25
2021-12-05 22:56:44.908827 (Thread-73): handling run_sql request
2021-12-05 22:56:44.909140 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b6970>]}
2021-12-05 22:56:44.910553 (Thread-73): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 22:56:46.863946 (Thread-73): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-05 22:56:46.874992 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 22:56:46.888038 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47d84076-8232-4bef-a0c9-8910d7f45637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5279a5730>]}
2021-12-05 22:56:46.888283 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:56:46.888670 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 22:56:46.888775 (Thread-1): Compiling rpc.my_new_project.request
2021-12-05 22:56:46.889719 (Thread-1): finished collecting timing info
2021-12-05 22:56:46.891021 (Thread-1): Using snowflake connection "rpc.my_new_project.request".
2021-12-05 22:56:46.891086 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-05 22:56:46.891142 (Thread-1): Opening a new connection, currently in state init
2021-12-05 22:56:47.307137 (Thread-74): handling poll request
2021-12-05 22:56:47.307491 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b6e80>]}
2021-12-05 22:56:47.308391 (Thread-74): sending response (<Response 4291 bytes [200 OK]>) to 10.0.3.73
2021-12-05 22:56:48.572604 (Thread-1): SQL status: SUCCESS 100 in 1.68 seconds
2021-12-05 22:56:48.576641 (Thread-1): finished collecting timing info
2021-12-05 22:56:48.576838 (Thread-1): On rpc.my_new_project.request: Close
2021-12-05 22:56:48.786577 (Thread-75): handling poll request
2021-12-05 22:56:48.786897 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b40d0>]}
2021-12-05 22:56:48.787440 (Thread-75): sending response (<Response 1333 bytes [200 OK]>) to 10.0.37.206
2021-12-05 22:56:50.264609 (Thread-76): handling poll request
2021-12-05 22:56:50.264930 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b44f0>]}
2021-12-05 22:56:50.266224 (Thread-76): sending response (<Response 11265 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:57:11.737818 (Thread-77): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 22:57:11.738140 (Thread-77): Partial parsing: updated file: my_new_project://models/dim_customers.sql
2021-12-05 22:57:11.742297 (Thread-77): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:57:11.787215 (Thread-77): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f47f0>]}
2021-12-05 22:57:12.541430 (Thread-78): handling status request
2021-12-05 22:57:12.541741 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f4940>]}
2021-12-05 22:57:12.542237 (Thread-78): sending response (<Response 1528 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:57:12.573084 (Thread-79): handling status request
2021-12-05 22:57:12.573338 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f44f0>]}
2021-12-05 22:57:12.573805 (Thread-79): sending response (<Response 1528 bytes [200 OK]>) to 10.0.39.19
2021-12-05 22:57:47.829256 (Thread-80): handling status request
2021-12-05 22:57:47.829590 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f4ca0>]}
2021-12-05 22:57:47.830052 (Thread-80): sending response (<Response 1528 bytes [200 OK]>) to 10.0.0.217
2021-12-05 22:57:48.183306 (Thread-81): handling status request
2021-12-05 22:57:48.183560 (Thread-81): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f48e0>]}
2021-12-05 22:57:48.184008 (Thread-81): sending response (<Response 1528 bytes [200 OK]>) to 10.0.38.70
2021-12-05 22:57:48.284957 (Thread-82): handling cli_args request
2021-12-05 22:57:48.285388 (Thread-82): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc639610>]}
2021-12-05 22:57:48.295523 (Thread-82): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 22:57:50.232424 (Thread-82): sending response (<Response 138 bytes [200 OK]>) to 10.0.13.223
2021-12-05 22:57:50.269871 (MainThread): Partial parsing not enabled
2021-12-05 22:57:50.309314 (MainThread): Parsing macros/catalog.sql
2021-12-05 22:57:50.311230 (MainThread): Parsing macros/adapters.sql
2021-12-05 22:57:50.345164 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 22:57:50.348774 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 22:57:50.351905 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 22:57:50.356083 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 22:57:50.357341 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 22:57:50.365502 (MainThread): Parsing macros/core.sql
2021-12-05 22:57:50.369015 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 22:57:50.375268 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 22:57:50.384703 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 22:57:50.391331 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 22:57:50.394992 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 22:57:50.416557 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 22:57:50.432736 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 22:57:50.434285 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 22:57:50.463760 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 22:57:50.470653 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 22:57:50.483724 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 22:57:50.502213 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 22:57:50.511630 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 22:57:50.513299 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 22:57:50.514665 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 22:57:50.522513 (MainThread): Parsing macros/etc/query.sql
2021-12-05 22:57:50.523446 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 22:57:50.525097 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 22:57:50.526529 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 22:57:50.528862 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 22:57:50.530228 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 22:57:50.582532 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 22:57:50.584627 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 22:57:50.585710 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 22:57:50.587207 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 22:57:50.676399 (Thread-83): handling poll request
2021-12-05 22:57:50.676705 (Thread-83): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f4f70>]}
2021-12-05 22:57:50.677736 (Thread-83): sending response (<Response 9652 bytes [200 OK]>) to 10.0.19.103
2021-12-05 22:57:50.769069 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:57:50.780668 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:57:50.784156 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:57:50.867075 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8225eca00>]}
2021-12-05 22:57:50.898261 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc822596ac0>]}
2021-12-05 22:57:50.898460 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:57:50.899590 (MainThread): 
2021-12-05 22:57:50.899792 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:57:50.900589 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 22:57:50.912225 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 22:57:50.912294 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 22:57:50.912348 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 22:57:52.234436 (Thread-84): handling poll request
2021-12-05 22:57:52.234757 (Thread-84): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f21f0>]}
2021-12-05 22:57:52.235341 (Thread-84): sending response (<Response 4316 bytes [200 OK]>) to 10.0.0.217
2021-12-05 22:57:52.417579 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.51 seconds
2021-12-05 22:57:52.419430 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 22:57:52.879514 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:57:52.886498 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:57:52.886603 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 22:57:52.886668 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 22:57:53.673719 (Thread-85): handling poll request
2021-12-05 22:57:53.674044 (Thread-85): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f2dc0>]}
2021-12-05 22:57:53.674568 (Thread-85): sending response (<Response 2221 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:57:54.300281 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.41 seconds
2021-12-05 22:57:54.301699 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 22:57:54.757623 (MainThread): 22:57:54 | Concurrency: 4 threads (target='default')
2021-12-05 22:57:54.757759 (MainThread): 22:57:54 | 
2021-12-05 22:57:54.759681 (Thread-1): Began running node model.my_new_project.dim_customers
2021-12-05 22:57:54.759970 (Thread-1): 22:57:54 | 1 of 3 START view model dbt_pstulnikov.dim_customers................. [RUN]
2021-12-05 22:57:54.760202 (Thread-1): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:57:54.760304 (Thread-1): Compiling model.my_new_project.dim_customers
2021-12-05 22:57:54.761158 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 22:57:54.761374 (Thread-2): 22:57:54 | 2 of 3 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 22:57:54.761600 (Thread-2): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:57:54.761671 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 22:57:54.762767 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:57:54.763939 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 22:57:54.773849 (Thread-1): finished collecting timing info
2021-12-05 22:57:54.784281 (Thread-2): finished collecting timing info
2021-12-05 22:57:54.804052 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:57:54.805489 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 22:57:54.817619 (Thread-1): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:57:54.817702 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */

  create or replace  view raw.dbt_pstulnikov.dim_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-12-05 22:57:54.817762 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 22:57:54.823131 (Thread-2): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:57:54.823215 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment
  );
2021-12-05 22:57:54.823270 (Thread-2): Opening a new connection, currently in state init
2021-12-05 22:57:55.122824 (Thread-86): handling poll request
2021-12-05 22:57:55.123101 (Thread-86): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5efe20>]}
2021-12-05 22:57:55.123835 (Thread-86): sending response (<Response 10684 bytes [200 OK]>) to 10.0.6.10
2021-12-05 22:57:56.317788 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-12-05 22:57:56.324385 (Thread-1): finished collecting timing info
2021-12-05 22:57:56.324537 (Thread-1): On model.my_new_project.dim_customers: Close
2021-12-05 22:57:56.326252 (Thread-2): SQL status: SUCCESS 1 in 1.50 seconds
2021-12-05 22:57:56.327307 (Thread-2): finished collecting timing info
2021-12-05 22:57:56.327413 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 22:57:56.597161 (Thread-87): handling poll request
2021-12-05 22:57:56.597529 (Thread-87): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5efe20>]}
2021-12-05 22:57:56.598093 (Thread-87): sending response (<Response 2514 bytes [200 OK]>) to 10.0.31.30
2021-12-05 22:57:56.772263 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8216d0700>]}
2021-12-05 22:57:56.772711 (Thread-1): 22:57:56 | 1 of 3 OK created view model dbt_pstulnikov.dim_customers............ [SUCCESS 1 in 2.01s]
2021-12-05 22:57:56.772809 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-12-05 22:57:56.780853 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82171b280>]}
2021-12-05 22:57:56.781157 (Thread-2): 22:57:56 | 2 of 3 OK created view model dbt_pstulnikov.my_first_dbt_model....... [SUCCESS 1 in 2.02s]
2021-12-05 22:57:56.781240 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 22:57:56.782060 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 22:57:56.782296 (Thread-4): 22:57:56 | 3 of 3 START view model dbt_pstulnikov.my_second_dbt_model........... [RUN]
2021-12-05 22:57:56.782534 (Thread-4): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:57:56.782628 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2021-12-05 22:57:56.784796 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 22:57:56.799566 (Thread-4): finished collecting timing info
2021-12-05 22:57:56.802135 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 22:57:56.817798 (Thread-4): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:57:56.817877 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
  );
2021-12-05 22:57:56.817935 (Thread-4): Opening a new connection, currently in state init
2021-12-05 22:57:58.051992 (Thread-88): handling poll request
2021-12-05 22:57:58.052299 (Thread-88): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5dcd90>]}
2021-12-05 22:57:58.052976 (Thread-88): sending response (<Response 7293 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:57:58.212699 (Thread-4): SQL status: SUCCESS 1 in 1.39 seconds
2021-12-05 22:57:58.214069 (Thread-4): finished collecting timing info
2021-12-05 22:57:58.214196 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2021-12-05 22:57:58.658077 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8216d4cd0>]}
2021-12-05 22:57:58.658431 (Thread-4): 22:57:58 | 3 of 3 OK created view model dbt_pstulnikov.my_second_dbt_model...... [SUCCESS 1 in 1.88s]
2021-12-05 22:57:58.658514 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 22:57:58.659968 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:57:58.660255 (MainThread): 22:57:58 | 
2021-12-05 22:57:58.660325 (MainThread): 22:57:58 | Finished running 3 view models in 7.76s.
2021-12-05 22:57:58.660374 (MainThread): Connection 'master' was properly closed.
2021-12-05 22:57:58.660416 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 22:57:58.660452 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:57:58.660508 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-12-05 22:57:58.718787 (MainThread): 
2021-12-05 22:57:58.718894 (MainThread): Completed successfully
2021-12-05 22:57:58.718956 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-05 22:57:59.538962 (Thread-89): handling poll request
2021-12-05 22:57:59.539296 (Thread-89): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc597040>]}
2021-12-05 22:57:59.540707 (Thread-89): sending response (<Response 14695 bytes [200 OK]>) to 10.0.26.3
2021-12-05 22:58:00.463188 (Thread-90): handling status request
2021-12-05 22:58:00.463494 (Thread-90): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5dc2e0>]}
2021-12-05 22:58:00.464012 (Thread-90): sending response (<Response 1528 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:58:00.775545 (Thread-91): handling status request
2021-12-05 22:58:00.775830 (Thread-91): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5ef5b0>]}
2021-12-05 22:58:00.798753 (Thread-91): sending response (<Response 1528 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:01:15.637033 (Thread-92): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 23:01:15.638903 (Thread-92): Partial parsing: updated file: my_new_project://models/dim_customers.sql
2021-12-05 23:01:15.642499 (Thread-92): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:15.693240 (Thread-92): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc553a30>]}
2021-12-05 23:01:16.433388 (Thread-93): handling status request
2021-12-05 23:01:16.433713 (Thread-93): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4ff340>]}
2021-12-05 23:01:16.434244 (Thread-93): sending response (<Response 1528 bytes [200 OK]>) to 10.0.6.71
2021-12-05 23:01:16.477420 (Thread-94): handling status request
2021-12-05 23:01:16.477638 (Thread-94): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4fff40>]}
2021-12-05 23:01:16.478056 (Thread-94): sending response (<Response 1528 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:01:18.429138 (Thread-95): handling status request
2021-12-05 23:01:18.429457 (Thread-95): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4ffdf0>]}
2021-12-05 23:01:18.429933 (Thread-95): sending response (<Response 1528 bytes [200 OK]>) to 10.0.30.196
2021-12-05 23:01:18.869527 (Thread-96): handling run_sql request
2021-12-05 23:01:18.870059 (Thread-96): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5964f0>]}
2021-12-05 23:01:18.871191 (Thread-96): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:01:20.808211 (Thread-96): sending response (<Response 138 bytes [200 OK]>) to 10.0.30.196
2021-12-05 23:01:20.819098 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 23:01:20.832838 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e5e712d-7afd-477c-a33a-3ce2d263b7c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5881eca2e0>]}
2021-12-05 23:01:20.833077 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:01:20.833507 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 23:01:20.833639 (Thread-1): Compiling rpc.my_new_project.request
2021-12-05 23:01:20.835422 (Thread-1): finished collecting timing info
2021-12-05 23:01:20.836875 (Thread-1): Using snowflake connection "rpc.my_new_project.request".
2021-12-05 23:01:20.836943 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-05 23:01:20.836996 (Thread-1): Opening a new connection, currently in state init
2021-12-05 23:01:21.282098 (Thread-97): handling poll request
2021-12-05 23:01:21.282434 (Thread-97): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5352b0>]}
2021-12-05 23:01:21.283304 (Thread-97): sending response (<Response 4291 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:01:22.322596 (Thread-1): SQL status: SUCCESS 100 in 1.49 seconds
2021-12-05 23:01:22.327810 (Thread-1): finished collecting timing info
2021-12-05 23:01:22.328067 (Thread-1): On rpc.my_new_project.request: Close
2021-12-05 23:01:22.727777 (Thread-98): handling poll request
2021-12-05 23:01:22.728080 (Thread-98): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535670>]}
2021-12-05 23:01:22.728634 (Thread-98): sending response (<Response 1333 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:01:24.170344 (Thread-99): handling poll request
2021-12-05 23:01:24.170649 (Thread-99): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535a60>]}
2021-12-05 23:01:24.171926 (Thread-99): sending response (<Response 11392 bytes [200 OK]>) to 10.0.22.219
2021-12-05 23:01:38.802447 (Thread-100): handling status request
2021-12-05 23:01:38.802760 (Thread-100): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535820>]}
2021-12-05 23:01:38.803264 (Thread-100): sending response (<Response 1528 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:01:39.347949 (Thread-101): handling status request
2021-12-05 23:01:39.348304 (Thread-101): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535eb0>]}
2021-12-05 23:01:39.348795 (Thread-101): sending response (<Response 1528 bytes [200 OK]>) to 10.0.26.3
2021-12-05 23:01:39.389721 (Thread-102): handling cli_args request
2021-12-05 23:01:39.389970 (Thread-102): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535dc0>]}
2021-12-05 23:01:41.334640 (Thread-102): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:01:41.371742 (MainThread): Partial parsing not enabled
2021-12-05 23:01:41.407980 (MainThread): Parsing macros/catalog.sql
2021-12-05 23:01:41.409972 (MainThread): Parsing macros/adapters.sql
2021-12-05 23:01:41.444077 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 23:01:41.447726 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 23:01:41.450969 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 23:01:41.455232 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 23:01:41.456484 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 23:01:41.464570 (MainThread): Parsing macros/core.sql
2021-12-05 23:01:41.468077 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 23:01:41.474345 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 23:01:41.483786 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 23:01:41.490403 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:01:41.494104 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:01:41.515534 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:01:41.531694 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:01:41.533245 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:01:41.562524 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 23:01:41.569451 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 23:01:41.582582 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:01:41.601098 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:01:41.610491 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:01:41.612139 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:01:41.613512 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 23:01:41.621364 (MainThread): Parsing macros/etc/query.sql
2021-12-05 23:01:41.622297 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 23:01:41.623929 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:01:41.625380 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:01:41.627685 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 23:01:41.629058 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 23:01:41.681754 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:01:41.683838 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:01:41.684940 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:01:41.686442 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 23:01:41.859015 (Thread-103): handling poll request
2021-12-05 23:01:41.859357 (Thread-103): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4db730>]}
2021-12-05 23:01:41.860409 (Thread-103): sending response (<Response 9652 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:01:41.868614 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:41.881086 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:01:41.884275 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:01:41.966824 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1982b8fd0>]}
2021-12-05 23:01:42.000948 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1982bd0d0>]}
2021-12-05 23:01:42.001246 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:01:42.002961 (MainThread): 
2021-12-05 23:01:42.003263 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:01:42.004297 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 23:01:42.016455 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 23:01:42.016560 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 23:01:42.016619 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:01:43.537732 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.52 seconds
2021-12-05 23:01:43.539678 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 23:01:43.578017 (Thread-104): handling poll request
2021-12-05 23:01:43.578327 (Thread-104): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4d41c0>]}
2021-12-05 23:01:43.578956 (Thread-104): sending response (<Response 4862 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:01:43.995595 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:01:44.002572 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:01:44.002676 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 23:01:44.002742 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 23:01:45.029858 (Thread-105): handling poll request
2021-12-05 23:01:45.030189 (Thread-105): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc52b940>]}
2021-12-05 23:01:45.030733 (Thread-105): sending response (<Response 1674 bytes [200 OK]>) to 10.0.31.30
2021-12-05 23:01:45.444725 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.44 seconds
2021-12-05 23:01:45.446158 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 23:01:45.900514 (MainThread): 23:01:45 | Concurrency: 4 threads (target='default')
2021-12-05 23:01:45.900664 (MainThread): 23:01:45 | 
2021-12-05 23:01:45.902652 (Thread-1): Began running node model.my_new_project.dim_customers
2021-12-05 23:01:45.902954 (Thread-1): 23:01:45 | 1 of 3 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-05 23:01:45.903186 (Thread-1): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:45.903287 (Thread-1): Compiling model.my_new_project.dim_customers
2021-12-05 23:01:45.904163 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 23:01:45.904399 (Thread-2): 23:01:45 | 2 of 3 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 23:01:45.904653 (Thread-2): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:01:45.904729 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 23:01:45.905867 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 23:01:45.907958 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:01:45.930012 (Thread-1): finished collecting timing info
2021-12-05 23:01:45.940472 (Thread-2): finished collecting timing info
2021-12-05 23:01:45.950037 (Thread-1): Dropping relation "RAW"."DBT_PSTULNIKOV"."DIM_CUSTOMERS" because it is of type view
2021-12-05 23:01:45.960675 (Thread-1): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:45.960762 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */
drop view if exists "RAW"."DBT_PSTULNIKOV"."DIM_CUSTOMERS" cascade
2021-12-05 23:01:45.960822 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 23:01:45.968079 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 23:01:45.985634 (Thread-2): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:01:45.985717 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment
  );
2021-12-05 23:01:45.985776 (Thread-2): Opening a new connection, currently in state init
2021-12-05 23:01:46.741858 (Thread-106): handling poll request
2021-12-05 23:01:46.742167 (Thread-106): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4c3e20>]}
2021-12-05 23:01:46.742880 (Thread-106): sending response (<Response 9750 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:01:47.378101 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-12-05 23:01:47.388282 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:01:47.405030 (Thread-1): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:47.405141 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


      create or replace transient table raw.dbt_pstulnikov.dim_customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-05 23:01:47.511259 (Thread-2): SQL status: SUCCESS 1 in 1.53 seconds
2021-12-05 23:01:47.517726 (Thread-2): finished collecting timing info
2021-12-05 23:01:47.517868 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 23:01:47.980134 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193475c40>]}
2021-12-05 23:01:47.980593 (Thread-2): 23:01:47 | 2 of 3 OK created view model dbt_pstulnikov.my_first_dbt_model....... [SUCCESS 1 in 2.08s]
2021-12-05 23:01:47.980688 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 23:01:47.981379 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 23:01:47.981613 (Thread-4): 23:01:47 | 3 of 3 START view model dbt_pstulnikov.my_second_dbt_model........... [RUN]
2021-12-05 23:01:47.981862 (Thread-4): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:01:47.981936 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2021-12-05 23:01:47.984842 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 23:01:48.001990 (Thread-4): finished collecting timing info
2021-12-05 23:01:48.003774 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 23:01:48.018930 (Thread-4): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:01:48.019016 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
  );
2021-12-05 23:01:48.019076 (Thread-4): Opening a new connection, currently in state init
2021-12-05 23:01:48.236281 (Thread-107): handling poll request
2021-12-05 23:01:48.236633 (Thread-107): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4dbbb0>]}
2021-12-05 23:01:48.237349 (Thread-107): sending response (<Response 9675 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:01:48.455821 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-12-05 23:01:48.460336 (Thread-1): finished collecting timing info
2021-12-05 23:01:48.460511 (Thread-1): On model.my_new_project.dim_customers: Close
2021-12-05 23:01:48.949957 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1982bda30>]}
2021-12-05 23:01:48.950341 (Thread-1): 23:01:48 | 1 of 3 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 3.05s]
2021-12-05 23:01:48.950431 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-12-05 23:01:49.449073 (Thread-4): SQL status: SUCCESS 1 in 1.43 seconds
2021-12-05 23:01:49.450439 (Thread-4): finished collecting timing info
2021-12-05 23:01:49.450562 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2021-12-05 23:01:49.841584 (Thread-108): handling poll request
2021-12-05 23:01:49.841922 (Thread-108): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4dbee0>]}
2021-12-05 23:01:49.842556 (Thread-108): sending response (<Response 3817 bytes [200 OK]>) to 10.0.22.219
2021-12-05 23:01:49.903778 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1934752e0>]}
2021-12-05 23:01:49.904304 (Thread-4): 23:01:49 | 3 of 3 OK created view model dbt_pstulnikov.my_second_dbt_model...... [SUCCESS 1 in 1.92s]
2021-12-05 23:01:49.904413 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 23:01:49.905953 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:01:49.906251 (MainThread): 23:01:49 | 
2021-12-05 23:01:49.906318 (MainThread): 23:01:49 | Finished running 2 view models, 1 table model in 7.90s.
2021-12-05 23:01:49.906367 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:01:49.906406 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:01:49.906442 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 23:01:49.906477 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-12-05 23:01:49.968199 (MainThread): 
2021-12-05 23:01:49.968306 (MainThread): Completed successfully
2021-12-05 23:01:49.968367 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-05 23:01:51.296179 (Thread-109): handling poll request
2021-12-05 23:01:51.296527 (Thread-109): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f040>]}
2021-12-05 23:01:51.297673 (Thread-109): sending response (<Response 13746 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:01:52.396016 (Thread-110): handling status request
2021-12-05 23:01:52.396346 (Thread-110): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f130>]}
2021-12-05 23:01:52.396913 (Thread-110): sending response (<Response 1528 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:01:52.549429 (Thread-111): handling status request
2021-12-05 23:01:52.549868 (Thread-111): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f460>]}
2021-12-05 23:01:52.550547 (Thread-111): sending response (<Response 1528 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:02:59.214417 (Thread-112): handling status request
2021-12-05 23:02:59.216347 (Thread-112): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f670>]}
2021-12-05 23:02:59.216864 (Thread-112): sending response (<Response 1528 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:02:59.579392 (Thread-113): handling status request
2021-12-05 23:02:59.579710 (Thread-113): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f850>]}
2021-12-05 23:02:59.580207 (Thread-113): sending response (<Response 1528 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:02:59.697542 (Thread-114): handling cli_args request
2021-12-05 23:02:59.697768 (Thread-114): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47fa30>]}
2021-12-05 23:03:01.684874 (Thread-114): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:03:01.721765 (MainThread): Partial parsing not enabled
2021-12-05 23:03:01.768429 (MainThread): Parsing macros/catalog.sql
2021-12-05 23:03:01.770393 (MainThread): Parsing macros/adapters.sql
2021-12-05 23:03:01.804580 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 23:03:01.808215 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 23:03:01.811381 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 23:03:01.815595 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 23:03:01.816849 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 23:03:01.824966 (MainThread): Parsing macros/core.sql
2021-12-05 23:03:01.828462 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 23:03:01.834718 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 23:03:01.844149 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 23:03:01.850805 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:03:01.854440 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:03:01.876086 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:03:01.892293 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:03:01.893856 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:03:01.923417 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 23:03:01.930404 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 23:03:01.943602 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:03:01.962183 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:03:01.971712 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:03:01.973415 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:03:01.974786 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 23:03:01.982700 (MainThread): Parsing macros/etc/query.sql
2021-12-05 23:03:01.983676 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 23:03:01.985339 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:03:01.986781 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:03:01.989132 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 23:03:01.990506 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 23:03:02.043405 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:03:02.045545 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:03:02.046636 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:03:02.048128 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 23:03:02.190120 (Thread-115): handling poll request
2021-12-05 23:03:02.190473 (Thread-115): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc522ee0>]}
2021-12-05 23:03:02.191541 (Thread-115): sending response (<Response 9675 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:03:02.233379 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:03:02.246106 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:03:02.249467 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:03:02.331171 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be7243d5-4332-42ef-9ec7-9fb0e12dfe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854bfbdeb0>]}
2021-12-05 23:03:02.366067 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be7243d5-4332-42ef-9ec7-9fb0e12dfe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854bfbc550>]}
2021-12-05 23:03:02.366320 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:03:02.367402 (MainThread): 
2021-12-05 23:03:02.367655 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:03:02.368442 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 23:03:02.380877 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 23:03:02.380956 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 23:03:02.381015 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:03:03.691049 (Thread-116): handling poll request
2021-12-05 23:03:03.691362 (Thread-116): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc52bc70>]}
2021-12-05 23:03:03.691965 (Thread-116): sending response (<Response 4339 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:03:03.924969 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.54 seconds
2021-12-05 23:03:03.926906 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 23:03:04.382945 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:03:04.389907 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:03:04.390013 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 23:03:04.390077 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 23:03:05.279428 (Thread-117): handling poll request
2021-12-05 23:03:05.279748 (Thread-117): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47a5b0>]}
2021-12-05 23:03:05.280319 (Thread-117): sending response (<Response 2244 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:03:05.645129 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-12-05 23:03:05.646540 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 23:03:06.088530 (MainThread): 23:03:06 | Concurrency: 4 threads (target='default')
2021-12-05 23:03:06.088687 (MainThread): 23:03:06 | 
2021-12-05 23:03:06.090725 (Thread-1): Began running node model.my_new_project.dim_customers
2021-12-05 23:03:06.091006 (Thread-1): 23:03:06 | 1 of 1 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-05 23:03:06.091234 (Thread-1): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:03:06.091333 (Thread-1): Compiling model.my_new_project.dim_customers
2021-12-05 23:03:06.094073 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:03:06.115532 (Thread-1): finished collecting timing info
2021-12-05 23:03:06.138718 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:03:06.160296 (Thread-1): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:03:06.160374 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


      create or replace transient table raw.dbt_pstulnikov.dim_customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-05 23:03:06.160433 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 23:03:06.765400 (Thread-118): handling poll request
2021-12-05 23:03:06.765720 (Thread-118): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4c3430>]}
2021-12-05 23:03:06.766357 (Thread-118): sending response (<Response 6498 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:03:08.275376 (Thread-119): handling poll request
2021-12-05 23:03:08.275695 (Thread-119): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4c3d60>]}
2021-12-05 23:03:08.276187 (Thread-119): sending response (<Response 309 bytes [200 OK]>) to 10.0.24.86
2021-12-05 23:03:08.295744 (Thread-1): SQL status: SUCCESS 1 in 2.14 seconds
2021-12-05 23:03:08.304916 (Thread-1): finished collecting timing info
2021-12-05 23:03:08.305052 (Thread-1): On model.my_new_project.dim_customers: Close
2021-12-05 23:03:08.757884 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7243d5-4332-42ef-9ec7-9fb0e12dfe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854b20bc10>]}
2021-12-05 23:03:08.758301 (Thread-1): 23:03:08 | 1 of 1 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.67s]
2021-12-05 23:03:08.758394 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-12-05 23:03:08.759957 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:03:08.760252 (MainThread): 23:03:08 | 
2021-12-05 23:03:08.760325 (MainThread): 23:03:08 | Finished running 1 table model in 6.39s.
2021-12-05 23:03:08.760374 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:03:08.760414 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:03:08.822791 (MainThread): 
2021-12-05 23:03:08.822894 (MainThread): Completed successfully
2021-12-05 23:03:08.822955 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-12-05 23:03:09.750659 (Thread-120): handling poll request
2021-12-05 23:03:09.750983 (Thread-120): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4ccb80>]}
2021-12-05 23:03:09.751939 (Thread-120): sending response (<Response 9398 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:03:10.671366 (Thread-121): handling status request
2021-12-05 23:03:10.671683 (Thread-121): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc51d790>]}
2021-12-05 23:03:10.693524 (Thread-121): sending response (<Response 1528 bytes [200 OK]>) to 10.0.26.3
2021-12-05 23:03:10.720306 (Thread-122): handling status request
2021-12-05 23:03:10.720534 (Thread-122): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc51d8b0>]}
2021-12-05 23:03:10.720957 (Thread-122): sending response (<Response 1528 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:08:35.019186 (Thread-123): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-05 23:08:35.020951 (Thread-123): Partial parsing enabled, no changes found, skipping parsing
2021-12-05 23:08:35.026220 (Thread-123): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc446b80>]}
2021-12-05 23:08:35.818964 (Thread-124): handling status request
2021-12-05 23:08:35.819273 (Thread-124): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc522340>]}
2021-12-05 23:08:35.819743 (Thread-124): sending response (<Response 1212 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:08:35.867305 (Thread-125): handling status request
2021-12-05 23:08:35.867563 (Thread-125): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc446d30>]}
2021-12-05 23:08:35.867991 (Thread-125): sending response (<Response 1212 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:09:26.347605 (Thread-126): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-05 23:09:26.347911 (Thread-126): Partial parsing: added file: my_new_project://models/stg_customers.sql
2021-12-05 23:09:26.351516 (Thread-126): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:09:26.402459 (Thread-126): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc427040>]}
2021-12-05 23:09:27.221326 (Thread-127): handling status request
2021-12-05 23:09:27.221641 (Thread-127): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc51adf0>]}
2021-12-05 23:09:27.222123 (Thread-127): sending response (<Response 1530 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:09:27.238745 (Thread-128): handling status request
2021-12-05 23:09:27.238959 (Thread-128): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc51a280>]}
2021-12-05 23:09:27.239337 (Thread-128): sending response (<Response 1530 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:14:21.027550 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-12-05 23:14:21.097528 (Thread-129): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 23:14:21.097864 (Thread-129): Partial parsing: updated file: my_new_project://models/stg_customers.sql
2021-12-05 23:14:21.101275 (Thread-129): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:14:21.148695 (Thread-129): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3fb6a0>]}
2021-12-05 23:14:21.898760 (Thread-130): handling status request
2021-12-05 23:14:21.899095 (Thread-130): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc37afd0>]}
2021-12-05 23:14:21.899597 (Thread-130): sending response (<Response 1532 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:14:21.938576 (Thread-131): handling status request
2021-12-05 23:14:21.938846 (Thread-131): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc37a820>]}
2021-12-05 23:14:21.939305 (Thread-131): sending response (<Response 1532 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:14:39.444562 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-12-05 23:14:39.501782 (Thread-132): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-05 23:14:39.502068 (Thread-132): Partial parsing: added file: my_new_project://models/stg_orders.sql
2021-12-05 23:14:39.505470 (Thread-132): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:14:39.550184 (Thread-132): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc2fbac0>]}
2021-12-05 23:14:40.356388 (Thread-133): handling status request
2021-12-05 23:14:40.356735 (Thread-133): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc399b20>]}
2021-12-05 23:14:40.357222 (Thread-133): sending response (<Response 1524 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:14:40.409563 (Thread-134): handling status request
2021-12-05 23:14:40.409796 (Thread-134): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3ac3a0>]}
2021-12-05 23:14:40.410212 (Thread-134): sending response (<Response 1524 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:15:19.951818 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:15:20.009354 (Thread-135): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 23:15:20.009659 (Thread-135): Partial parsing: updated file: my_new_project://models/stg_orders.sql
2021-12-05 23:15:20.012973 (Thread-135): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:15:20.060842 (Thread-135): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc319640>]}
2021-12-05 23:15:20.790487 (Thread-136): handling status request
2021-12-05 23:15:20.790796 (Thread-136): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc377c40>]}
2021-12-05 23:15:20.791280 (Thread-136): sending response (<Response 1526 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:15:20.851325 (Thread-137): handling status request
2021-12-05 23:15:20.851574 (Thread-137): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3774c0>]}
2021-12-05 23:15:20.852042 (Thread-137): sending response (<Response 1526 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:15:40.422646 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:15:40.601669 (Thread-138): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-05 23:15:40.602003 (Thread-138): Partial parsing enabled, no changes found, skipping parsing
2021-12-05 23:15:40.607187 (Thread-138): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc38a4f0>]}
2021-12-05 23:15:41.312573 (Thread-139): handling status request
2021-12-05 23:15:41.312896 (Thread-139): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc300790>]}
2021-12-05 23:15:41.313379 (Thread-139): sending response (<Response 1212 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:15:41.393253 (Thread-140): handling status request
2021-12-05 23:15:41.393503 (Thread-140): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc300130>]}
2021-12-05 23:15:41.393941 (Thread-140): sending response (<Response 1212 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:18:00.807609 (Thread-141): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 23:18:00.809657 (Thread-141): Partial parsing: updated file: my_new_project://models/dim_customers.sql
2021-12-05 23:18:00.813065 (Thread-141): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:18:00.866415 (Thread-141): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81569a0>]}
2021-12-05 23:18:01.584741 (Thread-142): handling status request
2021-12-05 23:18:01.585061 (Thread-142): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3981f0>]}
2021-12-05 23:18:01.585546 (Thread-142): sending response (<Response 1532 bytes [200 OK]>) to 10.0.6.71
2021-12-05 23:18:01.848406 (Thread-143): handling status request
2021-12-05 23:18:01.848741 (Thread-143): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3983d0>]}
2021-12-05 23:18:01.849201 (Thread-143): sending response (<Response 1532 bytes [200 OK]>) to 10.0.26.3
2021-12-05 23:18:13.731208 (Thread-144): handling status request
2021-12-05 23:18:13.731530 (Thread-144): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc398b20>]}
2021-12-05 23:18:13.732011 (Thread-144): sending response (<Response 1532 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:18:14.205122 (Thread-145): handling compile_sql request
2021-12-05 23:18:14.205414 (Thread-145): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3980a0>]}
2021-12-05 23:18:14.206504 (Thread-145): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:18:16.140968 (Thread-145): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:18:16.151900 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 23:18:16.166334 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde71eb8-5f22-4191-89eb-969a87710148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c9a3ebb0>]}
2021-12-05 23:18:16.166574 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:18:16.166949 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 23:18:16.167054 (Thread-1): Compiling rpc.my_new_project.request
2021-12-05 23:18:16.169485 (Thread-1): finished collecting timing info
2021-12-05 23:18:16.169599 (Thread-1): finished collecting timing info
2021-12-05 23:18:16.634243 (Thread-146): handling poll request
2021-12-05 23:18:16.634596 (Thread-146): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3a7640>]}
2021-12-05 23:18:16.635766 (Thread-146): sending response (<Response 8060 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:19:05.365139 (Thread-147): handling status request
2021-12-05 23:19:05.365454 (Thread-147): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3a7400>]}
2021-12-05 23:19:05.365959 (Thread-147): sending response (<Response 1532 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:19:05.743682 (Thread-148): handling status request
2021-12-05 23:19:05.743977 (Thread-148): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3a73d0>]}
2021-12-05 23:19:05.744442 (Thread-148): sending response (<Response 1532 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:19:05.808000 (Thread-149): handling cli_args request
2021-12-05 23:19:05.808218 (Thread-149): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc305310>]}
2021-12-05 23:19:07.769780 (Thread-149): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:19:07.807385 (MainThread): Partial parsing not enabled
2021-12-05 23:19:07.863186 (MainThread): Parsing macros/catalog.sql
2021-12-05 23:19:07.865365 (MainThread): Parsing macros/adapters.sql
2021-12-05 23:19:07.899941 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 23:19:07.903614 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 23:19:07.906819 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 23:19:07.911038 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 23:19:07.912283 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 23:19:07.920411 (MainThread): Parsing macros/core.sql
2021-12-05 23:19:07.923951 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 23:19:07.930227 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 23:19:07.939693 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 23:19:07.946453 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:19:07.950030 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:19:07.971898 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:19:07.988117 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:19:07.989681 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:19:08.019123 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 23:19:08.026011 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 23:19:08.039069 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:19:08.057677 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:19:08.067100 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:19:08.068811 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:19:08.070176 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 23:19:08.078071 (MainThread): Parsing macros/etc/query.sql
2021-12-05 23:19:08.079021 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 23:19:08.080646 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:19:08.082085 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:19:08.084423 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 23:19:08.085820 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 23:19:08.138551 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:19:08.140706 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:19:08.141799 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:19:08.143307 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 23:19:08.246749 (Thread-150): handling poll request
2021-12-05 23:19:08.247111 (Thread-150): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb365dc0>]}
2021-12-05 23:19:08.248536 (Thread-150): sending response (<Response 9652 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:19:08.325888 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:19:08.337647 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:19:08.341354 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:19:08.343940 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:19:08.347157 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:19:08.456464 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c3efbfd0>]}
2021-12-05 23:19:08.481762 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c3efa550>]}
2021-12-05 23:19:08.481982 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:19:08.484217 (MainThread): 
2021-12-05 23:19:08.484458 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:19:08.485417 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 23:19:08.545184 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 23:19:08.545275 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 23:19:08.545334 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:19:09.772755 (Thread-151): handling poll request
2021-12-05 23:19:09.773072 (Thread-151): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c9365700>]}
2021-12-05 23:19:09.799308 (Thread-151): sending response (<Response 4927 bytes [200 OK]>) to 10.0.22.219
2021-12-05 23:19:10.089632 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.54 seconds
2021-12-05 23:19:10.091574 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 23:19:10.548665 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:19:10.556039 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:19:10.556147 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 23:19:10.556213 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 23:19:11.250824 (Thread-152): handling poll request
2021-12-05 23:19:11.251131 (Thread-152): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bcc10>]}
2021-12-05 23:19:11.251684 (Thread-152): sending response (<Response 2221 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:19:11.815687 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-12-05 23:19:11.817222 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 23:19:12.271966 (MainThread): 23:19:12 | Concurrency: 4 threads (target='default')
2021-12-05 23:19:12.272117 (MainThread): 23:19:12 | 
2021-12-05 23:19:12.274188 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 23:19:12.274486 (Thread-1): 23:19:12 | 1 of 5 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 23:19:12.274719 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:19:12.274818 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 23:19:12.275698 (Thread-2): Began running node model.my_new_project.stg_customers
2021-12-05 23:19:12.275908 (Thread-2): 23:19:12 | 2 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-05 23:19:12.276129 (Thread-2): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:19:12.276199 (Thread-2): Compiling model.my_new_project.stg_customers
2021-12-05 23:19:12.277314 (Thread-2): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:19:12.278200 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 23:19:12.278369 (Thread-3): Began running node model.my_new_project.stg_orders
2021-12-05 23:19:12.278571 (Thread-3): 23:19:12 | 3 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-05 23:19:12.278795 (Thread-3): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:19:12.278865 (Thread-3): Compiling model.my_new_project.stg_orders
2021-12-05 23:19:12.279952 (Thread-3): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:19:12.290874 (Thread-3): finished collecting timing info
2021-12-05 23:19:12.296187 (Thread-2): finished collecting timing info
2021-12-05 23:19:12.324468 (Thread-2): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:19:12.324868 (Thread-3): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:19:12.330763 (Thread-1): finished collecting timing info
2021-12-05 23:19:12.332413 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 23:19:12.338281 (Thread-2): Using snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:19:12.338363 (Thread-2): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view raw.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-05 23:19:12.338422 (Thread-2): Opening a new connection, currently in state init
2021-12-05 23:19:12.342263 (Thread-3): Using snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:19:12.342347 (Thread-3): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view raw.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-05 23:19:12.342404 (Thread-3): Opening a new connection, currently in state init
2021-12-05 23:19:12.348318 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:19:12.348404 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment
  );
2021-12-05 23:19:12.348462 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 23:19:12.681296 (Thread-153): handling poll request
2021-12-05 23:19:12.681604 (Thread-153): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb365f10>]}
2021-12-05 23:19:12.682448 (Thread-153): sending response (<Response 14112 bytes [200 OK]>) to 10.0.26.3
2021-12-05 23:19:13.915471 (Thread-3): SQL status: SUCCESS 1 in 1.57 seconds
2021-12-05 23:19:13.922454 (Thread-3): finished collecting timing info
2021-12-05 23:19:13.922599 (Thread-3): On model.my_new_project.stg_orders: Close
2021-12-05 23:19:13.978206 (Thread-2): SQL status: SUCCESS 1 in 1.64 seconds
2021-12-05 23:19:13.979452 (Thread-2): finished collecting timing info
2021-12-05 23:19:13.979574 (Thread-2): On model.my_new_project.stg_customers: Close
2021-12-05 23:19:14.169292 (Thread-154): handling poll request
2021-12-05 23:19:14.169594 (Thread-154): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb365970>]}
2021-12-05 23:19:14.170149 (Thread-154): sending response (<Response 2482 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:19:14.171032 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-12-05 23:19:14.172328 (Thread-1): finished collecting timing info
2021-12-05 23:19:14.172456 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 23:19:14.374671 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c313ec10>]}
2021-12-05 23:19:14.375091 (Thread-3): 23:19:14 | 3 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.10s]
2021-12-05 23:19:14.375189 (Thread-3): Finished running node model.my_new_project.stg_orders
2021-12-05 23:19:14.433122 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c03d04f0>]}
2021-12-05 23:19:14.433430 (Thread-2): 23:19:14 | 2 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.16s]
2021-12-05 23:19:14.433517 (Thread-2): Finished running node model.my_new_project.stg_customers
2021-12-05 23:19:14.434163 (Thread-4): Began running node model.my_new_project.dim_customers
2021-12-05 23:19:14.434396 (Thread-4): 23:19:14 | 4 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-05 23:19:14.434630 (Thread-4): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:19:14.434704 (Thread-4): Compiling model.my_new_project.dim_customers
2021-12-05 23:19:14.437359 (Thread-4): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:19:14.454330 (Thread-4): finished collecting timing info
2021-12-05 23:19:14.471066 (Thread-4): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:19:14.488321 (Thread-4): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:19:14.488400 (Thread-4): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


      create or replace transient table raw.dbt_pstulnikov.dim_customers  as
      (

with customers as (
    select * from raw.dbt_pstulnikov.stg_customers
),

orders as (
    select * from raw.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-05 23:19:14.488460 (Thread-4): Opening a new connection, currently in state init
2021-12-05 23:19:14.613225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c03d0c70>]}
2021-12-05 23:19:14.613538 (Thread-1): 23:19:14 | 1 of 5 OK created view model dbt_pstulnikov.my_first_dbt_model....... [SUCCESS 1 in 2.34s]
2021-12-05 23:19:14.613626 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 23:19:14.614204 (Thread-2): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 23:19:14.614459 (Thread-2): 23:19:14 | 5 of 5 START view model dbt_pstulnikov.my_second_dbt_model........... [RUN]
2021-12-05 23:19:14.614665 (Thread-2): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:19:14.614741 (Thread-2): Compiling model.my_new_project.my_second_dbt_model
2021-12-05 23:19:14.616684 (Thread-2): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 23:19:14.632143 (Thread-2): finished collecting timing info
2021-12-05 23:19:14.633964 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 23:19:14.649827 (Thread-2): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:19:14.649908 (Thread-2): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
  );
2021-12-05 23:19:14.649967 (Thread-2): Opening a new connection, currently in state closed
2021-12-05 23:19:15.642014 (Thread-155): handling poll request
2021-12-05 23:19:15.642324 (Thread-155): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb373a00>]}
2021-12-05 23:19:15.643169 (Thread-155): sending response (<Response 14674 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:19:16.016575 (Thread-2): SQL status: SUCCESS 1 in 1.37 seconds
2021-12-05 23:19:16.018001 (Thread-2): finished collecting timing info
2021-12-05 23:19:16.018177 (Thread-2): On model.my_new_project.my_second_dbt_model: Close
2021-12-05 23:19:16.481861 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c30ce5b0>]}
2021-12-05 23:19:16.482258 (Thread-2): 23:19:16 | 5 of 5 OK created view model dbt_pstulnikov.my_second_dbt_model...... [SUCCESS 1 in 1.87s]
2021-12-05 23:19:16.482349 (Thread-2): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 23:19:17.017019 (Thread-4): SQL status: SUCCESS 1 in 2.53 seconds
2021-12-05 23:19:17.021567 (Thread-4): finished collecting timing info
2021-12-05 23:19:17.021708 (Thread-4): On model.my_new_project.dim_customers: Close
2021-12-05 23:19:17.094865 (Thread-156): handling poll request
2021-12-05 23:19:17.095170 (Thread-156): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb373490>]}
2021-12-05 23:19:17.095768 (Thread-156): sending response (<Response 3842 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:19:17.463655 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c038afa0>]}
2021-12-05 23:19:17.464033 (Thread-4): 23:19:17 | 4 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 3.03s]
2021-12-05 23:19:17.464118 (Thread-4): Finished running node model.my_new_project.dim_customers
2021-12-05 23:19:17.465685 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:19:17.465988 (MainThread): 23:19:17 | 
2021-12-05 23:19:17.466058 (MainThread): 23:19:17 | Finished running 4 view models, 1 table model in 8.98s.
2021-12-05 23:19:17.466108 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:19:17.466150 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 23:19:17.466186 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-12-05 23:19:17.466222 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:19:17.466257 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:19:17.520954 (MainThread): 
2021-12-05 23:19:17.521068 (MainThread): Completed successfully
2021-12-05 23:19:17.521135 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-05 23:19:18.532541 (Thread-157): handling poll request
2021-12-05 23:19:18.532855 (Thread-157): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb353760>]}
2021-12-05 23:19:18.534380 (Thread-157): sending response (<Response 18246 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:19:19.395223 (Thread-158): handling status request
2021-12-05 23:19:19.395555 (Thread-158): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c814c940>]}
2021-12-05 23:19:19.396096 (Thread-158): sending response (<Response 1532 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:19:19.676218 (Thread-159): handling status request
2021-12-05 23:19:19.676556 (Thread-159): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb372460>]}
2021-12-05 23:19:19.677048 (Thread-159): sending response (<Response 1532 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:22:15.958002 (MainThread): Running with dbt=0.21.0
2021-12-05 23:22:16.303373 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-12-05 23:22:16.311748 (MainThread): Tracking: tracking
2021-12-05 23:22:16.311972 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42f4267130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c498b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4998880>]}
2021-12-05 23:22:16.312301 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2021-12-05 23:22:16.313403 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2021-12-05 23:22:16.317617 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-12-05 23:22:16.336327 (Thread-12): Unable to do partial parsing because profile has changed
2021-12-05 23:22:16.336558 (Thread-12): Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4998e20>]}
2021-12-05 23:22:16.380655 (Thread-12): Parsing macros/catalog.sql
2021-12-05 23:22:16.382681 (Thread-12): Parsing macros/adapters.sql
2021-12-05 23:22:16.417699 (Thread-12): Parsing macros/materializations/merge.sql
2021-12-05 23:22:16.421439 (Thread-12): Parsing macros/materializations/table.sql
2021-12-05 23:22:16.424380 (Thread-12): Parsing macros/materializations/seed.sql
2021-12-05 23:22:16.428531 (Thread-12): Parsing macros/materializations/view.sql
2021-12-05 23:22:16.429798 (Thread-12): Parsing macros/materializations/incremental.sql
2021-12-05 23:22:16.437825 (Thread-12): Parsing macros/core.sql
2021-12-05 23:22:16.441287 (Thread-12): Parsing macros/materializations/test.sql
2021-12-05 23:22:16.447401 (Thread-12): Parsing macros/materializations/helpers.sql
2021-12-05 23:22:16.456513 (Thread-12): Parsing macros/materializations/view/view.sql
2021-12-05 23:22:16.463126 (Thread-12): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:22:16.466714 (Thread-12): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:22:16.487861 (Thread-12): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:22:16.503865 (Thread-12): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:22:16.505439 (Thread-12): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:22:16.534502 (Thread-12): Parsing macros/materializations/table/table.sql
2021-12-05 23:22:16.541324 (Thread-12): Parsing macros/materializations/common/merge.sql
2021-12-05 23:22:16.554294 (Thread-12): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:22:16.572572 (Thread-12): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:22:16.581977 (Thread-12): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:22:16.583561 (Thread-12): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:22:16.584929 (Thread-12): Parsing macros/etc/datetime.sql
2021-12-05 23:22:16.592606 (Thread-12): Parsing macros/etc/query.sql
2021-12-05 23:22:16.593514 (Thread-12): Parsing macros/etc/where_subquery.sql
2021-12-05 23:22:16.595191 (Thread-12): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:22:16.596679 (Thread-12): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:22:16.598944 (Thread-12): Parsing macros/etc/is_incremental.sql
2021-12-05 23:22:16.600351 (Thread-12): Parsing macros/adapters/common.sql
2021-12-05 23:22:16.651427 (Thread-12): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:22:16.653512 (Thread-12): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:22:16.654667 (Thread-12): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:22:16.656206 (Thread-12): Parsing macros/schema_tests/unique.sql
2021-12-05 23:22:16.834304 (Thread-12): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:22:16.846729 (Thread-12): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:22:16.850793 (Thread-12): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:22:16.853334 (Thread-12): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:22:16.856951 (Thread-12): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:22:16.939676 (Thread-12): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4875910>]}
2021-12-05 23:22:21.043843 (Thread-13): handling status request
2021-12-05 23:22:21.044207 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c482dca0>]}
2021-12-05 23:22:21.045103 (Thread-13): sending response (<Response 11918 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:22:21.264335 (Thread-14): handling status request
2021-12-05 23:22:21.264621 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c487c5b0>]}
2021-12-05 23:22:21.265362 (Thread-14): sending response (<Response 11918 bytes [200 OK]>) to 10.0.6.71
2021-12-05 23:22:21.271841 (Thread-15): handling ps request
2021-12-05 23:22:21.272038 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4899e50>]}
2021-12-05 23:22:21.272387 (Thread-15): sending response (<Response 105 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:22:21.309198 (Thread-16): handling status request
2021-12-05 23:22:21.309402 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49bdc10>]}
2021-12-05 23:22:21.310084 (Thread-16): sending response (<Response 11918 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:22:40.079866 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 23:22:40.143013 (Thread-17): Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
2021-12-05 23:22:40.143376 (Thread-17): Partial parsing: deleted file: my_new_project://models/example/my_second_dbt_model.sql
2021-12-05 23:22:40.143492 (Thread-17): Partial parsing: deleted file: my_new_project://models/example/my_first_dbt_model.sql
2021-12-05 23:22:40.176556 (Thread-17): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-05 23:22:40.180972 (Thread-17): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4070>]}
2021-12-05 23:22:41.185873 (Thread-18): handling status request
2021-12-05 23:22:41.186211 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd45e0>]}
2021-12-05 23:22:41.186711 (Thread-18): sending response (<Response 1983 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:22:41.253970 (Thread-19): handling status request
2021-12-05 23:22:41.254179 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4940>]}
2021-12-05 23:22:41.254579 (Thread-19): sending response (<Response 1983 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:22:53.153225 (Thread-20): handling status request
2021-12-05 23:22:53.153519 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4c40>]}
2021-12-05 23:22:53.154009 (Thread-20): sending response (<Response 1983 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:22:53.543508 (Thread-21): handling status request
2021-12-05 23:22:53.545089 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4490>]}
2021-12-05 23:22:53.545508 (Thread-21): sending response (<Response 1983 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:22:53.805108 (Thread-22): handling cli_args request
2021-12-05 23:22:53.805389 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4ca0>]}
2021-12-05 23:22:55.713770 (Thread-22): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:22:55.749456 (MainThread): Partial parsing not enabled
2021-12-05 23:22:55.788266 (MainThread): Parsing macros/catalog.sql
2021-12-05 23:22:55.790193 (MainThread): Parsing macros/adapters.sql
2021-12-05 23:22:55.823837 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 23:22:55.827419 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 23:22:55.830550 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 23:22:55.834650 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 23:22:55.835858 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 23:22:55.843831 (MainThread): Parsing macros/core.sql
2021-12-05 23:22:55.847358 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 23:22:55.853515 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 23:22:55.862869 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 23:22:55.869773 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:22:55.873388 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:22:55.894757 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:22:55.919851 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:22:55.922262 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:22:55.951521 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 23:22:55.958369 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 23:22:55.971238 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:22:55.989630 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:22:55.998972 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:22:56.000638 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:22:56.001997 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 23:22:56.009782 (MainThread): Parsing macros/etc/query.sql
2021-12-05 23:22:56.010749 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 23:22:56.012344 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:22:56.013754 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:22:56.016060 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 23:22:56.017405 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 23:22:56.069272 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:22:56.071399 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:22:56.072476 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:22:56.073968 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 23:22:56.252991 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:22:56.264286 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:22:56.267827 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:22:56.314735 (Thread-23): handling poll request
2021-12-05 23:22:56.315008 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4fa0>]}
2021-12-05 23:22:56.316071 (Thread-23): sending response (<Response 10570 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:22:56.317530 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-05 23:22:56.321422 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd0194eb0>]}
2021-12-05 23:22:56.339793 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd02a3460>]}
2021-12-05 23:22:56.339994 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:22:56.340989 (MainThread): 
2021-12-05 23:22:56.341180 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:22:56.341917 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-05 23:22:56.353017 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-05 23:22:56.353089 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-05 23:22:56.353144 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:22:57.902915 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.55 seconds
2021-12-05 23:22:57.904702 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-05 23:22:58.351552 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_pstulnikov".
2021-12-05 23:22:58.351743 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_pstulnikov".
2021-12-05 23:22:58.351930 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt_pstulnikov"
2021-12-05 23:22:58.357243 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_pstulnikov".
2021-12-05 23:22:58.357328 (ThreadPoolExecutor-0_0): On create_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "create_analytics_dbt_pstulnikov"} */
create schema if not exists analytics.dbt_pstulnikov
2021-12-05 23:22:58.357390 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-12-05 23:22:58.387954 (Thread-24): handling poll request
2021-12-05 23:22:58.388221 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfa9070>]}
2021-12-05 23:22:58.388857 (Thread-24): sending response (<Response 6433 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:22:59.835573 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.48 seconds
2021-12-05 23:22:59.836456 (ThreadPoolExecutor-0_0): On create_analytics_dbt_pstulnikov: Close
2021-12-05 23:22:59.864356 (Thread-25): handling poll request
2021-12-05 23:22:59.864622 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfa9790>]}
2021-12-05 23:22:59.865103 (Thread-25): sending response (<Response 854 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:23:00.293513 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-05 23:23:00.300065 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-05 23:23:00.300170 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-05 23:23:00.300228 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 23:23:01.421949 (Thread-26): handling poll request
2021-12-05 23:23:01.422250 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfdc220>]}
2021-12-05 23:23:01.422749 (Thread-26): sending response (<Response 1704 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:23:01.556875 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.26 seconds
2021-12-05 23:23:01.558107 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-05 23:23:02.009467 (MainThread): 23:23:02 | Concurrency: 4 threads (target='default')
2021-12-05 23:23:02.009613 (MainThread): 23:23:02 | 
2021-12-05 23:23:02.011567 (Thread-1): Began running node model.my_new_project.stg_customers
2021-12-05 23:23:02.011874 (Thread-1): 23:23:02 | 1 of 3 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-05 23:23:02.012122 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:23:02.012239 (Thread-1): Compiling model.my_new_project.stg_customers
2021-12-05 23:23:02.013116 (Thread-2): Began running node model.my_new_project.stg_orders
2021-12-05 23:23:02.013327 (Thread-2): 23:23:02 | 2 of 3 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-05 23:23:02.013546 (Thread-2): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:23:02.013614 (Thread-2): Compiling model.my_new_project.stg_orders
2021-12-05 23:23:02.014741 (Thread-2): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:23:02.016036 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:23:02.029281 (Thread-2): finished collecting timing info
2021-12-05 23:23:02.034603 (Thread-1): finished collecting timing info
2021-12-05 23:23:02.064724 (Thread-2): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:23:02.067293 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:23:02.089766 (Thread-2): Using snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:23:02.089878 (Thread-2): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-05 23:23:02.089971 (Thread-2): Opening a new connection, currently in state init
2021-12-05 23:23:02.091181 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:23:02.091260 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-05 23:23:02.091318 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 23:23:02.867716 (Thread-27): handling poll request
2021-12-05 23:23:02.868030 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf89160>]}
2021-12-05 23:23:02.868761 (Thread-27): sending response (<Response 9907 bytes [200 OK]>) to 10.0.30.196
2021-12-05 23:23:03.585377 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-12-05 23:23:03.592058 (Thread-1): finished collecting timing info
2021-12-05 23:23:03.592194 (Thread-1): On model.my_new_project.stg_customers: Close
2021-12-05 23:23:03.607556 (Thread-2): SQL status: SUCCESS 1 in 1.52 seconds
2021-12-05 23:23:03.608611 (Thread-2): finished collecting timing info
2021-12-05 23:23:03.608713 (Thread-2): On model.my_new_project.stg_orders: Close
2021-12-05 23:23:04.045025 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fca632e80>]}
2021-12-05 23:23:04.045634 (Thread-1): 23:23:04 | 1 of 3 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.03s]
2021-12-05 23:23:04.045790 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-12-05 23:23:04.049099 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fca643280>]}
2021-12-05 23:23:04.049407 (Thread-2): 23:23:04 | 2 of 3 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.04s]
2021-12-05 23:23:04.049496 (Thread-2): Finished running node model.my_new_project.stg_orders
2021-12-05 23:23:04.050449 (Thread-4): Began running node model.my_new_project.dim_customers
2021-12-05 23:23:04.050666 (Thread-4): 23:23:04 | 3 of 3 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-05 23:23:04.050890 (Thread-4): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:23:04.050966 (Thread-4): Compiling model.my_new_project.dim_customers
2021-12-05 23:23:04.053565 (Thread-4): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:23:04.069882 (Thread-4): finished collecting timing info
2021-12-05 23:23:04.086194 (Thread-4): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:23:04.101283 (Thread-4): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:23:04.101364 (Thread-4): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (

with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-05 23:23:04.101423 (Thread-4): Opening a new connection, currently in state init
2021-12-05 23:23:04.393045 (Thread-28): handling poll request
2021-12-05 23:23:04.393348 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf89d30>]}
2021-12-05 23:23:04.394076 (Thread-28): sending response (<Response 10061 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:23:05.841225 (Thread-29): handling poll request
2021-12-05 23:23:05.841533 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf89e20>]}
2021-12-05 23:23:05.842064 (Thread-29): sending response (<Response 287 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:23:06.310940 (Thread-4): SQL status: SUCCESS 1 in 2.21 seconds
2021-12-05 23:23:06.315481 (Thread-4): finished collecting timing info
2021-12-05 23:23:06.315620 (Thread-4): On model.my_new_project.dim_customers: Close
2021-12-05 23:23:06.766886 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fcaa82ac0>]}
2021-12-05 23:23:06.767228 (Thread-4): 23:23:06 | 3 of 3 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.72s]
2021-12-05 23:23:06.767314 (Thread-4): Finished running node model.my_new_project.dim_customers
2021-12-05 23:23:06.768789 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:23:06.769079 (MainThread): 23:23:06 | 
2021-12-05 23:23:06.769147 (MainThread): 23:23:06 | Finished running 2 view models, 1 table model in 10.43s.
2021-12-05 23:23:06.769197 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:23:06.769237 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-12-05 23:23:06.769272 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:23:06.769306 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:23:06.822851 (MainThread): 
2021-12-05 23:23:06.822961 (MainThread): Completed successfully
2021-12-05 23:23:06.823031 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-05 23:23:07.284040 (Thread-30): handling poll request
2021-12-05 23:23:07.284367 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4ca0>]}
2021-12-05 23:23:07.285489 (Thread-30): sending response (<Response 14304 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:23:08.221652 (Thread-31): handling status request
2021-12-05 23:23:08.222010 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfab190>]}
2021-12-05 23:23:08.222549 (Thread-31): sending response (<Response 1983 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:23:08.237477 (Thread-32): handling status request
2021-12-05 23:23:08.237689 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfab820>]}
2021-12-05 23:23:08.238127 (Thread-32): sending response (<Response 1983 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:25:04.270383 (Thread-33): handling status request
2021-12-05 23:25:04.272500 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfaba30>]}
2021-12-05 23:25:04.273030 (Thread-33): sending response (<Response 1983 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:25:04.571123 (Thread-34): handling status request
2021-12-05 23:25:04.571475 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfabc10>]}
2021-12-05 23:25:04.572016 (Thread-34): sending response (<Response 1983 bytes [200 OK]>) to 10.0.22.219
2021-12-05 23:25:04.741700 (Thread-35): handling docs.generate request
2021-12-05 23:25:04.742010 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfabdf0>]}
2021-12-05 23:25:06.669798 (Thread-35): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:25:06.693822 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7da2f32a-4a01-46b2-915f-d0e528786892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d329c7070>]}
2021-12-05 23:25:06.694097 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:25:06.695256 (MainThread): 
2021-12-05 23:25:06.695373 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:25:06.695972 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-05 23:25:06.710161 (ThreadPoolExecutor-0_0): Parsing macros/catalog.sql
2021-12-05 23:25:06.713321 (ThreadPoolExecutor-0_0): Parsing macros/adapters.sql
2021-12-05 23:25:06.747071 (ThreadPoolExecutor-0_0): Parsing macros/materializations/merge.sql
2021-12-05 23:25:06.750827 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table.sql
2021-12-05 23:25:06.753963 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed.sql
2021-12-05 23:25:06.758124 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view.sql
2021-12-05 23:25:06.759502 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental.sql
2021-12-05 23:25:06.768451 (ThreadPoolExecutor-0_0): Parsing macros/core.sql
2021-12-05 23:25:06.772008 (ThreadPoolExecutor-0_0): Parsing macros/materializations/test.sql
2021-12-05 23:25:06.778694 (ThreadPoolExecutor-0_0): Parsing macros/materializations/helpers.sql
2021-12-05 23:25:06.787879 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/view.sql
2021-12-05 23:25:06.794575 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:25:06.798258 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:25:06.819300 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:25:06.835258 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:25:06.836945 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:25:06.866003 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table/table.sql
2021-12-05 23:25:06.872885 (ThreadPoolExecutor-0_0): Parsing macros/materializations/common/merge.sql
2021-12-05 23:25:06.885956 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:25:06.904384 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:25:06.914014 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:25:06.915709 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:25:06.917208 (ThreadPoolExecutor-0_0): Parsing macros/etc/datetime.sql
2021-12-05 23:25:06.925125 (ThreadPoolExecutor-0_0): Parsing macros/etc/query.sql
2021-12-05 23:25:06.926153 (ThreadPoolExecutor-0_0): Parsing macros/etc/where_subquery.sql
2021-12-05 23:25:06.927917 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:25:06.929505 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:25:06.931914 (ThreadPoolExecutor-0_0): Parsing macros/etc/is_incremental.sql
2021-12-05 23:25:06.933479 (ThreadPoolExecutor-0_0): Parsing macros/adapters/common.sql
2021-12-05 23:25:06.984890 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:25:06.987105 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:25:06.988330 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:25:06.989981 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/unique.sql
2021-12-05 23:25:07.002413 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-05 23:25:07.002495 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: show terse objects in analytics.dbt_pstulnikov
2021-12-05 23:25:07.002550 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:25:07.114774 (Thread-36): handling poll request
2021-12-05 23:25:07.115053 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc73fca0>]}
2021-12-05 23:25:07.116069 (Thread-36): sending response (<Response 12362 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:25:08.528873 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.53 seconds
2021-12-05 23:25:08.530867 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: Close
2021-12-05 23:25:08.556972 (Thread-37): handling poll request
2021-12-05 23:25:08.557230 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc73ff10>]}
2021-12-05 23:25:08.557713 (Thread-37): sending response (<Response 862 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:25:08.976698 (MainThread): 23:25:08 | Concurrency: 4 threads (target='default')
2021-12-05 23:25:08.976896 (MainThread): 23:25:08 | 
2021-12-05 23:25:08.978968 (Thread-1): Began running node model.my_new_project.stg_customers
2021-12-05 23:25:08.979149 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:25:08.979250 (Thread-1): Compiling model.my_new_project.stg_customers
2021-12-05 23:25:08.980153 (Thread-2): Began running node model.my_new_project.stg_orders
2021-12-05 23:25:08.980313 (Thread-2): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:25:08.980384 (Thread-2): Compiling model.my_new_project.stg_orders
2021-12-05 23:25:08.981677 (Thread-2): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:25:08.983055 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:25:09.001084 (Thread-1): finished collecting timing info
2021-12-05 23:25:09.001395 (Thread-1): finished collecting timing info
2021-12-05 23:25:09.001526 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-12-05 23:25:09.002754 (Thread-2): finished collecting timing info
2021-12-05 23:25:09.002873 (Thread-2): finished collecting timing info
2021-12-05 23:25:09.002972 (Thread-2): Finished running node model.my_new_project.stg_orders
2021-12-05 23:25:09.003652 (Thread-4): Began running node model.my_new_project.dim_customers
2021-12-05 23:25:09.003808 (Thread-4): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:25:09.003877 (Thread-4): Compiling model.my_new_project.dim_customers
2021-12-05 23:25:09.006614 (Thread-4): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:25:09.022508 (Thread-4): finished collecting timing info
2021-12-05 23:25:09.022632 (Thread-4): finished collecting timing info
2021-12-05 23:25:09.022734 (Thread-4): Finished running node model.my_new_project.dim_customers
2021-12-05 23:25:09.023793 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:25:09.023871 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-12-05 23:25:09.023911 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:25:09.023946 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:25:09.081490 (MainThread): 23:25:09 | Done.
2021-12-05 23:25:09.123233 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-12-05 23:25:09.123311 (MainThread): 23:25:09 | Building catalog
2021-12-05 23:25:09.124096 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "analytics.information_schema".
2021-12-05 23:25:09.131535 (ThreadPoolExecutor-1_0): Using snowflake connection "analytics.information_schema".
2021-12-05 23:25:09.131602 (ThreadPoolExecutor-1_0): On analytics.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_pstulnikov'))
      order by "column_index"
2021-12-05 23:25:09.131663 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-05 23:25:09.996385 (Thread-38): handling poll request
2021-12-05 23:25:09.996692 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfa9070>]}
2021-12-05 23:25:09.997488 (Thread-38): sending response (<Response 15437 bytes [200 OK]>) to 10.0.30.196
2021-12-05 23:25:11.446258 (Thread-39): handling poll request
2021-12-05 23:25:11.446552 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfae610>]}
2021-12-05 23:25:11.470857 (Thread-39): sending response (<Response 296 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:25:11.509545 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 13 in 2.38 seconds
2021-12-05 23:25:11.518177 (ThreadPoolExecutor-1_0): On analytics.information_schema: Close
2021-12-05 23:25:12.016621 (MainThread): 23:25:12 | Catalog written to /usr/src/develop/user-48664/environment-53260/repository-43071/target/catalog.json
2021-12-05 23:25:12.957237 (Thread-40): handling poll request
2021-12-05 23:25:12.957527 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc750cd0>]}
2021-12-05 23:25:12.958243 (Thread-40): sending response (<Response 4200 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:25:13.890924 (Thread-41): handling status request
2021-12-05 23:25:13.891232 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc750dc0>]}
2021-12-05 23:25:13.891784 (Thread-41): sending response (<Response 1983 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:25:13.962318 (Thread-42): handling status request
2021-12-05 23:25:13.962535 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc750e20>]}
2021-12-05 23:25:13.962956 (Thread-42): sending response (<Response 1983 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:25:14.017894 (Thread-43): handling status request
2021-12-05 23:25:14.018144 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc74f250>]}
2021-12-05 23:25:14.018555 (Thread-43): sending response (<Response 1983 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:51:40.796717 (Thread-44): handling status request
2021-12-05 23:51:40.798715 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc74f610>]}
2021-12-05 23:51:40.799222 (Thread-44): sending response (<Response 1983 bytes [200 OK]>) to 10.0.6.71
2021-12-05 23:51:44.243532 (Thread-45): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-05 23:51:44.243841 (Thread-45): Partial parsing enabled, no changes found, skipping parsing
2021-12-05 23:51:44.244304 (Thread-45): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-05 23:51:44.248871 (Thread-45): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc71fc40>]}
2021-12-05 23:51:45.174730 (Thread-46): handling status request
2021-12-05 23:51:45.175045 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc71feb0>]}
2021-12-05 23:51:45.175522 (Thread-46): sending response (<Response 1639 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:51:45.176463 (Thread-47): handling status request
2021-12-05 23:51:45.176808 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c491e460>]}
2021-12-05 23:51:45.177236 (Thread-47): sending response (<Response 1639 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:02:56.092098 (Thread-48): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:02:56.093917 (Thread-48): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:02:56.094382 (Thread-48): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:02:56.098882 (Thread-48): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc690d00>]}
2021-12-06 00:02:56.917529 (Thread-49): handling status request
2021-12-06 00:02:56.917851 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc76dfd0>]}
2021-12-06 00:02:56.918363 (Thread-49): sending response (<Response 1639 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:02:56.979116 (Thread-50): handling status request
2021-12-06 00:02:56.979336 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc76dd60>]}
2021-12-06 00:02:56.979751 (Thread-50): sending response (<Response 1639 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:03:09.271898 (Thread-51): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:03:09.272222 (Thread-51): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:03:09.272639 (Thread-51): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:03:09.277102 (Thread-51): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6fd790>]}
2021-12-06 00:03:10.035617 (Thread-52): handling status request
2021-12-06 00:03:10.035920 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6ed160>]}
2021-12-06 00:03:10.036390 (Thread-52): sending response (<Response 1639 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:03:10.060978 (Thread-53): handling status request
2021-12-06 00:03:10.061183 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6ed130>]}
2021-12-06 00:03:10.061557 (Thread-53): sending response (<Response 1639 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:03:14.998032 (Thread-54): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:03:14.998366 (Thread-54): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:03:14.998793 (Thread-54): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:03:15.003384 (Thread-54): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63bbe0>]}
2021-12-06 00:03:15.781692 (Thread-55): handling status request
2021-12-06 00:03:15.782041 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6580d0>]}
2021-12-06 00:03:15.782556 (Thread-55): sending response (<Response 1639 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:03:15.831753 (Thread-56): handling status request
2021-12-06 00:03:15.831952 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc658040>]}
2021-12-06 00:03:15.832352 (Thread-56): sending response (<Response 1639 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:03:41.272521 (Thread-57): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:03:41.272844 (Thread-57): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:03:41.273292 (Thread-57): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:03:41.277624 (Thread-57): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc7786a0>]}
2021-12-06 00:03:42.388727 (Thread-58): handling status request
2021-12-06 00:03:42.389047 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc717d60>]}
2021-12-06 00:03:42.389555 (Thread-58): sending response (<Response 1639 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:03:42.396585 (Thread-59): handling status request
2021-12-06 00:03:42.396791 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc7179d0>]}
2021-12-06 00:03:42.397160 (Thread-59): sending response (<Response 1639 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:04:12.860250 (Thread-60): Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2021-12-06 00:04:12.860559 (Thread-60): Partial parsing: added file: my_new_project://models/staging/jaffle_shop/stg_customers.sql
2021-12-06 00:04:12.860687 (Thread-60): Partial parsing: deleted file: my_new_project://models/stg_customers.sql
2021-12-06 00:04:12.864217 (Thread-60): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-06 00:04:12.866775 (Thread-60): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-06 00:04:12.903913 (Thread-60): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:04:12.908181 (Thread-60): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc71f220>]}
2021-12-06 00:04:13.620584 (Thread-61): handling status request
2021-12-06 00:04:13.620897 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6fb6d0>]}
2021-12-06 00:04:13.621451 (Thread-61): sending response (<Response 2584 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:04:13.647768 (Thread-62): handling status request
2021-12-06 00:04:13.647970 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6fba30>]}
2021-12-06 00:04:13.648405 (Thread-62): sending response (<Response 2584 bytes [200 OK]>) to 10.0.6.71
2021-12-06 00:04:31.285780 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-06 00:04:31.347213 (Thread-63): Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2021-12-06 00:04:31.347482 (Thread-63): Partial parsing: added file: my_new_project://models/staging/jaffle_shop/stg_orders.sql
2021-12-06 00:04:31.347600 (Thread-63): Partial parsing: deleted file: my_new_project://models/stg_orders.sql
2021-12-06 00:04:31.350864 (Thread-63): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-06 00:04:31.353393 (Thread-63): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-06 00:04:31.396858 (Thread-63): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:04:31.401215 (Thread-63): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc610eb0>]}
2021-12-06 00:04:32.094671 (Thread-64): handling status request
2021-12-06 00:04:32.094982 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc610eb0>]}
2021-12-06 00:04:32.095508 (Thread-64): sending response (<Response 2575 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:04:32.128530 (Thread-65): handling status request
2021-12-06 00:04:32.128753 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc766610>]}
2021-12-06 00:04:32.129184 (Thread-65): sending response (<Response 2575 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:05:15.352603 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-06 00:05:15.419055 (Thread-66): Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2021-12-06 00:05:15.419330 (Thread-66): Partial parsing: added file: my_new_project://models/marts/core/dim_customers.sql
2021-12-06 00:05:15.419449 (Thread-66): Partial parsing: deleted file: my_new_project://models/dim_customers.sql
2021-12-06 00:05:15.422765 (Thread-66): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-06 00:05:15.462926 (Thread-66): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:05:15.467179 (Thread-66): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5e1be0>]}
2021-12-06 00:05:16.171179 (Thread-67): handling status request
2021-12-06 00:05:16.171485 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5e1820>]}
2021-12-06 00:05:16.171977 (Thread-67): sending response (<Response 2270 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:05:16.180991 (Thread-68): handling status request
2021-12-06 00:05:16.181187 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5e1910>]}
2021-12-06 00:05:16.181543 (Thread-68): sending response (<Response 2270 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:17:36.738806 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-06 00:17:36.763689 (Thread-69): Unable to do partial parsing because a project dependency has been added
2021-12-06 00:17:36.763944 (Thread-69): Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc64ee50>]}
2021-12-06 00:17:36.839292 (Thread-69): Parsing macros/catalog.sql
2021-12-06 00:17:36.841232 (Thread-69): Parsing macros/adapters.sql
2021-12-06 00:17:36.874101 (Thread-69): Parsing macros/materializations/merge.sql
2021-12-06 00:17:36.877665 (Thread-69): Parsing macros/materializations/table.sql
2021-12-06 00:17:36.880725 (Thread-69): Parsing macros/materializations/seed.sql
2021-12-06 00:17:36.884822 (Thread-69): Parsing macros/materializations/view.sql
2021-12-06 00:17:36.886109 (Thread-69): Parsing macros/materializations/incremental.sql
2021-12-06 00:17:36.894023 (Thread-69): Parsing macros/core.sql
2021-12-06 00:17:36.897419 (Thread-69): Parsing macros/materializations/test.sql
2021-12-06 00:17:36.903565 (Thread-69): Parsing macros/materializations/helpers.sql
2021-12-06 00:17:36.913069 (Thread-69): Parsing macros/materializations/view/view.sql
2021-12-06 00:17:36.919540 (Thread-69): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:17:36.923183 (Thread-69): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:17:36.944262 (Thread-69): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:17:36.960121 (Thread-69): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:17:36.961709 (Thread-69): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:17:36.990743 (Thread-69): Parsing macros/materializations/table/table.sql
2021-12-06 00:17:36.997527 (Thread-69): Parsing macros/materializations/common/merge.sql
2021-12-06 00:17:37.010457 (Thread-69): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:17:37.028732 (Thread-69): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:17:37.038003 (Thread-69): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:17:37.039685 (Thread-69): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:17:37.041183 (Thread-69): Parsing macros/etc/datetime.sql
2021-12-06 00:17:37.049052 (Thread-69): Parsing macros/etc/query.sql
2021-12-06 00:17:37.049989 (Thread-69): Parsing macros/etc/where_subquery.sql
2021-12-06 00:17:37.051657 (Thread-69): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:17:37.053167 (Thread-69): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:17:37.055495 (Thread-69): Parsing macros/etc/is_incremental.sql
2021-12-06 00:17:37.056892 (Thread-69): Parsing macros/adapters/common.sql
2021-12-06 00:17:37.108140 (Thread-69): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:17:37.110264 (Thread-69): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:17:37.111438 (Thread-69): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:17:37.112976 (Thread-69): Parsing macros/schema_tests/unique.sql
2021-12-06 00:17:37.286014 (Thread-69): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:17:37.288873 (Thread-69): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:17:37.291553 (Thread-69): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:17:37.387152 (Thread-69): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc49fa90>]}
2021-12-06 00:17:37.581527 (Thread-70): handling status request
2021-12-06 00:17:37.581846 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5baf40>]}
2021-12-06 00:17:37.582664 (Thread-70): sending response (<Response 11304 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:17:37.626541 (Thread-71): handling status request
2021-12-06 00:17:37.626772 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5bac10>]}
2021-12-06 00:17:37.627484 (Thread-71): sending response (<Response 11304 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:17:45.174665 (Thread-72): handling status request
2021-12-06 00:17:45.174974 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5baa90>]}
2021-12-06 00:17:45.175729 (Thread-72): sending response (<Response 11304 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:17:45.524775 (Thread-73): handling status request
2021-12-06 00:17:45.525027 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5ba7c0>]}
2021-12-06 00:17:45.525770 (Thread-73): sending response (<Response 11304 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:17:45.663124 (Thread-74): handling cli_args request
2021-12-06 00:17:45.663330 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5ba5e0>]}
2021-12-06 00:17:45.673418 (Thread-74): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:17:47.635001 (Thread-74): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:17:47.657826 (MainThread): Partial parsing not enabled
2021-12-06 00:17:47.696956 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:17:47.699057 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:17:47.735455 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:17:47.739214 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:17:47.742560 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:17:47.746908 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:17:47.748169 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:17:47.756652 (MainThread): Parsing macros/core.sql
2021-12-06 00:17:47.760213 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:17:47.766807 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:17:47.776463 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:17:47.783408 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:17:47.787148 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:17:47.809420 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:17:47.826313 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:17:47.827885 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:17:47.858301 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:17:47.865414 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:17:47.878904 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:17:47.897995 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:17:47.907765 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:17:47.909510 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:17:47.910967 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:17:47.919186 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:17:47.920098 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:17:47.921753 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:17:47.923282 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:17:47.925673 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:17:47.927126 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:17:47.982046 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:17:47.984180 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:17:47.985287 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:17:47.986878 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:17:48.119815 (Thread-75): handling poll request
2021-12-06 00:17:48.120124 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc766fa0>]}
2021-12-06 00:17:48.121220 (Thread-75): sending response (<Response 9652 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:17:48.176826 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:17:48.188561 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:17:48.191039 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:17:48.248883 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33cc136df0>]}
2021-12-06 00:17:48.265769 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33cc136e20>]}
2021-12-06 00:17:48.265994 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:17:48.266989 (MainThread): 
2021-12-06 00:17:48.267189 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:17:48.267951 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:17:48.279223 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:17:48.279292 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:17:48.279345 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:17:49.604494 (Thread-76): handling poll request
2021-12-06 00:17:49.604805 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4a4b20>]}
2021-12-06 00:17:49.605417 (Thread-76): sending response (<Response 4323 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:17:49.820526 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.54 seconds
2021-12-06 00:17:49.822366 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:17:50.273308 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:17:50.280368 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:17:50.280477 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:17:50.280542 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:17:51.048053 (Thread-77): handling poll request
2021-12-06 00:17:51.048365 (Thread-77): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4a4730>]}
2021-12-06 00:17:51.048913 (Thread-77): sending response (<Response 2257 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:17:51.545302 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-12-06 00:17:51.546727 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:17:52.001850 (MainThread): 00:17:51 | Concurrency: 4 threads (target='default')
2021-12-06 00:17:52.002016 (MainThread): 00:17:51 | 
2021-12-06 00:17:52.003916 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:17:52.004189 (Thread-1): 00:17:51 | 1 of 3 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:17:52.004411 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:17:52.004506 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:17:52.005322 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:17:52.005540 (Thread-2): 00:17:51 | 2 of 3 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:17:52.005772 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:17:52.005841 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:17:52.006951 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:17:52.007807 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:17:52.044624 (Thread-2): finished collecting timing info
2021-12-06 00:17:52.049946 (Thread-1): finished collecting timing info
2021-12-06 00:17:52.077577 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:17:52.078733 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:17:52.115104 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:17:52.115183 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:17:52.115240 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:17:52.119223 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:17:52.119305 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:17:52.119361 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:17:52.513741 (Thread-78): handling poll request
2021-12-06 00:17:52.514057 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5d06a0>]}
2021-12-06 00:17:52.514806 (Thread-78): sending response (<Response 9839 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:17:53.656068 (Thread-2): SQL status: SUCCESS 1 in 1.54 seconds
2021-12-06 00:17:53.662881 (Thread-2): finished collecting timing info
2021-12-06 00:17:53.663018 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:17:53.663726 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-12-06 00:17:53.664819 (Thread-1): finished collecting timing info
2021-12-06 00:17:53.664927 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:17:53.975205 (Thread-79): handling poll request
2021-12-06 00:17:53.975503 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5d0ac0>]}
2021-12-06 00:17:53.976033 (Thread-79): sending response (<Response 2458 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:17:54.111223 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33cc9fa190>]}
2021-12-06 00:17:54.111629 (Thread-2): 00:17:54 | 2 of 3 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.11s]
2021-12-06 00:17:54.111728 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:17:54.126865 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c71b1fd0>]}
2021-12-06 00:17:54.127158 (Thread-1): 00:17:54 | 1 of 3 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.12s]
2021-12-06 00:17:54.127236 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:17:54.127968 (Thread-4): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:17:54.128172 (Thread-4): 00:17:54 | 3 of 3 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:17:54.128405 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:17:54.128478 (Thread-4): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:17:54.131112 (Thread-4): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:17:54.158508 (Thread-4): finished collecting timing info
2021-12-06 00:17:54.174661 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:17:54.201525 (Thread-4): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:17:54.201608 (Thread-4): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (

with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:17:54.201667 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:17:55.423809 (Thread-80): handling poll request
2021-12-06 00:17:55.424121 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b9310>]}
2021-12-06 00:17:55.424786 (Thread-80): sending response (<Response 7789 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:17:57.009021 (Thread-4): SQL status: SUCCESS 1 in 2.81 seconds
2021-12-06 00:17:57.013607 (Thread-4): finished collecting timing info
2021-12-06 00:17:57.013741 (Thread-4): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:17:57.052105 (Thread-81): handling poll request
2021-12-06 00:17:57.052380 (Thread-81): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b9610>]}
2021-12-06 00:17:57.052909 (Thread-81): sending response (<Response 1378 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:17:57.470881 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ccae3a00>]}
2021-12-06 00:17:57.471239 (Thread-4): 00:17:57 | 3 of 3 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 3.34s]
2021-12-06 00:17:57.471331 (Thread-4): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:17:57.472789 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:17:57.473096 (MainThread): 00:17:57 | 
2021-12-06 00:17:57.473169 (MainThread): 00:17:57 | Finished running 2 view models, 1 table model in 9.21s.
2021-12-06 00:17:57.473219 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:17:57.473260 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:17:57.473297 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:17:57.473333 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:17:57.527014 (MainThread): 
2021-12-06 00:17:57.527124 (MainThread): Completed successfully
2021-12-06 00:17:57.527189 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-06 00:17:58.498627 (Thread-82): handling poll request
2021-12-06 00:17:58.498953 (Thread-82): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5d08e0>]}
2021-12-06 00:17:58.500048 (Thread-82): sending response (<Response 13443 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:17:59.464845 (Thread-83): handling status request
2021-12-06 00:17:59.465166 (Thread-83): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6876a0>]}
2021-12-06 00:17:59.466056 (Thread-83): sending response (<Response 11304 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:17:59.519230 (Thread-84): handling status request
2021-12-06 00:17:59.519465 (Thread-84): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5453d0>]}
2021-12-06 00:17:59.520169 (Thread-84): sending response (<Response 11304 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:18:08.375458 (Thread-85): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:18:08.375764 (Thread-85): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 00:18:08.379344 (Thread-85): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:18:08.423159 (Thread-85): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4e7130>]}
2021-12-06 00:18:09.160768 (Thread-86): handling status request
2021-12-06 00:18:09.161094 (Thread-86): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5c1160>]}
2021-12-06 00:18:09.161602 (Thread-86): sending response (<Response 1533 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:18:09.193386 (Thread-87): handling status request
2021-12-06 00:18:09.193610 (Thread-87): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4e7d30>]}
2021-12-06 00:18:09.194065 (Thread-87): sending response (<Response 1533 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:18:12.362366 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:18:12.422417 (Thread-88): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:18:12.422706 (Thread-88): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:18:12.427193 (Thread-88): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52b820>]}
2021-12-06 00:18:13.098062 (Thread-89): handling status request
2021-12-06 00:18:13.098369 (Thread-89): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52ae50>]}
2021-12-06 00:18:13.098847 (Thread-89): sending response (<Response 1209 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:18:13.139500 (Thread-90): handling status request
2021-12-06 00:18:13.139707 (Thread-90): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4d04f0>]}
2021-12-06 00:18:13.140100 (Thread-90): sending response (<Response 1209 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:16.253264 (Thread-91): handling status request
2021-12-06 00:18:16.253576 (Thread-91): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b29a0>]}
2021-12-06 00:18:16.254057 (Thread-91): sending response (<Response 1209 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:18:16.555660 (Thread-92): handling status request
2021-12-06 00:18:16.555940 (Thread-92): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b2790>]}
2021-12-06 00:18:16.556382 (Thread-92): sending response (<Response 1209 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:18:16.737898 (Thread-93): handling cli_args request
2021-12-06 00:18:16.738142 (Thread-93): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b2520>]}
2021-12-06 00:18:18.676638 (Thread-93): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:18.713053 (MainThread): Partial parsing not enabled
2021-12-06 00:18:18.752333 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:18:18.754319 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:18:18.789032 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:18:18.792733 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:18:18.795927 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:18:18.800189 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:18:18.801435 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:18:18.809746 (MainThread): Parsing macros/core.sql
2021-12-06 00:18:18.813266 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:18:18.819633 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:18:18.829378 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:18:18.836287 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:18:18.839959 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:18:18.861914 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:18:18.878632 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:18:18.880197 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:18:18.910201 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:18:18.917254 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:18:18.930659 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:18:18.949558 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:18:18.959358 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:18:18.961056 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:18:18.962487 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:18:18.970690 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:18:18.971571 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:18:18.973213 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:18:18.974740 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:18:18.977102 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:18:18.978536 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:18:19.031829 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:18:19.033961 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:18:19.035086 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:18:19.036604 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:18:19.148441 (Thread-94): handling poll request
2021-12-06 00:18:19.148741 (Thread-94): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b8be0>]}
2021-12-06 00:18:19.149787 (Thread-94): sending response (<Response 9652 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:19.223699 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:18:19.235427 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:18:19.237841 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:18:19.294427 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5280081b20>]}
2021-12-06 00:18:19.313001 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5280081ee0>]}
2021-12-06 00:18:19.313199 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:18:19.314257 (MainThread): 
2021-12-06 00:18:19.314456 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:18:19.322324 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:18:19.334126 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:18:19.334201 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:18:19.334255 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:18:20.593240 (Thread-95): handling poll request
2021-12-06 00:18:20.593550 (Thread-95): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc55e820>]}
2021-12-06 00:18:20.594174 (Thread-95): sending response (<Response 4323 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:18:20.942196 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.61 seconds
2021-12-06 00:18:20.943968 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:18:21.392172 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:18:21.399137 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:18:21.399241 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:18:21.399305 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:18:22.091556 (Thread-96): handling poll request
2021-12-06 00:18:22.091860 (Thread-96): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc49fbe0>]}
2021-12-06 00:18:22.092397 (Thread-96): sending response (<Response 2257 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:18:22.647379 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.25 seconds
2021-12-06 00:18:22.648795 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:18:23.103696 (MainThread): 00:18:23 | Concurrency: 4 threads (target='default')
2021-12-06 00:18:23.103839 (MainThread): 00:18:23 | 
2021-12-06 00:18:23.105721 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:18:23.106026 (Thread-1): 00:18:23 | 1 of 3 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:18:23.106251 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:18:23.106351 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:18:23.107178 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:18:23.107395 (Thread-2): 00:18:23 | 2 of 3 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:18:23.107616 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:18:23.107683 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:18:23.108747 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:18:23.109605 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:18:23.124837 (Thread-2): finished collecting timing info
2021-12-06 00:18:23.130024 (Thread-1): finished collecting timing info
2021-12-06 00:18:23.157727 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:18:23.159703 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:18:23.176636 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:18:23.176713 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:18:23.176768 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:18:23.178700 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:18:23.178782 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:18:23.178836 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:18:23.537528 (Thread-97): handling poll request
2021-12-06 00:18:23.537772 (Thread-97): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5d6f10>]}
2021-12-06 00:18:23.538528 (Thread-97): sending response (<Response 9839 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:18:24.716122 (Thread-2): SQL status: SUCCESS 1 in 1.54 seconds
2021-12-06 00:18:24.722516 (Thread-2): finished collecting timing info
2021-12-06 00:18:24.722644 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:18:24.853072 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2021-12-06 00:18:24.854256 (Thread-1): finished collecting timing info
2021-12-06 00:18:24.854363 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:18:25.010935 (Thread-98): handling poll request
2021-12-06 00:18:25.011219 (Thread-98): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a2e50>]}
2021-12-06 00:18:25.039362 (Thread-98): sending response (<Response 2458 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:25.180706 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f528010d5e0>]}
2021-12-06 00:18:25.181093 (Thread-2): 00:18:25 | 2 of 3 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.07s]
2021-12-06 00:18:25.181178 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:18:25.305320 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527b19e430>]}
2021-12-06 00:18:25.305631 (Thread-1): 00:18:25 | 1 of 3 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.20s]
2021-12-06 00:18:25.305728 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:18:25.306653 (Thread-4): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:18:25.306869 (Thread-4): 00:18:25 | 3 of 3 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:18:25.307096 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:18:25.307167 (Thread-4): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:18:25.309542 (Thread-4): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:18:25.324394 (Thread-4): finished collecting timing info
2021-12-06 00:18:25.340457 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:18:25.356891 (Thread-4): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:18:25.356970 (Thread-4): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:18:25.357029 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:18:26.524497 (Thread-99): handling poll request
2021-12-06 00:18:26.524801 (Thread-99): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc49f580>]}
2021-12-06 00:18:26.525477 (Thread-99): sending response (<Response 7784 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:18:27.474354 (Thread-4): SQL status: SUCCESS 1 in 2.12 seconds
2021-12-06 00:18:27.478912 (Thread-4): finished collecting timing info
2021-12-06 00:18:27.479048 (Thread-4): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:18:27.938868 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5280aa39a0>]}
2021-12-06 00:18:27.939247 (Thread-4): 00:18:27 | 3 of 3 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.63s]
2021-12-06 00:18:27.939334 (Thread-4): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:18:27.940821 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:18:27.941105 (MainThread): 00:18:27 | 
2021-12-06 00:18:27.941176 (MainThread): 00:18:27 | Finished running 2 view models, 1 table model in 8.63s.
2021-12-06 00:18:27.941226 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:18:27.941264 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:18:27.941300 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:18:27.941333 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:18:27.997066 (MainThread): 
2021-12-06 00:18:27.997173 (MainThread): Completed successfully
2021-12-06 00:18:27.997238 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-06 00:18:28.365554 (Thread-100): handling poll request
2021-12-06 00:18:28.365851 (Thread-100): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a56d0>]}
2021-12-06 00:18:28.366993 (Thread-100): sending response (<Response 14485 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:18:29.338636 (Thread-101): handling status request
2021-12-06 00:18:29.338968 (Thread-101): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a58b0>]}
2021-12-06 00:18:29.339494 (Thread-101): sending response (<Response 1209 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:18:29.369370 (Thread-102): handling status request
2021-12-06 00:18:29.369591 (Thread-102): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a5f70>]}
2021-12-06 00:18:29.370031 (Thread-102): sending response (<Response 1209 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:56.531594 (Thread-103): handling status request
2021-12-06 00:18:56.531900 (Thread-103): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a5eb0>]}
2021-12-06 00:18:56.532355 (Thread-103): sending response (<Response 1209 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:19:00.668515 (Thread-104): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:19:00.668814 (Thread-104): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:19:00.674290 (Thread-104): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63b940>]}
2021-12-06 00:19:01.506642 (Thread-105): handling status request
2021-12-06 00:19:01.506961 (Thread-105): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63b100>]}
2021-12-06 00:19:01.507441 (Thread-105): sending response (<Response 1212 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:19:01.528460 (Thread-106): handling status request
2021-12-06 00:19:01.528679 (Thread-106): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63b3a0>]}
2021-12-06 00:19:01.529074 (Thread-106): sending response (<Response 1212 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:24:42.951754 (Thread-107): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:24:42.953505 (Thread-107): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:24:42.958167 (Thread-107): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf8a310>]}
2021-12-06 00:24:43.858950 (Thread-108): handling status request
2021-12-06 00:24:43.859268 (Thread-108): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc7178e0>]}
2021-12-06 00:24:43.859774 (Thread-108): sending response (<Response 1212 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:24:43.861013 (Thread-109): handling status request
2021-12-06 00:24:43.861211 (Thread-109): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc717d90>]}
2021-12-06 00:24:43.861552 (Thread-109): sending response (<Response 1212 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:24:59.525430 (Thread-110): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:24:59.525760 (Thread-110): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:24:59.530527 (Thread-110): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c48fd400>]}
2021-12-06 00:25:00.582113 (Thread-111): handling status request
2021-12-06 00:25:00.582435 (Thread-111): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc723b20>]}
2021-12-06 00:25:00.582916 (Thread-111): sending response (<Response 1212 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:25:00.603004 (Thread-112): handling status request
2021-12-06 00:25:00.603217 (Thread-112): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc723e20>]}
2021-12-06 00:25:00.603572 (Thread-112): sending response (<Response 1212 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:27:38.453297 (Thread-113): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 00:27:38.455210 (Thread-113): Partial parsing: added file: jaffle_shop://models/staging/stripe/stg_payments.sql
2021-12-06 00:27:38.459016 (Thread-113): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:27:38.500722 (Thread-113): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c48cc760>]}
2021-12-06 00:27:39.257280 (Thread-114): handling status request
2021-12-06 00:27:39.257589 (Thread-114): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfbc6a0>]}
2021-12-06 00:27:39.258126 (Thread-114): sending response (<Response 1537 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:27:39.275183 (Thread-115): handling status request
2021-12-06 00:27:39.275394 (Thread-115): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfbcac0>]}
2021-12-06 00:27:39.275774 (Thread-115): sending response (<Response 1537 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:29:20.346227 (Thread-116): handling status request
2021-12-06 00:29:20.348091 (Thread-116): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfbcb20>]}
2021-12-06 00:29:20.348579 (Thread-116): sending response (<Response 1537 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:29:20.829642 (Thread-117): handling run_sql request
2021-12-06 00:29:20.829981 (Thread-117): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfbcd00>]}
2021-12-06 00:29:20.832166 (Thread-117): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:29:22.740177 (Thread-117): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:29:22.751107 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:22.766863 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ff749a7-8779-45f5-a477-0a94ee3a5701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042659be20>]}
2021-12-06 00:29:22.767103 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:29:22.767463 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:22.767565 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:29:22.768484 (Thread-1): finished collecting timing info
2021-12-06 00:29:22.769072 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:22.769134 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payments

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 00:29:22.769187 (Thread-1): Opening a new connection, currently in state init
2021-12-06 00:29:23.194234 (Thread-118): handling poll request
2021-12-06 00:29:23.194550 (Thread-118): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf8a490>]}
2021-12-06 00:29:23.195413 (Thread-118): sending response (<Response 3478 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:29:24.251846 (Thread-1): Snowflake query id: 01a0c17d-3200-95c4-0000-00008ef92b15
2021-12-06 00:29:24.252041 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
2021-12-06 00:29:24.252172 (Thread-1): finished collecting timing info
2021-12-06 00:29:24.252323 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 00:29:24.656088 (Thread-119): handling poll request
2021-12-06 00:29:24.656373 (Thread-119): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc647730>]}
2021-12-06 00:29:24.656951 (Thread-119): sending response (<Response 1712 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:29:24.702595 (Thread-1): Got an exception: Database Error
  002003 (42S02): SQL compilation error:
  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (42S02): SQL compilation error:
  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
2021-12-06 00:29:24.703543 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.", 'raw_sql': 'with payments as (\n    select\n        orderid as order_id,\n        amount\n\n    from raw.stripe.payments\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with payments as (\n    select\n        orderid as order_id,\n        amount\n\n    from raw.stripe.payments\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.", 'raw_sql': 'with payments as (\n    select\n        orderid as order_id,\n        amount\n\n    from raw.stripe.payments\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with payments as (\n    select\n        orderid as order_id,\n        amount\n\n    from raw.stripe.payments\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-12-06 00:29:26.143868 (Thread-120): handling poll request
2021-12-06 00:29:26.144205 (Thread-120): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b8700>]}
2021-12-06 00:29:26.144878 (Thread-120): sending response (<Response 10294 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:29:46.753523 (Thread-121): handling status request
2021-12-06 00:29:46.753844 (Thread-121): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52baf0>]}
2021-12-06 00:29:46.754412 (Thread-121): sending response (<Response 1537 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:29:47.210726 (Thread-122): handling run_sql request
2021-12-06 00:29:47.211003 (Thread-122): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52bb20>]}
2021-12-06 00:29:49.138372 (Thread-122): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:29:49.149345 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:49.162225 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04f4b3d0-ecfc-4dc4-be0d-329ac9868852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d79477d90>]}
2021-12-06 00:29:49.162453 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:29:49.162830 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:49.162928 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:29:49.163836 (Thread-1): finished collecting timing info
2021-12-06 00:29:49.164420 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:49.164479 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 00:29:49.164531 (Thread-1): Opening a new connection, currently in state init
2021-12-06 00:29:49.578760 (Thread-123): handling poll request
2021-12-06 00:29:49.579091 (Thread-123): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52b880>]}
2021-12-06 00:29:49.579898 (Thread-123): sending response (<Response 3477 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:29:50.706074 (Thread-1): SQL status: SUCCESS 120 in 1.54 seconds
2021-12-06 00:29:50.709085 (Thread-1): finished collecting timing info
2021-12-06 00:29:50.709277 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 00:29:51.137035 (Thread-124): handling poll request
2021-12-06 00:29:51.137336 (Thread-124): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4910>]}
2021-12-06 00:29:51.137879 (Thread-124): sending response (<Response 1344 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:29:52.694855 (Thread-125): handling poll request
2021-12-06 00:29:52.695194 (Thread-125): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc56ddf0>]}
2021-12-06 00:29:52.696431 (Thread-125): sending response (<Response 4730 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:30:12.228072 (Thread-126): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:30:12.228392 (Thread-126): Partial parsing: updated file: jaffle_shop://models/staging/stripe/stg_payments.sql
2021-12-06 00:30:12.232884 (Thread-126): 1699: statically parsed staging/stripe/stg_payments.sql
2021-12-06 00:30:12.233090 (Thread-126): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:30:12.235041 (Thread-126): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6b6b50>]}
2021-12-06 00:30:12.277015 (Thread-126): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51d8460>]}
2021-12-06 00:30:12.974040 (Thread-127): handling status request
2021-12-06 00:30:12.974352 (Thread-127): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51d86d0>]}
2021-12-06 00:30:13.000030 (Thread-127): sending response (<Response 2272 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:30:13.459956 (Thread-128): handling status request
2021-12-06 00:30:13.460369 (Thread-128): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51d8910>]}
2021-12-06 00:30:13.461046 (Thread-128): sending response (<Response 2272 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:31:32.300310 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:31:32.382333 (Thread-129): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 00:31:32.382595 (Thread-129): Partial parsing: added file: jaffle_shop://models/marts/core/fct_orders.sql
2021-12-06 00:31:32.385894 (Thread-129): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:31:32.426647 (Thread-129): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc48f970>]}
2021-12-06 00:31:33.244945 (Thread-130): handling status request
2021-12-06 00:31:33.245256 (Thread-130): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49bd910>]}
2021-12-06 00:31:33.245739 (Thread-130): sending response (<Response 1529 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:31:33.255899 (Thread-131): handling status request
2021-12-06 00:31:33.256117 (Thread-131): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49bd760>]}
2021-12-06 00:31:33.256487 (Thread-131): sending response (<Response 1529 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:37:57.089990 (Thread-132): handling status request
2021-12-06 00:37:57.092075 (Thread-132): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4939670>]}
2021-12-06 00:37:57.092557 (Thread-132): sending response (<Response 1529 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:37:57.643751 (Thread-133): handling run_sql request
2021-12-06 00:37:57.644052 (Thread-133): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4939640>]}
2021-12-06 00:37:57.645160 (Thread-133): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:37:59.580582 (Thread-133): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:37:59.591565 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:37:59.608589 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fad98b19-8068-449c-9e07-e44b216296a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27890b0d0>]}
2021-12-06 00:37:59.608843 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:37:59.609218 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:37:59.609322 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:37:59.611323 (Thread-1): finished collecting timing info
2021-12-06 00:37:59.612227 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:37:59.612294 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 00:37:59.612348 (Thread-1): Opening a new connection, currently in state init
2021-12-06 00:38:00.085611 (Thread-134): handling poll request
2021-12-06 00:38:00.086015 (Thread-134): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63b4f0>]}
2021-12-06 00:38:00.086916 (Thread-134): sending response (<Response 3684 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:38:01.082390 (Thread-1): Snowflake query id: 01a0c186-3200-95c4-0000-00008ef92b21
2021-12-06 00:38:01.082575 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.
2021-12-06 00:38:01.082701 (Thread-1): finished collecting timing info
2021-12-06 00:38:01.082845 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 00:38:01.544591 (Thread-1): Got an exception: Database Error
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.
2021-12-06 00:38:01.545572 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments')}}\n),\n\norders as (\n    select * from {{ ref('stg_orders')}}\n),\n\n\nfinal as (\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n    \n    from orders\n\n    left join payments using (order_id)\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\norders as (\n    select * from analytics.dbt_pstulnikov.stg_orders\n),\n\n\nfinal as (\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n    \n    from orders\n\n    left join payments using (order_id)\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments')}}\n),\n\norders as (\n    select * from {{ ref('stg_orders')}}\n),\n\n\nfinal as (\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n    \n    from orders\n\n    left join payments using (order_id)\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\norders as (\n    select * from analytics.dbt_pstulnikov.stg_orders\n),\n\n\nfinal as (\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n    \n    from orders\n\n    left join payments using (order_id)\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-12-06 00:38:01.588126 (Thread-135): handling poll request
2021-12-06 00:38:01.588450 (Thread-135): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc690c40>]}
2021-12-06 00:38:01.589069 (Thread-135): sending response (<Response 7814 bytes [200 OK]>) to 10.0.6.71
2021-12-06 00:38:03.035456 (Thread-136): handling poll request
2021-12-06 00:38:03.035789 (Thread-136): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc690a60>]}
2021-12-06 00:38:03.036414 (Thread-136): sending response (<Response 11882 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:38:22.343796 (Thread-137): handling status request
2021-12-06 00:38:22.344198 (Thread-137): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6b65e0>]}
2021-12-06 00:38:22.344802 (Thread-137): sending response (<Response 1529 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:38:22.648710 (Thread-138): handling status request
2021-12-06 00:38:22.649017 (Thread-138): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a5640>]}
2021-12-06 00:38:22.649521 (Thread-138): sending response (<Response 1529 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:38:22.795378 (Thread-139): handling cli_args request
2021-12-06 00:38:22.795586 (Thread-139): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52baf0>]}
2021-12-06 00:38:24.705854 (Thread-139): sending response (<Response 138 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:38:24.741160 (MainThread): Partial parsing not enabled
2021-12-06 00:38:24.799163 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:38:24.801076 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:38:24.834483 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:38:24.838060 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:38:24.841120 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:38:24.845239 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:38:24.846471 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:38:24.854509 (MainThread): Parsing macros/core.sql
2021-12-06 00:38:24.857919 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:38:24.864068 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:38:24.873473 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:38:24.880004 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:38:24.883577 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:38:24.904674 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:38:24.920562 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:38:24.922091 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:38:24.950972 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:38:24.957726 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:38:24.970632 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:38:24.988984 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:38:24.998328 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:38:24.999957 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:38:25.001291 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:38:25.009073 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:38:25.010029 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:38:25.011619 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:38:25.013027 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:38:25.015300 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:38:25.016640 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:38:25.068360 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:38:25.070420 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:38:25.071481 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:38:25.072943 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:38:25.156183 (Thread-140): handling poll request
2021-12-06 00:38:25.156738 (Thread-140): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63e220>]}
2021-12-06 00:38:25.157683 (Thread-140): sending response (<Response 9652 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:38:25.251779 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:38:25.263500 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:38:25.265855 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:38:25.268297 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:38:25.271930 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:38:25.327174 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8738f72550>]}
2021-12-06 00:38:25.352598 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8738f72df0>]}
2021-12-06 00:38:25.352807 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:38:25.353839 (MainThread): 
2021-12-06 00:38:25.354049 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:38:25.354865 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:38:25.368903 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:38:25.369003 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:38:25.369083 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:38:26.711252 (Thread-141): handling poll request
2021-12-06 00:38:26.711575 (Thread-141): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51d8310>]}
2021-12-06 00:38:26.712186 (Thread-141): sending response (<Response 4927 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:38:26.906790 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.54 seconds
2021-12-06 00:38:26.908604 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:38:27.366596 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:38:27.374050 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:38:27.374156 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:38:27.374230 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:38:28.198624 (Thread-142): handling poll request
2021-12-06 00:38:28.198932 (Thread-142): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc48ffa0>]}
2021-12-06 00:38:28.199496 (Thread-142): sending response (<Response 2257 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:38:28.641271 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.27 seconds
2021-12-06 00:38:28.642793 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:38:29.099611 (MainThread): 00:38:29 | Concurrency: 4 threads (target='default')
2021-12-06 00:38:29.099759 (MainThread): 00:38:29 | 
2021-12-06 00:38:29.101731 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:38:29.102056 (Thread-1): 00:38:29 | 1 of 4 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:38:29.102298 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:38:29.102398 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:38:29.103233 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:38:29.103455 (Thread-2): 00:38:29 | 2 of 4 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:38:29.103688 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:38:29.103756 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:38:29.104821 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:38:29.105688 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:38:29.105866 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:38:29.106088 (Thread-3): 00:38:29 | 3 of 4 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:38:29.106309 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:38:29.106372 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:38:29.107417 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:38:29.128906 (Thread-2): finished collecting timing info
2021-12-06 00:38:29.134042 (Thread-1): finished collecting timing info
2021-12-06 00:38:29.162385 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:38:29.162564 (Thread-3): finished collecting timing info
2021-12-06 00:38:29.164121 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:38:29.166077 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:38:29.183980 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:38:29.184059 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:38:29.184117 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:38:29.186088 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:38:29.186172 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:38:29.186227 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:38:29.187197 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:38:29.187266 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:38:29.187319 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:38:29.786651 (Thread-143): handling poll request
2021-12-06 00:38:29.786984 (Thread-143): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6f0880>]}
2021-12-06 00:38:29.787811 (Thread-143): sending response (<Response 14013 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:38:30.805283 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-12-06 00:38:30.811659 (Thread-1): finished collecting timing info
2021-12-06 00:38:30.811797 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:38:30.827068 (Thread-3): SQL status: SUCCESS 1 in 1.64 seconds
2021-12-06 00:38:30.828119 (Thread-3): finished collecting timing info
2021-12-06 00:38:30.828226 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:38:30.989104 (Thread-2): SQL status: SUCCESS 1 in 1.80 seconds
2021-12-06 00:38:30.990186 (Thread-2): finished collecting timing info
2021-12-06 00:38:30.990286 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:38:31.266572 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87380fc4f0>]}
2021-12-06 00:38:31.266902 (Thread-1): 00:38:31 | 1 of 4 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.16s]
2021-12-06 00:38:31.266984 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:38:31.268541 (Thread-144): handling poll request
2021-12-06 00:38:31.268789 (Thread-144): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6776d0>]}
2021-12-06 00:38:31.269357 (Thread-144): sending response (<Response 4835 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:38:31.268968 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873820d430>]}
2021-12-06 00:38:31.269349 (Thread-3): 00:38:31 | 3 of 4 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.16s]
2021-12-06 00:38:31.269432 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:38:31.441879 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8738096a00>]}
2021-12-06 00:38:31.442223 (Thread-2): 00:38:31 | 2 of 4 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.34s]
2021-12-06 00:38:31.442307 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:38:31.443179 (Thread-4): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:38:31.443423 (Thread-4): 00:38:31 | 4 of 4 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:38:31.443651 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:38:31.443722 (Thread-4): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:38:31.446084 (Thread-4): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:38:31.463214 (Thread-4): finished collecting timing info
2021-12-06 00:38:31.480181 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:38:31.500367 (Thread-4): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:38:31.500483 (Thread-4): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:38:31.500577 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:38:32.744617 (Thread-145): handling poll request
2021-12-06 00:38:32.744932 (Thread-145): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc677dc0>]}
2021-12-06 00:38:32.745577 (Thread-145): sending response (<Response 7781 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:38:33.614819 (Thread-4): SQL status: SUCCESS 1 in 2.11 seconds
2021-12-06 00:38:33.619453 (Thread-4): finished collecting timing info
2021-12-06 00:38:33.619592 (Thread-4): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:38:34.067766 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8728b72b50>]}
2021-12-06 00:38:34.068145 (Thread-4): 00:38:34 | 4 of 4 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.62s]
2021-12-06 00:38:34.068236 (Thread-4): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:38:34.069958 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:38:34.070284 (MainThread): 00:38:34 | 
2021-12-06 00:38:34.070355 (MainThread): 00:38:34 | Finished running 3 view models, 1 table model in 8.72s.
2021-12-06 00:38:34.070403 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:38:34.070442 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:38:34.070477 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:38:34.070511 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:38:34.070543 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:38:34.130228 (MainThread): 
2021-12-06 00:38:34.130332 (MainThread): Completed successfully
2021-12-06 00:38:34.130395 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-12-06 00:38:34.246993 (Thread-146): handling poll request
2021-12-06 00:38:34.247327 (Thread-146): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc61e4c0>]}
2021-12-06 00:38:34.247963 (Thread-146): sending response (<Response 6190 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:38:35.786840 (Thread-147): handling poll request
2021-12-06 00:38:35.787178 (Thread-147): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc61e460>]}
2021-12-06 00:38:35.790390 (Thread-147): sending response (<Response 11154 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:38:36.795944 (Thread-148): handling status request
2021-12-06 00:38:36.796254 (Thread-148): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6772e0>]}
2021-12-06 00:38:36.796744 (Thread-148): sending response (<Response 1529 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:38:36.864918 (Thread-149): handling status request
2021-12-06 00:38:36.865143 (Thread-149): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63e100>]}
2021-12-06 00:38:36.865537 (Thread-149): sending response (<Response 1529 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:38:39.580076 (Thread-150): handling status request
2021-12-06 00:38:39.580404 (Thread-150): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc690eb0>]}
2021-12-06 00:38:39.580892 (Thread-150): sending response (<Response 1529 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:38:40.021326 (Thread-151): handling run_sql request
2021-12-06 00:38:40.021606 (Thread-151): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfb0370>]}
2021-12-06 00:38:41.947831 (Thread-151): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:38:41.959115 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:38:41.973018 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a135c2b-b0d9-4d46-ae54-c9af045c6877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7b951e1c0>]}
2021-12-06 00:38:41.973256 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:38:41.973616 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:38:41.973717 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:38:41.975702 (Thread-1): finished collecting timing info
2021-12-06 00:38:41.976609 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:38:41.976673 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 00:38:41.976726 (Thread-1): Opening a new connection, currently in state init
2021-12-06 00:38:42.479750 (Thread-152): handling poll request
2021-12-06 00:38:42.480125 (Thread-152): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6f09d0>]}
2021-12-06 00:38:42.481039 (Thread-152): sending response (<Response 3695 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:38:43.826405 (Thread-1): SQL status: SUCCESS 120 in 1.85 seconds
2021-12-06 00:38:43.829695 (Thread-1): finished collecting timing info
2021-12-06 00:38:43.829889 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 00:38:43.997112 (Thread-153): handling poll request
2021-12-06 00:38:43.997405 (Thread-153): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6f0d60>]}
2021-12-06 00:38:43.997957 (Thread-153): sending response (<Response 1341 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:38:45.537154 (Thread-154): handling poll request
2021-12-06 00:38:45.537495 (Thread-154): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6cb790>]}
2021-12-06 00:38:45.538840 (Thread-154): sending response (<Response 6351 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:47:40.071349 (Thread-155): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:47:40.073276 (Thread-155): Partial parsing: updated file: jaffle_shop://models/marts/core/fct_orders.sql
2021-12-06 00:47:40.076941 (Thread-155): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:47:40.121081 (Thread-155): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6089a0>]}
2021-12-06 00:47:41.022869 (Thread-156): handling status request
2021-12-06 00:47:41.023177 (Thread-156): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6086d0>]}
2021-12-06 00:47:41.023671 (Thread-156): sending response (<Response 1531 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:47:41.094912 (Thread-157): handling status request
2021-12-06 00:47:41.095129 (Thread-157): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6087f0>]}
2021-12-06 00:47:41.115967 (Thread-157): sending response (<Response 1531 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:49:31.504703 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:49:31.593905 (Thread-158): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:49:31.594204 (Thread-158): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 00:49:31.597480 (Thread-158): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:49:31.641438 (Thread-158): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc05ea90>]}
2021-12-06 00:49:32.367892 (Thread-159): handling status request
2021-12-06 00:49:32.368212 (Thread-159): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9ca0>]}
2021-12-06 00:49:32.377829 (Thread-159): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.71
2021-12-06 00:49:32.421130 (Thread-160): handling status request
2021-12-06 00:49:32.421328 (Thread-160): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9a30>]}
2021-12-06 00:49:32.421690 (Thread-160): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:49:34.193736 (Thread-161): handling status request
2021-12-06 00:49:34.194107 (Thread-161): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9850>]}
2021-12-06 00:49:34.194632 (Thread-161): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:49:34.522185 (Thread-162): handling status request
2021-12-06 00:49:34.522455 (Thread-162): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9670>]}
2021-12-06 00:49:34.522908 (Thread-162): sending response (<Response 1537 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:49:34.671824 (Thread-163): handling cli_args request
2021-12-06 00:49:34.672037 (Thread-163): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9490>]}
2021-12-06 00:49:34.682581 (Thread-163): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:49:36.589646 (Thread-163): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:49:36.625527 (MainThread): Partial parsing not enabled
2021-12-06 00:49:36.674427 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:49:36.676305 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:49:36.709711 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:49:36.713299 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:49:36.716370 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:49:36.720499 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:49:36.721711 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:49:36.729594 (MainThread): Parsing macros/core.sql
2021-12-06 00:49:36.733040 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:49:36.739148 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:49:36.748456 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:49:36.754943 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:49:36.758548 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:49:36.779620 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:49:36.795417 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:49:36.796926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:49:36.826259 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:49:36.833073 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:49:36.846017 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:49:36.864264 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:49:36.873611 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:49:36.875277 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:49:36.876603 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:49:36.884351 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:49:36.885286 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:49:36.886889 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:49:36.888295 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:49:36.890593 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:49:36.891926 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:49:36.943619 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:49:36.945649 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:49:36.946730 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:49:36.948206 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:49:37.067538 (Thread-164): handling poll request
2021-12-06 00:49:37.067829 (Thread-164): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc61e8e0>]}
2021-12-06 00:49:37.068857 (Thread-164): sending response (<Response 9686 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:49:37.126076 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:49:37.137357 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:49:37.139744 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:49:37.142207 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:49:37.146056 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:49:37.202553 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7800fbb20>]}
2021-12-06 00:49:37.233219 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7800fb970>]}
2021-12-06 00:49:37.233413 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:49:37.234548 (MainThread): 
2021-12-06 00:49:37.234743 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:49:37.235583 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:49:37.246687 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:49:37.246756 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:49:37.246810 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:49:38.517042 (Thread-165): handling poll request
2021-12-06 00:49:38.517373 (Thread-165): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b7730>]}
2021-12-06 00:49:38.518010 (Thread-165): sending response (<Response 4941 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:49:38.770644 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.52 seconds
2021-12-06 00:49:38.772417 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:49:39.214888 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:49:39.221960 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:49:39.222066 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:49:39.222141 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:49:39.975780 (Thread-166): handling poll request
2021-12-06 00:49:39.976088 (Thread-166): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6b6760>]}
2021-12-06 00:49:39.976637 (Thread-166): sending response (<Response 2263 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:49:40.478241 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.26 seconds
2021-12-06 00:49:40.480497 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:49:40.922695 (MainThread): 00:49:40 | Concurrency: 4 threads (target='default')
2021-12-06 00:49:40.922833 (MainThread): 00:49:40 | 
2021-12-06 00:49:40.924795 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:49:40.925077 (Thread-1): 00:49:40 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:49:40.925305 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:49:40.925404 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:49:40.926249 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:49:40.926456 (Thread-2): 00:49:40 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:49:40.926676 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:49:40.926745 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:49:40.927799 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:49:40.928662 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:49:40.928844 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:49:40.929052 (Thread-3): 00:49:40 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:49:40.929275 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:49:40.929341 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:49:40.930406 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:49:40.946010 (Thread-3): finished collecting timing info
2021-12-06 00:49:40.951097 (Thread-1): finished collecting timing info
2021-12-06 00:49:40.981232 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:49:40.981391 (Thread-2): finished collecting timing info
2021-12-06 00:49:40.982984 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:49:40.985393 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:49:40.998747 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:49:40.998831 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:49:40.998891 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:49:41.004628 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:49:41.004712 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:49:41.004768 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:49:41.005783 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:49:41.005857 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:49:41.005912 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:49:41.619522 (Thread-167): handling poll request
2021-12-06 00:49:41.619803 (Thread-167): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6534f0>]}
2021-12-06 00:49:41.620621 (Thread-167): sending response (<Response 14047 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:49:42.676369 (Thread-2): SQL status: SUCCESS 1 in 1.67 seconds
2021-12-06 00:49:42.682866 (Thread-2): finished collecting timing info
2021-12-06 00:49:42.683000 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:49:42.731733 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-12-06 00:49:42.732887 (Thread-1): finished collecting timing info
2021-12-06 00:49:42.732996 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:49:42.845564 (Thread-3): SQL status: SUCCESS 1 in 1.85 seconds
2021-12-06 00:49:42.846660 (Thread-3): finished collecting timing info
2021-12-06 00:49:42.846762 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:49:43.123233 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77aad8e50>]}
2021-12-06 00:49:43.123577 (Thread-2): 00:49:43 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.20s]
2021-12-06 00:49:43.123659 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:49:43.125274 (Thread-168): handling poll request
2021-12-06 00:49:43.125507 (Thread-168): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6bc700>]}
2021-12-06 00:49:43.126092 (Thread-168): sending response (<Response 4835 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:49:43.217854 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77a9fed30>]}
2021-12-06 00:49:43.218161 (Thread-1): 00:49:43 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.29s]
2021-12-06 00:49:43.218241 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:49:43.289120 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77a521d30>]}
2021-12-06 00:49:43.289379 (Thread-3): 00:49:43 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.36s]
2021-12-06 00:49:43.289453 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:49:43.290262 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 00:49:43.290461 (Thread-4): 00:49:43 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 00:49:43.290678 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:49:43.290751 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 00:49:43.292985 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:49:43.304384 (Thread-4): finished collecting timing info
2021-12-06 00:49:43.320518 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:49:43.333114 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:49:43.333194 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 00:49:43.333250 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:49:44.601208 (Thread-169): handling poll request
2021-12-06 00:49:44.601515 (Thread-169): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6bc9a0>]}
2021-12-06 00:49:44.602450 (Thread-169): sending response (<Response 7299 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:49:45.863388 (Thread-4): SQL status: SUCCESS 1 in 2.53 seconds
2021-12-06 00:49:45.868136 (Thread-4): finished collecting timing info
2021-12-06 00:49:45.868294 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 00:49:46.081208 (Thread-170): handling poll request
2021-12-06 00:49:46.081486 (Thread-170): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6bcbb0>]}
2021-12-06 00:49:46.082019 (Thread-170): sending response (<Response 1369 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:49:46.307609 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77aa630d0>]}
2021-12-06 00:49:46.307973 (Thread-4): 00:49:46 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 3.02s]
2021-12-06 00:49:46.308056 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 00:49:46.308889 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:49:46.309138 (Thread-1): 00:49:46 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:49:46.309366 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:49:46.309445 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:49:46.312070 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:49:46.328457 (Thread-1): finished collecting timing info
2021-12-06 00:49:46.330481 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:49:46.348563 (Thread-1): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:49:46.348645 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
)

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:49:46.348705 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:49:47.526637 (Thread-171): handling poll request
2021-12-06 00:49:47.526957 (Thread-171): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc61e520>]}
2021-12-06 00:49:47.527616 (Thread-171): sending response (<Response 6855 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:49:47.627595 (Thread-1): Snowflake query id: 01a0c191-3200-95c3-0000-00008ef91c49
2021-12-06 00:49:47.627728 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 0 unexpected 'customer_orders'.
syntax error line 23 at position 24 unexpected 'as'.
2021-12-06 00:49:47.627848 (Thread-1): finished collecting timing info
2021-12-06 00:49:47.627952 (Thread-1): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:49:48.070330 (Thread-1): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 0 unexpected 'customer_orders'.
  syntax error line 23 at position 24 unexpected 'as'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 18 at position 0 unexpected 'customer_orders'.
syntax error line 23 at position 24 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 0 unexpected 'customer_orders'.
  syntax error line 23 at position 24 unexpected 'as'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:49:48.071206 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7784ecb80>]}
2021-12-06 00:49:48.071537 (Thread-1): 00:49:48 | 5 of 5 ERROR creating table model dbt_pstulnikov.dim_customers....... [ERROR in 1.76s]
2021-12-06 00:49:48.071623 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:49:48.073282 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:49:48.073589 (MainThread): 00:49:48 | 
2021-12-06 00:49:48.073658 (MainThread): 00:49:48 | Finished running 3 view models, 2 table models in 10.84s.
2021-12-06 00:49:48.073706 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:49:48.073745 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:49:48.073783 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:49:48.073818 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:49:48.073851 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:49:48.140544 (MainThread): 
2021-12-06 00:49:48.140646 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 00:49:48.140702 (MainThread): 
2021-12-06 00:49:48.140754 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-12-06 00:49:48.140797 (MainThread):   001003 (42000): SQL compilation error:
2021-12-06 00:49:48.140834 (MainThread):   syntax error line 18 at position 0 unexpected 'customer_orders'.
2021-12-06 00:49:48.140869 (MainThread):   syntax error line 23 at position 24 unexpected 'as'.
2021-12-06 00:49:48.140904 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:49:48.140952 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-12-06 00:49:49.008763 (Thread-172): handling poll request
2021-12-06 00:49:49.009146 (Thread-172): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b9370>]}
2021-12-06 00:49:49.010773 (Thread-172): sending response (<Response 29030 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:49:49.922113 (Thread-173): handling status request
2021-12-06 00:49:49.922425 (Thread-173): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b90a0>]}
2021-12-06 00:49:49.922925 (Thread-173): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:49:49.957366 (Thread-174): handling status request
2021-12-06 00:49:49.957589 (Thread-174): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b9310>]}
2021-12-06 00:49:49.958016 (Thread-174): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:50:36.455243 (Thread-175): handling status request
2021-12-06 00:50:36.455556 (Thread-175): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b33d0>]}
2021-12-06 00:50:36.456005 (Thread-175): sending response (<Response 1537 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:50:36.901921 (Thread-176): handling compile_sql request
2021-12-06 00:50:36.902201 (Thread-176): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b3a90>]}
2021-12-06 00:50:38.831841 (Thread-176): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:50:38.843004 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:50:38.857055 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f664d17e-2273-4959-83bf-629ac0a2a4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c751c40>]}
2021-12-06 00:50:38.857287 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:50:38.857647 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:50:38.857748 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:50:38.860030 (Thread-1): finished collecting timing info
2021-12-06 00:50:38.860254 (Thread-1): finished collecting timing info
2021-12-06 00:50:39.373219 (Thread-177): handling poll request
2021-12-06 00:50:39.373598 (Thread-177): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b3cd0>]}
2021-12-06 00:50:39.375159 (Thread-177): sending response (<Response 9220 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:51:12.891202 (Thread-178): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:51:12.891514 (Thread-178): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 00:51:12.895144 (Thread-178): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:51:12.938024 (Thread-178): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067910>]}
2021-12-06 00:51:13.712159 (Thread-179): handling status request
2021-12-06 00:51:13.712465 (Thread-179): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067580>]}
2021-12-06 00:51:13.712960 (Thread-179): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:51:13.849721 (Thread-180): handling status request
2021-12-06 00:51:13.850097 (Thread-180): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067cd0>]}
2021-12-06 00:51:13.850609 (Thread-180): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:51:15.658170 (Thread-181): handling status request
2021-12-06 00:51:15.658492 (Thread-181): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc0679a0>]}
2021-12-06 00:51:15.658968 (Thread-181): sending response (<Response 1537 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:51:16.028510 (Thread-182): handling status request
2021-12-06 00:51:16.028781 (Thread-182): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc0677f0>]}
2021-12-06 00:51:16.029247 (Thread-182): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:51:16.130701 (Thread-183): handling cli_args request
2021-12-06 00:51:16.130908 (Thread-183): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067eb0>]}
2021-12-06 00:51:16.140894 (Thread-183): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:51:18.067653 (Thread-183): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:51:18.103837 (MainThread): Partial parsing not enabled
2021-12-06 00:51:18.152114 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:51:18.154036 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:51:18.187578 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:51:18.191331 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:51:18.194565 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:51:18.198693 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:51:18.199915 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:51:18.207920 (MainThread): Parsing macros/core.sql
2021-12-06 00:51:18.211400 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:51:18.217538 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:51:18.226828 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:51:18.233345 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:51:18.236928 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:51:18.258168 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:51:18.274090 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:51:18.275603 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:51:18.304754 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:51:18.311621 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:51:18.324565 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:51:18.342940 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:51:18.352241 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:51:18.353873 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:51:18.355235 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:51:18.362979 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:51:18.363919 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:51:18.365517 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:51:18.366953 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:51:18.369232 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:51:18.370612 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:51:18.422429 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:51:18.424453 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:51:18.425514 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:51:18.427003 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:51:18.607055 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:51:18.621236 (Thread-184): handling poll request
2021-12-06 00:51:18.621525 (Thread-184): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ed9790>]}
2021-12-06 00:51:18.622565 (Thread-184): sending response (<Response 9991 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:51:18.618449 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:51:18.620864 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:51:18.623334 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:51:18.627236 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:51:18.681500 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656dbba970>]}
2021-12-06 00:51:18.707923 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656dbbaa90>]}
2021-12-06 00:51:18.708129 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:51:18.709231 (MainThread): 
2021-12-06 00:51:18.709427 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:51:18.710513 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:51:18.722215 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:51:18.722298 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:51:18.722355 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:51:20.170180 (Thread-185): handling poll request
2021-12-06 00:51:20.170494 (Thread-185): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067700>]}
2021-12-06 00:51:20.171096 (Thread-185): sending response (<Response 4636 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:51:20.341441 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.62 seconds
2021-12-06 00:51:20.343314 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:51:20.795371 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:51:20.802584 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:51:20.802683 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:51:20.802748 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:51:21.619816 (Thread-186): handling poll request
2021-12-06 00:51:21.620118 (Thread-186): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5f5e700>]}
2021-12-06 00:51:21.620653 (Thread-186): sending response (<Response 2263 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:51:22.222236 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.42 seconds
2021-12-06 00:51:22.223713 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:51:22.677317 (MainThread): 00:51:22 | Concurrency: 4 threads (target='default')
2021-12-06 00:51:22.677457 (MainThread): 00:51:22 | 
2021-12-06 00:51:22.679534 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:51:22.679847 (Thread-1): 00:51:22 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:51:22.680079 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:51:22.680202 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:51:22.681027 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:51:22.681251 (Thread-2): 00:51:22 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:51:22.681478 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:51:22.681546 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:51:22.682691 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:51:22.683014 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:51:22.683225 (Thread-3): 00:51:22 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:51:22.683439 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:51:22.683507 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:51:22.684454 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:51:22.685360 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:51:22.699623 (Thread-1): finished collecting timing info
2021-12-06 00:51:22.704980 (Thread-2): finished collecting timing info
2021-12-06 00:51:22.720240 (Thread-3): finished collecting timing info
2021-12-06 00:51:22.735342 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:51:22.737023 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:51:22.740665 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:51:22.759517 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:51:22.759602 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:51:22.759662 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:51:22.760755 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:51:22.760826 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:51:22.760881 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:51:22.761459 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:51:22.761539 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:51:22.761594 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:51:23.100294 (Thread-187): handling poll request
2021-12-06 00:51:23.100569 (Thread-187): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecf760>]}
2021-12-06 00:51:23.122990 (Thread-187): sending response (<Response 14047 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:51:24.396552 (Thread-2): SQL status: SUCCESS 1 in 1.64 seconds
2021-12-06 00:51:24.402866 (Thread-2): finished collecting timing info
2021-12-06 00:51:24.402997 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:51:24.415661 (Thread-3): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-06 00:51:24.416704 (Thread-3): finished collecting timing info
2021-12-06 00:51:24.416806 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:51:24.475948 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-12-06 00:51:24.476989 (Thread-1): finished collecting timing info
2021-12-06 00:51:24.477089 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:51:24.641830 (Thread-188): handling poll request
2021-12-06 00:51:24.642147 (Thread-188): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecf190>]}
2021-12-06 00:51:24.642709 (Thread-188): sending response (<Response 3556 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:51:24.842491 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656cc99730>]}
2021-12-06 00:51:24.842911 (Thread-2): 00:51:24 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.16s]
2021-12-06 00:51:24.843005 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:51:24.871537 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656dc3c7f0>]}
2021-12-06 00:51:24.871827 (Thread-3): 00:51:24 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.19s]
2021-12-06 00:51:24.871908 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:51:24.872539 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 00:51:24.872777 (Thread-4): 00:51:24 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 00:51:24.873017 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:51:24.873094 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 00:51:24.875479 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:51:24.891011 (Thread-4): finished collecting timing info
2021-12-06 00:51:24.907510 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:51:24.924104 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:51:24.924185 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 00:51:24.924244 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:51:24.983647 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656cca55e0>]}
2021-12-06 00:51:24.983914 (Thread-1): 00:51:24 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.30s]
2021-12-06 00:51:24.983985 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:51:26.128682 (Thread-189): handling poll request
2021-12-06 00:51:26.128987 (Thread-189): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e74820>]}
2021-12-06 00:51:26.129633 (Thread-189): sending response (<Response 8577 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:51:26.944288 (Thread-4): SQL status: SUCCESS 1 in 2.02 seconds
2021-12-06 00:51:26.948896 (Thread-4): finished collecting timing info
2021-12-06 00:51:26.949029 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 00:51:27.418289 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c8201c0>]}
2021-12-06 00:51:27.418655 (Thread-4): 00:51:27 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.55s]
2021-12-06 00:51:27.418739 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 00:51:27.419624 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:51:27.419874 (Thread-3): 00:51:27 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:51:27.420083 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:51:27.420158 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:51:27.422778 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:51:27.437487 (Thread-3): finished collecting timing info
2021-12-06 00:51:27.439412 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:51:27.455200 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:51:27.455277 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:51:27.455334 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 00:51:27.578715 (Thread-190): handling poll request
2021-12-06 00:51:27.578935 (Thread-190): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e800a0>]}
2021-12-06 00:51:27.579554 (Thread-190): sending response (<Response 7940 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:51:28.711474 (Thread-3): Snowflake query id: 01a0c193-3200-95c4-0000-00008ef92b49
2021-12-06 00:51:28.711616 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 63 at position 0 unexpected 'select'.
2021-12-06 00:51:28.711750 (Thread-3): finished collecting timing info
2021-12-06 00:51:28.711857 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:51:29.044751 (Thread-191): handling poll request
2021-12-06 00:51:29.045057 (Thread-191): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e80400>]}
2021-12-06 00:51:29.045571 (Thread-191): sending response (<Response 1923 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:51:29.157706 (Thread-3): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 63 at position 0 unexpected 'select'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 63 at position 0 unexpected 'select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 63 at position 0 unexpected 'select'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:51:29.158526 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655d761c70>]}
2021-12-06 00:51:29.158830 (Thread-3): 00:51:29 | 5 of 5 ERROR creating table model dbt_pstulnikov.dim_customers....... [ERROR in 1.74s]
2021-12-06 00:51:29.158911 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:51:29.160634 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:51:29.160923 (MainThread): 00:51:29 | 
2021-12-06 00:51:29.160989 (MainThread): 00:51:29 | Finished running 3 view models, 2 table models in 10.45s.
2021-12-06 00:51:29.161037 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:51:29.161077 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:51:29.161112 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:51:29.161146 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:51:29.161178 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:51:29.226972 (MainThread): 
2021-12-06 00:51:29.227072 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 00:51:29.227126 (MainThread): 
2021-12-06 00:51:29.227179 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-12-06 00:51:29.227222 (MainThread):   001003 (42000): SQL compilation error:
2021-12-06 00:51:29.227259 (MainThread):   syntax error line 55 at position 8 unexpected 'customer_payments'.
2021-12-06 00:51:29.227295 (MainThread):   syntax error line 59 at position 37 unexpected 'customer_id'.
2021-12-06 00:51:29.227331 (MainThread):   syntax error line 63 at position 0 unexpected 'select'.
2021-12-06 00:51:29.227365 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:51:29.227413 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-12-06 00:51:30.521609 (Thread-192): handling poll request
2021-12-06 00:51:30.521920 (Thread-192): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e74340>]}
2021-12-06 00:51:30.523297 (Thread-192): sending response (<Response 28251 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:51:31.456554 (Thread-193): handling status request
2021-12-06 00:51:31.456862 (Thread-193): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e807f0>]}
2021-12-06 00:51:31.457384 (Thread-193): sending response (<Response 1537 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:51:32.332838 (Thread-194): handling status request
2021-12-06 00:51:32.333152 (Thread-194): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e80250>]}
2021-12-06 00:51:32.333639 (Thread-194): sending response (<Response 1537 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:52:16.320204 (Thread-195): handling status request
2021-12-06 00:52:16.320522 (Thread-195): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e90340>]}
2021-12-06 00:52:16.320995 (Thread-195): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:52:16.820407 (Thread-196): handling compile_sql request
2021-12-06 00:52:16.820724 (Thread-196): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e905b0>]}
2021-12-06 00:52:18.791682 (Thread-196): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:52:18.803071 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:52:18.817427 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8157a2f-f980-4e31-90a9-5fbedfe0a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201ac9d1c0>]}
2021-12-06 00:52:18.817669 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:52:18.818039 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:52:18.818142 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:52:18.820395 (Thread-1): finished collecting timing info
2021-12-06 00:52:18.820618 (Thread-1): finished collecting timing info
2021-12-06 00:52:19.502672 (Thread-197): handling poll request
2021-12-06 00:52:19.503027 (Thread-197): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e94730>]}
2021-12-06 00:52:19.504195 (Thread-197): sending response (<Response 9224 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:53:21.919531 (Thread-198): handling status request
2021-12-06 00:53:21.919872 (Thread-198): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e94820>]}
2021-12-06 00:53:21.920397 (Thread-198): sending response (<Response 1537 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:53:22.316447 (Thread-199): handling status request
2021-12-06 00:53:22.316661 (Thread-199): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e94b50>]}
2021-12-06 00:53:22.317044 (Thread-199): sending response (<Response 1537 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:53:22.365912 (Thread-200): handling cli_args request
2021-12-06 00:53:22.366147 (Thread-200): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e94d60>]}
2021-12-06 00:53:24.297601 (Thread-200): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:53:24.333660 (MainThread): Partial parsing not enabled
2021-12-06 00:53:24.392826 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:53:24.394773 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:53:24.428765 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:53:24.432346 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:53:24.435436 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:53:24.439582 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:53:24.440821 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:53:24.448765 (MainThread): Parsing macros/core.sql
2021-12-06 00:53:24.452250 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:53:24.458427 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:53:24.467741 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:53:24.474307 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:53:24.477874 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:53:24.498999 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:53:24.514969 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:53:24.516492 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:53:24.545507 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:53:24.552387 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:53:24.565337 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:53:24.583813 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:53:24.593251 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:53:24.594945 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:53:24.596301 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:53:24.604200 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:53:24.605147 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:53:24.606775 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:53:24.608206 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:53:24.610551 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:53:24.611906 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:53:24.663926 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:53:24.665992 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:53:24.667067 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:53:24.668554 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:53:24.736968 (Thread-201): handling poll request
2021-12-06 00:53:24.737252 (Thread-201): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecd160>]}
2021-12-06 00:53:24.738583 (Thread-201): sending response (<Response 9686 bytes [200 OK]>) to 10.0.6.71
2021-12-06 00:53:24.849464 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:24.860863 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:24.863238 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:24.865663 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:24.869554 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:24.924878 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277bf79490>]}
2021-12-06 00:53:24.952796 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277bf79a90>]}
2021-12-06 00:53:24.952987 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:53:24.954100 (MainThread): 
2021-12-06 00:53:24.954293 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:53:24.955134 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:53:24.966764 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:53:24.966836 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:53:24.966892 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:53:26.265312 (Thread-202): handling poll request
2021-12-06 00:53:26.265635 (Thread-202): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ed9760>]}
2021-12-06 00:53:26.266342 (Thread-202): sending response (<Response 4941 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:53:26.500637 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.53 seconds
2021-12-06 00:53:26.502469 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:53:26.956280 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:53:26.963389 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:53:26.963491 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:53:26.963556 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:53:27.697769 (Thread-203): handling poll request
2021-12-06 00:53:27.698115 (Thread-203): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5edb6a0>]}
2021-12-06 00:53:27.698658 (Thread-203): sending response (<Response 2263 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:53:28.220671 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.26 seconds
2021-12-06 00:53:28.222143 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:53:28.672292 (MainThread): 00:53:28 | Concurrency: 4 threads (target='default')
2021-12-06 00:53:28.672433 (MainThread): 00:53:28 | 
2021-12-06 00:53:28.674452 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:53:28.674734 (Thread-1): 00:53:28 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:53:28.674959 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:28.675058 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:53:28.675876 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:53:28.676092 (Thread-2): 00:53:28 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:53:28.676311 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:28.676378 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:53:28.677568 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:53:28.678462 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:53:28.678637 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:53:28.678838 (Thread-3): 00:53:28 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:53:28.679050 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:28.679114 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:53:28.680168 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:53:28.705171 (Thread-2): finished collecting timing info
2021-12-06 00:53:28.710302 (Thread-3): finished collecting timing info
2021-12-06 00:53:28.735635 (Thread-1): finished collecting timing info
2021-12-06 00:53:28.740318 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:53:28.741660 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:53:28.745209 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:53:28.762041 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:28.762127 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:53:28.762186 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:53:28.763302 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:28.763376 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:53:28.763429 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:53:28.767156 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:28.767238 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:53:28.767291 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:53:29.171294 (Thread-204): handling poll request
2021-12-06 00:53:29.171601 (Thread-204): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ea0040>]}
2021-12-06 00:53:29.172468 (Thread-204): sending response (<Response 14047 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:53:30.571623 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-06 00:53:30.578297 (Thread-2): finished collecting timing info
2021-12-06 00:53:30.578438 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:53:30.612089 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-12-06 00:53:30.613166 (Thread-1): finished collecting timing info
2021-12-06 00:53:30.613268 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:53:30.638590 (Thread-205): handling poll request
2021-12-06 00:53:30.638841 (Thread-205): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ea0e50>]}
2021-12-06 00:53:30.639369 (Thread-205): sending response (<Response 2464 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:53:30.666968 (Thread-3): SQL status: SUCCESS 1 in 1.90 seconds
2021-12-06 00:53:30.667992 (Thread-3): finished collecting timing info
2021-12-06 00:53:30.668090 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:53:31.022668 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b0679a0>]}
2021-12-06 00:53:31.023003 (Thread-2): 00:53:31 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.35s]
2021-12-06 00:53:31.023083 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:53:31.054973 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b0bea00>]}
2021-12-06 00:53:31.055250 (Thread-1): 00:53:31 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.38s]
2021-12-06 00:53:31.055321 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:53:31.131952 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277bf9a790>]}
2021-12-06 00:53:31.132223 (Thread-3): 00:53:31 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.45s]
2021-12-06 00:53:31.132295 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:53:31.132994 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 00:53:31.133219 (Thread-4): 00:53:31 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 00:53:31.133443 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:31.133516 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 00:53:31.135724 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:53:31.154356 (Thread-4): finished collecting timing info
2021-12-06 00:53:31.170411 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:53:31.194199 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:31.194281 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 00:53:31.194339 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:53:32.074298 (Thread-206): handling poll request
2021-12-06 00:53:32.074622 (Thread-206): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ec9c10>]}
2021-12-06 00:53:32.075348 (Thread-206): sending response (<Response 9670 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:53:33.329592 (Thread-4): SQL status: SUCCESS 1 in 2.14 seconds
2021-12-06 00:53:33.334280 (Thread-4): finished collecting timing info
2021-12-06 00:53:33.334417 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 00:53:33.510279 (Thread-207): handling poll request
2021-12-06 00:53:33.510615 (Thread-207): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ec9790>]}
2021-12-06 00:53:33.511154 (Thread-207): sending response (<Response 1369 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:53:33.776248 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b0bed90>]}
2021-12-06 00:53:33.776576 (Thread-4): 00:53:33 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.64s]
2021-12-06 00:53:33.776659 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 00:53:33.777510 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:53:33.777772 (Thread-1): 00:53:33 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:53:33.778012 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:33.778091 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:53:33.780637 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:53:33.796934 (Thread-1): finished collecting timing info
2021-12-06 00:53:33.798909 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:53:33.815388 (Thread-1): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:33.815468 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:53:33.815526 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:53:34.985000 (Thread-208): handling poll request
2021-12-06 00:53:34.985320 (Thread-208): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ec9ac0>]}
2021-12-06 00:53:34.986029 (Thread-208): sending response (<Response 6856 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:53:35.090015 (Thread-1): Snowflake query id: 01a0c195-3200-95c3-0000-00008ef91c65
2021-12-06 00:53:35.090145 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 63 at position 0 unexpected 'select'.
2021-12-06 00:53:35.090264 (Thread-1): finished collecting timing info
2021-12-06 00:53:35.090367 (Thread-1): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:53:35.542778 (Thread-1): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 63 at position 0 unexpected 'select'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 63 at position 0 unexpected 'select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 63 at position 0 unexpected 'select'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:53:35.543606 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b0c02b0>]}
2021-12-06 00:53:35.543941 (Thread-1): 00:53:35 | 5 of 5 ERROR creating table model dbt_pstulnikov.dim_customers....... [ERROR in 1.77s]
2021-12-06 00:53:35.544020 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:53:35.545621 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:53:35.545919 (MainThread): 00:53:35 | 
2021-12-06 00:53:35.546016 (MainThread): 00:53:35 | Finished running 3 view models, 2 table models in 10.59s.
2021-12-06 00:53:35.546066 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:53:35.546108 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:53:35.546143 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:53:35.546177 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:53:35.546210 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:53:35.599008 (MainThread): 
2021-12-06 00:53:35.599113 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 00:53:35.599167 (MainThread): 
2021-12-06 00:53:35.599219 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-12-06 00:53:35.599260 (MainThread):   001003 (42000): SQL compilation error:
2021-12-06 00:53:35.599297 (MainThread):   syntax error line 55 at position 8 unexpected 'customer_payments'.
2021-12-06 00:53:35.599332 (MainThread):   syntax error line 59 at position 37 unexpected 'customer_id'.
2021-12-06 00:53:35.599366 (MainThread):   syntax error line 63 at position 0 unexpected 'select'.
2021-12-06 00:53:35.599400 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:53:35.599447 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-12-06 00:53:36.464314 (Thread-209): handling poll request
2021-12-06 00:53:36.464656 (Thread-209): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ec9e20>]}
2021-12-06 00:53:36.466046 (Thread-209): sending response (<Response 29888 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:53:37.393868 (Thread-210): handling status request
2021-12-06 00:53:37.394235 (Thread-210): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecd370>]}
2021-12-06 00:53:37.394743 (Thread-210): sending response (<Response 1537 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:53:37.526190 (Thread-211): handling status request
2021-12-06 00:53:37.526487 (Thread-211): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecd3a0>]}
2021-12-06 00:53:37.526941 (Thread-211): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:53:45.524375 (Thread-212): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:53:45.524740 (Thread-212): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 00:53:45.528460 (Thread-212): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:45.573799 (Thread-212): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e4b1c0>]}
2021-12-06 00:53:46.317526 (Thread-213): handling status request
2021-12-06 00:53:46.317831 (Thread-213): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e4b370>]}
2021-12-06 00:53:46.318344 (Thread-213): sending response (<Response 1537 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:53:46.347193 (Thread-214): handling status request
2021-12-06 00:53:46.347408 (Thread-214): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e67340>]}
2021-12-06 00:53:46.347788 (Thread-214): sending response (<Response 1537 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:53:48.553689 (Thread-215): handling status request
2021-12-06 00:53:48.554036 (Thread-215): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e67700>]}
2021-12-06 00:53:48.554513 (Thread-215): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:53:48.916481 (Thread-216): handling status request
2021-12-06 00:53:48.916726 (Thread-216): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e671f0>]}
2021-12-06 00:53:48.917170 (Thread-216): sending response (<Response 1537 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:53:48.999068 (Thread-217): handling cli_args request
2021-12-06 00:53:48.999284 (Thread-217): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e67e50>]}
2021-12-06 00:53:49.030612 (Thread-217): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:53:51.005893 (Thread-217): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:53:51.042014 (MainThread): Partial parsing not enabled
2021-12-06 00:53:51.091909 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:53:51.093839 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:53:51.127606 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:53:51.131225 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:53:51.134322 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:53:51.138423 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:53:51.139632 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:53:51.147573 (MainThread): Parsing macros/core.sql
2021-12-06 00:53:51.151042 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:53:51.157165 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:53:51.166455 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:53:51.173063 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:53:51.176662 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:53:51.198242 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:53:51.214481 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:53:51.215994 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:53:51.245259 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:53:51.252294 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:53:51.265296 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:53:51.283675 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:53:51.293048 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:53:51.294713 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:53:51.296040 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:53:51.303848 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:53:51.304782 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:53:51.306401 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:53:51.307808 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:53:51.310119 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:53:51.311460 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:53:51.363365 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:53:51.365385 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:53:51.366485 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:53:51.367970 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:53:51.455014 (Thread-218): handling poll request
2021-12-06 00:53:51.455324 (Thread-218): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e67b50>]}
2021-12-06 00:53:51.456345 (Thread-218): sending response (<Response 9686 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:53:51.550647 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:51.561992 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:51.564345 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:51.566791 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:51.570687 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:51.629639 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce491f87f0>]}
2021-12-06 00:53:51.657048 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce491f8730>]}
2021-12-06 00:53:51.657239 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:53:51.658378 (MainThread): 
2021-12-06 00:53:51.658569 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:53:51.659417 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:53:51.670729 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:53:51.670799 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:53:51.670852 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:53:52.942395 (Thread-219): handling poll request
2021-12-06 00:53:52.942708 (Thread-219): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e41280>]}
2021-12-06 00:53:52.943322 (Thread-219): sending response (<Response 4941 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:53:53.178105 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.51 seconds
2021-12-06 00:53:53.179903 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:53:53.626064 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:53:53.632880 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:53:53.632971 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:53:53.633033 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:53:54.441613 (Thread-220): handling poll request
2021-12-06 00:53:54.441953 (Thread-220): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e41e20>]}
2021-12-06 00:53:54.442493 (Thread-220): sending response (<Response 2263 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:53:55.061662 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.43 seconds
2021-12-06 00:53:55.063170 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:53:55.503378 (MainThread): 00:53:55 | Concurrency: 4 threads (target='default')
2021-12-06 00:53:55.503522 (MainThread): 00:53:55 | 
2021-12-06 00:53:55.505509 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:53:55.505803 (Thread-1): 00:53:55 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:53:55.506078 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:55.506183 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:53:55.507037 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:53:55.507264 (Thread-2): 00:53:55 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:53:55.507499 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:55.507568 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:53:55.508637 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:53:55.509504 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:53:55.509684 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:53:55.509893 (Thread-3): 00:53:55 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:53:55.510141 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:55.510207 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:53:55.511250 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:53:55.529745 (Thread-3): finished collecting timing info
2021-12-06 00:53:55.534819 (Thread-2): finished collecting timing info
2021-12-06 00:53:55.539896 (Thread-1): finished collecting timing info
2021-12-06 00:53:55.565057 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:53:55.568536 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:53:55.572358 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:53:55.584993 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:55.585069 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:53:55.585126 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:53:55.588827 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:55.588911 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:53:55.588965 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:53:55.589889 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:55.589988 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:53:55.590043 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:53:55.962475 (Thread-221): handling poll request
2021-12-06 00:53:55.962815 (Thread-221): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5dd9250>]}
2021-12-06 00:53:55.963666 (Thread-221): sending response (<Response 14047 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:53:57.211747 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2021-12-06 00:53:57.218075 (Thread-1): finished collecting timing info
2021-12-06 00:53:57.218201 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:53:57.246356 (Thread-3): SQL status: SUCCESS 1 in 1.66 seconds
2021-12-06 00:53:57.247428 (Thread-3): finished collecting timing info
2021-12-06 00:53:57.247529 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:53:57.277396 (Thread-2): SQL status: SUCCESS 1 in 1.69 seconds
2021-12-06 00:53:57.278450 (Thread-2): finished collecting timing info
2021-12-06 00:53:57.278566 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:53:57.486630 (Thread-222): handling poll request
2021-12-06 00:53:57.486893 (Thread-222): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d89340>]}
2021-12-06 00:53:57.487438 (Thread-222): sending response (<Response 3556 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:53:57.678836 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4837bd00>]}
2021-12-06 00:53:57.679235 (Thread-1): 00:53:57 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.17s]
2021-12-06 00:53:57.679323 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:53:57.699236 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce48070280>]}
2021-12-06 00:53:57.699522 (Thread-3): 00:53:57 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.19s]
2021-12-06 00:53:57.699595 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:53:57.726955 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce48066610>]}
2021-12-06 00:53:57.727210 (Thread-2): 00:53:57 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.22s]
2021-12-06 00:53:57.727280 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:53:57.728074 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 00:53:57.728374 (Thread-4): 00:53:57 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 00:53:57.728697 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:57.728810 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 00:53:57.732439 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:53:57.748220 (Thread-4): finished collecting timing info
2021-12-06 00:53:57.764707 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:53:57.781381 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:57.781459 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 00:53:57.781516 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:53:58.962836 (Thread-223): handling poll request
2021-12-06 00:53:58.963145 (Thread-223): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d89c70>]}
2021-12-06 00:53:58.963805 (Thread-223): sending response (<Response 8578 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:53:59.784255 (Thread-4): SQL status: SUCCESS 1 in 2.00 seconds
2021-12-06 00:53:59.788857 (Thread-4): finished collecting timing info
2021-12-06 00:53:59.789001 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 00:54:00.244074 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4841c9a0>]}
2021-12-06 00:54:00.244450 (Thread-4): 00:54:00 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.52s]
2021-12-06 00:54:00.244536 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 00:54:00.245386 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:54:00.245705 (Thread-3): 00:54:00 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:54:00.246050 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:54:00.246172 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:54:00.249217 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:54:00.263708 (Thread-3): finished collecting timing info
2021-12-06 00:54:00.265682 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:54:00.282175 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:54:00.282253 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
      );
2021-12-06 00:54:00.282310 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 00:54:00.415606 (Thread-224): handling poll request
2021-12-06 00:54:00.415847 (Thread-224): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d944c0>]}
2021-12-06 00:54:00.416508 (Thread-224): sending response (<Response 7993 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:54:01.544394 (Thread-3): Snowflake query id: 01a0c196-3200-95c3-0000-00008ef91c79
2021-12-06 00:54:01.544529 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 60 at position 4 unexpected 'left'.
2021-12-06 00:54:01.544651 (Thread-3): finished collecting timing info
2021-12-06 00:54:01.544752 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:54:01.861440 (Thread-225): handling poll request
2021-12-06 00:54:01.861739 (Thread-225): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d94820>]}
2021-12-06 00:54:01.862454 (Thread-225): sending response (<Response 1921 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:54:01.998827 (Thread-3): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 60 at position 4 unexpected 'left'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 60 at position 4 unexpected 'left'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 60 at position 4 unexpected 'left'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:54:01.999675 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4841c9a0>]}
2021-12-06 00:54:02.000030 (Thread-3): 00:54:01 | 5 of 5 ERROR creating table model dbt_pstulnikov.dim_customers....... [ERROR in 1.75s]
2021-12-06 00:54:02.000113 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:54:02.001734 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:54:02.002066 (MainThread): 00:54:01 | 
2021-12-06 00:54:02.002141 (MainThread): 00:54:01 | Finished running 3 view models, 2 table models in 10.34s.
2021-12-06 00:54:02.002190 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:54:02.002228 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:54:02.002266 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:54:02.002299 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:54:02.002331 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:54:02.073229 (MainThread): 
2021-12-06 00:54:02.073360 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 00:54:02.073423 (MainThread): 
2021-12-06 00:54:02.073478 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-12-06 00:54:02.073527 (MainThread):   001003 (42000): SQL compilation error:
2021-12-06 00:54:02.073564 (MainThread):   syntax error line 55 at position 8 unexpected 'customer_payments'.
2021-12-06 00:54:02.073608 (MainThread):   syntax error line 59 at position 37 unexpected 'customer_id'.
2021-12-06 00:54:02.073643 (MainThread):   syntax error line 60 at position 4 unexpected 'left'.
2021-12-06 00:54:02.073686 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:54:02.073741 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-12-06 00:54:03.302099 (Thread-226): handling poll request
2021-12-06 00:54:03.302474 (Thread-226): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d89a30>]}
2021-12-06 00:54:03.303888 (Thread-226): sending response (<Response 28346 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:54:04.210022 (Thread-227): handling status request
2021-12-06 00:54:04.210332 (Thread-227): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d98310>]}
2021-12-06 00:54:04.210830 (Thread-227): sending response (<Response 1537 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:54:04.227577 (Thread-228): handling status request
2021-12-06 00:54:04.227781 (Thread-228): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d986d0>]}
2021-12-06 00:54:04.228170 (Thread-228): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:59:27.841288 (Thread-229): handling status request
2021-12-06 00:59:27.842104 (Thread-230): handling status request
2021-12-06 00:59:27.843361 (Thread-229): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d988b0>]}
2021-12-06 00:59:27.843629 (Thread-230): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5da3070>]}
2021-12-06 00:59:27.844132 (Thread-229): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:27.844605 (Thread-230): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:27.852487 (Thread-231): handling list request
2021-12-06 00:59:27.852677 (Thread-231): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d98f70>]}
2021-12-06 00:59:27.902478 (Thread-231): sending response (<Response 214 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:27.903772 (Thread-232): sending response (<Response 214 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:28.261563 (Thread-233): handling status request
2021-12-06 00:59:28.261799 (Thread-233): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0f650fbd-11eb-4a91-9a7f-f70cd94e865f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5da5880>]}
2021-12-06 00:59:28.262243 (Thread-233): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:28.267567 (Thread-234): handling list request
2021-12-06 00:59:28.267767 (Thread-234): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0f650fbd-11eb-4a91-9a7f-f70cd94e865f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5dad9a0>]}
2021-12-06 00:59:28.297827 (Thread-234): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '331f19dc-7a13-47df-9998-a9b32d646307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d983a0>]}
2021-12-06 00:59:28.298074 (Thread-234): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:59:28.299602 (Thread-234): sending response (<Response 1757 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:29.279088 (Thread-235): handling status request
2021-12-06 00:59:29.279419 (Thread-235): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '331f19dc-7a13-47df-9998-a9b32d646307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5545100>]}
2021-12-06 00:59:29.279916 (Thread-235): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:29.285062 (Thread-236): handling list request
2021-12-06 00:59:29.285259 (Thread-236): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '331f19dc-7a13-47df-9998-a9b32d646307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5545c40>]}
2021-12-06 00:59:29.347463 (Thread-236): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d98130>]}
2021-12-06 00:59:29.347719 (Thread-236): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:59:29.350121 (Thread-236): sending response (<Response 3976 bytes [200 OK]>) to 10.0.26.110
2021-12-06 01:00:28.199306 (Thread-237): handling status request
2021-12-06 01:00:28.199616 (Thread-237): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5545f70>]}
2021-12-06 01:00:28.200110 (Thread-237): sending response (<Response 1537 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:00:28.643731 (Thread-238): handling compile_sql request
2021-12-06 01:00:28.644024 (Thread-238): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a55458e0>]}
2021-12-06 01:00:30.555412 (Thread-238): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:00:30.566571 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:30.583585 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af33b9d1-8957-44ee-a113-cad0ee402a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c53dcfa0>]}
2021-12-06 01:00:30.583816 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:00:30.584175 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:30.584279 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:00:30.586575 (Thread-1): finished collecting timing info
2021-12-06 01:00:30.586797 (Thread-1): finished collecting timing info
2021-12-06 01:00:31.018753 (Thread-239): handling poll request
2021-12-06 01:00:31.019118 (Thread-239): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d15910>]}
2021-12-06 01:00:31.020250 (Thread-239): sending response (<Response 9436 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:00:47.880878 (Thread-240): handling status request
2021-12-06 01:00:47.881215 (Thread-240): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d15a00>]}
2021-12-06 01:00:47.881760 (Thread-240): sending response (<Response 1537 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:00:48.330198 (Thread-241): handling run_sql request
2021-12-06 01:00:48.330490 (Thread-241): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d15d30>]}
2021-12-06 01:00:50.259766 (Thread-241): sending response (<Response 138 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:00:50.270985 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:50.284755 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c133fa1-69cf-41a9-803a-9ab8fbdbd5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe354f131c0>]}
2021-12-06 01:00:50.284999 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:00:50.285396 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:50.285532 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:00:50.287606 (Thread-1): finished collecting timing info
2021-12-06 01:00:50.288548 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:50.288619 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:00:50.288686 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:00:50.803852 (Thread-242): handling poll request
2021-12-06 01:00:50.804193 (Thread-242): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d1fd00>]}
2021-12-06 01:00:50.805022 (Thread-242): sending response (<Response 3695 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:00:52.175679 (Thread-1): SQL status: SUCCESS 120 in 1.89 seconds
2021-12-06 01:00:52.178915 (Thread-1): finished collecting timing info
2021-12-06 01:00:52.179100 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:00:52.282189 (Thread-243): handling poll request
2021-12-06 01:00:52.282442 (Thread-243): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d27040>]}
2021-12-06 01:00:52.306041 (Thread-243): sending response (<Response 1341 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:00:53.849159 (Thread-244): handling poll request
2021-12-06 01:00:53.849466 (Thread-244): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44b6490>]}
2021-12-06 01:00:53.850689 (Thread-244): sending response (<Response 6350 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:00:58.957670 (Thread-245): handling status request
2021-12-06 01:00:58.958002 (Thread-245): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44b6580>]}
2021-12-06 01:00:58.958502 (Thread-245): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:00:59.435271 (Thread-246): handling run_sql request
2021-12-06 01:00:59.435564 (Thread-246): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44b68b0>]}
2021-12-06 01:01:01.390206 (Thread-246): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:01:01.401070 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:01.414769 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00776b3f-8a40-4707-baf5-8fb3df9bd317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67777eca0>]}
2021-12-06 01:01:01.415035 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:01:01.415494 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:01.415601 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:01:01.416609 (Thread-1): finished collecting timing info
2021-12-06 01:01:01.417222 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:01.417284 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:01:01.417340 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:01:01.864455 (Thread-247): handling poll request
2021-12-06 01:01:01.864790 (Thread-247): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d26880>]}
2021-12-06 01:01:01.865607 (Thread-247): sending response (<Response 3486 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:01:02.864121 (Thread-1): SQL status: SUCCESS 120 in 1.45 seconds
2021-12-06 01:01:02.868549 (Thread-1): finished collecting timing info
2021-12-06 01:01:02.868743 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:01:03.328952 (Thread-248): handling poll request
2021-12-06 01:01:03.329245 (Thread-248): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c96a0>]}
2021-12-06 01:01:03.329768 (Thread-248): sending response (<Response 1347 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:01:04.794528 (Thread-249): handling poll request
2021-12-06 01:01:04.794828 (Thread-249): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c9640>]}
2021-12-06 01:01:04.795873 (Thread-249): sending response (<Response 4729 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:01:14.490934 (Thread-250): handling status request
2021-12-06 01:01:14.491235 (Thread-250): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c9850>]}
2021-12-06 01:01:14.491744 (Thread-250): sending response (<Response 1537 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:01:14.924428 (Thread-251): handling run_sql request
2021-12-06 01:01:14.924726 (Thread-251): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c9b50>]}
2021-12-06 01:01:16.841109 (Thread-251): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:01:16.852300 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:16.866403 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eef27197-f2b8-406a-badd-c89055e95190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0d51cc10>]}
2021-12-06 01:01:16.866636 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:01:16.867010 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:16.867112 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:01:16.869481 (Thread-1): finished collecting timing info
2021-12-06 01:01:16.871110 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:16.871178 (Thread-1): On rpc.jaffle_shop.request: with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:01:16.871231 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:01:17.313295 (Thread-252): handling poll request
2021-12-06 01:01:17.313608 (Thread-252): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c9400>]}
2021-12-06 01:01:17.314440 (Thread-252): sending response (<Response 4505 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:01:18.339980 (Thread-1): Snowflake query id: 01a0c19d-3200-95c4-0000-00008ef92b6d
2021-12-06 01:01:18.340179 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 8 unexpected 'customer_payments'.
syntax error line 58 at position 37 unexpected 'customer_id'.
syntax error line 59 at position 4 unexpected 'left'.
2021-12-06 01:01:18.340316 (Thread-1): finished collecting timing info
2021-12-06 01:01:18.340478 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:01:18.783710 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 8 unexpected 'customer_payments'.
  syntax error line 58 at position 37 unexpected 'customer_id'.
  syntax error line 59 at position 4 unexpected 'left'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 54 at position 8 unexpected 'customer_payments'.
syntax error line 58 at position 37 unexpected 'customer_id'.
syntax error line 59 at position 4 unexpected 'left'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 8 unexpected 'customer_payments'.
  syntax error line 58 at position 37 unexpected 'customer_id'.
  syntax error line 59 at position 4 unexpected 'left'.
2021-12-06 01:01:18.784664 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 54 at position 8 unexpected 'customer_payments'.\n  syntax error line 58 at position 37 unexpected 'customer_id'.\n  syntax error line 59 at position 4 unexpected 'left'.", 'raw_sql': "with customers as (\n    select * from {{ ref('stg_customers')}}\n),\n\norders as (\n    select * from {{ ref('stg_orders')}}\n),\n\npayments as (\n    select\n        customer_id,\n        amount\n    \n    from {{ ref('fct_orders')}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        customer_id,\n\n        sum(amount) as lifetime_value\n\n    from payments\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        customer_payments.lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n    select * from analytics.dbt_pstulnikov.stg_customers\n),\n\norders as (\n    select * from analytics.dbt_pstulnikov.stg_orders\n),\n\npayments as (\n    select\n        customer_id,\n        amount\n    \n    from analytics.dbt_pstulnikov.fct_orders\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        customer_id,\n\n        sum(amount) as lifetime_value\n\n    from payments\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        customer_payments.lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 54 at position 8 unexpected 'customer_payments'.\n  syntax error line 58 at position 37 unexpected 'customer_id'.\n  syntax error line 59 at position 4 unexpected 'left'.", 'raw_sql': "with customers as (\n    select * from {{ ref('stg_customers')}}\n),\n\norders as (\n    select * from {{ ref('stg_orders')}}\n),\n\npayments as (\n    select\n        customer_id,\n        amount\n    \n    from {{ ref('fct_orders')}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        customer_id,\n\n        sum(amount) as lifetime_value\n\n    from payments\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        customer_payments.lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n    select * from analytics.dbt_pstulnikov.stg_customers\n),\n\norders as (\n    select * from analytics.dbt_pstulnikov.stg_orders\n),\n\npayments as (\n    select\n        customer_id,\n        amount\n    \n    from analytics.dbt_pstulnikov.fct_orders\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        customer_id,\n\n        sum(amount) as lifetime_value\n\n    from payments\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        customer_payments.lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-12-06 01:01:18.874304 (Thread-253): handling poll request
2021-12-06 01:01:18.874620 (Thread-253): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44d0040>]}
2021-12-06 01:01:18.875246 (Thread-253): sending response (<Response 11837 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:01:20.365977 (Thread-254): handling poll request
2021-12-06 01:01:20.366298 (Thread-254): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44d2100>]}
2021-12-06 01:01:20.366933 (Thread-254): sending response (<Response 18430 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:01:42.669384 (Thread-255): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 01:01:42.669720 (Thread-255): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 01:01:42.674753 (Thread-255): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a447ff10>]}
2021-12-06 01:01:43.486657 (Thread-256): handling status request
2021-12-06 01:01:43.486985 (Thread-256): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a447fd60>]}
2021-12-06 01:01:43.487505 (Thread-256): sending response (<Response 1212 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:01:43.526555 (Thread-257): handling status request
2021-12-06 01:01:43.526767 (Thread-257): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44865e0>]}
2021-12-06 01:01:43.527151 (Thread-257): sending response (<Response 1212 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:02:07.704031 (Thread-258): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:02:07.704373 (Thread-258): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 01:02:07.708147 (Thread-258): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:02:07.751992 (Thread-258): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a444ee80>]}
2021-12-06 01:02:08.491549 (Thread-259): handling status request
2021-12-06 01:02:08.491869 (Thread-259): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4447100>]}
2021-12-06 01:02:08.492368 (Thread-259): sending response (<Response 1537 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:02:08.536120 (Thread-260): handling status request
2021-12-06 01:02:08.536326 (Thread-260): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44e5eb0>]}
2021-12-06 01:02:08.536696 (Thread-260): sending response (<Response 1537 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:02:11.743043 (Thread-261): handling status request
2021-12-06 01:02:11.743355 (Thread-261): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44e5d00>]}
2021-12-06 01:02:11.743820 (Thread-261): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:02:12.159309 (Thread-262): handling status request
2021-12-06 01:02:12.159630 (Thread-262): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44e5790>]}
2021-12-06 01:02:12.160115 (Thread-262): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:02:12.212132 (Thread-263): handling cli_args request
2021-12-06 01:02:12.212365 (Thread-263): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44e5370>]}
2021-12-06 01:02:12.222550 (Thread-263): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:02:14.122884 (Thread-263): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:02:14.159167 (MainThread): Partial parsing not enabled
2021-12-06 01:02:14.207453 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:02:14.209339 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:02:14.244754 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:02:14.248306 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:02:14.251404 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:02:14.255542 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:02:14.256762 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:02:14.264739 (MainThread): Parsing macros/core.sql
2021-12-06 01:02:14.268224 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:02:14.274419 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:02:14.283774 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:02:14.290322 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:02:14.293865 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:02:14.315125 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:02:14.331109 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:02:14.332622 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:02:14.361705 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:02:14.368556 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:02:14.381525 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:02:14.399902 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:02:14.409222 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:02:14.410885 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:02:14.412224 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:02:14.420042 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:02:14.420984 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:02:14.422619 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:02:14.424035 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:02:14.426328 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:02:14.427674 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:02:14.479465 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:02:14.481523 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:02:14.482615 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:02:14.484089 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:02:14.657824 (Thread-264): handling poll request
2021-12-06 01:02:14.658128 (Thread-264): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5deb310>]}
2021-12-06 01:02:14.659135 (Thread-264): sending response (<Response 9686 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:02:14.663049 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:02:14.674464 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:02:14.676838 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:02:14.679328 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:02:14.683264 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:02:14.748655 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80c47adf0>]}
2021-12-06 01:02:14.780743 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80c47ac70>]}
2021-12-06 01:02:14.780942 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:02:14.782087 (MainThread): 
2021-12-06 01:02:14.782297 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:02:14.786360 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:02:14.797886 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:02:14.797990 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:02:14.798048 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:02:16.324558 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.53 seconds
2021-12-06 01:02:16.326374 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:02:16.339409 (Thread-265): handling poll request
2021-12-06 01:02:16.339690 (Thread-265): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5dede20>]}
2021-12-06 01:02:16.340327 (Thread-265): sending response (<Response 5496 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:02:16.788258 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:02:16.795305 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:02:16.795402 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:02:16.795465 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:02:17.843953 (Thread-266): handling poll request
2021-12-06 01:02:17.844295 (Thread-266): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44111c0>]}
2021-12-06 01:02:17.844842 (Thread-266): sending response (<Response 1708 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:02:18.204027 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.41 seconds
2021-12-06 01:02:18.205509 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:02:18.652117 (MainThread): 01:02:18 | Concurrency: 4 threads (target='default')
2021-12-06 01:02:18.652234 (MainThread): 01:02:18 | 
2021-12-06 01:02:18.654144 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:02:18.654415 (Thread-1): 01:02:18 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:02:18.654639 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:02:18.654731 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:02:18.655546 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:02:18.655770 (Thread-2): 01:02:18 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:02:18.655995 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:02:18.656064 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:02:18.657132 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:02:18.658013 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:02:18.658189 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:02:18.658399 (Thread-3): 01:02:18 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:02:18.658617 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:02:18.658685 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:02:18.659779 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:02:18.675430 (Thread-2): finished collecting timing info
2021-12-06 01:02:18.680511 (Thread-3): finished collecting timing info
2021-12-06 01:02:18.690690 (Thread-1): finished collecting timing info
2021-12-06 01:02:18.715565 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:02:18.717832 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:02:18.721270 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:02:18.734849 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:02:18.734928 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:02:18.734987 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:02:18.741366 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:02:18.741451 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:02:18.741508 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:02:18.742521 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:02:18.742593 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:02:18.742645 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:02:19.349889 (Thread-267): handling poll request
2021-12-06 01:02:19.350239 (Thread-267): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44400a0>]}
2021-12-06 01:02:19.351070 (Thread-267): sending response (<Response 14047 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:02:20.388349 (Thread-2): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-06 01:02:20.394846 (Thread-2): finished collecting timing info
2021-12-06 01:02:20.394979 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:02:20.414373 (Thread-3): SQL status: SUCCESS 1 in 1.67 seconds
2021-12-06 01:02:20.415462 (Thread-3): finished collecting timing info
2021-12-06 01:02:20.415563 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:02:20.448600 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-12-06 01:02:20.449659 (Thread-1): finished collecting timing info
2021-12-06 01:02:20.449761 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:02:20.845982 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80c057f40>]}
2021-12-06 01:02:20.846406 (Thread-2): 01:02:20 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.19s]
2021-12-06 01:02:20.846492 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:02:20.877321 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8070b3130>]}
2021-12-06 01:02:20.877633 (Thread-3): 01:02:20 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.22s]
2021-12-06 01:02:20.877714 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:02:20.878357 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:02:20.878600 (Thread-4): 01:02:20 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:02:20.878834 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:02:20.878915 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:02:20.881331 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:02:20.891144 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8075db130>]}
2021-12-06 01:02:20.891406 (Thread-1): 01:02:20 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.24s]
2021-12-06 01:02:20.891479 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:02:20.896602 (Thread-268): handling poll request
2021-12-06 01:02:20.897105 (Thread-268): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4411f40>]}
2021-12-06 01:02:20.897766 (Thread-268): sending response (<Response 9469 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:02:20.903082 (Thread-4): finished collecting timing info
2021-12-06 01:02:20.919214 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:02:20.949389 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:02:20.949467 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 01:02:20.949525 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:02:22.365715 (Thread-269): handling poll request
2021-12-06 01:02:22.366044 (Thread-269): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a444ee50>]}
2021-12-06 01:02:22.366586 (Thread-269): sending response (<Response 2666 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:02:23.190456 (Thread-4): SQL status: SUCCESS 1 in 2.24 seconds
2021-12-06 01:02:23.195080 (Thread-4): finished collecting timing info
2021-12-06 01:02:23.195213 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:02:23.639350 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff807586940>]}
2021-12-06 01:02:23.639687 (Thread-4): 01:02:23 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.76s]
2021-12-06 01:02:23.639773 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:02:23.640596 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:02:23.640823 (Thread-3): 01:02:23 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:02:23.641026 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:02:23.641096 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:02:23.643637 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:02:23.660448 (Thread-3): finished collecting timing info
2021-12-06 01:02:23.662476 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:02:23.680580 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:02:23.680663 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
      );
2021-12-06 01:02:23.680723 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 01:02:23.814734 (Thread-270): handling poll request
2021-12-06 01:02:23.815003 (Thread-270): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a443c550>]}
2021-12-06 01:02:23.815641 (Thread-270): sending response (<Response 7994 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:02:25.270211 (Thread-271): handling poll request
2021-12-06 01:02:25.270526 (Thread-271): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a443c430>]}
2021-12-06 01:02:25.271018 (Thread-271): sending response (<Response 287 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:02:25.832210 (Thread-3): SQL status: SUCCESS 1 in 2.15 seconds
2021-12-06 01:02:25.833624 (Thread-3): finished collecting timing info
2021-12-06 01:02:25.833757 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:02:26.277770 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e3fd1130>]}
2021-12-06 01:02:26.278219 (Thread-3): 01:02:26 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.64s]
2021-12-06 01:02:26.278321 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:02:26.279840 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:02:26.280145 (MainThread): 01:02:26 | 
2021-12-06 01:02:26.280216 (MainThread): 01:02:26 | Finished running 3 view models, 2 table models in 11.50s.
2021-12-06 01:02:26.280262 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:02:26.280301 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:02:26.280337 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:02:26.280370 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:02:26.280403 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:02:26.339491 (MainThread): 
2021-12-06 01:02:26.339597 (MainThread): Completed successfully
2021-12-06 01:02:26.339672 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:02:26.720398 (Thread-272): handling poll request
2021-12-06 01:02:26.720711 (Thread-272): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a447c1f0>]}
2021-12-06 01:02:26.722036 (Thread-272): sending response (<Response 20628 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:02:27.630634 (Thread-273): handling status request
2021-12-06 01:02:27.630954 (Thread-273): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a447c2e0>]}
2021-12-06 01:02:27.650073 (Thread-274): handling status request
2021-12-06 01:02:27.650351 (Thread-274): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44adaf0>]}
2021-12-06 01:02:27.653721 (Thread-273): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:02:27.654129 (Thread-274): sending response (<Response 1537 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:02:34.976898 (Thread-275): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 01:02:34.977229 (Thread-275): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 01:02:34.982214 (Thread-275): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4386280>]}
2021-12-06 01:02:35.794627 (Thread-276): handling status request
2021-12-06 01:02:35.794987 (Thread-276): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4406e80>]}
2021-12-06 01:02:35.795460 (Thread-276): sending response (<Response 1212 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:02:35.824878 (Thread-277): handling status request
2021-12-06 01:02:35.825104 (Thread-277): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43885e0>]}
2021-12-06 01:02:35.825534 (Thread-277): sending response (<Response 1212 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:02:40.787835 (Thread-278): handling status request
2021-12-06 01:02:40.788151 (Thread-278): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4388d90>]}
2021-12-06 01:02:40.788607 (Thread-278): sending response (<Response 1212 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:02:41.260721 (Thread-279): handling run_sql request
2021-12-06 01:02:41.261010 (Thread-279): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4388f70>]}
2021-12-06 01:02:43.197150 (Thread-279): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:02:43.207965 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:02:43.222471 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fcb8922-b689-460a-a08a-c943f431a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1355e040>]}
2021-12-06 01:02:43.222710 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:02:43.223064 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:02:43.223165 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:02:43.225548 (Thread-1): finished collecting timing info
2021-12-06 01:02:43.227057 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:02:43.227120 (Thread-1): On rpc.jaffle_shop.request: with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:02:43.227174 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:02:43.644205 (Thread-280): handling poll request
2021-12-06 01:02:43.644541 (Thread-280): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43884f0>]}
2021-12-06 01:02:43.645416 (Thread-280): sending response (<Response 4506 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:02:45.054128 (Thread-1): SQL status: SUCCESS 100 in 1.83 seconds
2021-12-06 01:02:45.058341 (Thread-1): finished collecting timing info
2021-12-06 01:02:45.058527 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:02:45.119616 (Thread-281): handling poll request
2021-12-06 01:02:45.119902 (Thread-281): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a438c2e0>]}
2021-12-06 01:02:45.120417 (Thread-281): sending response (<Response 1343 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:02:46.625843 (Thread-282): handling poll request
2021-12-06 01:02:46.626199 (Thread-282): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a438c820>]}
2021-12-06 01:02:46.627702 (Thread-282): sending response (<Response 12913 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:03:09.650562 (Thread-283): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:03:09.650877 (Thread-283): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 01:03:09.654577 (Thread-283): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:03:09.698817 (Thread-283): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a440ce80>]}
2021-12-06 01:03:10.482694 (Thread-284): handling status request
2021-12-06 01:03:10.483019 (Thread-284): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a448c7f0>]}
2021-12-06 01:03:10.483592 (Thread-284): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:03:10.484427 (Thread-285): handling status request
2021-12-06 01:03:10.484959 (Thread-285): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43a2250>]}
2021-12-06 01:03:10.485359 (Thread-285): sending response (<Response 1537 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:03:15.682762 (Thread-286): handling status request
2021-12-06 01:03:15.683093 (Thread-286): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4358340>]}
2021-12-06 01:03:15.683614 (Thread-286): sending response (<Response 1537 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:03:15.994500 (Thread-287): handling status request
2021-12-06 01:03:15.994763 (Thread-287): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43586d0>]}
2021-12-06 01:03:15.995212 (Thread-287): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:03:16.185765 (Thread-288): handling cli_args request
2021-12-06 01:03:16.186005 (Thread-288): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4358e50>]}
2021-12-06 01:03:16.196108 (Thread-288): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:03:18.104458 (Thread-288): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:03:18.139950 (MainThread): Partial parsing not enabled
2021-12-06 01:03:18.186605 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:03:18.188540 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:03:18.222938 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:03:18.226527 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:03:18.229665 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:03:18.233819 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:03:18.235068 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:03:18.243118 (MainThread): Parsing macros/core.sql
2021-12-06 01:03:18.246635 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:03:18.252815 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:03:18.262214 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:03:18.268767 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:03:18.272470 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:03:18.293816 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:03:18.309850 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:03:18.311430 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:03:18.340638 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:03:18.347502 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:03:18.360447 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:03:18.378834 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:03:18.388185 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:03:18.389861 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:03:18.391238 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:03:18.399047 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:03:18.399991 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:03:18.401587 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:03:18.403035 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:03:18.405310 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:03:18.406677 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:03:18.458645 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:03:18.460704 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:03:18.461763 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:03:18.463265 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:03:18.559661 (Thread-289): handling poll request
2021-12-06 01:03:18.559949 (Thread-289): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4327400>]}
2021-12-06 01:03:18.560914 (Thread-289): sending response (<Response 9686 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:03:18.642981 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:03:18.655246 (MainThread): 1699: statically parsed staging/jaffle_shop/stg_orders.sql
2021-12-06 01:03:18.655351 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:03:18.656913 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8191faf0>]}
2021-12-06 01:03:18.657915 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:03:18.660408 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:03:18.664360 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:03:18.717816 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8193d9a0>]}
2021-12-06 01:03:18.748466 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8193d5e0>]}
2021-12-06 01:03:18.748657 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:03:18.749763 (MainThread): 
2021-12-06 01:03:18.749983 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:03:18.750828 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:03:18.762098 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:03:18.762167 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:03:18.762221 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:03:20.089165 (Thread-290): handling poll request
2021-12-06 01:03:20.089483 (Thread-290): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a440cdc0>]}
2021-12-06 01:03:20.090131 (Thread-290): sending response (<Response 5681 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:03:20.319076 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.56 seconds
2021-12-06 01:03:20.320912 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:03:20.790321 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:03:20.797320 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:03:20.797418 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:03:20.797493 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 01:03:21.618445 (Thread-291): handling poll request
2021-12-06 01:03:21.618775 (Thread-291): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a432e880>]}
2021-12-06 01:03:21.619330 (Thread-291): sending response (<Response 2261 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:03:22.089351 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.29 seconds
2021-12-06 01:03:22.090854 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:03:22.539710 (MainThread): 01:03:22 | Concurrency: 4 threads (target='default')
2021-12-06 01:03:22.539846 (MainThread): 01:03:22 | 
2021-12-06 01:03:22.541801 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:03:22.542108 (Thread-1): 01:03:22 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:03:22.542335 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:03:22.542433 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:03:22.543268 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:03:22.543483 (Thread-2): 01:03:22 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:03:22.543688 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:03:22.543756 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:03:22.544892 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:03:22.545801 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:03:22.546006 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:03:22.546215 (Thread-3): 01:03:22 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:03:22.546433 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:03:22.546498 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:03:22.547558 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:03:22.562642 (Thread-2): finished collecting timing info
2021-12-06 01:03:22.567988 (Thread-1): finished collecting timing info
2021-12-06 01:03:22.583495 (Thread-3): finished collecting timing info
2021-12-06 01:03:22.598433 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:03:22.602287 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:03:22.604440 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:03:22.621088 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:03:22.621166 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:03:22.621226 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:03:22.622369 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:03:22.622441 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:03:22.622497 (Thread-2): Opening a new connection, currently in state closed
2021-12-06 01:03:22.623553 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:03:22.623625 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:03:22.623679 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:03:23.072219 (Thread-292): handling poll request
2021-12-06 01:03:23.072515 (Thread-292): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42b71c0>]}
2021-12-06 01:03:23.073389 (Thread-292): sending response (<Response 14049 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:03:24.266825 (Thread-3): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-06 01:03:24.273273 (Thread-3): finished collecting timing info
2021-12-06 01:03:24.273410 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:03:24.433036 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-06 01:03:24.434181 (Thread-2): finished collecting timing info
2021-12-06 01:03:24.434291 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:03:24.436084 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-06 01:03:24.437141 (Thread-1): finished collecting timing info
2021-12-06 01:03:24.437244 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:03:24.569913 (Thread-293): handling poll request
2021-12-06 01:03:24.570172 (Thread-293): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42d8370>]}
2021-12-06 01:03:24.570726 (Thread-293): sending response (<Response 3556 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:03:24.738264 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e49d68250>]}
2021-12-06 01:03:24.738593 (Thread-3): 01:03:24 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.19s]
2021-12-06 01:03:24.738679 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:03:24.902069 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8196e820>]}
2021-12-06 01:03:24.902342 (Thread-2): 01:03:24 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.36s]
2021-12-06 01:03:24.902415 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:03:24.903098 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:03:24.903323 (Thread-4): 01:03:24 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:03:24.903545 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:03:24.903618 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:03:24.905867 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:03:24.906521 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4aa3bd00>]}
2021-12-06 01:03:24.906770 (Thread-1): 01:03:24 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.36s]
2021-12-06 01:03:24.906839 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:03:24.920558 (Thread-4): finished collecting timing info
2021-12-06 01:03:24.936814 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:03:24.952137 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:03:24.952218 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 01:03:24.952291 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:03:26.017154 (Thread-294): handling poll request
2021-12-06 01:03:26.017458 (Thread-294): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42d8cd0>]}
2021-12-06 01:03:26.018141 (Thread-294): sending response (<Response 8578 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:03:26.991523 (Thread-4): SQL status: SUCCESS 1 in 2.04 seconds
2021-12-06 01:03:26.996048 (Thread-4): finished collecting timing info
2021-12-06 01:03:26.996179 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:03:27.464963 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e49d59b50>]}
2021-12-06 01:03:27.465445 (Thread-4): 01:03:27 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.56s]
2021-12-06 01:03:27.468272 (Thread-295): handling poll request
2021-12-06 01:03:27.468520 (Thread-295): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42e20d0>]}
2021-12-06 01:03:27.469020 (Thread-295): sending response (<Response 2246 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:03:27.465541 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:03:27.466308 (Thread-2): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:03:27.466539 (Thread-2): 01:03:27 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:03:27.466762 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:03:27.466838 (Thread-2): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:03:27.469412 (Thread-2): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:03:27.484699 (Thread-2): finished collecting timing info
2021-12-06 01:03:27.486719 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:03:27.503049 (Thread-2): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:03:27.503128 (Thread-2): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
      );
2021-12-06 01:03:27.503185 (Thread-2): Opening a new connection, currently in state closed
2021-12-06 01:03:28.913873 (Thread-296): handling poll request
2021-12-06 01:03:28.914224 (Thread-296): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42e5700>]}
2021-12-06 01:03:28.914886 (Thread-296): sending response (<Response 6064 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:03:29.625563 (Thread-2): SQL status: SUCCESS 1 in 2.12 seconds
2021-12-06 01:03:29.626985 (Thread-2): finished collecting timing info
2021-12-06 01:03:29.627120 (Thread-2): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:03:30.074660 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8199d3d0>]}
2021-12-06 01:03:30.075021 (Thread-2): 01:03:30 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.61s]
2021-12-06 01:03:30.075107 (Thread-2): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:03:30.076629 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:03:30.076961 (MainThread): 01:03:30 | 
2021-12-06 01:03:30.077030 (MainThread): 01:03:30 | Finished running 3 view models, 2 table models in 11.33s.
2021-12-06 01:03:30.077081 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:03:30.077121 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:03:30.077158 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:03:30.077193 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 01:03:30.077232 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:03:30.132832 (MainThread): 
2021-12-06 01:03:30.132944 (MainThread): Completed successfully
2021-12-06 01:03:30.133010 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:03:30.357788 (Thread-297): handling poll request
2021-12-06 01:03:30.358150 (Thread-297): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42b7880>]}
2021-12-06 01:03:30.359497 (Thread-297): sending response (<Response 20690 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:03:31.265627 (Thread-298): handling status request
2021-12-06 01:03:31.266026 (Thread-298): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d04340>]}
2021-12-06 01:03:31.266574 (Thread-298): sending response (<Response 1537 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:03:31.407069 (Thread-299): handling status request
2021-12-06 01:03:31.407384 (Thread-299): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4358ca0>]}
2021-12-06 01:03:31.407884 (Thread-299): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:03:54.917519 (Thread-300): handling status request
2021-12-06 01:03:54.917898 (Thread-300): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4327ee0>]}
2021-12-06 01:03:54.918503 (Thread-300): sending response (<Response 1537 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:03:58.535095 (Thread-301): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 01:03:58.535451 (Thread-301): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 01:03:58.540541 (Thread-301): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42907f0>]}
2021-12-06 01:03:59.366306 (Thread-302): handling status request
2021-12-06 01:03:59.366622 (Thread-302): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4290b20>]}
2021-12-06 01:03:59.367094 (Thread-302): sending response (<Response 1212 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:03:59.452262 (Thread-303): handling status request
2021-12-06 01:03:59.452529 (Thread-303): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42907c0>]}
2021-12-06 01:03:59.475638 (Thread-303): sending response (<Response 1212 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:04:40.660019 (Thread-304): handling status request
2021-12-06 01:04:40.660348 (Thread-304): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4290490>]}
2021-12-06 01:04:40.660846 (Thread-304): sending response (<Response 1212 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:04:41.239608 (Thread-305): handling run_sql request
2021-12-06 01:04:41.239935 (Thread-305): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4290fa0>]}
2021-12-06 01:04:43.144470 (Thread-305): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:04:43.159830 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:04:43.179612 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a57ff8-5146-4db8-ad00-af75aae9d7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68c83a0d0>]}
2021-12-06 01:04:43.179888 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:04:43.180288 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:04:43.180393 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:04:43.182950 (Thread-1): finished collecting timing info
2021-12-06 01:04:43.184541 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:04:43.184606 (Thread-1): On rpc.jaffle_shop.request: with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:04:43.184662 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:04:43.622276 (Thread-306): handling poll request
2021-12-06 01:04:43.622724 (Thread-306): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4242c70>]}
2021-12-06 01:04:43.623645 (Thread-306): sending response (<Response 4537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:04:45.000910 (Thread-1): SQL status: SUCCESS 100 in 1.82 seconds
2021-12-06 01:04:45.005161 (Thread-1): finished collecting timing info
2021-12-06 01:04:45.005349 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:04:45.168228 (Thread-307): handling poll request
2021-12-06 01:04:45.168510 (Thread-307): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4249160>]}
2021-12-06 01:04:45.169040 (Thread-307): sending response (<Response 1344 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:04:46.734432 (Thread-308): handling poll request
2021-12-06 01:04:46.734751 (Thread-308): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4249580>]}
2021-12-06 01:04:46.736194 (Thread-308): sending response (<Response 12998 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:07:02.970750 (Thread-309): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:07:02.972732 (Thread-309): Partial parsing: updated file: jaffle_shop://models/staging/stripe/stg_payments.sql
2021-12-06 01:07:02.976595 (Thread-309): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:07:03.017461 (Thread-309): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a421d6d0>]}
2021-12-06 01:07:03.773719 (Thread-310): handling status request
2021-12-06 01:07:03.774059 (Thread-310): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a421d940>]}
2021-12-06 01:07:03.774572 (Thread-310): sending response (<Response 1539 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:07:03.832528 (Thread-311): handling status request
2021-12-06 01:07:03.832758 (Thread-311): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a421dcd0>]}
2021-12-06 01:07:03.833173 (Thread-311): sending response (<Response 1539 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:09:42.984322 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 01:09:43.069575 (Thread-312): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:09:43.069868 (Thread-312): Partial parsing: updated file: jaffle_shop://models/marts/core/fct_orders.sql
2021-12-06 01:09:43.073217 (Thread-312): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:09:43.117728 (Thread-312): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41ab550>]}
2021-12-06 01:09:43.870720 (Thread-313): handling status request
2021-12-06 01:09:43.871029 (Thread-313): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41c74f0>]}
2021-12-06 01:09:43.871509 (Thread-313): sending response (<Response 1531 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:09:43.957752 (Thread-314): handling status request
2021-12-06 01:09:43.958037 (Thread-314): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41c71f0>]}
2021-12-06 01:09:43.958490 (Thread-314): sending response (<Response 1531 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:11:15.341311 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:11:15.551596 (Thread-315): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:11:15.551973 (Thread-315): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 01:11:15.555514 (Thread-315): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:11:15.597183 (Thread-315): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5f67340>]}
2021-12-06 01:11:16.261875 (Thread-316): handling status request
2021-12-06 01:11:16.262227 (Thread-316): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41cbb80>]}
2021-12-06 01:11:16.262689 (Thread-316): sending response (<Response 1537 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:11:16.265431 (Thread-317): handling status request
2021-12-06 01:11:16.265630 (Thread-317): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41cbdc0>]}
2021-12-06 01:11:16.266008 (Thread-317): sending response (<Response 1537 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:11:23.442010 (Thread-318): handling status request
2021-12-06 01:11:23.442343 (Thread-318): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41cbf70>]}
2021-12-06 01:11:23.442827 (Thread-318): sending response (<Response 1537 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:11:23.856542 (Thread-319): handling status request
2021-12-06 01:11:23.856836 (Thread-319): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41cb850>]}
2021-12-06 01:11:23.857288 (Thread-319): sending response (<Response 1537 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:11:23.888716 (Thread-320): handling cli_args request
2021-12-06 01:11:23.888935 (Thread-320): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41dfeb0>]}
2021-12-06 01:11:23.898787 (Thread-320): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:11:25.840847 (Thread-320): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:11:25.876246 (MainThread): Partial parsing not enabled
2021-12-06 01:11:25.927698 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:11:25.929669 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:11:25.963429 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:11:25.967082 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:11:25.970271 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:11:25.974562 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:11:25.975801 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:11:25.983966 (MainThread): Parsing macros/core.sql
2021-12-06 01:11:25.987531 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:11:25.993973 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:11:26.003571 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:11:26.010438 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:11:26.014043 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:11:26.035530 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:11:26.051859 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:11:26.053419 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:11:26.082821 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:11:26.089779 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:11:26.103139 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:11:26.121848 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:11:26.131398 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:11:26.133050 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:11:26.134467 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:11:26.142593 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:11:26.143468 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:11:26.145086 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:11:26.146585 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:11:26.148939 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:11:26.150325 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:11:26.202919 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:11:26.204941 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:11:26.206027 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:11:26.207506 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:11:26.284652 (Thread-321): handling poll request
2021-12-06 01:11:26.284934 (Thread-321): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41d3070>]}
2021-12-06 01:11:26.286081 (Thread-321): sending response (<Response 9686 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:11:26.388658 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:11:26.400389 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:11:26.402840 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:11:26.405345 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:11:26.409089 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:11:26.464847 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '390e79f9-b259-4b70-9e76-604adbf8fb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052067aa90>]}
2021-12-06 01:11:26.494068 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '390e79f9-b259-4b70-9e76-604adbf8fb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052067a850>]}
2021-12-06 01:11:26.494267 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:11:26.495377 (MainThread): 
2021-12-06 01:11:26.495570 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:11:26.496446 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:11:26.507696 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:11:26.507764 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:11:26.507817 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:11:27.817222 (Thread-322): handling poll request
2021-12-06 01:11:27.817548 (Thread-322): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41d3b50>]}
2021-12-06 01:11:27.818224 (Thread-322): sending response (<Response 4941 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:11:28.069679 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.56 seconds
2021-12-06 01:11:28.071575 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:11:28.518390 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:11:28.525372 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:11:28.525456 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:11:28.525518 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:11:29.294665 (Thread-323): handling poll request
2021-12-06 01:11:29.294973 (Thread-323): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41d7490>]}
2021-12-06 01:11:29.295535 (Thread-323): sending response (<Response 2263 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:11:29.800787 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.28 seconds
2021-12-06 01:11:29.802283 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:11:30.259876 (MainThread): 01:11:30 | Concurrency: 4 threads (target='default')
2021-12-06 01:11:30.260024 (MainThread): 01:11:30 | 
2021-12-06 01:11:30.261990 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:11:30.262278 (Thread-1): 01:11:30 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:11:30.262511 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:11:30.262609 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:11:30.263455 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:11:30.263674 (Thread-2): 01:11:30 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:11:30.263903 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:11:30.263976 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:11:30.265071 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:11:30.265361 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:11:30.265576 (Thread-3): 01:11:30 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:11:30.265796 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:11:30.265863 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:11:30.266917 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:11:30.267814 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:11:30.285174 (Thread-2): finished collecting timing info
2021-12-06 01:11:30.290532 (Thread-1): finished collecting timing info
2021-12-06 01:11:30.305793 (Thread-3): finished collecting timing info
2021-12-06 01:11:30.328961 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:11:30.329517 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:11:30.326481 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:11:30.345072 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:11:30.345159 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:11:30.345220 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:11:30.346353 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:11:30.346426 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:11:30.346481 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:11:30.347551 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:11:30.347626 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:11:30.347679 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:11:30.746090 (Thread-324): handling poll request
2021-12-06 01:11:30.746354 (Thread-324): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41d85b0>]}
2021-12-06 01:11:30.747519 (Thread-324): sending response (<Response 14241 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:11:31.997201 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-06 01:11:32.003759 (Thread-1): finished collecting timing info
2021-12-06 01:11:32.003889 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:11:32.101841 (Thread-2): SQL status: SUCCESS 1 in 1.76 seconds
2021-12-06 01:11:32.103003 (Thread-2): finished collecting timing info
2021-12-06 01:11:32.103116 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:11:32.158459 (Thread-3): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-06 01:11:32.159578 (Thread-3): finished collecting timing info
2021-12-06 01:11:32.159690 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:11:32.211810 (Thread-325): handling poll request
2021-12-06 01:11:32.212066 (Thread-325): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41ceaf0>]}
2021-12-06 01:11:32.212633 (Thread-325): sending response (<Response 3556 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:11:32.454734 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390e79f9-b259-4b70-9e76-604adbf8fb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051b78ad90>]}
2021-12-06 01:11:32.455069 (Thread-1): 01:11:32 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.19s]
2021-12-06 01:11:32.455153 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:11:32.557699 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390e79f9-b259-4b70-9e76-604adbf8fb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05205d7b50>]}
2021-12-06 01:11:32.558000 (Thread-2): 01:11:32 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.29s]
2021-12-06 01:11:32.558081 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:11:32.631964 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390e79f9-b259-4b70-9e76-604adbf8fb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052067a5b0>]}
2021-12-06 01:11:32.632234 (Thread-3): 01:11:32 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.37s]
2021-12-06 01:11:32.632308 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:11:32.633146 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:11:32.633355 (Thread-4): 01:11:32 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:11:32.633578 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:11:32.633650 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:11:32.635980 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:11:32.651565 (Thread-4): finished collecting timing info
2021-12-06 01:11:32.668178 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:11:32.684324 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:11:32.684406 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 01:11:32.684463 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:11:33.653696 (Thread-326): handling poll request
2021-12-06 01:11:33.654037 (Thread-326): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41d85b0>]}
2021-12-06 01:11:33.654776 (Thread-326): sending response (<Response 8809 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:11:34.734415 (Thread-4): SQL status: SUCCESS 1 in 2.05 seconds
2021-12-06 01:11:34.741419 (Thread-4): finished collecting timing info
2021-12-06 01:11:34.741556 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:11:35.138750 (Thread-327): handling poll request
2021-12-06 01:11:35.139072 (Thread-327): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41d87f0>]}
2021-12-06 01:11:35.139627 (Thread-327): sending response (<Response 1369 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:11:35.198328 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390e79f9-b259-4b70-9e76-604adbf8fb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051b2b03d0>]}
2021-12-06 01:11:35.198711 (Thread-4): 01:11:35 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.56s]
2021-12-06 01:11:35.198801 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:11:35.199707 (Thread-2): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:11:35.199968 (Thread-2): 01:11:35 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:11:35.200198 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:11:35.200273 (Thread-2): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:11:35.202669 (Thread-2): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:11:35.217258 (Thread-2): finished collecting timing info
2021-12-06 01:11:35.219248 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:11:35.235110 (Thread-2): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:11:35.235190 (Thread-2): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 01:11:35.235249 (Thread-2): Opening a new connection, currently in state closed
2021-12-06 01:11:36.622103 (Thread-328): handling poll request
2021-12-06 01:11:36.622421 (Thread-328): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41d81c0>]}
2021-12-06 01:11:36.623077 (Thread-328): sending response (<Response 6594 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:11:37.364601 (Thread-2): SQL status: SUCCESS 1 in 2.13 seconds
2021-12-06 01:11:37.366075 (Thread-2): finished collecting timing info
2021-12-06 01:11:37.366220 (Thread-2): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:11:37.826400 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390e79f9-b259-4b70-9e76-604adbf8fb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0520096460>]}
2021-12-06 01:11:37.826785 (Thread-2): 01:11:37 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.63s]
2021-12-06 01:11:37.826875 (Thread-2): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:11:37.828347 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:11:37.828647 (MainThread): 01:11:37 | 
2021-12-06 01:11:37.828714 (MainThread): 01:11:37 | Finished running 3 view models, 2 table models in 11.33s.
2021-12-06 01:11:37.828762 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:11:37.828801 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:11:37.828836 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:11:37.828869 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 01:11:37.828901 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:11:37.907143 (MainThread): 
2021-12-06 01:11:37.907263 (MainThread): Completed successfully
2021-12-06 01:11:37.907331 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:11:38.517728 (Thread-329): handling poll request
2021-12-06 01:11:38.518082 (Thread-329): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fd3e80>]}
2021-12-06 01:11:38.519535 (Thread-329): sending response (<Response 20875 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:11:39.412466 (Thread-330): handling status request
2021-12-06 01:11:39.412779 (Thread-330): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fd3c40>]}
2021-12-06 01:11:39.413308 (Thread-330): sending response (<Response 1537 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:11:39.433025 (Thread-331): handling status request
2021-12-06 01:11:39.433249 (Thread-331): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fd3130>]}
2021-12-06 01:11:39.433669 (Thread-331): sending response (<Response 1537 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:11:47.390409 (Thread-332): handling status request
2021-12-06 01:11:47.390723 (Thread-332): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fd33d0>]}
2021-12-06 01:11:47.391193 (Thread-332): sending response (<Response 1537 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:11:47.843593 (Thread-333): handling run_sql request
2021-12-06 01:11:47.843902 (Thread-333): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fd3310>]}
2021-12-06 01:11:49.765746 (Thread-333): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:11:49.776916 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:11:49.790768 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f017ead-b48f-4ef4-a767-5beda313f902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86cccf130>]}
2021-12-06 01:11:49.791006 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:11:49.791401 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:11:49.791505 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:11:49.793577 (Thread-1): finished collecting timing info
2021-12-06 01:11:49.794984 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:11:49.795058 (Thread-1): On rpc.jaffle_shop.request: with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:11:49.795123 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:11:50.212300 (Thread-334): handling poll request
2021-12-06 01:11:50.212669 (Thread-334): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5f3eee0>]}
2021-12-06 01:11:50.213573 (Thread-334): sending response (<Response 4222 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:11:51.538217 (Thread-1): SQL status: SUCCESS 100 in 1.74 seconds
2021-12-06 01:11:51.544034 (Thread-1): finished collecting timing info
2021-12-06 01:11:51.544205 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:11:51.839860 (Thread-335): handling poll request
2021-12-06 01:11:51.840142 (Thread-335): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5f3e430>]}
2021-12-06 01:11:51.840687 (Thread-335): sending response (<Response 1344 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:11:53.323681 (Thread-336): handling poll request
2021-12-06 01:11:53.324008 (Thread-336): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fe51c0>]}
2021-12-06 01:11:53.325472 (Thread-336): sending response (<Response 11622 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:12:14.275772 (Thread-337): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:12:14.276110 (Thread-337): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 01:12:14.279925 (Thread-337): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:12:14.323071 (Thread-337): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49accd0>]}
2021-12-06 01:12:15.082808 (Thread-338): handling status request
2021-12-06 01:12:15.083116 (Thread-338): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49acaf0>]}
2021-12-06 01:12:15.083641 (Thread-338): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:12:15.585319 (Thread-339): handling status request
2021-12-06 01:12:15.585631 (Thread-339): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49ac3a0>]}
2021-12-06 01:12:15.586147 (Thread-339): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:12:18.067035 (Thread-340): handling status request
2021-12-06 01:12:18.067347 (Thread-340): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49ac1c0>]}
2021-12-06 01:12:18.067819 (Thread-340): sending response (<Response 1537 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:12:18.553173 (Thread-341): handling cli_args request
2021-12-06 01:12:18.553480 (Thread-341): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6cbfd0>]}
2021-12-06 01:12:18.560695 (Thread-342): handling status request
2021-12-06 01:12:18.561089 (Thread-342): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4927ac0>]}
2021-12-06 01:12:18.561628 (Thread-342): sending response (<Response 1537 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:12:18.566029 (Thread-341): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:12:20.490754 (Thread-341): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:12:20.527087 (MainThread): Partial parsing not enabled
2021-12-06 01:12:20.575611 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:12:20.577510 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:12:20.614116 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:12:20.617696 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:12:20.620862 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:12:20.625028 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:12:20.626297 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:12:20.634284 (MainThread): Parsing macros/core.sql
2021-12-06 01:12:20.637759 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:12:20.644040 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:12:20.653375 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:12:20.659946 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:12:20.663534 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:12:20.684759 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:12:20.701810 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:12:20.703975 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:12:20.735907 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:12:20.742854 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:12:20.756151 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:12:20.775273 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:12:20.785291 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:12:20.786975 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:12:20.788367 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:12:20.796463 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:12:20.797358 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:12:20.798999 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:12:20.800471 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:12:20.802819 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:12:20.804193 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:12:20.856783 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:12:20.858899 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:12:20.860026 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:12:20.861536 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:12:21.007688 (Thread-343): handling poll request
2021-12-06 01:12:21.007978 (Thread-343): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5f76ee0>]}
2021-12-06 01:12:21.009117 (Thread-343): sending response (<Response 9686 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:12:21.043026 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:12:21.054620 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:12:21.057039 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:12:21.059539 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:12:21.063287 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:12:21.127373 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '963204e8-c6d9-4b4d-a86f-84685070598b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfb12f940>]}
2021-12-06 01:12:21.156124 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '963204e8-c6d9-4b4d-a86f-84685070598b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfb12ffa0>]}
2021-12-06 01:12:21.156319 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:12:21.157433 (MainThread): 
2021-12-06 01:12:21.157627 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:12:21.158483 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:12:21.169799 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:12:21.169869 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:12:21.169923 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:12:22.499760 (Thread-344): handling poll request
2021-12-06 01:12:22.500073 (Thread-344): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6cb100>]}
2021-12-06 01:12:22.500697 (Thread-344): sending response (<Response 4941 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:12:22.682902 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.51 seconds
2021-12-06 01:12:22.684682 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:12:23.129686 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:12:23.136607 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:12:23.136698 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:12:23.136760 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:12:23.940533 (Thread-345): handling poll request
2021-12-06 01:12:23.940849 (Thread-345): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49c4160>]}
2021-12-06 01:12:23.941410 (Thread-345): sending response (<Response 2263 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:12:24.401838 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.27 seconds
2021-12-06 01:12:24.403316 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:12:24.847770 (MainThread): 01:12:24 | Concurrency: 4 threads (target='default')
2021-12-06 01:12:24.847896 (MainThread): 01:12:24 | 
2021-12-06 01:12:24.849860 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:12:24.850160 (Thread-1): 01:12:24 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:12:24.850386 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:12:24.850485 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:12:24.851308 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:12:24.851531 (Thread-2): 01:12:24 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:12:24.851754 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:12:24.851825 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:12:24.852923 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:12:24.853184 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:12:24.853394 (Thread-3): 01:12:24 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:12:24.853610 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:12:24.853676 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:12:24.854668 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:12:24.855579 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:12:24.870292 (Thread-2): finished collecting timing info
2021-12-06 01:12:24.875549 (Thread-1): finished collecting timing info
2021-12-06 01:12:24.890818 (Thread-3): finished collecting timing info
2021-12-06 01:12:24.906076 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:12:24.908062 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:12:24.911556 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:12:24.927143 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:12:24.927226 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:12:24.927283 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:12:24.928326 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:12:24.928399 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:12:24.928453 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:12:24.929437 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:12:24.929505 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:12:24.929558 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:12:25.404491 (Thread-346): handling poll request
2021-12-06 01:12:25.404741 (Thread-346): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4927eb0>]}
2021-12-06 01:12:25.405618 (Thread-346): sending response (<Response 14241 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:12:26.566570 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-12-06 01:12:26.573028 (Thread-1): finished collecting timing info
2021-12-06 01:12:26.573167 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:12:26.710027 (Thread-2): SQL status: SUCCESS 1 in 1.78 seconds
2021-12-06 01:12:26.711269 (Thread-2): finished collecting timing info
2021-12-06 01:12:26.711391 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:12:26.743496 (Thread-3): SQL status: SUCCESS 1 in 1.82 seconds
2021-12-06 01:12:26.744610 (Thread-3): finished collecting timing info
2021-12-06 01:12:26.744719 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:12:26.925867 (Thread-347): handling poll request
2021-12-06 01:12:26.926160 (Thread-347): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc48f400>]}
2021-12-06 01:12:26.926719 (Thread-347): sending response (<Response 3556 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:12:27.025626 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963204e8-c6d9-4b4d-a86f-84685070598b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfa27aa90>]}
2021-12-06 01:12:27.026009 (Thread-1): 01:12:27 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.18s]
2021-12-06 01:12:27.026096 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:12:27.168638 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963204e8-c6d9-4b4d-a86f-84685070598b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf85407c0>]}
2021-12-06 01:12:27.168922 (Thread-2): 01:12:27 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.32s]
2021-12-06 01:12:27.168995 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:12:27.196233 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963204e8-c6d9-4b4d-a86f-84685070598b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf9d9bf70>]}
2021-12-06 01:12:27.196501 (Thread-3): 01:12:27 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.34s]
2021-12-06 01:12:27.196571 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:12:27.197453 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:12:27.197669 (Thread-4): 01:12:27 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:12:27.197895 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:12:27.198001 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:12:27.200356 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:12:27.215458 (Thread-4): finished collecting timing info
2021-12-06 01:12:27.232395 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:12:27.248346 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:12:27.248427 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 01:12:27.248484 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:12:28.455952 (Thread-348): handling poll request
2021-12-06 01:12:28.456275 (Thread-348): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5f503d0>]}
2021-12-06 01:12:28.457018 (Thread-348): sending response (<Response 8809 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:12:29.241036 (Thread-4): SQL status: SUCCESS 1 in 1.99 seconds
2021-12-06 01:12:29.245547 (Thread-4): finished collecting timing info
2021-12-06 01:12:29.245681 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:12:29.700983 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963204e8-c6d9-4b4d-a86f-84685070598b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfa2f5af0>]}
2021-12-06 01:12:29.701374 (Thread-4): 01:12:29 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.50s]
2021-12-06 01:12:29.701464 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:12:29.702385 (Thread-2): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:12:29.702642 (Thread-2): 01:12:29 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:12:29.702887 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:12:29.702981 (Thread-2): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:12:29.705412 (Thread-2): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:12:29.722125 (Thread-2): finished collecting timing info
2021-12-06 01:12:29.724256 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:12:29.742275 (Thread-2): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:12:29.742358 (Thread-2): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 01:12:29.742419 (Thread-2): Opening a new connection, currently in state closed
2021-12-06 01:12:29.911974 (Thread-349): handling poll request
2021-12-06 01:12:29.912239 (Thread-349): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6c8520>]}
2021-12-06 01:12:29.912948 (Thread-349): sending response (<Response 7709 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:12:31.402178 (Thread-350): handling poll request
2021-12-06 01:12:31.402508 (Thread-350): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6c8cd0>]}
2021-12-06 01:12:31.402999 (Thread-350): sending response (<Response 287 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:12:31.793473 (Thread-2): SQL status: SUCCESS 1 in 2.05 seconds
2021-12-06 01:12:31.794887 (Thread-2): finished collecting timing info
2021-12-06 01:12:31.795021 (Thread-2): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:12:32.247743 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963204e8-c6d9-4b4d-a86f-84685070598b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfa358af0>]}
2021-12-06 01:12:32.248120 (Thread-2): 01:12:32 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.54s]
2021-12-06 01:12:32.248208 (Thread-2): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:12:32.249838 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:12:32.250206 (MainThread): 01:12:32 | 
2021-12-06 01:12:32.250287 (MainThread): 01:12:32 | Finished running 3 view models, 2 table models in 11.09s.
2021-12-06 01:12:32.250336 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:12:32.250376 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:12:32.250411 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:12:32.250446 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 01:12:32.250479 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:12:32.309602 (MainThread): 
2021-12-06 01:12:32.309714 (MainThread): Completed successfully
2021-12-06 01:12:32.309778 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:12:32.909255 (Thread-351): handling poll request
2021-12-06 01:12:32.909574 (Thread-351): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc74f2e0>]}
2021-12-06 01:12:32.911069 (Thread-351): sending response (<Response 20939 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:12:33.815117 (Thread-352): handling status request
2021-12-06 01:12:33.815448 (Thread-352): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc772580>]}
2021-12-06 01:12:33.815981 (Thread-352): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:12:33.826056 (Thread-353): handling status request
2021-12-06 01:12:33.826266 (Thread-353): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc772ca0>]}
2021-12-06 01:12:33.826624 (Thread-353): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:12:40.995114 (Thread-354): handling status request
2021-12-06 01:12:40.995464 (Thread-354): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc772f40>]}
2021-12-06 01:12:40.996004 (Thread-354): sending response (<Response 1537 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:12:41.523018 (Thread-355): handling run_sql request
2021-12-06 01:12:41.523284 (Thread-355): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc772400>]}
2021-12-06 01:12:43.498926 (Thread-355): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:12:43.484145 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:12:43.511857 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db8cb75f-f3d8-40f8-9e44-63539b096602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb5a601c0>]}
2021-12-06 01:12:43.512097 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:12:43.512492 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:12:43.512596 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:12:43.514641 (Thread-1): finished collecting timing info
2021-12-06 01:12:43.516039 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:12:43.516103 (Thread-1): On rpc.jaffle_shop.request: with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:12:43.516158 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:12:44.027402 (Thread-356): handling poll request
2021-12-06 01:12:44.027750 (Thread-356): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4321c70>]}
2021-12-06 01:12:44.028651 (Thread-356): sending response (<Response 4253 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:12:45.156103 (Thread-1): SQL status: SUCCESS 100 in 1.64 seconds
2021-12-06 01:12:45.164390 (Thread-1): finished collecting timing info
2021-12-06 01:12:45.164572 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:12:45.491000 (Thread-357): handling poll request
2021-12-06 01:12:45.491307 (Thread-357): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4321eb0>]}
2021-12-06 01:12:45.491836 (Thread-357): sending response (<Response 1344 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:12:47.017970 (Thread-358): handling poll request
2021-12-06 01:12:47.018328 (Thread-358): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4321970>]}
2021-12-06 01:12:47.019806 (Thread-358): sending response (<Response 11715 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:12:50.087729 (Thread-359): handling status request
2021-12-06 01:12:50.088052 (Thread-359): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4242dc0>]}
2021-12-06 01:12:50.088576 (Thread-359): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 01:12:50.093541 (Thread-360): handling status request
2021-12-06 01:12:50.093741 (Thread-360): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42421f0>]}
2021-12-06 01:12:50.094306 (Thread-360): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 01:12:50.094983 (Thread-361): handling list request
2021-12-06 01:12:50.095482 (Thread-361): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4242eb0>]}
2021-12-06 01:12:50.107222 (Thread-362): handling list request
2021-12-06 01:12:50.107570 (Thread-362): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '9f0bbd2a-5638-4da8-b2c3-3df1ef6c9f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43216a0>]}
2021-12-06 01:12:50.126807 (Thread-362): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ef972f9-9d9c-4db5-946a-6bb3f6039a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a425dee0>]}
2021-12-06 01:12:50.158418 (Thread-361): sending response (<Response 1630 bytes [200 OK]>) to 10.0.26.110
2021-12-06 01:12:50.129153 (Thread-361): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ef972f9-9d9c-4db5-946a-6bb3f6039a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43425e0>]}
2021-12-06 01:12:50.152607 (Thread-362): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:12:50.153313 (Thread-361): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:12:50.159968 (Thread-362): sending response (<Response 4935 bytes [200 OK]>) to 10.0.26.110
2021-12-06 01:12:50.514620 (Thread-363): handling status request
2021-12-06 01:12:50.514868 (Thread-363): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8ef972f9-9d9c-4db5-946a-6bb3f6039a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d942b0>]}
2021-12-06 01:12:50.515305 (Thread-363): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 01:12:50.521035 (Thread-364): handling list request
2021-12-06 01:12:50.521226 (Thread-364): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8ef972f9-9d9c-4db5-946a-6bb3f6039a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4342790>]}
2021-12-06 01:12:50.554764 (Thread-364): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a425de50>]}
2021-12-06 01:12:50.554984 (Thread-364): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:12:50.556535 (Thread-364): sending response (<Response 1725 bytes [200 OK]>) to 10.0.26.110
2021-12-06 01:13:21.589989 (Thread-365): handling status request
2021-12-06 01:13:21.590337 (Thread-365): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc051790>]}
2021-12-06 01:13:21.590828 (Thread-365): sending response (<Response 1537 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:13:25.215023 (Thread-366): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 01:13:25.215339 (Thread-366): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 01:13:25.220359 (Thread-366): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc652250>]}
2021-12-06 01:13:26.284592 (Thread-367): handling status request
2021-12-06 01:13:26.284907 (Thread-367): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc518b80>]}
2021-12-06 01:13:26.285394 (Thread-367): sending response (<Response 1212 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:13:26.368362 (Thread-368): handling status request
2021-12-06 01:13:26.368578 (Thread-368): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5bf1f0>]}
2021-12-06 01:13:26.368966 (Thread-368): sending response (<Response 1212 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:32:46.296168 (Thread-369): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 01:32:46.298224 (Thread-369): Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 01:32:46.343205 (Thread-369): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a414feb0>]}
2021-12-06 01:32:47.097656 (Thread-370): handling status request
2021-12-06 01:32:47.097998 (Thread-370): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c498bdc0>]}
2021-12-06 01:32:47.098501 (Thread-370): sending response (<Response 1243 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:32:47.128014 (Thread-371): handling status request
2021-12-06 01:32:47.128226 (Thread-371): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c48b79a0>]}
2021-12-06 01:32:47.128603 (Thread-371): sending response (<Response 1243 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:34:45.165578 (Thread-372): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:34:45.167672 (Thread-372): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 01:34:45.216859 (Thread-372): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a440c220>]}
2021-12-06 01:34:45.956418 (Thread-373): handling status request
2021-12-06 01:34:45.956733 (Thread-373): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4de460>]}
2021-12-06 01:34:45.957208 (Thread-373): sending response (<Response 1251 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:34:45.995533 (Thread-374): handling status request
2021-12-06 01:34:45.995752 (Thread-374): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4de8e0>]}
2021-12-06 01:34:45.996137 (Thread-374): sending response (<Response 1251 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:34:50.271410 (Thread-375): handling status request
2021-12-06 01:34:50.271749 (Thread-375): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4de7c0>]}
2021-12-06 01:34:50.272237 (Thread-375): sending response (<Response 1251 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:34:50.644131 (Thread-376): handling status request
2021-12-06 01:34:50.644373 (Thread-376): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4de8b0>]}
2021-12-06 01:34:50.644805 (Thread-376): sending response (<Response 1251 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:34:50.725554 (Thread-377): handling cli_args request
2021-12-06 01:34:50.725804 (Thread-377): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4c2220>]}
2021-12-06 01:34:52.636332 (Thread-377): sending response (<Response 138 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:34:52.671977 (MainThread): Partial parsing not enabled
2021-12-06 01:34:52.725185 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:34:52.727135 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:34:52.760779 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:34:52.764337 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:34:52.767427 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:34:52.771546 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:34:52.772755 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:34:52.780723 (MainThread): Parsing macros/core.sql
2021-12-06 01:34:52.784171 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:34:52.790335 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:34:52.799593 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:34:52.806144 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:34:52.809694 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:34:52.830859 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:34:52.846762 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:34:52.848274 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:34:52.877201 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:34:52.884038 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:34:52.896981 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:34:52.915305 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:34:52.924614 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:34:52.926291 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:34:52.927628 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:34:52.935452 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:34:52.936389 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:34:52.937987 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:34:52.939412 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:34:52.941692 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:34:52.943071 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:34:52.994788 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:34:52.996814 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:34:52.997868 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:34:52.999376 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:34:53.178099 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:34:53.189608 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:34:53.197109 (Thread-378): handling poll request
2021-12-06 01:34:53.197472 (Thread-378): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4c23d0>]}
2021-12-06 01:34:53.198664 (Thread-378): sending response (<Response 10293 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:34:53.192035 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:34:53.194507 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:34:53.198355 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:34:53.277803 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2456c52-e0f6-4614-be89-c1ec80ea6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc2df88e0>]}
2021-12-06 01:34:53.314968 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2456c52-e0f6-4614-be89-c1ec80ea6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc2df8e20>]}
2021-12-06 01:34:53.315170 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:34:53.316349 (MainThread): 
2021-12-06 01:34:53.316546 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:34:53.317400 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:34:53.329227 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:34:53.329295 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:34:53.329349 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:34:54.680984 (Thread-379): handling poll request
2021-12-06 01:34:54.681319 (Thread-379): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc51d610>]}
2021-12-06 01:34:54.681991 (Thread-379): sending response (<Response 4334 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:34:54.867330 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.54 seconds
2021-12-06 01:34:54.869145 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:34:55.323722 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:34:55.331245 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:34:55.331340 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:34:55.331404 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:34:56.150137 (Thread-380): handling poll request
2021-12-06 01:34:56.150480 (Thread-380): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4d5fa0>]}
2021-12-06 01:34:56.151036 (Thread-380): sending response (<Response 2263 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:34:56.611636 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.28 seconds
2021-12-06 01:34:56.613092 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:34:57.070893 (MainThread): 01:34:57 | Concurrency: 4 threads (target='default')
2021-12-06 01:34:57.071030 (MainThread): 01:34:57 | 
2021-12-06 01:34:57.072937 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:34:57.073234 (Thread-1): 01:34:57 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:34:57.073472 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:34:57.073571 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:34:57.074448 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:34:57.074665 (Thread-2): 01:34:57 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:34:57.074906 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:34:57.074978 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:34:57.076070 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:34:57.076952 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:34:57.077128 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:34:57.077334 (Thread-3): 01:34:57 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:34:57.077548 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:34:57.077613 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:34:57.078708 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:34:57.094087 (Thread-3): finished collecting timing info
2021-12-06 01:34:57.099191 (Thread-2): finished collecting timing info
2021-12-06 01:34:57.109386 (Thread-1): finished collecting timing info
2021-12-06 01:34:57.135285 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:34:57.137314 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:34:57.138722 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:34:57.157480 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:34:57.157557 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:34:57.157614 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:34:57.158677 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:34:57.158749 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:34:57.158803 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:34:57.159444 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:34:57.159522 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:34:57.159576 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:34:57.634650 (Thread-381): handling poll request
2021-12-06 01:34:57.635017 (Thread-381): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4d5880>]}
2021-12-06 01:34:57.635955 (Thread-381): sending response (<Response 14241 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:34:58.815507 (Thread-3): SQL status: SUCCESS 1 in 1.66 seconds
2021-12-06 01:34:58.821895 (Thread-3): finished collecting timing info
2021-12-06 01:34:58.822061 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:34:58.860432 (Thread-2): SQL status: SUCCESS 1 in 1.70 seconds
2021-12-06 01:34:58.861583 (Thread-2): finished collecting timing info
2021-12-06 01:34:58.861694 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:34:58.953648 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-12-06 01:34:58.954771 (Thread-1): finished collecting timing info
2021-12-06 01:34:58.954877 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:34:59.225730 (Thread-382): handling poll request
2021-12-06 01:34:59.226060 (Thread-382): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc56fe50>]}
2021-12-06 01:34:59.226659 (Thread-382): sending response (<Response 3555 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:34:59.265249 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2456c52-e0f6-4614-be89-c1ec80ea6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc1fcabb0>]}
2021-12-06 01:34:59.265644 (Thread-3): 01:34:59 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.19s]
2021-12-06 01:34:59.265731 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:34:59.304018 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2456c52-e0f6-4614-be89-c1ec80ea6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc02cd130>]}
2021-12-06 01:34:59.304320 (Thread-2): 01:34:59 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.23s]
2021-12-06 01:34:59.304401 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:34:59.305019 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:34:59.305255 (Thread-4): 01:34:59 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:34:59.305487 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:34:59.305559 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:34:59.307964 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:34:59.323522 (Thread-4): finished collecting timing info
2021-12-06 01:34:59.339800 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:34:59.355391 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:34:59.355472 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 01:34:59.355529 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:34:59.404341 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2456c52-e0f6-4614-be89-c1ec80ea6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc1f744c0>]}
2021-12-06 01:34:59.404666 (Thread-1): 01:34:59 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.33s]
2021-12-06 01:34:59.404754 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:35:00.742279 (Thread-383): handling poll request
2021-12-06 01:35:00.742926 (Thread-383): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc56f640>]}
2021-12-06 01:35:00.743606 (Thread-383): sending response (<Response 8810 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:35:02.252380 (Thread-384): handling poll request
2021-12-06 01:35:02.252700 (Thread-384): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc51daf0>]}
2021-12-06 01:35:02.253219 (Thread-384): sending response (<Response 287 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:35:02.966708 (Thread-4): SQL status: SUCCESS 1 in 3.61 seconds
2021-12-06 01:35:02.973846 (Thread-4): finished collecting timing info
2021-12-06 01:35:02.974061 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:35:03.424050 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2456c52-e0f6-4614-be89-c1ec80ea6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc1ef2580>]}
2021-12-06 01:35:03.424435 (Thread-4): 01:35:03 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 4.12s]
2021-12-06 01:35:03.424523 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:35:03.425452 (Thread-2): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:35:03.425695 (Thread-2): 01:35:03 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:35:03.425920 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:35:03.426028 (Thread-2): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:35:03.428373 (Thread-2): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:35:03.443982 (Thread-2): finished collecting timing info
2021-12-06 01:35:03.445972 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:35:03.462136 (Thread-2): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:35:03.462214 (Thread-2): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 01:35:03.462272 (Thread-2): Opening a new connection, currently in state closed
2021-12-06 01:35:03.696334 (Thread-385): handling poll request
2021-12-06 01:35:03.696689 (Thread-385): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5e1f70>]}
2021-12-06 01:35:03.697398 (Thread-385): sending response (<Response 7708 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:35:05.172569 (Thread-386): handling poll request
2021-12-06 01:35:05.172897 (Thread-386): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc526610>]}
2021-12-06 01:35:05.173384 (Thread-386): sending response (<Response 287 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:35:06.393756 (Thread-2): SQL status: SUCCESS 1 in 2.93 seconds
2021-12-06 01:35:06.395155 (Thread-2): finished collecting timing info
2021-12-06 01:35:06.395287 (Thread-2): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:35:06.745559 (Thread-387): handling poll request
2021-12-06 01:35:06.745839 (Thread-387): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc526310>]}
2021-12-06 01:35:06.746379 (Thread-387): sending response (<Response 1381 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:35:06.843834 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2456c52-e0f6-4614-be89-c1ec80ea6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc02a7dc0>]}
2021-12-06 01:35:06.844180 (Thread-2): 01:35:06 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 3.42s]
2021-12-06 01:35:06.844263 (Thread-2): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:35:06.845737 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:35:06.846051 (MainThread): 01:35:06 | 
2021-12-06 01:35:06.846120 (MainThread): 01:35:06 | Finished running 3 view models, 2 table models in 13.53s.
2021-12-06 01:35:06.846168 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:35:06.846208 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:35:06.846243 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:35:06.846277 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 01:35:06.846310 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:35:06.903603 (MainThread): 
2021-12-06 01:35:06.903705 (MainThread): Completed successfully
2021-12-06 01:35:06.903768 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:35:08.208621 (Thread-388): handling poll request
2021-12-06 01:35:08.208947 (Thread-388): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4ecd30>]}
2021-12-06 01:35:08.210269 (Thread-388): sending response (<Response 20013 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:35:09.099074 (Thread-389): handling status request
2021-12-06 01:35:09.099403 (Thread-389): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b9580>]}
2021-12-06 01:35:09.099937 (Thread-389): sending response (<Response 1251 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:35:09.132567 (Thread-390): handling status request
2021-12-06 01:35:09.132785 (Thread-390): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4adee0>]}
2021-12-06 01:35:09.156087 (Thread-390): sending response (<Response 1251 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:35:14.414616 (Thread-391): handling status request
2021-12-06 01:35:14.414913 (Thread-391): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6edcd0>]}
2021-12-06 01:35:14.415358 (Thread-391): sending response (<Response 1251 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:35:14.806644 (Thread-392): handling status request
2021-12-06 01:35:14.806958 (Thread-392): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6ed9a0>]}
2021-12-06 01:35:14.807425 (Thread-392): sending response (<Response 1251 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:35:14.848936 (Thread-393): handling cli_args request
2021-12-06 01:35:14.849140 (Thread-393): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6ed670>]}
2021-12-06 01:35:16.765778 (Thread-393): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:35:16.801566 (MainThread): Partial parsing not enabled
2021-12-06 01:35:16.852871 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:35:16.854806 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:35:16.888233 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:35:16.891813 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:35:16.894915 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:35:16.899042 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:35:16.900271 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:35:16.908250 (MainThread): Parsing macros/core.sql
2021-12-06 01:35:16.911628 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:35:16.917739 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:35:16.926988 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:35:16.933464 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:35:16.937014 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:35:16.958066 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:35:16.973849 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:35:16.975367 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:35:17.004198 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:35:17.010989 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:35:17.023830 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:35:17.042053 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:35:17.051299 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:35:17.052934 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:35:17.054286 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:35:17.062014 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:35:17.062941 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:35:17.064526 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:35:17.065927 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:35:17.068212 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:35:17.069567 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:35:17.121051 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:35:17.123107 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:35:17.124162 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:35:17.125630 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:35:17.235816 (Thread-394): handling poll request
2021-12-06 01:35:17.236143 (Thread-394): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a418d700>]}
2021-12-06 01:35:17.237163 (Thread-394): sending response (<Response 9687 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:35:17.303140 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:35:17.314667 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:35:17.317149 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:35:17.319633 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:35:17.323302 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:35:17.397322 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71796f1d-6568-4e5f-ab85-c545d5ab101f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44f9af8a00>]}
2021-12-06 01:35:17.425032 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71796f1d-6568-4e5f-ab85-c545d5ab101f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44f9af8f40>]}
2021-12-06 01:35:17.425236 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:35:17.426400 (MainThread): 
2021-12-06 01:35:17.426594 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:35:17.427484 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:35:17.439032 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:35:17.439100 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:35:17.439154 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 01:35:18.754184 (Thread-395): handling poll request
2021-12-06 01:35:18.754491 (Thread-395): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49cfa00>]}
2021-12-06 01:35:18.755107 (Thread-395): sending response (<Response 4991 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:35:18.958616 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.52 seconds
2021-12-06 01:35:18.960669 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:35:19.405975 (MainThread): 01:35:19 | Concurrency: 4 threads (target='default')
2021-12-06 01:35:19.406137 (MainThread): 01:35:19 | 
2021-12-06 01:35:19.408406 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:35:19.408691 (Thread-1): 01:35:19 | 1 of 2 START test not_null_stg_customers_customer_id................. [RUN]
2021-12-06 01:35:19.408986 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:35:19.409219 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:35:19.410965 (Thread-2): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:35:19.411096 (Thread-2): 01:35:19 | 2 of 2 START test unique_stg_customers_customer_id................... [RUN]
2021-12-06 01:35:19.411337 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:35:19.411411 (Thread-2): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:35:19.421568 (Thread-2): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:35:19.427957 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:35:19.451949 (Thread-2): finished collecting timing info
2021-12-06 01:35:19.457296 (Thread-1): finished collecting timing info
2021-12-06 01:35:19.477512 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:35:19.478826 (Thread-2): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:35:19.504941 (Thread-1): Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:35:19.505041 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt_pstulnikov.stg_customers
where customer_id is null



      
    ) dbt_internal_test
2021-12-06 01:35:19.505111 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:35:19.510195 (Thread-2): Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:35:19.510284 (Thread-2): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.dbt_pstulnikov.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-06 01:35:19.510342 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:35:20.203737 (Thread-396): handling poll request
2021-12-06 01:35:20.204059 (Thread-396): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c48c59a0>]}
2021-12-06 01:35:20.204773 (Thread-396): sending response (<Response 11298 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:35:21.227797 (Thread-2): SQL status: SUCCESS 1 in 1.72 seconds
2021-12-06 01:35:21.230048 (Thread-2): finished collecting timing info
2021-12-06 01:35:21.230181 (Thread-2): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
2021-12-06 01:35:21.457058 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2021-12-06 01:35:21.458366 (Thread-1): finished collecting timing info
2021-12-06 01:35:21.458493 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
2021-12-06 01:35:21.652811 (Thread-397): handling poll request
2021-12-06 01:35:21.653078 (Thread-397): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c48c5910>]}
2021-12-06 01:35:21.653604 (Thread-397): sending response (<Response 2717 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:35:21.671870 (Thread-2): 01:35:21 | 2 of 2 PASS unique_stg_customers_customer_id......................... [PASS in 2.26s]
2021-12-06 01:35:21.671992 (Thread-2): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:35:21.908178 (Thread-1): 01:35:21 | 1 of 2 PASS not_null_stg_customers_customer_id....................... [PASS in 2.50s]
2021-12-06 01:35:21.908293 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:35:21.909694 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:35:21.909986 (MainThread): 01:35:21 | 
2021-12-06 01:35:21.910059 (MainThread): 01:35:21 | Finished running 2 tests in 4.48s.
2021-12-06 01:35:21.910108 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:35:21.910147 (MainThread): Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
2021-12-06 01:35:21.910183 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 01:35:21.979789 (MainThread): 
2021-12-06 01:35:21.979900 (MainThread): Completed successfully
2021-12-06 01:35:21.979961 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-12-06 01:35:23.143377 (Thread-398): handling poll request
2021-12-06 01:35:23.143688 (Thread-398): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4154e80>]}
2021-12-06 01:35:23.144739 (Thread-398): sending response (<Response 10223 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:35:24.097598 (Thread-399): handling status request
2021-12-06 01:35:24.097911 (Thread-399): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4154f70>]}
2021-12-06 01:35:24.098455 (Thread-399): sending response (<Response 1251 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:35:24.125997 (Thread-400): handling status request
2021-12-06 01:35:24.126209 (Thread-400): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4154c10>]}
2021-12-06 01:35:24.126616 (Thread-400): sending response (<Response 1251 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:39:25.735290 (Thread-401): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:39:25.737091 (Thread-401): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 01:39:26.543726 (Thread-402): handling status request
2021-12-06 01:39:26.544029 (Thread-402): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c498b970>]}
2021-12-06 01:39:26.544505 (Thread-402): sending response (<Response 1147 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:39:26.598391 (Thread-403): handling status request
2021-12-06 01:39:26.598603 (Thread-403): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4b0e20>]}
2021-12-06 01:39:26.598964 (Thread-403): sending response (<Response 1147 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:39:46.340774 (Thread-404): handling status request
2021-12-06 01:39:46.341095 (Thread-404): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4b07c0>]}
2021-12-06 01:39:46.341560 (Thread-404): sending response (<Response 1147 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:39:46.691847 (Thread-405): handling status request
2021-12-06 01:39:46.692140 (Thread-405): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4b06d0>]}
2021-12-06 01:39:46.692616 (Thread-405): sending response (<Response 1147 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:39:46.778717 (Thread-406): handling cli_args request
2021-12-06 01:39:46.778925 (Thread-406): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4b09d0>]}
2021-12-06 01:39:46.779263 (Thread-406): sending response (<Response 991 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:39:58.944828 (Thread-407): handling status request
2021-12-06 01:39:58.945147 (Thread-407): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6df1f0>]}
2021-12-06 01:39:58.945604 (Thread-407): sending response (<Response 1147 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:39:59.025893 (Thread-408): handling status request
2021-12-06 01:39:59.026182 (Thread-408): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6df460>]}
2021-12-06 01:39:59.026598 (Thread-408): sending response (<Response 1147 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:40:11.521084 (Thread-409): handling status request
2021-12-06 01:40:11.521478 (Thread-409): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4de0a0>]}
2021-12-06 01:40:11.521963 (Thread-409): sending response (<Response 1147 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:40:11.879516 (Thread-410): handling status request
2021-12-06 01:40:11.879815 (Thread-410): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6dfaf0>]}
2021-12-06 01:40:11.880260 (Thread-410): sending response (<Response 1147 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:40:11.966749 (Thread-411): handling cli_args request
2021-12-06 01:40:11.966962 (Thread-411): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6dffa0>]}
2021-12-06 01:40:11.967264 (Thread-411): sending response (<Response 991 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:40:15.930192 (Thread-412): handling status request
2021-12-06 01:40:15.930501 (Thread-412): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5c78e0>]}
2021-12-06 01:40:15.930944 (Thread-412): sending response (<Response 1147 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:40:15.933110 (Thread-413): handling status request
2021-12-06 01:40:15.933327 (Thread-413): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5c71c0>]}
2021-12-06 01:40:15.933680 (Thread-413): sending response (<Response 1147 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:40:23.055164 (Thread-414): handling status request
2021-12-06 01:40:23.055492 (Thread-414): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc610640>]}
2021-12-06 01:40:23.055954 (Thread-414): sending response (<Response 1147 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:40:23.407184 (Thread-415): handling status request
2021-12-06 01:40:23.407406 (Thread-415): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc610580>]}
2021-12-06 01:40:23.407818 (Thread-415): sending response (<Response 1147 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:40:23.501177 (Thread-416): handling cli_args request
2021-12-06 01:40:23.501375 (Thread-416): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6109d0>]}
2021-12-06 01:40:23.501662 (Thread-416): sending response (<Response 991 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:40:28.286144 (Thread-417): handling status request
2021-12-06 01:40:28.286461 (Thread-417): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4a4af0>]}
2021-12-06 01:40:28.286917 (Thread-417): sending response (<Response 1147 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:40:28.339529 (Thread-418): handling status request
2021-12-06 01:40:28.339768 (Thread-418): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41549a0>]}
2021-12-06 01:40:28.340201 (Thread-418): sending response (<Response 1147 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:40:50.293041 (Thread-419): handling status request
2021-12-06 01:40:50.293512 (Thread-419): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b2cd0>]}
2021-12-06 01:40:50.294238 (Thread-419): sending response (<Response 1147 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:40:50.653534 (Thread-420): handling status request
2021-12-06 01:40:50.653747 (Thread-420): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc610490>]}
2021-12-06 01:40:50.654156 (Thread-420): sending response (<Response 1147 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:40:50.790557 (Thread-421): handling cli_args request
2021-12-06 01:40:50.790830 (Thread-421): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc610220>]}
2021-12-06 01:40:50.815478 (Thread-421): sending response (<Response 991 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:41:09.418162 (Thread-422): handling status request
2021-12-06 01:41:09.418475 (Thread-422): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5c7250>]}
2021-12-06 01:41:09.418935 (Thread-422): sending response (<Response 1147 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:41:09.432386 (Thread-423): handling status request
2021-12-06 01:41:09.432582 (Thread-423): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5c70a0>]}
2021-12-06 01:41:09.432921 (Thread-423): sending response (<Response 1147 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:41:12.187217 (Thread-424): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:41:12.187538 (Thread-424): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 01:41:12.246147 (Thread-424): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40acbe0>]}
2021-12-06 01:41:12.984394 (Thread-425): handling status request
2021-12-06 01:41:12.984723 (Thread-425): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4154d00>]}
2021-12-06 01:41:12.985218 (Thread-425): sending response (<Response 1251 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:41:13.003947 (Thread-426): handling status request
2021-12-06 01:41:13.004156 (Thread-426): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc051d90>]}
2021-12-06 01:41:13.004508 (Thread-426): sending response (<Response 1251 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:41:17.309282 (Thread-427): handling status request
2021-12-06 01:41:17.309608 (Thread-427): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40ac670>]}
2021-12-06 01:41:17.310120 (Thread-427): sending response (<Response 1251 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:41:17.671894 (Thread-428): handling status request
2021-12-06 01:41:17.672215 (Thread-428): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40ac040>]}
2021-12-06 01:41:17.672678 (Thread-428): sending response (<Response 1251 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:41:17.782578 (Thread-429): handling cli_args request
2021-12-06 01:41:17.782853 (Thread-429): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40ac970>]}
2021-12-06 01:41:19.713372 (Thread-429): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:41:19.749539 (MainThread): Partial parsing not enabled
2021-12-06 01:41:19.801311 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:41:19.803222 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:41:19.836878 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:41:19.840463 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:41:19.843421 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:41:19.847691 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:41:19.848909 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:41:19.857058 (MainThread): Parsing macros/core.sql
2021-12-06 01:41:19.860528 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:41:19.866880 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:41:19.876091 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:41:19.882911 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:41:19.886581 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:41:19.908640 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:41:19.924724 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:41:19.926292 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:41:19.955918 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:41:19.962779 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:41:19.975731 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:41:19.994142 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:41:20.003553 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:41:20.005225 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:41:20.006586 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:41:20.014389 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:41:20.015328 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:41:20.016910 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:41:20.018342 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:41:20.020674 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:41:20.022036 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:41:20.074210 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:41:20.076256 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:41:20.077317 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:41:20.078818 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:41:20.198598 (Thread-430): handling poll request
2021-12-06 01:41:20.198951 (Thread-430): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41d9d60>]}
2021-12-06 01:41:20.200103 (Thread-430): sending response (<Response 9706 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:41:20.259089 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:41:20.270723 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:41:20.273121 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:41:20.275576 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:41:20.279257 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:41:20.364617 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8acd691b-6ef9-4950-926b-8b7d56a2e154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601b538df0>]}
2021-12-06 01:41:20.392640 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8acd691b-6ef9-4950-926b-8b7d56a2e154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601be6e310>]}
2021-12-06 01:41:20.392836 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:41:20.393876 (MainThread): 
2021-12-06 01:41:20.394099 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:41:20.394779 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:41:20.446129 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:41:20.446212 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:41:20.446267 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:41:21.795265 (Thread-431): handling poll request
2021-12-06 01:41:21.795589 (Thread-431): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40716d0>]}
2021-12-06 01:41:21.796229 (Thread-431): sending response (<Response 4961 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:41:22.062454 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.62 seconds
2021-12-06 01:41:22.064175 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:41:22.516300 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:41:22.523339 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:41:22.523443 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:41:22.523508 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:41:23.282543 (Thread-432): handling poll request
2021-12-06 01:41:23.282881 (Thread-432): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4056220>]}
2021-12-06 01:41:23.283466 (Thread-432): sending response (<Response 2283 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:41:23.798547 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.28 seconds
2021-12-06 01:41:23.800025 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:41:24.299273 (MainThread): 01:41:24 | Concurrency: 4 threads (target='default')
2021-12-06 01:41:24.299413 (MainThread): 01:41:24 | 
2021-12-06 01:41:24.301328 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:41:24.301609 (Thread-1): 01:41:24 | 1 of 1 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:41:24.301834 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:41:24.301956 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:41:24.303563 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:41:24.318797 (Thread-1): finished collecting timing info
2021-12-06 01:41:24.339158 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:41:24.354988 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:41:24.355067 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:41:24.355123 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:41:24.748074 (Thread-433): handling poll request
2021-12-06 01:41:24.748323 (Thread-433): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4066310>]}
2021-12-06 01:41:24.748948 (Thread-433): sending response (<Response 5639 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:41:25.717032 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-12-06 01:41:25.723446 (Thread-1): finished collecting timing info
2021-12-06 01:41:25.723576 (Thread-1): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:41:26.171719 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8acd691b-6ef9-4950-926b-8b7d56a2e154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60181f4280>]}
2021-12-06 01:41:26.172130 (Thread-1): 01:41:26 | 1 of 1 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 1.87s]
2021-12-06 01:41:26.172220 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:41:26.173740 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:41:26.174053 (MainThread): 01:41:26 | 
2021-12-06 01:41:26.174122 (MainThread): 01:41:26 | Finished running 1 view model in 5.78s.
2021-12-06 01:41:26.174170 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:41:26.174209 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:41:26.230602 (MainThread): 
2021-12-06 01:41:26.230704 (MainThread): Completed successfully
2021-12-06 01:41:26.230764 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-12-06 01:41:26.297846 (Thread-434): handling poll request
2021-12-06 01:41:26.298170 (Thread-434): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a405d940>]}
2021-12-06 01:41:26.298803 (Thread-434): sending response (<Response 5288 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:41:27.775505 (Thread-435): handling poll request
2021-12-06 01:41:27.775845 (Thread-435): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a405d8e0>]}
2021-12-06 01:41:27.776701 (Thread-435): sending response (<Response 2985 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:41:28.682927 (Thread-436): handling status request
2021-12-06 01:41:28.683253 (Thread-436): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a405da00>]}
2021-12-06 01:41:28.683758 (Thread-436): sending response (<Response 1251 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:41:28.693512 (Thread-437): handling status request
2021-12-06 01:41:28.693727 (Thread-437): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a405dd90>]}
2021-12-06 01:41:28.694117 (Thread-437): sending response (<Response 1251 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:41:34.868122 (Thread-438): handling status request
2021-12-06 01:41:34.868446 (Thread-438): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a405df70>]}
2021-12-06 01:41:34.868903 (Thread-438): sending response (<Response 1251 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:41:35.183359 (Thread-439): handling status request
2021-12-06 01:41:35.183689 (Thread-439): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40320d0>]}
2021-12-06 01:41:35.184163 (Thread-439): sending response (<Response 1251 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:41:35.340796 (Thread-440): handling cli_args request
2021-12-06 01:41:35.341020 (Thread-440): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4032340>]}
2021-12-06 01:41:37.259452 (Thread-440): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:41:37.295188 (MainThread): Partial parsing not enabled
2021-12-06 01:41:37.348325 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:41:37.350233 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:41:37.383905 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:41:37.387465 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:41:37.390503 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:41:37.394691 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:41:37.395910 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:41:37.403964 (MainThread): Parsing macros/core.sql
2021-12-06 01:41:37.407421 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:41:37.413884 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:41:37.423118 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:41:37.429785 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:41:37.433394 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:41:37.454630 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:41:37.470606 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:41:37.472108 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:41:37.500987 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:41:37.507754 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:41:37.520726 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:41:37.538996 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:41:37.548274 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:41:37.549903 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:41:37.551261 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:41:37.559070 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:41:37.560031 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:41:37.561616 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:41:37.563059 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:41:37.565363 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:41:37.566741 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:41:37.618720 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:41:37.620755 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:41:37.621807 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:41:37.623323 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:41:37.730600 (Thread-441): handling poll request
2021-12-06 01:41:37.730869 (Thread-441): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4032a00>]}
2021-12-06 01:41:37.731793 (Thread-441): sending response (<Response 9687 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:41:37.804199 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:41:37.815686 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:41:37.818116 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:41:37.820589 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:41:37.824259 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:41:37.907951 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40d8142d-0b74-4db5-b6a2-8902020d9342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480093be80>]}
2021-12-06 01:41:37.940714 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40d8142d-0b74-4db5-b6a2-8902020d9342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480126e340>]}
2021-12-06 01:41:37.940916 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:41:37.942189 (MainThread): 
2021-12-06 01:41:37.942396 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:41:37.943309 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:41:37.993532 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:41:37.993612 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:41:37.993667 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 01:41:39.216006 (Thread-442): handling poll request
2021-12-06 01:41:39.216323 (Thread-442): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4032820>]}
2021-12-06 01:41:39.216968 (Thread-442): sending response (<Response 4991 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:41:39.475364 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.48 seconds
2021-12-06 01:41:39.477411 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:41:39.937723 (MainThread): 01:41:39 | Concurrency: 4 threads (target='default')
2021-12-06 01:41:39.937847 (MainThread): 01:41:39 | 
2021-12-06 01:41:39.939934 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9
2021-12-06 01:41:39.940106 (Thread-1): 01:41:39 | 1 of 3 START test accepted_values_stg_orders_status__completed__shipped__returned__placed [RUN]
2021-12-06 01:41:39.940340 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9".
2021-12-06 01:41:39.940441 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9
2021-12-06 01:41:39.941220 (Thread-2): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:41:39.941352 (Thread-2): 01:41:39 | 2 of 3 START test not_null_stg_customers_customer_id................. [RUN]
2021-12-06 01:41:39.941576 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:41:39.941643 (Thread-2): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:41:39.946437 (Thread-3): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:41:39.946570 (Thread-3): 01:41:39 | 3 of 3 START test unique_stg_customers_customer_id................... [RUN]
2021-12-06 01:41:39.946785 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:41:39.946851 (Thread-3): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:41:39.954434 (Thread-3): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:41:39.959459 (Thread-2): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:41:39.964139 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9"
2021-12-06 01:41:39.973432 (Thread-3): finished collecting timing info
2021-12-06 01:41:39.978603 (Thread-1): finished collecting timing info
2021-12-06 01:41:39.998020 (Thread-3): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:41:39.999030 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9"
2021-12-06 01:41:39.999180 (Thread-2): finished collecting timing info
2021-12-06 01:41:40.000537 (Thread-2): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:41:40.011795 (Thread-1): Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9".
2021-12-06 01:41:40.011879 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from analytics.dbt_pstulnikov.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','placed'
)



      
    ) dbt_internal_test
2021-12-06 01:41:40.011948 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:41:40.017862 (Thread-3): Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:41:40.017962 (Thread-3): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.dbt_pstulnikov.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-06 01:41:40.018020 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:41:40.021095 (Thread-2): Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:41:40.021178 (Thread-2): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt_pstulnikov.stg_customers
where customer_id is null



      
    ) dbt_internal_test
2021-12-06 01:41:40.021233 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:41:40.670791 (Thread-443): handling poll request
2021-12-06 01:41:40.671093 (Thread-443): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a406aa90>]}
2021-12-06 01:41:40.671929 (Thread-443): sending response (<Response 17144 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:41:41.547851 (Thread-2): SQL status: SUCCESS 1 in 1.53 seconds
2021-12-06 01:41:41.550004 (Thread-2): finished collecting timing info
2021-12-06 01:41:41.550144 (Thread-2): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
2021-12-06 01:41:41.552278 (Thread-3): SQL status: SUCCESS 1 in 1.53 seconds
2021-12-06 01:41:41.553441 (Thread-3): finished collecting timing info
2021-12-06 01:41:41.553557 (Thread-3): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
2021-12-06 01:41:41.757991 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2021-12-06 01:41:41.759234 (Thread-1): finished collecting timing info
2021-12-06 01:41:41.759365 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9: Close
2021-12-06 01:41:42.006376 (Thread-2): 01:41:42 | 2 of 3 PASS not_null_stg_customers_customer_id....................... [PASS in 2.06s]
2021-12-06 01:41:42.006489 (Thread-2): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:41:42.008397 (Thread-3): 01:41:42 | 3 of 3 PASS unique_stg_customers_customer_id......................... [PASS in 2.06s]
2021-12-06 01:41:42.008512 (Thread-3): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:41:42.143965 (Thread-444): handling poll request
2021-12-06 01:41:42.144213 (Thread-444): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4066a90>]}
2021-12-06 01:41:42.144806 (Thread-444): sending response (<Response 5869 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:41:42.202943 (Thread-1): 01:41:42 | 1 of 3 FAIL 1 accepted_values_stg_orders_status__completed__shipped__returned__placed [FAIL 1 in 2.26s]
2021-12-06 01:41:42.203075 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9
2021-12-06 01:41:42.204477 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:41:42.204742 (MainThread): 01:41:42 | 
2021-12-06 01:41:42.204810 (MainThread): 01:41:42 | Finished running 3 tests in 4.26s.
2021-12-06 01:41:42.204859 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:41:42.204899 (MainThread): Connection 'test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed.63879ca2d9' was properly closed.
2021-12-06 01:41:42.204934 (MainThread): Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
2021-12-06 01:41:42.204968 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 01:41:42.263204 (MainThread): 
2021-12-06 01:41:42.263312 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 01:41:42.263368 (MainThread): 
2021-12-06 01:41:42.263431 (MainThread): Failure in test accepted_values_stg_orders_status__completed__shipped__returned__placed (models/staging/jaffle_shop/stg_jaffle_shop.yml)
2021-12-06 01:41:42.263474 (MainThread):   Got 1 result, configured to fail if != 0
2021-12-06 01:41:42.263516 (MainThread): 
2021-12-06 01:41:42.263558 (MainThread):   compiled SQL at target/compiled/jaffle_shop/models/staging/jaffle_shop/stg_jaffle_shop.yml/schema_test/accepted_values_stg_orders_b12cba0306385c9edafc2a5147fb1e87.sql
2021-12-06 01:41:42.263613 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-12-06 01:41:43.618997 (Thread-445): handling poll request
2021-12-06 01:41:43.619325 (Thread-445): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4056430>]}
2021-12-06 01:41:43.620488 (Thread-445): sending response (<Response 15350 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:41:44.507541 (Thread-446): handling status request
2021-12-06 01:41:44.507842 (Thread-446): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40546a0>]}
2021-12-06 01:41:44.508323 (Thread-446): sending response (<Response 1251 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:41:44.558944 (Thread-447): handling status request
2021-12-06 01:41:44.559187 (Thread-447): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40545b0>]}
2021-12-06 01:41:44.559617 (Thread-447): sending response (<Response 1251 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:43:29.184947 (Thread-448): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:43:29.186837 (Thread-448): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 01:43:29.190528 (Thread-448): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:43:29.974987 (Thread-449): handling status request
2021-12-06 01:43:29.975318 (Thread-449): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40d1df0>]}
2021-12-06 01:43:29.975813 (Thread-449): sending response (<Response 1465 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:43:30.013786 (Thread-450): handling status request
2021-12-06 01:43:30.014018 (Thread-450): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40d1ac0>]}
2021-12-06 01:43:30.014381 (Thread-450): sending response (<Response 1465 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:44:12.494216 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:44:12.570195 (Thread-451): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:44:12.570547 (Thread-451): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 01:44:12.573883 (Thread-451): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:44:12.628857 (Thread-451): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd525b0>]}
2021-12-06 01:44:13.398601 (Thread-452): handling status request
2021-12-06 01:44:13.398912 (Thread-452): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd52640>]}
2021-12-06 01:44:13.427838 (Thread-452): sending response (<Response 1551 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:44:13.474527 (Thread-453): handling status request
2021-12-06 01:44:13.474766 (Thread-453): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd52a90>]}
2021-12-06 01:44:13.475165 (Thread-453): sending response (<Response 1551 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:44:17.055505 (Thread-454): handling status request
2021-12-06 01:44:17.055859 (Thread-454): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd7c070>]}
2021-12-06 01:44:17.056379 (Thread-454): sending response (<Response 1551 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:44:17.435699 (Thread-455): handling status request
2021-12-06 01:44:17.435943 (Thread-455): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd52280>]}
2021-12-06 01:44:17.436388 (Thread-455): sending response (<Response 1551 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:44:17.544713 (Thread-456): handling cli_args request
2021-12-06 01:44:17.544942 (Thread-456): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd52a90>]}
2021-12-06 01:44:17.555176 (Thread-456): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:44:19.502057 (Thread-456): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:44:19.538225 (MainThread): Partial parsing not enabled
2021-12-06 01:44:19.594008 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:44:19.595938 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:44:19.629879 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:44:19.633457 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:44:19.636419 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:44:19.640575 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:44:19.641800 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:44:19.649948 (MainThread): Parsing macros/core.sql
2021-12-06 01:44:19.653381 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:44:19.659533 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:44:19.668747 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:44:19.675410 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:44:19.679080 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:44:19.700442 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:44:19.716470 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:44:19.717996 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:44:19.747992 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:44:19.754840 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:44:19.767823 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:44:19.786225 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:44:19.795625 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:44:19.797310 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:44:19.798677 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:44:19.806493 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:44:19.807426 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:44:19.809015 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:44:19.810478 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:44:19.812769 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:44:19.814142 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:44:19.866400 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:44:19.868450 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:44:19.869756 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:44:19.871449 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:44:19.987476 (Thread-457): handling poll request
2021-12-06 01:44:19.987769 (Thread-457): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd9e9a0>]}
2021-12-06 01:44:19.988825 (Thread-457): sending response (<Response 9686 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:44:20.053332 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:44:20.064922 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:44:20.067327 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:44:20.069783 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:44:20.073449 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:44:20.159704 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08738cec-3200-4058-8fba-e36a4be6f7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9e2f9f70>]}
2021-12-06 01:44:20.183454 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08738cec-3200-4058-8fba-e36a4be6f7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9e2f9a90>]}
2021-12-06 01:44:20.183658 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:44:20.184895 (MainThread): 
2021-12-06 01:44:20.185096 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:44:20.185991 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:44:20.236994 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:44:20.237076 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:44:20.237131 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:44:21.502463 (Thread-458): handling poll request
2021-12-06 01:44:21.502795 (Thread-458): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd0de80>]}
2021-12-06 01:44:21.503422 (Thread-458): sending response (<Response 4941 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:44:21.711042 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.47 seconds
2021-12-06 01:44:21.712783 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:44:22.158835 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:44:22.165809 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:44:22.165902 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:44:22.165988 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:44:22.986252 (Thread-459): handling poll request
2021-12-06 01:44:22.986575 (Thread-459): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd32490>]}
2021-12-06 01:44:22.987140 (Thread-459): sending response (<Response 2263 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:44:23.571317 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.41 seconds
2021-12-06 01:44:23.572796 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:44:24.015636 (MainThread): 01:44:24 | Concurrency: 4 threads (target='default')
2021-12-06 01:44:24.015771 (MainThread): 01:44:24 | 
2021-12-06 01:44:24.017716 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:44:24.018022 (Thread-1): 01:44:24 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:44:24.018255 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:44:24.018354 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:44:24.019194 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:44:24.019429 (Thread-2): 01:44:24 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:44:24.019659 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:44:24.019728 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:44:24.020847 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:44:24.021720 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:44:24.021903 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:44:24.022134 (Thread-3): 01:44:24 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:44:24.022349 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:44:24.022575 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:44:24.023466 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:44:24.039091 (Thread-3): finished collecting timing info
2021-12-06 01:44:24.044413 (Thread-1): finished collecting timing info
2021-12-06 01:44:24.049498 (Thread-2): finished collecting timing info
2021-12-06 01:44:24.078367 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:44:24.078724 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:44:24.080160 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:44:24.097821 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:44:24.097907 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:44:24.097996 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:44:24.099119 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:44:24.099190 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:44:24.099245 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:44:24.100219 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:44:24.100291 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:44:24.100347 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:44:24.500362 (Thread-460): handling poll request
2021-12-06 01:44:24.500655 (Thread-460): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcbc790>]}
2021-12-06 01:44:24.501467 (Thread-460): sending response (<Response 14240 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:44:25.715080 (Thread-2): SQL status: SUCCESS 1 in 1.61 seconds
2021-12-06 01:44:25.722126 (Thread-2): finished collecting timing info
2021-12-06 01:44:25.722307 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:44:25.758600 (Thread-3): SQL status: SUCCESS 1 in 1.66 seconds
2021-12-06 01:44:25.759714 (Thread-3): finished collecting timing info
2021-12-06 01:44:25.759833 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:44:25.771478 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2021-12-06 01:44:25.772522 (Thread-1): finished collecting timing info
2021-12-06 01:44:25.772622 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:44:26.031260 (Thread-461): handling poll request
2021-12-06 01:44:26.031563 (Thread-461): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcbccd0>]}
2021-12-06 01:44:26.032133 (Thread-461): sending response (<Response 3556 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:44:26.176753 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08738cec-3200-4058-8fba-e36a4be6f7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9c7ac1c0>]}
2021-12-06 01:44:26.177186 (Thread-2): 01:44:26 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.16s]
2021-12-06 01:44:26.177282 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:44:26.210863 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08738cec-3200-4058-8fba-e36a4be6f7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9d4d3700>]}
2021-12-06 01:44:26.211171 (Thread-3): 01:44:26 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.19s]
2021-12-06 01:44:26.211250 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:44:26.211873 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:44:26.212113 (Thread-4): 01:44:26 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:44:26.212350 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:44:26.212426 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:44:26.214887 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:44:26.223575 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08738cec-3200-4058-8fba-e36a4be6f7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9c7b7f70>]}
2021-12-06 01:44:26.223831 (Thread-1): 01:44:26 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.21s]
2021-12-06 01:44:26.223902 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:44:26.230952 (Thread-4): finished collecting timing info
2021-12-06 01:44:26.247050 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:44:26.263824 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:44:26.263902 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 01:44:26.263960 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:44:27.523881 (Thread-462): handling poll request
2021-12-06 01:44:27.524209 (Thread-462): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcc9640>]}
2021-12-06 01:44:27.524926 (Thread-462): sending response (<Response 8809 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:44:28.274926 (Thread-4): SQL status: SUCCESS 1 in 2.01 seconds
2021-12-06 01:44:28.279697 (Thread-4): finished collecting timing info
2021-12-06 01:44:28.279845 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:44:28.722718 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08738cec-3200-4058-8fba-e36a4be6f7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9c7bef10>]}
2021-12-06 01:44:28.723088 (Thread-4): 01:44:28 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.51s]
2021-12-06 01:44:28.723179 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:44:28.724075 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:44:28.724336 (Thread-3): 01:44:28 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:44:28.724556 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:44:28.724632 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:44:28.727040 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:44:28.742928 (Thread-3): finished collecting timing info
2021-12-06 01:44:28.744963 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:44:28.762945 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:44:28.763027 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 01:44:28.763087 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 01:44:28.965389 (Thread-463): handling poll request
2021-12-06 01:44:28.965669 (Thread-463): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcbc940>]}
2021-12-06 01:44:28.966363 (Thread-463): sending response (<Response 7709 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:44:30.416365 (Thread-464): handling poll request
2021-12-06 01:44:30.416715 (Thread-464): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a405dac0>]}
2021-12-06 01:44:30.417285 (Thread-464): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:44:30.941983 (Thread-3): SQL status: SUCCESS 1 in 2.18 seconds
2021-12-06 01:44:30.943440 (Thread-3): finished collecting timing info
2021-12-06 01:44:30.943576 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:44:31.405028 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08738cec-3200-4058-8fba-e36a4be6f7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9d413910>]}
2021-12-06 01:44:31.405404 (Thread-3): 01:44:31 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.68s]
2021-12-06 01:44:31.405495 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:44:31.407142 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:44:31.407446 (MainThread): 01:44:31 | 
2021-12-06 01:44:31.407512 (MainThread): 01:44:31 | Finished running 3 view models, 2 table models in 11.22s.
2021-12-06 01:44:31.407560 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:44:31.407600 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:44:31.407636 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:44:31.407670 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:44:31.407709 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:44:31.468452 (MainThread): 
2021-12-06 01:44:31.468571 (MainThread): Completed successfully
2021-12-06 01:44:31.468638 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:44:31.919297 (Thread-465): handling poll request
2021-12-06 01:44:31.919613 (Thread-465): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcd38e0>]}
2021-12-06 01:44:31.920910 (Thread-465): sending response (<Response 21273 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:44:32.898819 (Thread-466): handling status request
2021-12-06 01:44:32.899126 (Thread-466): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcd39d0>]}
2021-12-06 01:44:32.899646 (Thread-466): sending response (<Response 1551 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:44:32.954973 (Thread-467): handling status request
2021-12-06 01:44:32.955193 (Thread-467): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcd3d00>]}
2021-12-06 01:44:32.955599 (Thread-467): sending response (<Response 1551 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:44:36.634846 (Thread-468): handling status request
2021-12-06 01:44:36.635200 (Thread-468): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcd3f10>]}
2021-12-06 01:44:36.635675 (Thread-468): sending response (<Response 1551 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:44:36.981748 (Thread-469): handling status request
2021-12-06 01:44:36.982032 (Thread-469): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcdd0a0>]}
2021-12-06 01:44:36.982483 (Thread-469): sending response (<Response 1551 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:44:37.070639 (Thread-470): handling cli_args request
2021-12-06 01:44:37.070861 (Thread-470): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcdd310>]}
2021-12-06 01:44:39.034765 (Thread-470): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:44:39.071141 (MainThread): Partial parsing not enabled
2021-12-06 01:44:39.127044 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:44:39.129034 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:44:39.164024 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:44:39.168110 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:44:39.171247 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:44:39.175565 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:44:39.176824 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:44:39.185408 (MainThread): Parsing macros/core.sql
2021-12-06 01:44:39.188977 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:44:39.195632 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:44:39.205114 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:44:39.213007 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:44:39.216591 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:44:39.238127 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:44:39.254185 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:44:39.255743 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:44:39.285663 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:44:39.294440 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:44:39.308005 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:44:39.326577 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:44:39.336339 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:44:39.338052 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:44:39.339410 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:44:39.347400 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:44:39.348263 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:44:39.349864 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:44:39.351312 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:44:39.353632 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:44:39.355002 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:44:39.407433 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:44:39.409515 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:44:39.410604 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:44:39.412179 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:44:39.505435 (Thread-471): handling poll request
2021-12-06 01:44:39.505784 (Thread-471): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc847c0>]}
2021-12-06 01:44:39.506794 (Thread-471): sending response (<Response 9687 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:44:39.592722 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:44:39.604358 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:44:39.606759 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:44:39.609183 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:44:39.612899 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:44:39.699182 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce100e46-3cbb-4722-8f92-5c7062cc0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79eed76df0>]}
2021-12-06 01:44:39.729826 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce100e46-3cbb-4722-8f92-5c7062cc0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79ef6af430>]}
2021-12-06 01:44:39.730057 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:44:39.731281 (MainThread): 
2021-12-06 01:44:39.731481 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:44:39.732419 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:44:39.783336 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:44:39.783416 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:44:39.783470 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 01:44:40.949719 (Thread-472): handling poll request
2021-12-06 01:44:40.950055 (Thread-472): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc7c250>]}
2021-12-06 01:44:40.950672 (Thread-472): sending response (<Response 4991 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:44:41.291310 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.51 seconds
2021-12-06 01:44:41.293301 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:44:41.759906 (MainThread): 01:44:41 | Concurrency: 4 threads (target='default')
2021-12-06 01:44:41.760092 (MainThread): 01:44:41 | 
2021-12-06 01:44:41.795273 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:44:41.795447 (Thread-1): 01:44:41 | 1 of 3 START test accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [RUN]
2021-12-06 01:44:41.795695 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 01:44:41.795795 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:44:41.796573 (Thread-2): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:44:41.796705 (Thread-2): 01:44:41 | 2 of 3 START test not_null_stg_customers_customer_id................. [RUN]
2021-12-06 01:44:41.796937 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:44:41.797012 (Thread-2): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:44:41.806969 (Thread-2): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:44:41.807157 (Thread-3): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:44:41.807285 (Thread-3): 01:44:41 | 3 of 3 START test unique_stg_customers_customer_id................... [RUN]
2021-12-06 01:44:41.807493 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:44:41.807556 (Thread-3): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:44:41.812857 (Thread-3): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:44:41.817731 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 01:44:41.827072 (Thread-1): finished collecting timing info
2021-12-06 01:44:41.832287 (Thread-2): finished collecting timing info
2021-12-06 01:44:41.847621 (Thread-3): finished collecting timing info
2021-12-06 01:44:41.855272 (Thread-2): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:44:41.856598 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 01:44:41.858043 (Thread-3): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:44:41.878216 (Thread-1): Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 01:44:41.878297 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from analytics.dbt_pstulnikov.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','placed','return_pending'
)



      
    ) dbt_internal_test
2021-12-06 01:44:41.878363 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:44:41.884499 (Thread-2): Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:44:41.884581 (Thread-2): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt_pstulnikov.stg_customers
where customer_id is null



      
    ) dbt_internal_test
2021-12-06 01:44:41.884637 (Thread-2): Opening a new connection, currently in state closed
2021-12-06 01:44:41.886493 (Thread-3): Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:44:41.886572 (Thread-3): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.dbt_pstulnikov.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-06 01:44:41.886627 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:44:42.436043 (Thread-473): handling poll request
2021-12-06 01:44:42.436366 (Thread-473): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcf12e0>]}
2021-12-06 01:44:42.437280 (Thread-473): sending response (<Response 17481 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:44:43.475101 (Thread-3): SQL status: SUCCESS 1 in 1.59 seconds
2021-12-06 01:44:43.477354 (Thread-3): finished collecting timing info
2021-12-06 01:44:43.477510 (Thread-3): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
2021-12-06 01:44:43.697528 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-06 01:44:43.698958 (Thread-2): finished collecting timing info
2021-12-06 01:44:43.699089 (Thread-2): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
2021-12-06 01:44:43.810828 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2021-12-06 01:44:43.812649 (Thread-1): finished collecting timing info
2021-12-06 01:44:43.812790 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b: Close
2021-12-06 01:44:43.917525 (Thread-474): handling poll request
2021-12-06 01:44:43.917809 (Thread-474): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcf1c40>]}
2021-12-06 01:44:43.918405 (Thread-474): sending response (<Response 4148 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:44:43.964872 (Thread-3): 01:44:43 | 3 of 3 PASS unique_stg_customers_customer_id......................... [PASS in 2.16s]
2021-12-06 01:44:43.964981 (Thread-3): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:44:44.152715 (Thread-2): 01:44:44 | 2 of 3 PASS not_null_stg_customers_customer_id....................... [PASS in 2.36s]
2021-12-06 01:44:44.152826 (Thread-2): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:44:44.327245 (Thread-1): 01:44:44 | 1 of 3 PASS accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [PASS in 2.53s]
2021-12-06 01:44:44.327349 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:44:44.328825 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:44:44.329095 (MainThread): 01:44:44 | 
2021-12-06 01:44:44.329160 (MainThread): 01:44:44 | Finished running 3 tests in 4.60s.
2021-12-06 01:44:44.329208 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:44:44.329247 (MainThread): Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
2021-12-06 01:44:44.329282 (MainThread): Connection 'test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b' was properly closed.
2021-12-06 01:44:44.329329 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 01:44:44.393259 (MainThread): 
2021-12-06 01:44:44.393360 (MainThread): Completed successfully
2021-12-06 01:44:44.393421 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-06 01:44:45.388834 (Thread-475): handling poll request
2021-12-06 01:44:45.389147 (Thread-475): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc9d910>]}
2021-12-06 01:44:45.390338 (Thread-475): sending response (<Response 14972 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:44:46.258341 (Thread-476): handling status request
2021-12-06 01:44:46.258658 (Thread-476): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc9da00>]}
2021-12-06 01:44:46.259177 (Thread-476): sending response (<Response 1551 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:44:46.292690 (Thread-477): handling status request
2021-12-06 01:44:46.292909 (Thread-477): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc9dd30>]}
2021-12-06 01:44:46.293281 (Thread-477): sending response (<Response 1551 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:47:06.152672 (Thread-478): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 01:47:06.154830 (Thread-478): Partial parsing: added file: jaffle_shop://tests/assert_total_payments_amount_is_positive.sql
2021-12-06 01:47:06.162872 (Thread-478): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-12-06 01:47:06.207482 (Thread-478): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc13fd0>]}
2021-12-06 01:47:06.952408 (Thread-479): handling status request
2021-12-06 01:47:06.952732 (Thread-479): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc13d90>]}
2021-12-06 01:47:06.953245 (Thread-479): sending response (<Response 1576 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:47:06.963843 (Thread-480): handling status request
2021-12-06 01:47:06.964043 (Thread-480): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dbfd370>]}
2021-12-06 01:47:06.964407 (Thread-480): sending response (<Response 1576 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:49:00.265355 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-12-06 01:49:00.359715 (Thread-481): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:49:00.360020 (Thread-481): Partial parsing: updated file: jaffle_shop://tests/assert_total_payments_amount_is_positive.sql
2021-12-06 01:49:00.363278 (Thread-481): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-12-06 01:49:00.410033 (Thread-481): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc00220>]}
2021-12-06 01:49:01.174843 (Thread-482): handling status request
2021-12-06 01:49:01.175157 (Thread-482): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcb12e0>]}
2021-12-06 01:49:01.198538 (Thread-482): sending response (<Response 1578 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:49:01.240621 (Thread-483): handling status request
2021-12-06 01:49:01.240828 (Thread-483): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcb1400>]}
2021-12-06 01:49:01.241198 (Thread-483): sending response (<Response 1578 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:49:05.665116 (Thread-484): handling status request
2021-12-06 01:49:05.665471 (Thread-484): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd007c0>]}
2021-12-06 01:49:05.666063 (Thread-484): sending response (<Response 1578 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:49:05.969481 (Thread-485): handling status request
2021-12-06 01:49:05.969773 (Thread-485): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd81c70>]}
2021-12-06 01:49:05.970269 (Thread-485): sending response (<Response 1578 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:49:06.149191 (Thread-486): handling cli_args request
2021-12-06 01:49:06.149425 (Thread-486): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd814c0>]}
2021-12-06 01:49:06.159591 (Thread-486): Connection 'test.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-12-06 01:49:08.049644 (Thread-486): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:49:08.085919 (MainThread): Partial parsing not enabled
2021-12-06 01:49:08.142506 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:49:08.144383 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:49:08.178427 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:49:08.182047 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:49:08.184997 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:49:08.189166 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:49:08.190439 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:49:08.198620 (MainThread): Parsing macros/core.sql
2021-12-06 01:49:08.202118 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:49:08.208322 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:49:08.217567 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:49:08.224313 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:49:08.227990 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:49:08.249392 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:49:08.265577 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:49:08.267120 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:49:08.296366 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:49:08.303254 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:49:08.316257 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:49:08.334584 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:49:08.343880 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:49:08.345496 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:49:08.346863 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:49:08.354647 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:49:08.355574 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:49:08.357175 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:49:08.358611 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:49:08.360913 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:49:08.362282 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:49:08.414282 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:49:08.416338 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:49:08.417398 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:49:08.418893 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:49:08.497821 (Thread-487): handling poll request
2021-12-06 01:49:08.498149 (Thread-487): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dcb11f0>]}
2021-12-06 01:49:08.499229 (Thread-487): sending response (<Response 9694 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:49:08.599114 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:49:08.610658 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:49:08.613067 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:49:08.615577 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:49:08.620294 (MainThread): 1699: statically parsed marts/core/fct_orders.sql
2021-12-06 01:49:08.620386 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:49:08.623565 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '38e18a56-e11b-4026-adb4-0bdbde08fba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb314d142b0>]}
2021-12-06 01:49:08.632662 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-12-06 01:49:08.760557 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38e18a56-e11b-4026-adb4-0bdbde08fba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb314d4c040>]}
2021-12-06 01:49:08.792845 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38e18a56-e11b-4026-adb4-0bdbde08fba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb314d4c310>]}
2021-12-06 01:49:08.793057 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:49:08.794450 (MainThread): 
2021-12-06 01:49:08.794670 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:49:08.795633 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:49:08.806822 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:49:08.806893 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:49:08.806947 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 01:49:10.104716 (Thread-488): handling poll request
2021-12-06 01:49:10.105051 (Thread-488): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd876a0>]}
2021-12-06 01:49:10.105731 (Thread-488): sending response (<Response 6060 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:49:10.297595 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.49 seconds
2021-12-06 01:49:10.299769 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:49:10.745326 (MainThread): 01:49:10 | Concurrency: 4 threads (target='default')
2021-12-06 01:49:10.745471 (MainThread): 01:49:10 | 
2021-12-06 01:49:10.747437 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-12-06 01:49:10.747618 (Thread-1): 01:49:10 | 1 of 1 START test assert_total_payments_amount_is_positive........... [RUN]
2021-12-06 01:49:10.747847 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-12-06 01:49:10.747949 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-12-06 01:49:10.751152 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-12-06 01:49:10.769328 (Thread-1): finished collecting timing info
2021-12-06 01:49:10.783916 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-12-06 01:49:10.803016 (Thread-1): Using snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-12-06 01:49:10.803099 (Thread-1): On test.jaffle_shop.assert_total_payments_amount_is_positive: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.assert_total_payments_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    order_id,
    sum(amount) as total_amount
from analytics.dbt_pstulnikov.stg_payments
group by 1
having not(total_amount >= 0)
      
    ) dbt_internal_test
2021-12-06 01:49:10.803163 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:49:11.599910 (Thread-489): handling poll request
2021-12-06 01:49:11.600219 (Thread-489): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd52a00>]}
2021-12-06 01:49:11.600884 (Thread-489): sending response (<Response 6298 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:49:12.240224 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-12-06 01:49:12.242469 (Thread-1): finished collecting timing info
2021-12-06 01:49:12.242599 (Thread-1): On test.jaffle_shop.assert_total_payments_amount_is_positive: Close
2021-12-06 01:49:12.718246 (Thread-1): 01:49:12 | 1 of 1 PASS assert_total_payments_amount_is_positive................. [PASS in 1.97s]
2021-12-06 01:49:12.718369 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-12-06 01:49:12.719794 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:49:12.720053 (MainThread): 01:49:12 | 
2021-12-06 01:49:12.720119 (MainThread): 01:49:12 | Finished running 1 test in 3.93s.
2021-12-06 01:49:12.720165 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:49:12.720204 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-12-06 01:49:12.776237 (MainThread): 
2021-12-06 01:49:12.776368 (MainThread): Completed successfully
2021-12-06 01:49:12.776444 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-12-06 01:49:13.068586 (Thread-490): handling poll request
2021-12-06 01:49:13.068920 (Thread-490): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd4b8b0>]}
2021-12-06 01:49:13.069959 (Thread-490): sending response (<Response 7485 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:49:14.006835 (Thread-491): handling status request
2021-12-06 01:49:14.007187 (Thread-491): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd180d0>]}
2021-12-06 01:49:14.007738 (Thread-491): sending response (<Response 1578 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:49:14.072232 (Thread-492): handling status request
2021-12-06 01:49:14.072471 (Thread-492): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd18310>]}
2021-12-06 01:49:14.072882 (Thread-492): sending response (<Response 1578 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:49:46.257956 (Thread-493): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:49:46.258308 (Thread-493): Partial parsing: updated file: jaffle_shop://tests/assert_total_payments_amount_is_positive.sql
2021-12-06 01:49:46.262836 (Thread-493): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-12-06 01:49:46.308858 (Thread-493): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc0eca0>]}
2021-12-06 01:49:47.043196 (Thread-494): handling status request
2021-12-06 01:49:47.043507 (Thread-494): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc0e940>]}
2021-12-06 01:49:47.044026 (Thread-494): sending response (<Response 1578 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:49:47.072780 (Thread-495): handling status request
2021-12-06 01:49:47.072992 (Thread-495): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc0e9d0>]}
2021-12-06 01:49:47.073365 (Thread-495): sending response (<Response 1578 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:50:22.082929 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-12-06 01:50:22.163109 (Thread-496): Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2021-12-06 01:50:22.163399 (Thread-496): Partial parsing: added file: jaffle_shop://tests/assert_total_payments_amount_is_not_negative.sql
2021-12-06 01:50:22.163511 (Thread-496): Partial parsing: deleted file: jaffle_shop://tests/assert_total_payments_amount_is_positive.sql
2021-12-06 01:50:22.166685 (Thread-496): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:50:22.211410 (Thread-496): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db7ab80>]}
2021-12-06 01:50:23.030438 (Thread-497): handling status request
2021-12-06 01:50:23.030766 (Thread-497): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db7a7f0>]}
2021-12-06 01:50:23.031266 (Thread-497): sending response (<Response 1911 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:50:23.092533 (Thread-498): handling status request
2021-12-06 01:50:23.092763 (Thread-498): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db7ac10>]}
2021-12-06 01:50:23.093193 (Thread-498): sending response (<Response 1911 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:50:37.852900 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_not_negative' was properly closed.
2021-12-06 01:50:37.930405 (Thread-499): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 01:50:37.930755 (Thread-499): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 01:50:37.935826 (Thread-499): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429da98f40>]}
2021-12-06 01:50:38.746128 (Thread-500): handling status request
2021-12-06 01:50:38.746458 (Thread-500): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db48640>]}
2021-12-06 01:50:38.746940 (Thread-500): sending response (<Response 1212 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:50:38.819285 (Thread-501): handling status request
2021-12-06 01:50:38.819530 (Thread-501): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db489a0>]}
2021-12-06 01:50:38.819962 (Thread-501): sending response (<Response 1212 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:55:28.138441 (Thread-502): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:55:28.140331 (Thread-502): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 01:55:28.144209 (Thread-502): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:55:28.227312 (Thread-502): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429da213a0>]}
2021-12-06 01:55:28.918699 (Thread-503): handling status request
2021-12-06 01:55:28.919020 (Thread-503): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db48100>]}
2021-12-06 01:55:28.919521 (Thread-503): sending response (<Response 1551 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:55:28.987592 (Thread-504): handling status request
2021-12-06 01:55:28.987810 (Thread-504): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd11d90>]}
2021-12-06 01:55:28.988196 (Thread-504): sending response (<Response 1551 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:55:40.996028 (Thread-505): handling status request
2021-12-06 01:55:40.996350 (Thread-505): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd11e80>]}
2021-12-06 01:55:40.996830 (Thread-505): sending response (<Response 1551 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:55:41.381620 (Thread-506): handling status request
2021-12-06 01:55:41.381864 (Thread-506): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd113d0>]}
2021-12-06 01:55:41.382320 (Thread-506): sending response (<Response 1551 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:55:41.490614 (Thread-507): handling cli_args request
2021-12-06 01:55:41.490827 (Thread-507): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd11670>]}
2021-12-06 01:55:41.500857 (Thread-507): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:55:43.402348 (Thread-507): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:55:43.439325 (MainThread): Partial parsing not enabled
2021-12-06 01:55:43.496946 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:55:43.498879 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:55:43.532773 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:55:43.536324 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:55:43.539320 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:55:43.543509 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:55:43.544747 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:55:43.552978 (MainThread): Parsing macros/core.sql
2021-12-06 01:55:43.556483 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:55:43.562753 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:55:43.572095 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:55:43.578819 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:55:43.582484 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:55:43.603930 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:55:43.619940 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:55:43.621442 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:55:43.650490 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:55:43.657329 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:55:43.670479 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:55:43.688955 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:55:43.698397 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:55:43.700095 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:55:43.701428 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:55:43.709336 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:55:43.710351 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:55:43.711954 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:55:43.713381 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:55:43.715714 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:55:43.717076 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:55:43.769434 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:55:43.771513 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:55:43.772592 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:55:43.774115 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:55:43.919417 (Thread-508): handling poll request
2021-12-06 01:55:43.919714 (Thread-508): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd961c0>]}
2021-12-06 01:55:43.920818 (Thread-508): sending response (<Response 9686 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:55:43.954919 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:55:43.966460 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:55:43.968808 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:55:43.971275 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:55:43.974901 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:55:43.986044 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:55:44.123235 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a81fdbf5-147f-4c16-9316-d696a49fcaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a95915700>]}
2021-12-06 01:55:44.168826 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a81fdbf5-147f-4c16-9316-d696a49fcaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a95915df0>]}
2021-12-06 01:55:44.169029 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:55:44.170533 (MainThread): 
2021-12-06 01:55:44.170735 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:55:44.171574 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:55:44.182955 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:55:44.183024 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:55:44.183078 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:55:45.405814 (Thread-509): handling poll request
2021-12-06 01:55:45.406167 (Thread-509): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dac2250>]}
2021-12-06 01:55:45.406807 (Thread-509): sending response (<Response 5276 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:55:45.690998 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.51 seconds
2021-12-06 01:55:45.692828 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:55:46.142273 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:55:46.149178 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:55:46.149289 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:55:46.149355 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:55:46.848859 (Thread-510): handling poll request
2021-12-06 01:55:46.849164 (Thread-510): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429da3db50>]}
2021-12-06 01:55:46.849733 (Thread-510): sending response (<Response 2263 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:55:47.460276 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.31 seconds
2021-12-06 01:55:47.461720 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:55:47.913046 (MainThread): 01:55:47 | Concurrency: 4 threads (target='default')
2021-12-06 01:55:47.913190 (MainThread): 01:55:47 | 
2021-12-06 01:55:47.915200 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:55:47.915481 (Thread-1): 01:55:47 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:55:47.915708 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:55:47.915806 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:55:47.916689 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:55:47.916900 (Thread-2): 01:55:47 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:55:47.917119 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:55:47.917186 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:55:47.918318 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:55:47.919182 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:55:47.919380 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:55:47.919584 (Thread-3): 01:55:47 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:55:47.919792 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:55:47.920017 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:55:47.920912 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:55:47.936978 (Thread-2): finished collecting timing info
2021-12-06 01:55:47.942104 (Thread-3): finished collecting timing info
2021-12-06 01:55:47.962272 (Thread-1): finished collecting timing info
2021-12-06 01:55:47.966755 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:55:47.969406 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:55:47.972767 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:55:47.985400 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:55:47.985480 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:55:47.985538 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:55:47.988864 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:55:47.988945 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:55:47.988998 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:55:47.990216 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:55:47.990288 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:55:47.990340 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:55:48.330160 (Thread-511): handling poll request
2021-12-06 01:55:48.330486 (Thread-511): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429da3d190>]}
2021-12-06 01:55:48.331339 (Thread-511): sending response (<Response 14240 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:55:49.585896 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-12-06 01:55:49.595689 (Thread-1): finished collecting timing info
2021-12-06 01:55:49.595863 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:55:49.710929 (Thread-3): SQL status: SUCCESS 1 in 1.72 seconds
2021-12-06 01:55:49.712007 (Thread-3): finished collecting timing info
2021-12-06 01:55:49.712111 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:55:49.780658 (Thread-2): SQL status: SUCCESS 1 in 1.79 seconds
2021-12-06 01:55:49.781757 (Thread-2): finished collecting timing info
2021-12-06 01:55:49.781856 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:55:49.785183 (Thread-512): handling poll request
2021-12-06 01:55:49.785440 (Thread-512): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dad2280>]}
2021-12-06 01:55:49.813404 (Thread-512): sending response (<Response 3556 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:55:50.137150 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81fdbf5-147f-4c16-9316-d696a49fcaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a949955e0>]}
2021-12-06 01:55:50.137591 (Thread-1): 01:55:50 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.22s]
2021-12-06 01:55:50.137684 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:55:50.157102 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81fdbf5-147f-4c16-9316-d696a49fcaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a94a4e1f0>]}
2021-12-06 01:55:50.157410 (Thread-3): 01:55:50 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.24s]
2021-12-06 01:55:50.157489 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:55:50.230588 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81fdbf5-147f-4c16-9316-d696a49fcaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a961da0d0>]}
2021-12-06 01:55:50.230908 (Thread-2): 01:55:50 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.31s]
2021-12-06 01:55:50.230987 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:55:50.231792 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:55:50.232015 (Thread-4): 01:55:50 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:55:50.232244 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:55:50.232316 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:55:50.234708 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:55:50.250579 (Thread-4): finished collecting timing info
2021-12-06 01:55:50.266720 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:55:50.282649 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:55:50.282730 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 01:55:50.282789 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:55:51.378177 (Thread-513): handling poll request
2021-12-06 01:55:51.378499 (Thread-513): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dacaa90>]}
2021-12-06 01:55:51.379241 (Thread-513): sending response (<Response 8809 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:55:52.460791 (Thread-4): SQL status: SUCCESS 1 in 2.18 seconds
2021-12-06 01:55:52.465241 (Thread-4): finished collecting timing info
2021-12-06 01:55:52.465377 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:55:52.833998 (Thread-514): handling poll request
2021-12-06 01:55:52.834348 (Thread-514): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429daca400>]}
2021-12-06 01:55:52.834870 (Thread-514): sending response (<Response 1369 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:55:52.917741 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81fdbf5-147f-4c16-9316-d696a49fcaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a94aa72e0>]}
2021-12-06 01:55:52.918139 (Thread-4): 01:55:52 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.69s]
2021-12-06 01:55:52.918230 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:55:52.919059 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:55:52.919303 (Thread-3): 01:55:52 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:55:52.919508 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:55:52.919582 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:55:52.921867 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:55:52.936296 (Thread-3): finished collecting timing info
2021-12-06 01:55:52.938236 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:55:52.953950 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:55:52.954027 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 01:55:52.954085 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 01:55:54.324000 (Thread-515): handling poll request
2021-12-06 01:55:54.324315 (Thread-515): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429daf0400>]}
2021-12-06 01:55:54.324967 (Thread-515): sending response (<Response 6625 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:55:55.041420 (Thread-3): SQL status: SUCCESS 1 in 2.09 seconds
2021-12-06 01:55:55.042972 (Thread-3): finished collecting timing info
2021-12-06 01:55:55.043117 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:55:55.496576 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81fdbf5-147f-4c16-9316-d696a49fcaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a944c5070>]}
2021-12-06 01:55:55.496998 (Thread-3): 01:55:55 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.58s]
2021-12-06 01:55:55.497101 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:55:55.498630 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:55:55.498934 (MainThread): 01:55:55 | 
2021-12-06 01:55:55.499003 (MainThread): 01:55:55 | Finished running 3 view models, 2 table models in 11.33s.
2021-12-06 01:55:55.499051 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:55:55.499092 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:55:55.499128 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:55:55.499160 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:55:55.499197 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:55:55.567792 (MainThread): 
2021-12-06 01:55:55.567910 (MainThread): Completed successfully
2021-12-06 01:55:55.567979 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:55:55.807375 (Thread-516): handling poll request
2021-12-06 01:55:55.807682 (Thread-516): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db0c430>]}
2021-12-06 01:55:55.809023 (Thread-516): sending response (<Response 21275 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:55:56.698800 (Thread-517): handling status request
2021-12-06 01:55:56.699129 (Thread-517): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db0c2b0>]}
2021-12-06 01:55:56.699663 (Thread-517): sending response (<Response 1551 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:55:56.730368 (Thread-518): handling status request
2021-12-06 01:55:56.730622 (Thread-518): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dac6190>]}
2021-12-06 01:55:56.731056 (Thread-518): sending response (<Response 1551 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:56:02.603256 (Thread-519): handling status request
2021-12-06 01:56:02.603573 (Thread-519): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dac6b50>]}
2021-12-06 01:56:02.604039 (Thread-519): sending response (<Response 1551 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:56:02.897997 (Thread-520): handling status request
2021-12-06 01:56:02.898317 (Thread-520): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dac6f10>]}
2021-12-06 01:56:02.898781 (Thread-520): sending response (<Response 1551 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:56:03.091087 (Thread-521): handling cli_args request
2021-12-06 01:56:03.091408 (Thread-521): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dac6220>]}
2021-12-06 01:56:05.027546 (Thread-521): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:56:05.062977 (MainThread): Partial parsing not enabled
2021-12-06 01:56:05.119054 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:56:05.120981 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:56:05.154793 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:56:05.158364 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:56:05.161338 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:56:05.165546 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:56:05.166807 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:56:05.174921 (MainThread): Parsing macros/core.sql
2021-12-06 01:56:05.178367 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:56:05.184516 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:56:05.194193 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:56:05.201097 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:56:05.204866 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:56:05.227191 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:56:05.243870 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:56:05.245454 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:56:05.275916 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:56:05.282968 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:56:05.296165 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:56:05.315318 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:56:05.325056 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:56:05.326773 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:56:05.328144 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:56:05.336303 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:56:05.337188 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:56:05.338848 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:56:05.340620 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:56:05.343033 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:56:05.344422 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:56:05.399616 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:56:05.401710 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:56:05.402851 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:56:05.404368 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:56:05.524875 (Thread-522): handling poll request
2021-12-06 01:56:05.525166 (Thread-522): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429daa76d0>]}
2021-12-06 01:56:05.526224 (Thread-522): sending response (<Response 9686 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:56:05.590652 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:56:05.602541 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:56:05.604938 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:56:05.607446 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:56:05.611179 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:56:05.622508 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:56:05.767669 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e59dc25-57b4-418e-99ac-5ea7d93eeb44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cc1d3670>]}
2021-12-06 01:56:05.799388 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e59dc25-57b4-418e-99ac-5ea7d93eeb44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cc1d35b0>]}
2021-12-06 01:56:05.799615 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:56:05.801257 (MainThread): 
2021-12-06 01:56:05.801479 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:56:05.802472 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:56:05.813568 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:56:05.813639 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:56:05.813696 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 01:56:07.046092 (Thread-523): handling poll request
2021-12-06 01:56:07.046447 (Thread-523): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dae2250>]}
2021-12-06 01:56:07.047130 (Thread-523): sending response (<Response 5325 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:56:07.289884 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.48 seconds
2021-12-06 01:56:07.291968 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:56:07.751196 (MainThread): 01:56:07 | Concurrency: 4 threads (target='default')
2021-12-06 01:56:07.751348 (MainThread): 01:56:07 | 
2021-12-06 01:56:07.753353 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:56:07.753540 (Thread-1): 01:56:07 | 1 of 5 START test accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [RUN]
2021-12-06 01:56:07.753794 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 01:56:07.753902 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:56:07.754737 (Thread-2): Began running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 01:56:07.754874 (Thread-2): 01:56:07 | 2 of 5 START test assert_total_payments_amount_is_not_negative....... [RUN]
2021-12-06 01:56:07.755109 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:56:07.755177 (Thread-2): Compiling test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 01:56:07.758304 (Thread-2): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 01:56:07.759028 (Thread-3): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:56:07.759169 (Thread-3): 01:56:07 | 3 of 5 START test not_null_stg_customers_customer_id................. [RUN]
2021-12-06 01:56:07.759399 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:56:07.759467 (Thread-3): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:56:07.768161 (Thread-3): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:56:07.768338 (Thread-4): Began running node test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b
2021-12-06 01:56:07.768473 (Thread-4): 01:56:07 | 4 of 5 START test relationships_stg_orders_status__customer_id__stg_customers [RUN]
2021-12-06 01:56:07.768688 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b".
2021-12-06 01:56:07.768753 (Thread-4): Compiling test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b
2021-12-06 01:56:07.772246 (Thread-4): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b"
2021-12-06 01:56:07.777413 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 01:56:07.783416 (Thread-2): finished collecting timing info
2021-12-06 01:56:07.788640 (Thread-3): finished collecting timing info
2021-12-06 01:56:07.807996 (Thread-2): Writing runtime SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 01:56:07.808153 (Thread-4): finished collecting timing info
2021-12-06 01:56:07.809484 (Thread-4): Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b"
2021-12-06 01:56:07.810683 (Thread-3): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:56:07.820055 (Thread-1): finished collecting timing info
2021-12-06 01:56:07.821190 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 01:56:07.822974 (Thread-2): Using snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:56:07.823050 (Thread-2): On test.jaffle_shop.assert_total_payments_amount_is_not_negative: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.assert_total_payments_amount_is_not_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select

    order_id,

    sum(amount) as total_amount

from analytics.dbt_pstulnikov.stg_payments

group by 1

having not(total_amount >= 0)
      
    ) dbt_internal_test
2021-12-06 01:56:07.823115 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:56:07.824497 (Thread-4): Using snowflake connection "test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b".
2021-12-06 01:56:07.824568 (Thread-4): On test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select status as from_field
    from analytics.dbt_pstulnikov.stg_orders
    where status is not null
),

parent as (
    select customer_id as to_field
    from stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-12-06 01:56:07.824623 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:56:07.833587 (Thread-3): Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:56:07.833687 (Thread-3): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt_pstulnikov.stg_customers
where customer_id is null



      
    ) dbt_internal_test
2021-12-06 01:56:07.833749 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:56:07.843021 (Thread-1): Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 01:56:07.843106 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from analytics.dbt_pstulnikov.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','placed','return_pending'
)



      
    ) dbt_internal_test
2021-12-06 01:56:07.843162 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:56:08.519968 (Thread-524): handling poll request
2021-12-06 01:56:08.520258 (Thread-524): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429da145e0>]}
2021-12-06 01:56:08.521213 (Thread-524): sending response (<Response 23139 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:56:09.638818 (Thread-4): Snowflake query id: 01a0c1d4-3200-95c4-0000-00008ef92c21
2021-12-06 01:56:09.638960 (Thread-4): Snowflake error: 100038 (22018): Numeric value 'returned' is not recognized
2021-12-06 01:56:09.639103 (Thread-4): finished collecting timing info
2021-12-06 01:56:09.639223 (Thread-4): On test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b: Close
2021-12-06 01:56:09.693054 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-12-06 01:56:09.695411 (Thread-1): finished collecting timing info
2021-12-06 01:56:09.695566 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b: Close
2021-12-06 01:56:10.007321 (Thread-525): handling poll request
2021-12-06 01:56:10.007607 (Thread-525): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429da14f10>]}
2021-12-06 01:56:10.008210 (Thread-525): sending response (<Response 3467 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:56:10.020277 (Thread-3): SQL status: SUCCESS 1 in 2.19 seconds
2021-12-06 01:56:10.021594 (Thread-3): finished collecting timing info
2021-12-06 01:56:10.021721 (Thread-3): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
2021-12-06 01:56:10.029135 (Thread-2): SQL status: SUCCESS 1 in 2.21 seconds
2021-12-06 01:56:10.030338 (Thread-2): finished collecting timing info
2021-12-06 01:56:10.030446 (Thread-2): On test.jaffle_shop.assert_total_payments_amount_is_not_negative: Close
2021-12-06 01:56:10.095223 (Thread-4): Database Error in test relationships_stg_orders_status__customer_id__stg_customers (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  100038 (22018): Numeric value 'returned' is not recognized
  compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_jaffle_shop.yml/schema_test/relationships_stg_orders_status__customer_id__stg_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 100038 (22018): Numeric value 'returned' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/test.py", line 112, in execute
    result = self.execute_test(test, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/test.py", line 82, in execute_test
    macro_func()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test relationships_stg_orders_status__customer_id__stg_customers (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  100038 (22018): Numeric value 'returned' is not recognized
  compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_jaffle_shop.yml/schema_test/relationships_stg_orders_status__customer_id__stg_customers.sql
2021-12-06 01:56:10.095946 (Thread-4): 01:56:10 | 4 of 5 ERROR relationships_stg_orders_status__customer_id__stg_customers [ERROR in 2.33s]
2021-12-06 01:56:10.096044 (Thread-4): Finished running node test.jaffle_shop.relationships_stg_orders_status__customer_id__stg_customers.97ca84515b
2021-12-06 01:56:10.096157 (Thread-4): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:56:10.096246 (Thread-4): 01:56:10 | 5 of 5 START test unique_stg_customers_customer_id................... [RUN]
2021-12-06 01:56:10.096440 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:56:10.096510 (Thread-4): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:56:10.103454 (Thread-4): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:56:10.121479 (Thread-4): finished collecting timing info
2021-12-06 01:56:10.122748 (Thread-4): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:56:10.137249 (Thread-4): Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:56:10.137330 (Thread-4): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.dbt_pstulnikov.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-06 01:56:10.137388 (Thread-4): Opening a new connection, currently in state closed
2021-12-06 01:56:10.151262 (Thread-1): 01:56:10 | 1 of 5 PASS accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [PASS in 2.40s]
2021-12-06 01:56:10.151355 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:56:10.477200 (Thread-3): 01:56:10 | 3 of 5 PASS not_null_stg_customers_customer_id....................... [PASS in 2.72s]
2021-12-06 01:56:10.477339 (Thread-3): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:56:10.479614 (Thread-2): 01:56:10 | 2 of 5 PASS assert_total_payments_amount_is_not_negative............. [PASS in 2.72s]
2021-12-06 01:56:10.479729 (Thread-2): Finished running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 01:56:11.515396 (Thread-526): handling poll request
2021-12-06 01:56:11.515728 (Thread-526): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9bd3a0>]}
2021-12-06 01:56:11.516529 (Thread-526): sending response (<Response 17195 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:56:11.768734 (Thread-4): SQL status: SUCCESS 1 in 1.63 seconds
2021-12-06 01:56:11.770212 (Thread-4): finished collecting timing info
2021-12-06 01:56:11.770345 (Thread-4): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
2021-12-06 01:56:12.214311 (Thread-4): 01:56:12 | 5 of 5 PASS unique_stg_customers_customer_id......................... [PASS in 2.12s]
2021-12-06 01:56:12.214450 (Thread-4): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:56:12.215928 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:56:12.216228 (MainThread): 01:56:12 | 
2021-12-06 01:56:12.216304 (MainThread): 01:56:12 | Finished running 5 tests in 6.41s.
2021-12-06 01:56:12.216355 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:56:12.216397 (MainThread): Connection 'test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b' was properly closed.
2021-12-06 01:56:12.216433 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_not_negative' was properly closed.
2021-12-06 01:56:12.216467 (MainThread): Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
2021-12-06 01:56:12.216500 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 01:56:12.272232 (MainThread): 
2021-12-06 01:56:12.272346 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 01:56:12.272404 (MainThread): 
2021-12-06 01:56:12.272456 (MainThread): Database Error in test relationships_stg_orders_status__customer_id__stg_customers (models/staging/jaffle_shop/stg_jaffle_shop.yml)
2021-12-06 01:56:12.272498 (MainThread):   100038 (22018): Numeric value 'returned' is not recognized
2021-12-06 01:56:12.272535 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_jaffle_shop.yml/schema_test/relationships_stg_orders_status__customer_id__stg_customers.sql
2021-12-06 01:56:12.272584 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-12-06 01:56:13.035358 (Thread-527): handling poll request
2021-12-06 01:56:13.035724 (Thread-527): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9d4d90>]}
2021-12-06 01:56:13.039852 (Thread-527): sending response (<Response 21958 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:56:14.055979 (Thread-528): handling status request
2021-12-06 01:56:14.056287 (Thread-528): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dabaf10>]}
2021-12-06 01:56:14.056808 (Thread-528): sending response (<Response 1551 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:56:14.122572 (Thread-529): handling status request
2021-12-06 01:56:14.122779 (Thread-529): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4054cd0>]}
2021-12-06 01:56:14.123189 (Thread-529): sending response (<Response 1551 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:56:56.069751 (Thread-530): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:56:56.070214 (Thread-530): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 01:56:56.074141 (Thread-530): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:56:56.140733 (Thread-530): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9b8dc0>]}
2021-12-06 01:56:56.910898 (Thread-531): handling status request
2021-12-06 01:56:56.911204 (Thread-531): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd81790>]}
2021-12-06 01:56:56.911689 (Thread-531): sending response (<Response 1551 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:56:56.937784 (Thread-532): handling status request
2021-12-06 01:56:56.938026 (Thread-532): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd114c0>]}
2021-12-06 01:56:56.938401 (Thread-532): sending response (<Response 1551 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:57:00.600459 (Thread-533): handling status request
2021-12-06 01:57:00.600792 (Thread-533): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9b83a0>]}
2021-12-06 01:57:00.601273 (Thread-533): sending response (<Response 1551 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:57:01.039671 (Thread-534): handling cli_args request
2021-12-06 01:57:01.039974 (Thread-534): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9b82e0>]}
2021-12-06 01:57:01.050611 (Thread-534): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:57:01.064262 (Thread-535): handling status request
2021-12-06 01:57:01.069377 (Thread-535): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d959d30>]}
2021-12-06 01:57:01.071011 (Thread-535): sending response (<Response 1551 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:57:02.982564 (Thread-534): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:57:03.020012 (MainThread): Partial parsing not enabled
2021-12-06 01:57:03.078278 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:57:03.080298 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:57:03.115064 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:57:03.118686 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:57:03.121701 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:57:03.126009 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:57:03.127392 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:57:03.136086 (MainThread): Parsing macros/core.sql
2021-12-06 01:57:03.139645 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:57:03.145889 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:57:03.155123 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:57:03.161833 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:57:03.165352 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:57:03.186917 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:57:03.203102 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:57:03.204627 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:57:03.233910 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:57:03.240819 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:57:03.253971 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:57:03.272503 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:57:03.283561 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:57:03.285889 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:57:03.287864 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:57:03.298957 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:57:03.300431 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:57:03.302943 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:57:03.305311 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:57:03.308760 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:57:03.310865 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:57:03.363582 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:57:03.365624 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:57:03.366760 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:57:03.368324 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:57:03.453590 (Thread-536): handling poll request
2021-12-06 01:57:03.453882 (Thread-536): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d973370>]}
2021-12-06 01:57:03.454785 (Thread-536): sending response (<Response 9686 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:57:03.552973 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:57:03.564698 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:57:03.567128 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:57:03.569593 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:57:03.573318 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:57:03.584585 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:57:03.717880 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95c817a3-434d-4dc0-a893-d3b458d2a7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b421c880>]}
2021-12-06 01:57:03.755766 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95c817a3-434d-4dc0-a893-d3b458d2a7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b421cbb0>]}
2021-12-06 01:57:03.755975 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:57:03.757429 (MainThread): 
2021-12-06 01:57:03.757641 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:57:03.758586 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:57:03.770056 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:57:03.770126 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:57:03.770180 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:57:04.912414 (Thread-537): handling poll request
2021-12-06 01:57:04.912729 (Thread-537): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9adbb0>]}
2021-12-06 01:57:04.913349 (Thread-537): sending response (<Response 5276 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:57:05.269142 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.50 seconds
2021-12-06 01:57:05.271057 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:57:05.717860 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:57:05.725215 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:57:05.725313 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:57:05.725377 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:57:06.449635 (Thread-538): handling poll request
2021-12-06 01:57:06.449974 (Thread-538): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9b3100>]}
2021-12-06 01:57:06.450524 (Thread-538): sending response (<Response 2263 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:57:06.977812 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.25 seconds
2021-12-06 01:57:06.979324 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:57:07.453422 (MainThread): 01:57:07 | Concurrency: 4 threads (target='default')
2021-12-06 01:57:07.453556 (MainThread): 01:57:07 | 
2021-12-06 01:57:07.455560 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:57:07.455846 (Thread-1): 01:57:07 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:57:07.456068 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:57:07.456166 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:57:07.457020 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:57:07.457225 (Thread-2): 01:57:07 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:57:07.457447 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:57:07.457514 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:57:07.458645 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:57:07.458999 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:57:07.459210 (Thread-3): 01:57:07 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:57:07.459418 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:57:07.459485 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:57:07.460447 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:57:07.461337 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:57:07.476169 (Thread-3): finished collecting timing info
2021-12-06 01:57:07.481459 (Thread-1): finished collecting timing info
2021-12-06 01:57:07.486553 (Thread-2): finished collecting timing info
2021-12-06 01:57:07.512100 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:57:07.514039 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:57:07.517565 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:57:07.532647 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:57:07.532727 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:57:07.532783 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:57:07.535070 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:57:07.535151 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:57:07.535205 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:57:07.536145 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:57:07.536218 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:57:07.536273 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:57:07.948006 (Thread-539): handling poll request
2021-12-06 01:57:07.948323 (Thread-539): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d960820>]}
2021-12-06 01:57:07.949155 (Thread-539): sending response (<Response 14241 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:57:09.158317 (Thread-2): SQL status: SUCCESS 1 in 1.62 seconds
2021-12-06 01:57:09.164834 (Thread-2): finished collecting timing info
2021-12-06 01:57:09.164969 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:57:09.213709 (Thread-3): SQL status: SUCCESS 1 in 1.68 seconds
2021-12-06 01:57:09.214903 (Thread-3): finished collecting timing info
2021-12-06 01:57:09.215018 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:57:09.352498 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-12-06 01:57:09.353745 (Thread-1): finished collecting timing info
2021-12-06 01:57:09.353863 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:57:09.481321 (Thread-540): handling poll request
2021-12-06 01:57:09.481602 (Thread-540): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d960d60>]}
2021-12-06 01:57:09.482260 (Thread-540): sending response (<Response 3556 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:57:09.611726 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95c817a3-434d-4dc0-a893-d3b458d2a7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3af322400>]}
2021-12-06 01:57:09.612104 (Thread-2): 01:57:09 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.15s]
2021-12-06 01:57:09.612191 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:57:09.656743 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95c817a3-434d-4dc0-a893-d3b458d2a7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3af25e7f0>]}
2021-12-06 01:57:09.657018 (Thread-3): 01:57:09 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.20s]
2021-12-06 01:57:09.657096 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:57:09.657737 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:57:09.658024 (Thread-4): 01:57:09 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:57:09.658267 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:57:09.658342 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:57:09.660765 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:57:09.676244 (Thread-4): finished collecting timing info
2021-12-06 01:57:09.693023 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:57:09.708541 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:57:09.708621 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 01:57:09.708678 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:57:09.801241 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95c817a3-434d-4dc0-a893-d3b458d2a7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3af2b7340>]}
2021-12-06 01:57:09.801515 (Thread-1): 01:57:09 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.35s]
2021-12-06 01:57:09.801588 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:57:10.927200 (Thread-541): handling poll request
2021-12-06 01:57:10.927530 (Thread-541): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8fc6d0>]}
2021-12-06 01:57:10.928223 (Thread-541): sending response (<Response 8809 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:57:11.706397 (Thread-4): SQL status: SUCCESS 1 in 2.00 seconds
2021-12-06 01:57:11.711382 (Thread-4): finished collecting timing info
2021-12-06 01:57:11.711518 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:57:12.185878 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95c817a3-434d-4dc0-a893-d3b458d2a7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b4ad9940>]}
2021-12-06 01:57:12.186267 (Thread-4): 01:57:12 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.53s]
2021-12-06 01:57:12.186350 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:57:12.187236 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:57:12.187479 (Thread-3): 01:57:12 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:57:12.187703 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:57:12.187777 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:57:12.190213 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:57:12.204993 (Thread-3): finished collecting timing info
2021-12-06 01:57:12.207094 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:57:12.222381 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:57:12.222463 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 01:57:12.222523 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 01:57:12.445598 (Thread-542): handling poll request
2021-12-06 01:57:12.445856 (Thread-542): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8fcee0>]}
2021-12-06 01:57:12.468389 (Thread-542): sending response (<Response 7709 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:57:13.941053 (Thread-543): handling poll request
2021-12-06 01:57:13.941379 (Thread-543): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8fcf10>]}
2021-12-06 01:57:13.941883 (Thread-543): sending response (<Response 287 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:57:14.331561 (Thread-3): SQL status: SUCCESS 1 in 2.11 seconds
2021-12-06 01:57:14.333063 (Thread-3): finished collecting timing info
2021-12-06 01:57:14.333212 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:57:14.783800 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95c817a3-434d-4dc0-a893-d3b458d2a7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3af307790>]}
2021-12-06 01:57:14.784189 (Thread-3): 01:57:14 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.60s]
2021-12-06 01:57:14.784280 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:57:14.785903 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:57:14.786244 (MainThread): 01:57:14 | 
2021-12-06 01:57:14.786312 (MainThread): 01:57:14 | Finished running 3 view models, 2 table models in 11.03s.
2021-12-06 01:57:14.786361 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:57:14.786400 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:57:14.786442 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:57:14.786478 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:57:14.786511 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:57:14.845225 (MainThread): 
2021-12-06 01:57:14.845328 (MainThread): Completed successfully
2021-12-06 01:57:14.845392 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:57:15.430163 (Thread-544): handling poll request
2021-12-06 01:57:15.430493 (Thread-544): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d909340>]}
2021-12-06 01:57:15.431885 (Thread-544): sending response (<Response 21390 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:57:16.353345 (Thread-545): handling status request
2021-12-06 01:57:16.353682 (Thread-545): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d909430>]}
2021-12-06 01:57:16.354218 (Thread-545): sending response (<Response 1551 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:57:16.385204 (Thread-546): handling status request
2021-12-06 01:57:16.385407 (Thread-546): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d909760>]}
2021-12-06 01:57:16.385772 (Thread-546): sending response (<Response 1551 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:57:20.608681 (Thread-547): handling status request
2021-12-06 01:57:20.609009 (Thread-547): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d909970>]}
2021-12-06 01:57:20.609500 (Thread-547): sending response (<Response 1551 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:57:20.770566 (Thread-548): handling status request
2021-12-06 01:57:20.770834 (Thread-548): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d909b50>]}
2021-12-06 01:57:20.771288 (Thread-548): sending response (<Response 1551 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:57:21.049205 (Thread-549): handling cli_args request
2021-12-06 01:57:21.049451 (Thread-549): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d909d30>]}
2021-12-06 01:57:22.952219 (Thread-549): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:57:22.987889 (MainThread): Partial parsing not enabled
2021-12-06 01:57:23.041118 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:57:23.043010 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:57:23.076704 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:57:23.080271 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:57:23.083203 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:57:23.087293 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:57:23.088512 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:57:23.096552 (MainThread): Parsing macros/core.sql
2021-12-06 01:57:23.100011 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:57:23.106131 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:57:23.115268 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:57:23.121885 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:57:23.125468 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:57:23.146600 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:57:23.162431 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:57:23.163931 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:57:23.192767 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:57:23.199568 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:57:23.212433 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:57:23.230675 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:57:23.239915 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:57:23.241530 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:57:23.242891 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:57:23.250658 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:57:23.251583 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:57:23.253167 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:57:23.254609 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:57:23.256890 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:57:23.258265 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:57:23.310050 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:57:23.312075 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:57:23.313130 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:57:23.314616 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:57:23.411972 (Thread-550): handling poll request
2021-12-06 01:57:23.412286 (Thread-550): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d933eb0>]}
2021-12-06 01:57:23.413348 (Thread-550): sending response (<Response 9687 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:57:23.493712 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:57:23.505214 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:57:23.507619 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:57:23.510096 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:57:23.513748 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:57:23.524924 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:57:23.656196 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '361c800f-a05b-4c7c-9b02-774343084444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098a71dbe0>]}
2021-12-06 01:57:23.689766 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '361c800f-a05b-4c7c-9b02-774343084444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098a71daf0>]}
2021-12-06 01:57:23.689974 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:57:23.691442 (MainThread): 
2021-12-06 01:57:23.691641 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:57:23.692540 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:57:23.703736 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:57:23.703826 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:57:23.703900 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 01:57:24.859628 (Thread-551): handling poll request
2021-12-06 01:57:24.859935 (Thread-551): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d933a30>]}
2021-12-06 01:57:24.860539 (Thread-551): sending response (<Response 5325 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:57:25.168811 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.46 seconds
2021-12-06 01:57:25.170917 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:57:25.623444 (MainThread): 01:57:25 | Concurrency: 4 threads (target='default')
2021-12-06 01:57:25.623584 (MainThread): 01:57:25 | 
2021-12-06 01:57:25.625631 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:57:25.625823 (Thread-1): 01:57:25 | 1 of 5 START test accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [RUN]
2021-12-06 01:57:25.626092 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 01:57:25.626206 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:57:25.626997 (Thread-2): Began running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 01:57:25.627143 (Thread-2): 01:57:25 | 2 of 5 START test assert_total_payments_amount_is_not_negative....... [RUN]
2021-12-06 01:57:25.627385 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:57:25.627457 (Thread-2): Compiling test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 01:57:25.630080 (Thread-2): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 01:57:25.630769 (Thread-3): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:57:25.630906 (Thread-3): 01:57:25 | 3 of 5 START test not_null_stg_customers_customer_id................. [RUN]
2021-12-06 01:57:25.631118 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:57:25.631184 (Thread-3): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:57:25.635855 (Thread-4): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331
2021-12-06 01:57:25.635996 (Thread-4): 01:57:25 | 4 of 5 START test relationships_stg_orders_customer_id__customer_id__stg_customers [RUN]
2021-12-06 01:57:25.636207 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331".
2021-12-06 01:57:25.636270 (Thread-4): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331
2021-12-06 01:57:25.645153 (Thread-3): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:57:25.651580 (Thread-4): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331"
2021-12-06 01:57:25.651798 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 01:57:25.657733 (Thread-2): finished collecting timing info
2021-12-06 01:57:25.663033 (Thread-4): finished collecting timing info
2021-12-06 01:57:25.683129 (Thread-2): Writing runtime SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 01:57:25.684251 (Thread-4): Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331"
2021-12-06 01:57:25.697335 (Thread-1): finished collecting timing info
2021-12-06 01:57:25.698696 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 01:57:25.698847 (Thread-3): finished collecting timing info
2021-12-06 01:57:25.699983 (Thread-3): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:57:25.704746 (Thread-4): Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331".
2021-12-06 01:57:25.704831 (Thread-4): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from analytics.dbt_pstulnikov.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-12-06 01:57:25.704901 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:57:25.709394 (Thread-2): Using snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:57:25.709472 (Thread-2): On test.jaffle_shop.assert_total_payments_amount_is_not_negative: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.assert_total_payments_amount_is_not_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select

    order_id,

    sum(amount) as total_amount

from analytics.dbt_pstulnikov.stg_payments

group by 1

having not(total_amount >= 0)
      
    ) dbt_internal_test
2021-12-06 01:57:25.709525 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:57:25.714765 (Thread-1): Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 01:57:25.714849 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from analytics.dbt_pstulnikov.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','placed','return_pending'
)



      
    ) dbt_internal_test
2021-12-06 01:57:25.714904 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:57:25.717268 (Thread-3): Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:57:25.717352 (Thread-3): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt_pstulnikov.stg_customers
where customer_id is null



      
    ) dbt_internal_test
2021-12-06 01:57:25.717407 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:57:26.323904 (Thread-552): handling poll request
2021-12-06 01:57:26.324234 (Thread-552): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9222e0>]}
2021-12-06 01:57:26.325361 (Thread-552): sending response (<Response 23247 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:57:27.479373 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2021-12-06 01:57:27.481614 (Thread-1): finished collecting timing info
2021-12-06 01:57:27.481755 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b: Close
2021-12-06 01:57:27.773122 (Thread-2): SQL status: SUCCESS 1 in 2.06 seconds
2021-12-06 01:57:27.774454 (Thread-2): finished collecting timing info
2021-12-06 01:57:27.774578 (Thread-2): On test.jaffle_shop.assert_total_payments_amount_is_not_negative: Close
2021-12-06 01:57:27.779044 (Thread-553): handling poll request
2021-12-06 01:57:27.779326 (Thread-553): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d922ca0>]}
2021-12-06 01:57:27.779864 (Thread-553): sending response (<Response 2933 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:57:27.790096 (Thread-4): SQL status: SUCCESS 1 in 2.09 seconds
2021-12-06 01:57:27.791222 (Thread-4): finished collecting timing info
2021-12-06 01:57:27.791333 (Thread-4): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331: Close
2021-12-06 01:57:27.800122 (Thread-3): SQL status: SUCCESS 1 in 2.08 seconds
2021-12-06 01:57:27.801199 (Thread-3): finished collecting timing info
2021-12-06 01:57:27.801300 (Thread-3): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
2021-12-06 01:57:27.940384 (Thread-1): 01:57:27 | 1 of 5 PASS accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [PASS in 2.31s]
2021-12-06 01:57:27.940497 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:57:27.940605 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:57:27.940695 (Thread-1): 01:57:27 | 5 of 5 START test unique_stg_customers_customer_id................... [RUN]
2021-12-06 01:57:27.940886 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:57:27.940956 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:57:27.947819 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:57:27.966272 (Thread-1): finished collecting timing info
2021-12-06 01:57:27.967543 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:57:27.985310 (Thread-1): Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:57:27.985390 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.dbt_pstulnikov.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-06 01:57:27.985448 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:57:28.223263 (Thread-2): 01:57:28 | 2 of 5 PASS assert_total_payments_amount_is_not_negative............. [PASS in 2.60s]
2021-12-06 01:57:28.223365 (Thread-2): Finished running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 01:57:28.244831 (Thread-4): 01:57:28 | 4 of 5 PASS relationships_stg_orders_customer_id__customer_id__stg_customers [PASS in 2.61s]
2021-12-06 01:57:28.244929 (Thread-4): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331
2021-12-06 01:57:28.246986 (Thread-3): 01:57:28 | 3 of 5 PASS not_null_stg_customers_customer_id....................... [PASS in 2.62s]
2021-12-06 01:57:28.247087 (Thread-3): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:57:29.275328 (Thread-554): handling poll request
2021-12-06 01:57:29.275643 (Thread-554): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8bbaf0>]}
2021-12-06 01:57:29.276365 (Thread-554): sending response (<Response 11681 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:57:29.321611 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-12-06 01:57:29.323080 (Thread-1): finished collecting timing info
2021-12-06 01:57:29.323217 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
2021-12-06 01:57:29.787204 (Thread-1): 01:57:29 | 5 of 5 PASS unique_stg_customers_customer_id......................... [PASS in 1.85s]
2021-12-06 01:57:29.787347 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:57:29.788884 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:57:29.789167 (MainThread): 01:57:29 | 
2021-12-06 01:57:29.789249 (MainThread): 01:57:29 | Finished running 5 tests in 6.10s.
2021-12-06 01:57:29.789295 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:57:29.789333 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 01:57:29.789371 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_not_negative' was properly closed.
2021-12-06 01:57:29.789404 (MainThread): Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
2021-12-06 01:57:29.789436 (MainThread): Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__stg_customers.37259f5331' was properly closed.
2021-12-06 01:57:29.858345 (MainThread): 
2021-12-06 01:57:29.858454 (MainThread): Completed successfully
2021-12-06 01:57:29.858517 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:57:30.725685 (Thread-555): handling poll request
2021-12-06 01:57:30.726043 (Thread-555): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8e0550>]}
2021-12-06 01:57:30.727453 (Thread-555): sending response (<Response 20133 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:57:31.602418 (Thread-556): handling status request
2021-12-06 01:57:31.602756 (Thread-556): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8e0640>]}
2021-12-06 01:57:31.603310 (Thread-556): sending response (<Response 1551 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:57:32.005727 (Thread-557): handling status request
2021-12-06 01:57:32.006104 (Thread-557): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8e0970>]}
2021-12-06 01:57:32.006624 (Thread-557): sending response (<Response 1551 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:58:12.864311 (Thread-558): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:58:12.864694 (Thread-558): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 01:58:12.868416 (Thread-558): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:58:12.930370 (Thread-558): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d84f3a0>]}
2021-12-06 01:58:13.730899 (Thread-559): handling status request
2021-12-06 01:58:13.731221 (Thread-559): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d864cd0>]}
2021-12-06 01:58:13.731722 (Thread-559): sending response (<Response 1551 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:58:13.806256 (Thread-560): handling status request
2021-12-06 01:58:13.806476 (Thread-560): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429da14d60>]}
2021-12-06 01:58:13.806861 (Thread-560): sending response (<Response 1551 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:58:18.490763 (Thread-561): handling status request
2021-12-06 01:58:18.491112 (Thread-561): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dae2520>]}
2021-12-06 01:58:18.491626 (Thread-561): sending response (<Response 1551 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:58:18.860104 (Thread-562): handling status request
2021-12-06 01:58:18.860382 (Thread-562): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d84f040>]}
2021-12-06 01:58:18.860848 (Thread-562): sending response (<Response 1551 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:58:18.930835 (Thread-563): handling cli_args request
2021-12-06 01:58:18.931062 (Thread-563): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d84f130>]}
2021-12-06 01:58:18.941520 (Thread-563): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:58:20.867736 (Thread-563): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:58:20.902890 (MainThread): Partial parsing not enabled
2021-12-06 01:58:20.960517 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:58:20.962422 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:58:20.996097 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:58:20.999723 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:58:21.002701 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:58:21.006802 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:58:21.008013 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:58:21.016121 (MainThread): Parsing macros/core.sql
2021-12-06 01:58:21.019598 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:58:21.025717 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:58:21.034914 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:58:21.041536 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:58:21.045135 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:58:21.066287 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:58:21.082203 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:58:21.083702 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:58:21.112973 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:58:21.119825 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:58:21.132772 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:58:21.151104 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:58:21.160392 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:58:21.162045 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:58:21.163377 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:58:21.171167 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:58:21.172096 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:58:21.173685 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:58:21.175123 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:58:21.177388 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:58:21.178769 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:58:21.230537 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:58:21.232565 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:58:21.233617 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:58:21.235117 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:58:21.319982 (Thread-564): handling poll request
2021-12-06 01:58:21.320307 (Thread-564): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d918fa0>]}
2021-12-06 01:58:21.321398 (Thread-564): sending response (<Response 9686 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:58:21.413442 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:58:21.424909 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:58:21.427262 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:58:21.429685 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:58:21.433306 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:58:21.444461 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:58:21.574219 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e8f0ee3-cc42-4961-83a9-e46a7a0318f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dfca48fa0>]}
2021-12-06 01:58:21.609039 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e8f0ee3-cc42-4961-83a9-e46a7a0318f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dfcaa4550>]}
2021-12-06 01:58:21.609238 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:58:21.610662 (MainThread): 
2021-12-06 01:58:21.610857 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:58:21.611700 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:58:21.622943 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:58:21.623011 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:58:21.623064 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:58:22.792612 (Thread-565): handling poll request
2021-12-06 01:58:22.792934 (Thread-565): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d864d60>]}
2021-12-06 01:58:22.793542 (Thread-565): sending response (<Response 5274 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:58:23.165798 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.54 seconds
2021-12-06 01:58:23.167648 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:58:23.623318 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:58:23.630728 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:58:23.630837 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:58:23.630905 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:58:24.290118 (Thread-566): handling poll request
2021-12-06 01:58:24.290433 (Thread-566): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8780a0>]}
2021-12-06 01:58:24.290973 (Thread-566): sending response (<Response 2263 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:58:25.055617 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.42 seconds
2021-12-06 01:58:25.057062 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:58:25.496961 (MainThread): 01:58:25 | Concurrency: 4 threads (target='default')
2021-12-06 01:58:25.497106 (MainThread): 01:58:25 | 
2021-12-06 01:58:25.499069 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:58:25.499372 (Thread-1): 01:58:25 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:58:25.499598 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:58:25.499700 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:58:25.500588 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:58:25.500811 (Thread-2): 01:58:25 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:58:25.501037 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:58:25.501107 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:58:25.502258 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:58:25.502839 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:58:25.503032 (Thread-3): 01:58:25 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:58:25.503241 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:58:25.503305 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:58:25.504246 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:58:25.505175 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:58:25.521374 (Thread-1): finished collecting timing info
2021-12-06 01:58:25.526599 (Thread-3): finished collecting timing info
2021-12-06 01:58:25.546757 (Thread-2): finished collecting timing info
2021-12-06 01:58:25.551485 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:58:25.554338 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:58:25.557765 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:58:25.570315 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:58:25.570395 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:58:25.570454 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:58:25.572672 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:58:25.572766 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:58:25.572825 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:58:25.573837 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:58:25.573907 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:58:25.573986 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:58:25.766235 (Thread-567): handling poll request
2021-12-06 01:58:25.766502 (Thread-567): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7fe310>]}
2021-12-06 01:58:25.767367 (Thread-567): sending response (<Response 14241 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:58:27.239494 (Thread-2): SQL status: SUCCESS 1 in 1.67 seconds
2021-12-06 01:58:27.245831 (Thread-2): finished collecting timing info
2021-12-06 01:58:27.245990 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:58:27.249533 (Thread-568): handling poll request
2021-12-06 01:58:27.249808 (Thread-568): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7fe610>]}
2021-12-06 01:58:27.250326 (Thread-568): sending response (<Response 1368 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:58:27.257511 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-12-06 01:58:27.258631 (Thread-1): finished collecting timing info
2021-12-06 01:58:27.258732 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:58:27.259781 (Thread-3): SQL status: SUCCESS 1 in 1.69 seconds
2021-12-06 01:58:27.260818 (Thread-3): finished collecting timing info
2021-12-06 01:58:27.260914 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:58:27.685641 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8f0ee3-cc42-4961-83a9-e46a7a0318f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0defac1610>]}
2021-12-06 01:58:27.686066 (Thread-2): 01:58:27 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.18s]
2021-12-06 01:58:27.686159 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:58:27.704669 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8f0ee3-cc42-4961-83a9-e46a7a0318f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dfca68430>]}
2021-12-06 01:58:27.704935 (Thread-3): 01:58:27 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.20s]
2021-12-06 01:58:27.705007 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:58:27.705553 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:58:27.705748 (Thread-4): 01:58:27 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:58:27.706003 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:58:27.706080 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:58:27.708345 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:58:27.713011 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8f0ee3-cc42-4961-83a9-e46a7a0318f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0defb22400>]}
2021-12-06 01:58:27.713263 (Thread-1): 01:58:27 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.21s]
2021-12-06 01:58:27.713334 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:58:27.722411 (Thread-4): finished collecting timing info
2021-12-06 01:58:27.739023 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:58:27.755196 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:58:27.755278 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 01:58:27.755338 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:58:28.745431 (Thread-569): handling poll request
2021-12-06 01:58:28.745746 (Thread-569): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d80b1c0>]}
2021-12-06 01:58:28.746522 (Thread-569): sending response (<Response 10997 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:58:29.803337 (Thread-4): SQL status: SUCCESS 1 in 2.05 seconds
2021-12-06 01:58:29.807860 (Thread-4): finished collecting timing info
2021-12-06 01:58:29.807993 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:58:30.213703 (Thread-570): handling poll request
2021-12-06 01:58:30.214032 (Thread-570): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d80b4c0>]}
2021-12-06 01:58:30.214554 (Thread-570): sending response (<Response 1368 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:58:30.266321 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8f0ee3-cc42-4961-83a9-e46a7a0318f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0defa5ea60>]}
2021-12-06 01:58:30.266686 (Thread-4): 01:58:30 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.56s]
2021-12-06 01:58:30.266772 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:58:30.267675 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:58:30.267951 (Thread-3): 01:58:30 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:58:30.268178 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:58:30.268256 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:58:30.270698 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:58:30.286199 (Thread-3): finished collecting timing info
2021-12-06 01:58:30.288210 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:58:30.303196 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:58:30.303276 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 01:58:30.303333 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 01:58:31.707987 (Thread-571): handling poll request
2021-12-06 01:58:31.708291 (Thread-571): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d80bbe0>]}
2021-12-06 01:58:31.708904 (Thread-571): sending response (<Response 6625 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:58:32.428323 (Thread-3): SQL status: SUCCESS 1 in 2.12 seconds
2021-12-06 01:58:32.429790 (Thread-3): finished collecting timing info
2021-12-06 01:58:32.429927 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:58:32.883058 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8f0ee3-cc42-4961-83a9-e46a7a0318f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dec582970>]}
2021-12-06 01:58:32.883446 (Thread-3): 01:58:32 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.61s]
2021-12-06 01:58:32.883528 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:58:32.885042 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:58:32.885366 (MainThread): 01:58:32 | 
2021-12-06 01:58:32.885439 (MainThread): 01:58:32 | Finished running 3 view models, 2 table models in 11.27s.
2021-12-06 01:58:32.885486 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:58:32.885524 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:58:32.885559 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:58:32.885593 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:58:32.885628 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:58:32.942084 (MainThread): 
2021-12-06 01:58:32.942186 (MainThread): Completed successfully
2021-12-06 01:58:32.942249 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:58:33.250761 (Thread-572): handling poll request
2021-12-06 01:58:33.251083 (Thread-572): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d819880>]}
2021-12-06 01:58:33.275146 (Thread-572): sending response (<Response 21392 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:58:34.213517 (Thread-573): handling status request
2021-12-06 01:58:34.213830 (Thread-573): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d819b80>]}
2021-12-06 01:58:34.214373 (Thread-573): sending response (<Response 1551 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:58:34.246505 (Thread-574): handling status request
2021-12-06 01:58:34.246717 (Thread-574): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8199d0>]}
2021-12-06 01:58:34.247111 (Thread-574): sending response (<Response 1551 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:58:41.799918 (Thread-575): handling status request
2021-12-06 01:58:41.800232 (Thread-575): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d819dc0>]}
2021-12-06 01:58:41.800694 (Thread-575): sending response (<Response 1551 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:58:42.118089 (Thread-576): handling status request
2021-12-06 01:58:42.118332 (Thread-576): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d811160>]}
2021-12-06 01:58:42.118756 (Thread-576): sending response (<Response 1551 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:58:42.242549 (Thread-577): handling cli_args request
2021-12-06 01:58:42.242805 (Thread-577): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8fcb20>]}
2021-12-06 01:58:44.165425 (Thread-577): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:58:44.201439 (MainThread): Partial parsing not enabled
2021-12-06 01:58:44.258181 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:58:44.260068 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:58:44.293770 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:58:44.297382 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:58:44.300414 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:58:44.304538 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:58:44.305770 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:58:44.313914 (MainThread): Parsing macros/core.sql
2021-12-06 01:58:44.317385 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:58:44.323564 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:58:44.332756 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:58:44.339484 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:58:44.343117 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:58:44.364379 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:58:44.380321 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:58:44.381836 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:58:44.410860 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:58:44.417683 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:58:44.430651 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:58:44.448943 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:58:44.458294 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:58:44.459942 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:58:44.461283 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:58:44.469073 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:58:44.470035 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:58:44.471641 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:58:44.473057 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:58:44.475352 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:58:44.476693 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:58:44.528718 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:58:44.530807 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:58:44.531872 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:58:44.533353 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:58:44.611709 (Thread-578): handling poll request
2021-12-06 01:58:44.611983 (Thread-578): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7c76a0>]}
2021-12-06 01:58:44.612978 (Thread-578): sending response (<Response 9685 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:58:44.713357 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:58:44.725349 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:58:44.727856 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:58:44.730433 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:58:44.734192 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:58:44.745626 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:58:44.886189 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42d299d3-82cb-4856-a438-995cf91f35a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e8d58b80>]}
2021-12-06 01:58:44.931197 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42d299d3-82cb-4856-a438-995cf91f35a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e8bc08b0>]}
2021-12-06 01:58:44.931398 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:58:44.932906 (MainThread): 
2021-12-06 01:58:44.933111 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:58:44.934101 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:58:44.945189 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:58:44.945260 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:58:44.945314 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 01:58:46.437446 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.49 seconds
2021-12-06 01:58:46.439566 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:58:46.907737 (MainThread): 01:58:46 | Concurrency: 4 threads (target='default')
2021-12-06 01:58:46.907883 (MainThread): 01:58:46 | 
2021-12-06 01:58:46.909921 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:58:46.910114 (Thread-1): 01:58:46 | 1 of 5 START test accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [RUN]
2021-12-06 01:58:46.910346 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 01:58:46.910449 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:58:46.911209 (Thread-2): Began running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 01:58:46.911343 (Thread-2): 01:58:46 | 2 of 5 START test assert_total_payments_amount_is_not_negative....... [RUN]
2021-12-06 01:58:46.911569 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:58:46.911640 (Thread-2): Compiling test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 01:58:46.914178 (Thread-2): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 01:58:46.914834 (Thread-3): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:58:46.914968 (Thread-3): 01:58:46 | 3 of 5 START test not_null_stg_customers_customer_id................. [RUN]
2021-12-06 01:58:46.915182 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:58:46.915250 (Thread-3): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:58:46.919938 (Thread-4): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 01:58:46.920057 (Thread-4): 01:58:46 | 4 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2021-12-06 01:58:46.920263 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-12-06 01:58:46.920326 (Thread-4): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 01:58:46.929205 (Thread-3): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:58:46.930937 (Thread-4): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-12-06 01:58:46.936157 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 01:58:46.943133 (Thread-2): finished collecting timing info
2021-12-06 01:58:46.948208 (Thread-4): finished collecting timing info
2021-12-06 01:58:46.963553 (Thread-3): finished collecting timing info
2021-12-06 01:58:46.971579 (Thread-2): Writing runtime SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 01:58:46.972647 (Thread-4): Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-12-06 01:58:46.974150 (Thread-3): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 01:58:46.980997 (Thread-1): finished collecting timing info
2021-12-06 01:58:46.983349 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 01:58:46.985268 (Thread-4): Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-12-06 01:58:46.985354 (Thread-4): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from analytics.dbt_pstulnikov.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from analytics.dbt_pstulnikov.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-12-06 01:58:46.985419 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:58:46.989760 (Thread-3): Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 01:58:46.989843 (Thread-3): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt_pstulnikov.stg_customers
where customer_id is null



      
    ) dbt_internal_test
2021-12-06 01:58:46.989901 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:58:46.991256 (Thread-2): Using snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 01:58:46.991331 (Thread-2): On test.jaffle_shop.assert_total_payments_amount_is_not_negative: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.assert_total_payments_amount_is_not_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select

    order_id,

    sum(amount) as total_amount

from analytics.dbt_pstulnikov.stg_payments

group by 1

having not(total_amount >= 0)
      
    ) dbt_internal_test
2021-12-06 01:58:46.991385 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:58:47.002485 (Thread-1): Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 01:58:47.002567 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from analytics.dbt_pstulnikov.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','placed','return_pending'
)



      
    ) dbt_internal_test
2021-12-06 01:58:47.002622 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:58:47.364086 (Thread-579): handling poll request
2021-12-06 01:58:47.364315 (Thread-579): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d811790>]}
2021-12-06 01:58:47.365429 (Thread-579): sending response (<Response 28448 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:58:48.860693 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2021-12-06 01:58:48.863850 (Thread-1): finished collecting timing info
2021-12-06 01:58:48.864032 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b: Close
2021-12-06 01:58:48.960925 (Thread-3): SQL status: SUCCESS 1 in 1.97 seconds
2021-12-06 01:58:48.962414 (Thread-3): finished collecting timing info
2021-12-06 01:58:48.962552 (Thread-3): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
2021-12-06 01:58:49.077809 (Thread-2): SQL status: SUCCESS 1 in 2.09 seconds
2021-12-06 01:58:49.079845 (Thread-2): finished collecting timing info
2021-12-06 01:58:49.080036 (Thread-2): On test.jaffle_shop.assert_total_payments_amount_is_not_negative: Close
2021-12-06 01:58:49.157456 (Thread-580): handling poll request
2021-12-06 01:58:49.157797 (Thread-580): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d820fa0>]}
2021-12-06 01:58:49.158423 (Thread-580): sending response (<Response 4152 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:58:49.319902 (Thread-4): SQL status: SUCCESS 1 in 2.33 seconds
2021-12-06 01:58:49.321252 (Thread-4): finished collecting timing info
2021-12-06 01:58:49.321377 (Thread-4): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
2021-12-06 01:58:49.324656 (Thread-1): 01:58:49 | 1 of 5 PASS accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [PASS in 2.41s]
2021-12-06 01:58:49.324768 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 01:58:49.324872 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:58:49.324961 (Thread-1): 01:58:49 | 5 of 5 START test unique_stg_customers_customer_id................... [RUN]
2021-12-06 01:58:49.325149 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:58:49.325220 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:58:49.331847 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:58:49.347556 (Thread-1): finished collecting timing info
2021-12-06 01:58:49.348832 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 01:58:49.364822 (Thread-1): Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 01:58:49.364898 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from analytics.dbt_pstulnikov.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-06 01:58:49.364954 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:58:49.433780 (Thread-3): 01:58:49 | 3 of 5 PASS not_null_stg_customers_customer_id....................... [PASS in 2.52s]
2021-12-06 01:58:49.433899 (Thread-3): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 01:58:49.526791 (Thread-2): 01:58:49 | 2 of 5 PASS assert_total_payments_amount_is_not_negative............. [PASS in 2.62s]
2021-12-06 01:58:49.526904 (Thread-2): Finished running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 01:58:49.775386 (Thread-4): 01:58:49 | 4 of 5 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 2.86s]
2021-12-06 01:58:49.775511 (Thread-4): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 01:58:50.760543 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-12-06 01:58:50.762015 (Thread-1): finished collecting timing info
2021-12-06 01:58:50.762140 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
2021-12-06 01:58:51.206477 (Thread-1): 01:58:51 | 5 of 5 PASS unique_stg_customers_customer_id......................... [PASS in 1.88s]
2021-12-06 01:58:51.206601 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 01:58:51.208138 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:58:51.208407 (MainThread): 01:58:51 | 
2021-12-06 01:58:51.208473 (MainThread): 01:58:51 | Finished running 5 tests in 6.28s.
2021-12-06 01:58:51.208520 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:58:51.208559 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 01:58:51.208593 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_not_negative' was properly closed.
2021-12-06 01:58:51.208627 (MainThread): Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
2021-12-06 01:58:51.208661 (MainThread): Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
2021-12-06 01:58:51.263963 (MainThread): 
2021-12-06 01:58:51.264067 (MainThread): Completed successfully
2021-12-06 01:58:51.264130 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:58:51.279158 (Thread-581): handling poll request
2021-12-06 01:58:51.279403 (Thread-581): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7e9df0>]}
2021-12-06 01:58:51.280255 (Thread-581): sending response (<Response 16277 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:58:53.140855 (Thread-582): handling poll request
2021-12-06 01:58:53.141251 (Thread-582): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7e9c10>]}
2021-12-06 01:58:53.142655 (Thread-582): sending response (<Response 14464 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:58:54.046054 (Thread-583): handling status request
2021-12-06 01:58:54.046366 (Thread-583): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7dc070>]}
2021-12-06 01:58:54.046886 (Thread-583): sending response (<Response 1551 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:58:54.104254 (Thread-584): handling status request
2021-12-06 01:58:54.104484 (Thread-584): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7dc2e0>]}
2021-12-06 01:58:54.104883 (Thread-584): sending response (<Response 1551 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:59:04.017326 (Thread-585): handling status request
2021-12-06 01:59:04.017643 (Thread-585): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7dc4f0>]}
2021-12-06 01:59:04.018176 (Thread-585): sending response (<Response 1551 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:59:08.394609 (Thread-586): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 01:59:08.394956 (Thread-586): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 01:59:08.400292 (Thread-586): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d74d100>]}
2021-12-06 01:59:09.266599 (Thread-587): handling status request
2021-12-06 01:59:09.266908 (Thread-587): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d74d400>]}
2021-12-06 01:59:09.267427 (Thread-587): sending response (<Response 1212 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:59:09.342704 (Thread-588): handling status request
2021-12-06 01:59:09.342967 (Thread-588): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7493a0>]}
2021-12-06 01:59:09.343397 (Thread-588): sending response (<Response 1212 bytes [200 OK]>) to 10.0.30.196
2021-12-06 02:11:37.030842 (Thread-589): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 02:11:37.032728 (Thread-589): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 02:11:37.036389 (Thread-589): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 02:11:37.094428 (Thread-589): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6ec160>]}
2021-12-06 02:11:37.854778 (Thread-590): handling status request
2021-12-06 02:11:37.855078 (Thread-590): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7441c0>]}
2021-12-06 02:11:37.855572 (Thread-590): sending response (<Response 1554 bytes [200 OK]>) to 10.0.31.30
2021-12-06 02:11:37.862513 (Thread-591): handling status request
2021-12-06 02:11:37.862713 (Thread-591): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8110d0>]}
2021-12-06 02:11:37.863096 (Thread-591): sending response (<Response 1554 bytes [200 OK]>) to 10.0.36.143
2021-12-06 02:12:00.909871 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 02:12:00.983431 (Thread-592): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 02:12:00.983753 (Thread-592): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 02:12:00.987058 (Thread-592): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 02:12:01.180504 (Thread-592): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fc4ee0>]}
2021-12-06 02:12:01.832378 (Thread-593): handling status request
2021-12-06 02:12:01.832692 (Thread-593): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d733880>]}
2021-12-06 02:12:01.833176 (Thread-593): sending response (<Response 1554 bytes [200 OK]>) to 10.0.37.206
2021-12-06 02:12:01.893295 (Thread-594): handling status request
2021-12-06 02:12:01.893622 (Thread-594): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d733040>]}
2021-12-06 02:12:01.894182 (Thread-594): sending response (<Response 1554 bytes [200 OK]>) to 10.0.6.10
2021-12-06 02:12:26.773072 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 02:12:26.873337 (Thread-595): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 02:12:26.873644 (Thread-595): Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/jaffle_shop.md
2021-12-06 02:12:26.913313 (Thread-595): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8bafd0>]}
2021-12-06 02:12:27.663699 (Thread-596): handling status request
2021-12-06 02:12:27.664020 (Thread-596): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6f78b0>]}
2021-12-06 02:12:27.664504 (Thread-596): sending response (<Response 1238 bytes [200 OK]>) to 10.0.0.217
2021-12-06 02:12:27.730636 (Thread-597): handling status request
2021-12-06 02:12:27.730858 (Thread-597): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6f78e0>]}
2021-12-06 02:12:27.731249 (Thread-597): sending response (<Response 1238 bytes [200 OK]>) to 10.0.38.70
2021-12-06 02:13:44.348400 (Thread-598): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 02:13:44.350467 (Thread-598): Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/jaffle_shop.md
2021-12-06 02:13:44.399593 (Thread-598): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429da11550>]}
2021-12-06 02:13:45.120543 (Thread-599): handling status request
2021-12-06 02:13:45.120852 (Thread-599): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8646d0>]}
2021-12-06 02:13:45.121318 (Thread-599): sending response (<Response 1240 bytes [200 OK]>) to 10.0.31.30
2021-12-06 02:13:45.259236 (Thread-600): handling status request
2021-12-06 02:13:45.259529 (Thread-600): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d864a60>]}
2021-12-06 02:13:45.259979 (Thread-600): sending response (<Response 1240 bytes [200 OK]>) to 10.0.38.70
2021-12-06 02:14:58.084687 (Thread-601): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 02:14:58.086414 (Thread-601): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 02:14:58.089971 (Thread-601): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 02:14:58.163020 (Thread-601): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd52c40>]}
2021-12-06 02:14:58.885659 (Thread-602): handling status request
2021-12-06 02:14:58.886008 (Thread-602): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d946790>]}
2021-12-06 02:14:58.890152 (Thread-603): handling status request
2021-12-06 02:14:58.890412 (Thread-603): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d954a90>]}
2021-12-06 02:14:58.907324 (Thread-602): sending response (<Response 1551 bytes [200 OK]>) to 10.0.36.143
2021-12-06 02:14:58.907718 (Thread-603): sending response (<Response 1551 bytes [200 OK]>) to 10.0.26.3
2021-12-06 02:15:17.438249 (Thread-604): handling status request
2021-12-06 02:15:17.438576 (Thread-604): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd7c190>]}
2021-12-06 02:15:17.439077 (Thread-604): sending response (<Response 1551 bytes [200 OK]>) to 10.0.39.19
2021-12-06 02:15:17.732861 (Thread-605): handling status request
2021-12-06 02:15:17.733192 (Thread-605): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd7c8b0>]}
2021-12-06 02:15:17.733663 (Thread-605): sending response (<Response 1551 bytes [200 OK]>) to 10.0.6.10
2021-12-06 02:15:17.873288 (Thread-606): handling cli_args request
2021-12-06 02:15:17.873545 (Thread-606): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9462b0>]}
2021-12-06 02:15:17.884470 (Thread-606): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 02:15:19.798152 (Thread-606): sending response (<Response 138 bytes [200 OK]>) to 10.0.30.196
2021-12-06 02:15:19.833304 (MainThread): Partial parsing not enabled
2021-12-06 02:15:19.888776 (MainThread): Parsing macros/catalog.sql
2021-12-06 02:15:19.890719 (MainThread): Parsing macros/adapters.sql
2021-12-06 02:15:19.924561 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 02:15:19.928178 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 02:15:19.931168 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 02:15:19.935335 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 02:15:19.936564 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 02:15:19.944688 (MainThread): Parsing macros/core.sql
2021-12-06 02:15:19.948190 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 02:15:19.954396 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 02:15:19.963629 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 02:15:19.970300 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 02:15:19.973899 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 02:15:19.995344 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 02:15:20.011276 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 02:15:20.012783 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 02:15:20.042115 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 02:15:20.048871 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 02:15:20.061808 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 02:15:20.080258 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 02:15:20.089601 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 02:15:20.091281 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 02:15:20.092617 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 02:15:20.100469 (MainThread): Parsing macros/etc/query.sql
2021-12-06 02:15:20.101412 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 02:15:20.103080 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 02:15:20.104509 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 02:15:20.106819 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 02:15:20.108162 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 02:15:20.160932 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 02:15:20.162993 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 02:15:20.164066 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 02:15:20.165548 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 02:15:20.241028 (Thread-607): handling poll request
2021-12-06 02:15:20.241332 (Thread-607): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d954ca0>]}
2021-12-06 02:15:20.242513 (Thread-607): sending response (<Response 9686 bytes [200 OK]>) to 10.0.19.103
2021-12-06 02:15:20.344373 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 02:15:20.356190 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 02:15:20.358629 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 02:15:20.361099 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 02:15:20.364769 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 02:15:20.376098 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 02:15:20.512581 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cbe76cd-a48f-4de1-b97c-7849a3eded98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedae3c1f0>]}
2021-12-06 02:15:20.549634 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cbe76cd-a48f-4de1-b97c-7849a3eded98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedacf4f70>]}
2021-12-06 02:15:20.549833 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 02:15:20.551283 (MainThread): 
2021-12-06 02:15:20.551492 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 02:15:20.552347 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 02:15:20.563568 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 02:15:20.563637 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 02:15:20.563691 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 02:15:21.727054 (Thread-608): handling poll request
2021-12-06 02:15:21.727366 (Thread-608): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5f76f10>]}
2021-12-06 02:15:21.728010 (Thread-608): sending response (<Response 5276 bytes [200 OK]>) to 10.0.2.25
2021-12-06 02:15:22.112957 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.55 seconds
2021-12-06 02:15:22.114761 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 02:15:22.573744 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 02:15:22.580734 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 02:15:22.580833 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 02:15:22.580895 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 02:15:23.222518 (Thread-609): handling poll request
2021-12-06 02:15:23.222829 (Thread-609): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b9340>]}
2021-12-06 02:15:23.223397 (Thread-609): sending response (<Response 2263 bytes [200 OK]>) to 10.0.0.217
2021-12-06 02:15:23.832702 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.25 seconds
2021-12-06 02:15:23.834267 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 02:15:24.298493 (MainThread): 02:15:24 | Concurrency: 4 threads (target='default')
2021-12-06 02:15:24.298616 (MainThread): 02:15:24 | 
2021-12-06 02:15:24.300580 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 02:15:24.300851 (Thread-1): 02:15:24 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 02:15:24.301082 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 02:15:24.301178 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 02:15:24.302051 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 02:15:24.302264 (Thread-2): 02:15:24 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 02:15:24.302485 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 02:15:24.302552 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 02:15:24.303650 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 02:15:24.304532 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 02:15:24.304710 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 02:15:24.304914 (Thread-3): 02:15:24 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 02:15:24.305293 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 02:15:24.305366 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 02:15:24.306297 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 02:15:24.322164 (Thread-3): finished collecting timing info
2021-12-06 02:15:24.327468 (Thread-2): finished collecting timing info
2021-12-06 02:15:24.343089 (Thread-1): finished collecting timing info
2021-12-06 02:15:24.357836 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 02:15:24.361155 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 02:15:24.363138 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 02:15:24.377090 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 02:15:24.377170 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 02:15:24.377227 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 02:15:24.378500 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 02:15:24.378582 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 02:15:24.378636 (Thread-3): Opening a new connection, currently in state init
2021-12-06 02:15:24.380261 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 02:15:24.380332 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 02:15:24.380385 (Thread-2): Opening a new connection, currently in state init
2021-12-06 02:15:24.654466 (Thread-610): handling poll request
2021-12-06 02:15:24.654706 (Thread-610): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d733850>]}
2021-12-06 02:15:24.655625 (Thread-610): sending response (<Response 14241 bytes [200 OK]>) to 10.0.26.3
2021-12-06 02:15:26.024869 (Thread-3): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-06 02:15:26.031323 (Thread-3): finished collecting timing info
2021-12-06 02:15:26.031452 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 02:15:26.103435 (Thread-611): handling poll request
2021-12-06 02:15:26.103731 (Thread-611): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d733f10>]}
2021-12-06 02:15:26.104261 (Thread-611): sending response (<Response 1376 bytes [200 OK]>) to 10.0.6.10
2021-12-06 02:15:26.148120 (Thread-1): SQL status: SUCCESS 1 in 1.77 seconds
2021-12-06 02:15:26.149388 (Thread-1): finished collecting timing info
2021-12-06 02:15:26.149512 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 02:15:26.167043 (Thread-2): SQL status: SUCCESS 1 in 1.79 seconds
2021-12-06 02:15:26.168116 (Thread-2): finished collecting timing info
2021-12-06 02:15:26.168216 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 02:15:26.483574 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cbe76cd-a48f-4de1-b97c-7849a3eded98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedad81700>]}
2021-12-06 02:15:26.483913 (Thread-3): 02:15:26 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.18s]
2021-12-06 02:15:26.483996 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 02:15:26.589043 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cbe76cd-a48f-4de1-b97c-7849a3eded98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed999d160>]}
2021-12-06 02:15:26.589319 (Thread-1): 02:15:26 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.29s]
2021-12-06 02:15:26.589389 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 02:15:26.627595 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cbe76cd-a48f-4de1-b97c-7849a3eded98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed9e177c0>]}
2021-12-06 02:15:26.627852 (Thread-2): 02:15:26 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.33s]
2021-12-06 02:15:26.627921 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 02:15:26.628724 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 02:15:26.628953 (Thread-4): 02:15:26 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 02:15:26.629189 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 02:15:26.629264 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 02:15:26.631591 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 02:15:26.646759 (Thread-4): finished collecting timing info
2021-12-06 02:15:26.662871 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 02:15:26.678643 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 02:15:26.678719 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 02:15:26.678775 (Thread-4): Opening a new connection, currently in state init
2021-12-06 02:15:27.575053 (Thread-612): handling poll request
2021-12-06 02:15:27.575362 (Thread-612): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d846be0>]}
2021-12-06 02:15:27.576176 (Thread-612): sending response (<Response 10989 bytes [200 OK]>) to 10.0.6.10
2021-12-06 02:15:29.022787 (Thread-613): handling poll request
2021-12-06 02:15:29.023119 (Thread-613): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d846670>]}
2021-12-06 02:15:29.023960 (Thread-613): sending response (<Response 287 bytes [200 OK]>) to 10.0.6.71
2021-12-06 02:15:29.200311 (Thread-4): SQL status: SUCCESS 1 in 2.52 seconds
2021-12-06 02:15:29.204864 (Thread-4): finished collecting timing info
2021-12-06 02:15:29.204999 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 02:15:29.658874 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cbe76cd-a48f-4de1-b97c-7849a3eded98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed9ee2430>]}
2021-12-06 02:15:29.659260 (Thread-4): 02:15:29 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 3.03s]
2021-12-06 02:15:29.659349 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 02:15:29.660192 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-12-06 02:15:29.660451 (Thread-1): 02:15:29 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 02:15:29.660670 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 02:15:29.660744 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-12-06 02:15:29.663084 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 02:15:29.677763 (Thread-1): finished collecting timing info
2021-12-06 02:15:29.679752 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 02:15:29.694756 (Thread-1): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 02:15:29.694833 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 02:15:29.694889 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 02:15:30.492307 (Thread-614): handling poll request
2021-12-06 02:15:30.492613 (Thread-614): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9542b0>]}
2021-12-06 02:15:30.493289 (Thread-614): sending response (<Response 7709 bytes [200 OK]>) to 10.0.38.70
2021-12-06 02:15:31.951745 (Thread-615): handling poll request
2021-12-06 02:15:31.952061 (Thread-615): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9acd60>]}
2021-12-06 02:15:31.952540 (Thread-615): sending response (<Response 287 bytes [200 OK]>) to 10.0.6.71
2021-12-06 02:15:32.162520 (Thread-1): SQL status: SUCCESS 1 in 2.47 seconds
2021-12-06 02:15:32.163882 (Thread-1): finished collecting timing info
2021-12-06 02:15:32.164007 (Thread-1): On model.jaffle_shop.dim_customers: Close
2021-12-06 02:15:32.616333 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cbe76cd-a48f-4de1-b97c-7849a3eded98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed9ec0f10>]}
2021-12-06 02:15:32.616639 (Thread-1): 02:15:32 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.96s]
2021-12-06 02:15:32.616716 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-12-06 02:15:32.618183 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 02:15:32.618477 (MainThread): 02:15:32 | 
2021-12-06 02:15:32.618544 (MainThread): 02:15:32 | Finished running 3 view models, 2 table models in 12.07s.
2021-12-06 02:15:32.618593 (MainThread): Connection 'master' was properly closed.
2021-12-06 02:15:32.618632 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 02:15:32.618667 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 02:15:32.618701 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 02:15:32.618734 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 02:15:32.678293 (MainThread): 
2021-12-06 02:15:32.678394 (MainThread): Completed successfully
2021-12-06 02:15:32.678459 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 02:15:33.389949 (Thread-616): handling poll request
2021-12-06 02:15:33.390264 (Thread-616): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7d4970>]}
2021-12-06 02:15:33.391783 (Thread-616): sending response (<Response 21982 bytes [200 OK]>) to 10.0.19.103
2021-12-06 02:15:34.269640 (Thread-617): handling status request
2021-12-06 02:15:34.269969 (Thread-617): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6e0400>]}
2021-12-06 02:15:34.270490 (Thread-617): sending response (<Response 1551 bytes [200 OK]>) to 10.0.13.223
2021-12-06 02:15:34.342818 (Thread-618): handling status request
2021-12-06 02:15:34.343056 (Thread-618): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6e0a00>]}
2021-12-06 02:15:34.343517 (Thread-618): sending response (<Response 1551 bytes [200 OK]>) to 10.0.39.19
2021-12-06 02:16:57.010845 (Thread-619): handling status request
2021-12-06 02:16:57.013191 (Thread-619): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6e02b0>]}
2021-12-06 02:16:57.013733 (Thread-619): sending response (<Response 1551 bytes [200 OK]>) to 10.0.30.196
2021-12-06 02:16:57.422767 (Thread-620): handling status request
2021-12-06 02:16:57.423062 (Thread-620): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6e0370>]}
2021-12-06 02:16:57.423521 (Thread-620): sending response (<Response 1551 bytes [200 OK]>) to 10.0.41.241
2021-12-06 02:16:57.550506 (Thread-621): handling docs.generate request
2021-12-06 02:16:57.550720 (Thread-621): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6e0e20>]}
2021-12-06 02:16:59.480464 (Thread-621): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.241
2021-12-06 02:16:59.512607 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1943c534-881c-48cc-8f78-92c4ba592bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3288bb1340>]}
2021-12-06 02:16:59.512845 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 02:16:59.514486 (MainThread): 
2021-12-06 02:16:59.514599 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 02:16:59.515318 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 02:16:59.529289 (ThreadPoolExecutor-0_0): Parsing macros/catalog.sql
2021-12-06 02:16:59.532460 (ThreadPoolExecutor-0_0): Parsing macros/adapters.sql
2021-12-06 02:16:59.566231 (ThreadPoolExecutor-0_0): Parsing macros/materializations/merge.sql
2021-12-06 02:16:59.570005 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table.sql
2021-12-06 02:16:59.573549 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed.sql
2021-12-06 02:16:59.577744 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view.sql
2021-12-06 02:16:59.579157 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental.sql
2021-12-06 02:16:59.588085 (ThreadPoolExecutor-0_0): Parsing macros/core.sql
2021-12-06 02:16:59.591653 (ThreadPoolExecutor-0_0): Parsing macros/materializations/test.sql
2021-12-06 02:16:59.597970 (ThreadPoolExecutor-0_0): Parsing macros/materializations/helpers.sql
2021-12-06 02:16:59.607177 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/view.sql
2021-12-06 02:16:59.613851 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 02:16:59.617543 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed/seed.sql
2021-12-06 02:16:59.638578 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 02:16:59.654535 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 02:16:59.656226 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 02:16:59.685205 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table/table.sql
2021-12-06 02:16:59.692134 (ThreadPoolExecutor-0_0): Parsing macros/materializations/common/merge.sql
2021-12-06 02:16:59.705147 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 02:16:59.723688 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 02:16:59.733104 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 02:16:59.734835 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_alias.sql
2021-12-06 02:16:59.736332 (ThreadPoolExecutor-0_0): Parsing macros/etc/datetime.sql
2021-12-06 02:16:59.744220 (ThreadPoolExecutor-0_0): Parsing macros/etc/query.sql
2021-12-06 02:16:59.745224 (ThreadPoolExecutor-0_0): Parsing macros/etc/where_subquery.sql
2021-12-06 02:16:59.747020 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_database.sql
2021-12-06 02:16:59.748594 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_schema.sql
2021-12-06 02:16:59.751009 (ThreadPoolExecutor-0_0): Parsing macros/etc/is_incremental.sql
2021-12-06 02:16:59.752566 (ThreadPoolExecutor-0_0): Parsing macros/adapters/common.sql
2021-12-06 02:16:59.804201 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 02:16:59.806439 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/not_null.sql
2021-12-06 02:16:59.807671 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/relationships.sql
2021-12-06 02:16:59.809323 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/unique.sql
2021-12-06 02:16:59.821950 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 02:16:59.822031 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: show terse objects in analytics.dbt_pstulnikov
2021-12-06 02:16:59.822086 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 02:16:59.956160 (Thread-622): handling poll request
2021-12-06 02:16:59.956458 (Thread-622): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d86d070>]}
2021-12-06 02:16:59.957747 (Thread-622): sending response (<Response 12403 bytes [200 OK]>) to 10.0.37.206
2021-12-06 02:17:01.329405 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.51 seconds
2021-12-06 02:17:01.331378 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 02:17:01.439831 (Thread-623): handling poll request
2021-12-06 02:17:01.440139 (Thread-623): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b9d90>]}
2021-12-06 02:17:01.440634 (Thread-623): sending response (<Response 864 bytes [200 OK]>) to 10.0.13.223
2021-12-06 02:17:01.806966 (MainThread): 02:17:01 | Concurrency: 4 threads (target='default')
2021-12-06 02:17:01.807156 (MainThread): 02:17:01 | 
2021-12-06 02:17:01.809272 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 02:17:01.809444 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 02:17:01.809545 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 02:17:01.810469 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 02:17:01.810613 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 02:17:01.810678 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 02:17:01.812047 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 02:17:01.812379 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 02:17:01.812519 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 02:17:01.812584 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 02:17:01.813564 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 02:17:01.814701 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 02:17:01.834153 (Thread-2): finished collecting timing info
2021-12-06 02:17:01.834306 (Thread-2): finished collecting timing info
2021-12-06 02:17:01.834418 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 02:17:01.834542 (Thread-3): finished collecting timing info
2021-12-06 02:17:01.834667 (Thread-3): finished collecting timing info
2021-12-06 02:17:01.834771 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 02:17:01.834975 (Thread-1): finished collecting timing info
2021-12-06 02:17:01.835093 (Thread-1): finished collecting timing info
2021-12-06 02:17:01.835189 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 02:17:01.835975 (Thread-4): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 02:17:01.836089 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 02:17:01.836147 (Thread-4): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 02:17:01.841027 (Thread-2): Began running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 02:17:01.841155 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 02:17:01.841211 (Thread-2): Compiling test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 02:17:01.844092 (Thread-2): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 02:17:01.849458 (Thread-3): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 02:17:01.849573 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 02:17:01.849631 (Thread-3): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 02:17:01.903456 (Thread-4): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 02:17:01.909849 (Thread-3): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 02:17:01.910131 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 02:17:01.910274 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-12-06 02:17:01.910341 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 02:17:01.917409 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-12-06 02:17:01.923924 (Thread-2): finished collecting timing info
2021-12-06 02:17:01.924103 (Thread-2): finished collecting timing info
2021-12-06 02:17:01.924217 (Thread-2): Finished running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 02:17:01.924300 (Thread-2): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 02:17:01.924377 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 02:17:01.924432 (Thread-2): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 02:17:01.929168 (Thread-4): finished collecting timing info
2021-12-06 02:17:01.929290 (Thread-4): finished collecting timing info
2021-12-06 02:17:01.929393 (Thread-4): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 02:17:01.930281 (Thread-2): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 02:17:01.931153 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 02:17:01.931265 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 02:17:01.931321 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 02:17:01.933392 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 02:17:01.936541 (Thread-3): finished collecting timing info
2021-12-06 02:17:01.936662 (Thread-3): finished collecting timing info
2021-12-06 02:17:01.936761 (Thread-3): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 02:17:01.936957 (Thread-1): finished collecting timing info
2021-12-06 02:17:01.937082 (Thread-1): finished collecting timing info
2021-12-06 02:17:01.937196 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 02:17:01.945154 (Thread-2): finished collecting timing info
2021-12-06 02:17:01.945268 (Thread-2): finished collecting timing info
2021-12-06 02:17:01.945359 (Thread-2): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 02:17:01.950868 (Thread-4): finished collecting timing info
2021-12-06 02:17:01.951016 (Thread-4): finished collecting timing info
2021-12-06 02:17:01.951120 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 02:17:01.951830 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 02:17:01.951958 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 02:17:01.952019 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 02:17:01.953998 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 02:17:01.968759 (Thread-3): finished collecting timing info
2021-12-06 02:17:01.968870 (Thread-3): finished collecting timing info
2021-12-06 02:17:01.968965 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 02:17:01.970154 (MainThread): Connection 'master' was properly closed.
2021-12-06 02:17:01.970233 (MainThread): Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
2021-12-06 02:17:01.970272 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 02:17:01.970306 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 02:17:01.970339 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 02:17:02.043282 (MainThread): 02:17:02 | Done.
2021-12-06 02:17:02.115086 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-12-06 02:17:02.115223 (MainThread): 02:17:02 | Building catalog
2021-12-06 02:17:02.116731 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "analytics.information_schema".
2021-12-06 02:17:02.123658 (ThreadPoolExecutor-1_0): Using snowflake connection "analytics.information_schema".
2021-12-06 02:17:02.123738 (ThreadPoolExecutor-1_0): On analytics.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_pstulnikov') or upper("table_schema") = upper('dbt_pstulnikov_dbt_test__audit'))
      order by "column_index"
2021-12-06 02:17:02.123798 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 02:17:02.935468 (Thread-624): handling poll request
2021-12-06 02:17:02.935768 (Thread-624): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6c1e80>]}
2021-12-06 02:17:02.937563 (Thread-624): sending response (<Response 40349 bytes [200 OK]>) to 10.0.36.143
2021-12-06 02:17:04.420205 (Thread-625): handling poll request
2021-12-06 02:17:04.420517 (Thread-625): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6c1f70>]}
2021-12-06 02:17:04.421000 (Thread-625): sending response (<Response 296 bytes [200 OK]>) to 10.0.39.19
2021-12-06 02:17:04.492057 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 24 in 2.37 seconds
2021-12-06 02:17:04.501987 (ThreadPoolExecutor-1_0): On analytics.information_schema: Close
2021-12-06 02:17:05.037284 (MainThread): 02:17:05 | Catalog written to /usr/src/develop/user-48664/environment-53260/repository-43071/target/catalog.json
2021-12-06 02:17:05.873600 (Thread-626): handling poll request
2021-12-06 02:17:05.873921 (Thread-626): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd83850>]}
2021-12-06 02:17:05.874842 (Thread-626): sending response (<Response 6410 bytes [200 OK]>) to 10.0.13.223
2021-12-06 02:17:06.721011 (Thread-627): handling status request
2021-12-06 02:17:06.721322 (Thread-627): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd955b0>]}
2021-12-06 02:17:06.721863 (Thread-627): sending response (<Response 1551 bytes [200 OK]>) to 10.0.0.217
2021-12-06 02:17:06.766010 (Thread-628): handling status request
2021-12-06 02:17:06.766222 (Thread-628): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd956d0>]}
2021-12-06 02:17:06.766623 (Thread-628): sending response (<Response 1551 bytes [200 OK]>) to 10.0.36.143
2021-12-06 02:17:06.855250 (Thread-629): handling status request
2021-12-06 02:17:06.855511 (Thread-629): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d86eca0>]}
2021-12-06 02:17:06.855908 (Thread-629): sending response (<Response 1551 bytes [200 OK]>) to 10.0.0.217
2021-12-06 04:24:01.432497 (Thread-630): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 04:24:01.434789 (Thread-630): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
2021-12-06 04:24:01.438914 (Thread-630): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 04:24:01.493778 (Thread-630): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d85cb80>]}
2021-12-06 04:24:02.254121 (Thread-631): handling status request
2021-12-06 04:24:02.254445 (Thread-631): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d85cdc0>]}
2021-12-06 04:24:02.254952 (Thread-631): sending response (<Response 1554 bytes [200 OK]>) to 10.0.13.223
2021-12-06 04:24:02.270244 (Thread-632): handling status request
2021-12-06 04:24:02.270452 (Thread-632): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d85cfa0>]}
2021-12-06 04:24:02.295107 (Thread-632): sending response (<Response 1554 bytes [200 OK]>) to 10.0.0.217
2021-12-06 04:24:16.387953 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 04:24:16.474249 (Thread-633): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 04:24:16.474576 (Thread-633): Partial parsing: added file: jaffle_shop://models/staging/stripe/stg_stripe.yml
2021-12-06 04:24:16.520011 (Thread-633): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db2aeb0>]}
2021-12-06 04:24:17.259421 (Thread-634): handling status request
2021-12-06 04:24:17.259747 (Thread-634): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd00b80>]}
2021-12-06 04:24:17.260226 (Thread-634): sending response (<Response 1233 bytes [200 OK]>) to 10.0.22.219
2021-12-06 04:24:17.316181 (Thread-635): handling status request
2021-12-06 04:24:17.316389 (Thread-635): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dbad310>]}
2021-12-06 04:24:17.316765 (Thread-635): sending response (<Response 1233 bytes [200 OK]>) to 10.0.38.50
2021-12-06 04:28:02.384610 (Thread-636): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 04:28:02.386446 (Thread-636): Partial parsing: added file: jaffle_shop://models/staging/stripe/stripe.md
2021-12-06 04:28:02.430856 (Thread-636): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d761820>]}
2021-12-06 04:28:03.173277 (Thread-637): handling status request
2021-12-06 04:28:03.173584 (Thread-637): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4b0bb0>]}
2021-12-06 04:28:03.174092 (Thread-637): sending response (<Response 1228 bytes [200 OK]>) to 10.0.41.241
2021-12-06 04:28:03.191108 (Thread-638): handling status request
2021-12-06 04:28:03.191321 (Thread-638): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4b0370>]}
2021-12-06 04:28:03.191694 (Thread-638): sending response (<Response 1228 bytes [200 OK]>) to 10.0.2.25
2021-12-06 04:31:02.717416 (Thread-639): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 04:31:02.720115 (Thread-639): Partial parsing: updated file: jaffle_shop://models/staging/stripe/stripe.md
2021-12-06 04:31:02.773818 (Thread-639): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db9f1f0>]}
2021-12-06 04:31:03.510987 (Thread-640): handling status request
2021-12-06 04:31:03.511299 (Thread-640): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4d0730>]}
2021-12-06 04:31:03.511769 (Thread-640): sending response (<Response 1230 bytes [200 OK]>) to 10.0.6.10
2021-12-06 04:31:03.556767 (Thread-641): handling status request
2021-12-06 04:31:03.556968 (Thread-641): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6df790>]}
2021-12-06 04:31:03.557319 (Thread-641): sending response (<Response 1230 bytes [200 OK]>) to 10.0.2.25
2021-12-06 04:31:44.101411 (Thread-642): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 04:31:44.101743 (Thread-642): Partial parsing: update schema file: jaffle_shop://models/staging/stripe/stg_stripe.yml
2021-12-06 04:31:45.153467 (Thread-643): handling status request
2021-12-06 04:31:45.153820 (Thread-643): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d716370>]}
2021-12-06 04:31:45.154908 (Thread-643): sending response (<Response 992 bytes [200 OK]>) to 10.0.0.217
2021-12-06 04:31:45.343839 (Thread-644): handling status request
2021-12-06 04:31:45.344077 (Thread-644): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d728f70>]}
2021-12-06 04:31:45.344488 (Thread-644): sending response (<Response 992 bytes [200 OK]>) to 10.0.38.50
2021-12-06 04:32:15.719163 (Thread-645): Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
2021-12-06 04:32:15.719492 (Thread-645): Partial parsing: update schema file: jaffle_shop://models/staging/stripe/stg_stripe.yml
2021-12-06 04:32:15.719625 (Thread-645): Partial parsing: updated file: jaffle_shop://models/staging/stripe/stripe.md
2021-12-06 04:32:16.494396 (Thread-646): handling status request
2021-12-06 04:32:16.494771 (Thread-646): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d641ca0>]}
2021-12-06 04:32:16.495268 (Thread-646): sending response (<Response 1300 bytes [200 OK]>) to 10.0.22.219
2021-12-06 04:32:16.584206 (Thread-647): handling status request
2021-12-06 04:32:16.584485 (Thread-647): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d63bd90>]}
2021-12-06 04:32:16.585467 (Thread-647): sending response (<Response 1300 bytes [200 OK]>) to 10.0.39.19
2021-12-06 04:35:37.239884 (Thread-648): Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
2021-12-06 04:35:37.242054 (Thread-648): Partial parsing: update schema file: jaffle_shop://models/staging/stripe/stg_stripe.yml
2021-12-06 04:35:37.242191 (Thread-648): Partial parsing: updated file: jaffle_shop://models/staging/stripe/stripe.md
2021-12-06 04:35:38.302446 (Thread-649): handling status request
2021-12-06 04:35:38.302765 (Thread-649): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db945e0>]}
2021-12-06 04:35:38.303265 (Thread-649): sending response (<Response 1300 bytes [200 OK]>) to 10.0.3.73
2021-12-06 04:35:38.329664 (Thread-650): handling status request
2021-12-06 04:35:38.329869 (Thread-650): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db94a00>]}
2021-12-06 04:35:38.330262 (Thread-650): sending response (<Response 1300 bytes [200 OK]>) to 10.0.19.103
2021-12-06 04:36:06.826054 (Thread-651): handling status request
2021-12-06 04:36:06.826369 (Thread-651): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db94dc0>]}
2021-12-06 04:36:06.826824 (Thread-651): sending response (<Response 1300 bytes [200 OK]>) to 10.0.3.73
2021-12-06 04:36:07.173983 (Thread-652): handling status request
2021-12-06 04:36:07.174205 (Thread-652): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db94ac0>]}
2021-12-06 04:36:07.174608 (Thread-652): sending response (<Response 1300 bytes [200 OK]>) to 10.0.26.3
2021-12-06 04:36:07.271287 (Thread-653): handling cli_args request
2021-12-06 04:36:07.271491 (Thread-653): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db944c0>]}
2021-12-06 04:36:07.271816 (Thread-653): sending response (<Response 701 bytes [200 OK]>) to 10.0.6.71
2021-12-06 04:36:23.413149 (Thread-654): handling status request
2021-12-06 04:36:23.413458 (Thread-654): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d71f5b0>]}
2021-12-06 04:36:23.413912 (Thread-654): sending response (<Response 1300 bytes [200 OK]>) to 10.0.38.70
2021-12-06 04:36:23.454787 (Thread-655): handling status request
2021-12-06 04:36:23.455010 (Thread-655): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d71f100>]}
2021-12-06 04:36:23.455405 (Thread-655): sending response (<Response 1300 bytes [200 OK]>) to 10.0.38.50
2021-12-06 04:36:32.876465 (Thread-656): Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
2021-12-06 04:36:32.876797 (Thread-656): Partial parsing: update schema file: jaffle_shop://models/staging/stripe/stg_stripe.yml
2021-12-06 04:36:32.876934 (Thread-656): Partial parsing: updated file: jaffle_shop://models/staging/stripe/stripe.md
2021-12-06 04:36:33.622231 (Thread-657): handling status request
2021-12-06 04:36:33.623053 (Thread-657): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d854a90>]}
2021-12-06 04:36:33.623577 (Thread-657): sending response (<Response 1300 bytes [200 OK]>) to 10.0.26.3
2021-12-06 04:36:33.776612 (Thread-658): handling status request
2021-12-06 04:36:33.776893 (Thread-658): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc50b8b0>]}
2021-12-06 04:36:33.777328 (Thread-658): sending response (<Response 1300 bytes [200 OK]>) to 10.0.37.206
2021-12-06 04:37:20.003486 (Thread-659): Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
2021-12-06 04:37:20.003815 (Thread-659): Partial parsing: update schema file: jaffle_shop://models/staging/stripe/stg_stripe.yml
2021-12-06 04:37:20.003938 (Thread-659): Partial parsing: updated file: jaffle_shop://models/staging/stripe/stripe.md
2021-12-06 04:37:20.054977 (Thread-659): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d579580>]}
2021-12-06 04:37:20.820761 (Thread-660): handling status request
2021-12-06 04:37:20.821092 (Thread-660): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d736b20>]}
2021-12-06 04:37:20.821584 (Thread-660): sending response (<Response 1549 bytes [200 OK]>) to 10.0.26.3
2021-12-06 04:37:20.894543 (Thread-661): handling status request
2021-12-06 04:37:20.894771 (Thread-661): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d736190>]}
2021-12-06 04:37:20.895189 (Thread-661): sending response (<Response 1549 bytes [200 OK]>) to 10.0.26.3
2021-12-06 04:37:23.571874 (Thread-662): handling status request
2021-12-06 04:37:23.572203 (Thread-662): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc687820>]}
2021-12-06 04:37:23.572688 (Thread-662): sending response (<Response 1549 bytes [200 OK]>) to 10.0.13.223
2021-12-06 04:37:23.944364 (Thread-663): handling status request
2021-12-06 04:37:23.944681 (Thread-663): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d757f40>]}
2021-12-06 04:37:23.945169 (Thread-663): sending response (<Response 1549 bytes [200 OK]>) to 10.0.24.86
2021-12-06 04:37:24.040154 (Thread-664): handling cli_args request
2021-12-06 04:37:24.040370 (Thread-664): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d757a90>]}
2021-12-06 04:37:25.957782 (Thread-664): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-06 04:37:25.994990 (MainThread): Partial parsing not enabled
2021-12-06 04:37:26.059764 (MainThread): Parsing macros/catalog.sql
2021-12-06 04:37:26.061695 (MainThread): Parsing macros/adapters.sql
2021-12-06 04:37:26.095826 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 04:37:26.099460 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 04:37:26.102474 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 04:37:26.106663 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 04:37:26.108317 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 04:37:26.116416 (MainThread): Parsing macros/core.sql
2021-12-06 04:37:26.119932 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 04:37:26.126193 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 04:37:26.135551 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 04:37:26.142244 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 04:37:26.145726 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 04:37:26.166908 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 04:37:26.182673 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 04:37:26.184170 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 04:37:26.213269 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 04:37:26.220138 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 04:37:26.233174 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 04:37:26.251613 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 04:37:26.260962 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 04:37:26.262603 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 04:37:26.263951 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 04:37:26.271768 (MainThread): Parsing macros/etc/query.sql
2021-12-06 04:37:26.272700 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 04:37:26.274308 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 04:37:26.275722 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 04:37:26.278011 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 04:37:26.279382 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 04:37:26.331269 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 04:37:26.333302 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 04:37:26.334390 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 04:37:26.335848 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 04:37:26.395465 (Thread-665): handling poll request
2021-12-06 04:37:26.395770 (Thread-665): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7616a0>]}
2021-12-06 04:37:26.396846 (Thread-665): sending response (<Response 9686 bytes [200 OK]>) to 10.0.30.196
2021-12-06 04:37:26.514108 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 04:37:26.525499 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 04:37:26.527880 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 04:37:26.530359 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 04:37:26.534023 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 04:37:26.545187 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 04:37:26.682515 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93dea009-5a9f-4d53-b955-190162a16149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31061d7820>]}
2021-12-06 04:37:26.712458 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93dea009-5a9f-4d53-b955-190162a16149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31061d7eb0>]}
2021-12-06 04:37:26.712673 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 04:37:26.714527 (MainThread): 
2021-12-06 04:37:26.714749 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 04:37:26.715729 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 04:37:26.728164 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 04:37:26.728240 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 04:37:26.728294 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 04:37:27.871974 (Thread-666): handling poll request
2021-12-06 04:37:27.872347 (Thread-666): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7610d0>]}
2021-12-06 04:37:27.895169 (Thread-666): sending response (<Response 5276 bytes [200 OK]>) to 10.0.24.86
2021-12-06 04:37:28.216782 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.49 seconds
2021-12-06 04:37:28.218648 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 04:37:28.674724 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 04:37:28.681722 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 04:37:28.681823 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 04:37:28.681888 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 04:37:29.331628 (Thread-667): handling poll request
2021-12-06 04:37:29.331943 (Thread-667): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4d0b20>]}
2021-12-06 04:37:29.332518 (Thread-667): sending response (<Response 2263 bytes [200 OK]>) to 10.0.26.3
2021-12-06 04:37:29.955183 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.27 seconds
2021-12-06 04:37:29.956704 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 04:37:30.399503 (MainThread): 04:37:30 | Concurrency: 4 threads (target='default')
2021-12-06 04:37:30.399647 (MainThread): 04:37:30 | 
2021-12-06 04:37:30.401608 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 04:37:30.401886 (Thread-1): 04:37:30 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 04:37:30.402138 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 04:37:30.402237 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 04:37:30.403111 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 04:37:30.403319 (Thread-2): 04:37:30 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 04:37:30.403543 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 04:37:30.403612 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 04:37:30.404707 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 04:37:30.405586 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 04:37:30.405767 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 04:37:30.406009 (Thread-3): 04:37:30 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 04:37:30.406404 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 04:37:30.406479 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 04:37:30.407473 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 04:37:30.422832 (Thread-2): finished collecting timing info
2021-12-06 04:37:30.428181 (Thread-3): finished collecting timing info
2021-12-06 04:37:30.433263 (Thread-1): finished collecting timing info
2021-12-06 04:37:30.458301 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 04:37:30.461993 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 04:37:30.464091 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 04:37:30.476767 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 04:37:30.476847 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 04:37:30.476905 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 04:37:30.478909 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 04:37:30.478995 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 04:37:30.479050 (Thread-3): Opening a new connection, currently in state init
2021-12-06 04:37:30.479985 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 04:37:30.480064 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 04:37:30.480119 (Thread-2): Opening a new connection, currently in state init
2021-12-06 04:37:30.803717 (Thread-668): handling poll request
2021-12-06 04:37:30.803983 (Thread-668): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d85ca60>]}
2021-12-06 04:37:30.804959 (Thread-668): sending response (<Response 14241 bytes [200 OK]>) to 10.0.39.19
2021-12-06 04:37:32.101680 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-12-06 04:37:32.108304 (Thread-1): finished collecting timing info
2021-12-06 04:37:32.108442 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 04:37:32.288689 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-06 04:37:32.289904 (Thread-2): finished collecting timing info
2021-12-06 04:37:32.290054 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 04:37:32.337388 (Thread-3): SQL status: SUCCESS 1 in 1.86 seconds
2021-12-06 04:37:32.338508 (Thread-3): finished collecting timing info
2021-12-06 04:37:32.338611 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 04:37:32.576507 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dea009-5a9f-4d53-b955-190162a16149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310525d160>]}
2021-12-06 04:37:32.576855 (Thread-1): 04:37:32 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.17s]
2021-12-06 04:37:32.576939 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 04:37:32.731928 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dea009-5a9f-4d53-b955-190162a16149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3105269c70>]}
2021-12-06 04:37:32.732252 (Thread-2): 04:37:32 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.33s]
2021-12-06 04:37:32.732332 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 04:37:32.786563 (Thread-669): handling poll request
2021-12-06 04:37:32.786868 (Thread-669): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d85c040>]}
2021-12-06 04:37:32.787557 (Thread-669): sending response (<Response 6126 bytes [200 OK]>) to 10.0.31.30
2021-12-06 04:37:32.787720 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dea009-5a9f-4d53-b955-190162a16149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3105328250>]}
2021-12-06 04:37:32.788057 (Thread-3): 04:37:32 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.38s]
2021-12-06 04:37:32.788151 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 04:37:32.788985 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 04:37:32.789218 (Thread-4): 04:37:32 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 04:37:32.789451 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 04:37:32.789528 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 04:37:32.791965 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 04:37:32.807263 (Thread-4): finished collecting timing info
2021-12-06 04:37:32.823716 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 04:37:32.841400 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 04:37:32.841482 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 04:37:32.841541 (Thread-4): Opening a new connection, currently in state init
2021-12-06 04:37:34.218031 (Thread-670): handling poll request
2021-12-06 04:37:34.218380 (Thread-670): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9a8760>]}
2021-12-06 04:37:34.219407 (Thread-670): sending response (<Response 6240 bytes [200 OK]>) to 10.0.22.219
2021-12-06 04:37:34.930008 (Thread-4): SQL status: SUCCESS 1 in 2.09 seconds
2021-12-06 04:37:34.934645 (Thread-4): finished collecting timing info
2021-12-06 04:37:34.934788 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 04:37:35.378679 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dea009-5a9f-4d53-b955-190162a16149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3105328880>]}
2021-12-06 04:37:35.379364 (Thread-4): 04:37:35 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.59s]
2021-12-06 04:37:35.379489 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 04:37:35.380277 (Thread-2): Began running node model.jaffle_shop.dim_customers
2021-12-06 04:37:35.380598 (Thread-2): 04:37:35 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 04:37:35.380917 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 04:37:35.381038 (Thread-2): Compiling model.jaffle_shop.dim_customers
2021-12-06 04:37:35.384757 (Thread-2): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 04:37:35.400007 (Thread-2): finished collecting timing info
2021-12-06 04:37:35.402040 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 04:37:35.418830 (Thread-2): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 04:37:35.418912 (Thread-2): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 04:37:35.418971 (Thread-2): Opening a new connection, currently in state closed
2021-12-06 04:37:35.725876 (Thread-671): handling poll request
2021-12-06 04:37:35.726170 (Thread-671): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7449d0>]}
2021-12-06 04:37:35.726857 (Thread-671): sending response (<Response 7709 bytes [200 OK]>) to 10.0.31.30
2021-12-06 04:37:37.202553 (Thread-672): handling poll request
2021-12-06 04:37:37.202895 (Thread-672): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc0eb50>]}
2021-12-06 04:37:37.203421 (Thread-672): sending response (<Response 287 bytes [200 OK]>) to 10.0.36.143
2021-12-06 04:37:37.573359 (Thread-2): SQL status: SUCCESS 1 in 2.15 seconds
2021-12-06 04:37:37.574794 (Thread-2): finished collecting timing info
2021-12-06 04:37:37.574924 (Thread-2): On model.jaffle_shop.dim_customers: Close
2021-12-06 04:37:38.056539 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dea009-5a9f-4d53-b955-190162a16149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3104df81f0>]}
2021-12-06 04:37:38.056927 (Thread-2): 04:37:38 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.68s]
2021-12-06 04:37:38.057021 (Thread-2): Finished running node model.jaffle_shop.dim_customers
2021-12-06 04:37:38.058565 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 04:37:38.058876 (MainThread): 04:37:38 | 
2021-12-06 04:37:38.058946 (MainThread): 04:37:38 | Finished running 3 view models, 2 table models in 11.34s.
2021-12-06 04:37:38.058994 (MainThread): Connection 'master' was properly closed.
2021-12-06 04:37:38.059034 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 04:37:38.059070 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 04:37:38.059120 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 04:37:38.059171 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 04:37:38.123887 (MainThread): 
2021-12-06 04:37:38.123987 (MainThread): Completed successfully
2021-12-06 04:37:38.124050 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 04:37:38.651045 (Thread-673): handling poll request
2021-12-06 04:37:38.651415 (Thread-673): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41d94c0>]}
2021-12-06 04:37:38.652932 (Thread-673): sending response (<Response 23816 bytes [200 OK]>) to 10.0.3.73
2021-12-06 04:37:39.571142 (Thread-674): handling status request
2021-12-06 04:37:39.571475 (Thread-674): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5795e0>]}
2021-12-06 04:37:39.572017 (Thread-674): sending response (<Response 1549 bytes [200 OK]>) to 10.0.36.143
2021-12-06 04:37:39.587612 (Thread-675): handling status request
2021-12-06 04:37:39.587822 (Thread-675): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d579610>]}
2021-12-06 04:37:39.588221 (Thread-675): sending response (<Response 1549 bytes [200 OK]>) to 10.0.3.73
2021-12-06 04:37:52.808518 (Thread-676): handling status request
2021-12-06 04:37:52.808837 (Thread-676): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d579880>]}
2021-12-06 04:37:52.809309 (Thread-676): sending response (<Response 1549 bytes [200 OK]>) to 10.0.6.71
2021-12-06 04:37:53.154602 (Thread-677): handling status request
2021-12-06 04:37:53.154872 (Thread-677): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d579e50>]}
2021-12-06 04:37:53.155361 (Thread-677): sending response (<Response 1549 bytes [200 OK]>) to 10.0.13.223
2021-12-06 04:37:53.246092 (Thread-678): handling docs.generate request
2021-12-06 04:37:53.246311 (Thread-678): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d579640>]}
2021-12-06 04:37:55.148899 (Thread-678): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.219
2021-12-06 04:37:55.183059 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f970241a-6df0-4de7-b9bb-7835b4127b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27516cb9d0>]}
2021-12-06 04:37:55.183296 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 04:37:55.184942 (MainThread): 
2021-12-06 04:37:55.185062 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 04:37:55.185779 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 04:37:55.200340 (ThreadPoolExecutor-0_0): Parsing macros/catalog.sql
2021-12-06 04:37:55.203567 (ThreadPoolExecutor-0_0): Parsing macros/adapters.sql
2021-12-06 04:37:55.237233 (ThreadPoolExecutor-0_0): Parsing macros/materializations/merge.sql
2021-12-06 04:37:55.241054 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table.sql
2021-12-06 04:37:55.244683 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed.sql
2021-12-06 04:37:55.248899 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view.sql
2021-12-06 04:37:55.250321 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental.sql
2021-12-06 04:37:55.259231 (ThreadPoolExecutor-0_0): Parsing macros/core.sql
2021-12-06 04:37:55.262799 (ThreadPoolExecutor-0_0): Parsing macros/materializations/test.sql
2021-12-06 04:37:55.269204 (ThreadPoolExecutor-0_0): Parsing macros/materializations/helpers.sql
2021-12-06 04:37:55.278440 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/view.sql
2021-12-06 04:37:55.285216 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 04:37:55.288963 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed/seed.sql
2021-12-06 04:37:55.310565 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 04:37:55.326594 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 04:37:55.328306 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 04:37:55.357168 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table/table.sql
2021-12-06 04:37:55.364158 (ThreadPoolExecutor-0_0): Parsing macros/materializations/common/merge.sql
2021-12-06 04:37:55.377367 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 04:37:55.395887 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 04:37:55.405335 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 04:37:55.407089 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_alias.sql
2021-12-06 04:37:55.408662 (ThreadPoolExecutor-0_0): Parsing macros/etc/datetime.sql
2021-12-06 04:37:55.419782 (ThreadPoolExecutor-0_0): Parsing macros/etc/query.sql
2021-12-06 04:37:55.421209 (ThreadPoolExecutor-0_0): Parsing macros/etc/where_subquery.sql
2021-12-06 04:37:55.423055 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_database.sql
2021-12-06 04:37:55.424664 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_schema.sql
2021-12-06 04:37:55.427139 (ThreadPoolExecutor-0_0): Parsing macros/etc/is_incremental.sql
2021-12-06 04:37:55.428737 (ThreadPoolExecutor-0_0): Parsing macros/adapters/common.sql
2021-12-06 04:37:55.481110 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 04:37:55.483393 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/not_null.sql
2021-12-06 04:37:55.484651 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/relationships.sql
2021-12-06 04:37:55.486362 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/unique.sql
2021-12-06 04:37:55.499217 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 04:37:55.499299 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: show terse objects in analytics.dbt_pstulnikov
2021-12-06 04:37:55.499356 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 04:37:55.580523 (Thread-679): handling poll request
2021-12-06 04:37:55.580801 (Thread-679): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dbad1c0>]}
2021-12-06 04:37:55.581924 (Thread-679): sending response (<Response 12403 bytes [200 OK]>) to 10.0.30.196
2021-12-06 04:37:57.040595 (Thread-680): handling poll request
2021-12-06 04:37:57.040910 (Thread-680): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4d09d0>]}
2021-12-06 04:37:57.041411 (Thread-680): sending response (<Response 295 bytes [200 OK]>) to 10.0.0.217
2021-12-06 04:37:57.053128 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.55 seconds
2021-12-06 04:37:57.055149 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 04:37:57.507237 (MainThread): 04:37:57 | Concurrency: 4 threads (target='default')
2021-12-06 04:37:57.507359 (MainThread): 04:37:57 | 
2021-12-06 04:37:57.509426 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 04:37:57.509600 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 04:37:57.509700 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 04:37:57.510580 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 04:37:57.510736 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 04:37:57.510805 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 04:37:57.512154 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 04:37:57.512861 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 04:37:57.513006 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 04:37:57.513074 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 04:37:57.514205 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 04:37:57.515372 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 04:37:57.531625 (Thread-2): finished collecting timing info
2021-12-06 04:37:57.531774 (Thread-2): finished collecting timing info
2021-12-06 04:37:57.531886 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 04:37:57.532008 (Thread-1): finished collecting timing info
2021-12-06 04:37:57.532121 (Thread-1): finished collecting timing info
2021-12-06 04:37:57.532217 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 04:37:57.532329 (Thread-3): finished collecting timing info
2021-12-06 04:37:57.532442 (Thread-3): finished collecting timing info
2021-12-06 04:37:57.532534 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 04:37:57.533402 (Thread-4): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 04:37:57.533543 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 04:37:57.533608 (Thread-4): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 04:37:57.538547 (Thread-2): Began running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 04:37:57.538656 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 04:37:57.538716 (Thread-2): Compiling test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 04:37:57.541524 (Thread-2): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 04:37:57.546760 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 04:37:57.546859 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 04:37:57.546915 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 04:37:57.595735 (Thread-3): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 04:37:57.595888 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-12-06 04:37:57.595952 (Thread-3): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 04:37:57.608973 (Thread-4): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 04:37:57.611401 (Thread-3): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-12-06 04:37:57.611802 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 04:37:57.618767 (Thread-2): finished collecting timing info
2021-12-06 04:37:57.618890 (Thread-2): finished collecting timing info
2021-12-06 04:37:57.618992 (Thread-2): Finished running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 04:37:57.619069 (Thread-2): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 04:37:57.619140 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 04:37:57.619191 (Thread-2): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 04:37:57.624625 (Thread-2): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 04:37:57.630893 (Thread-3): finished collecting timing info
2021-12-06 04:37:57.631010 (Thread-3): finished collecting timing info
2021-12-06 04:37:57.631128 (Thread-3): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 04:37:57.631275 (Thread-1): finished collecting timing info
2021-12-06 04:37:57.631424 (Thread-1): finished collecting timing info
2021-12-06 04:37:57.631530 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 04:37:57.631831 (Thread-4): finished collecting timing info
2021-12-06 04:37:57.631946 (Thread-4): finished collecting timing info
2021-12-06 04:37:57.632039 (Thread-4): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 04:37:57.632916 (Thread-3): Began running node model.jaffle_shop.fct_orders
2021-12-06 04:37:57.633040 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 04:37:57.633098 (Thread-3): Compiling model.jaffle_shop.fct_orders
2021-12-06 04:37:57.634990 (Thread-3): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 04:37:57.651761 (Thread-2): finished collecting timing info
2021-12-06 04:37:57.651874 (Thread-2): finished collecting timing info
2021-12-06 04:37:57.651969 (Thread-2): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 04:37:57.655323 (Thread-3): finished collecting timing info
2021-12-06 04:37:57.655443 (Thread-3): finished collecting timing info
2021-12-06 04:37:57.655537 (Thread-3): Finished running node model.jaffle_shop.fct_orders
2021-12-06 04:37:57.656228 (Thread-4): Began running node model.jaffle_shop.dim_customers
2021-12-06 04:37:57.656335 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 04:37:57.656391 (Thread-4): Compiling model.jaffle_shop.dim_customers
2021-12-06 04:37:57.658483 (Thread-4): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 04:37:57.673557 (Thread-4): finished collecting timing info
2021-12-06 04:37:57.673667 (Thread-4): finished collecting timing info
2021-12-06 04:37:57.673760 (Thread-4): Finished running node model.jaffle_shop.dim_customers
2021-12-06 04:37:57.674817 (MainThread): Connection 'master' was properly closed.
2021-12-06 04:37:57.674895 (MainThread): Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
2021-12-06 04:37:57.674935 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 04:37:57.674970 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 04:37:57.675003 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 04:37:57.767856 (MainThread): 04:37:57 | Done.
2021-12-06 04:37:57.871505 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-12-06 04:37:57.871584 (MainThread): 04:37:57 | Building catalog
2021-12-06 04:37:57.872940 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "analytics.information_schema".
2021-12-06 04:37:57.879131 (ThreadPoolExecutor-1_0): Using snowflake connection "analytics.information_schema".
2021-12-06 04:37:57.879199 (ThreadPoolExecutor-1_0): On analytics.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_pstulnikov') or upper("table_schema") = upper('dbt_pstulnikov_dbt_test__audit'))
      order by "column_index"
2021-12-06 04:37:57.879257 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 04:37:58.505474 (Thread-681): handling poll request
2021-12-06 04:37:58.505781 (Thread-681): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d56c880>]}
2021-12-06 04:37:58.507305 (Thread-681): sending response (<Response 40884 bytes [200 OK]>) to 10.0.37.206
2021-12-06 04:37:59.952434 (Thread-682): handling poll request
2021-12-06 04:37:59.952799 (Thread-682): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d56cbb0>]}
2021-12-06 04:37:59.953294 (Thread-682): sending response (<Response 296 bytes [200 OK]>) to 10.0.19.103
2021-12-06 04:38:00.198575 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 24 in 2.32 seconds
2021-12-06 04:38:00.208490 (ThreadPoolExecutor-1_0): On analytics.information_schema: Close
2021-12-06 04:38:00.722346 (MainThread): 04:38:00 | Catalog written to /usr/src/develop/user-48664/environment-53260/repository-43071/target/catalog.json
2021-12-06 04:38:01.400383 (Thread-683): handling poll request
2021-12-06 04:38:01.400713 (Thread-683): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7b1790>]}
2021-12-06 04:38:01.401582 (Thread-683): sending response (<Response 6410 bytes [200 OK]>) to 10.0.2.25
2021-12-06 04:38:02.251041 (Thread-684): handling status request
2021-12-06 04:38:02.251348 (Thread-684): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7800d0>]}
2021-12-06 04:38:02.251852 (Thread-684): sending response (<Response 1549 bytes [200 OK]>) to 10.0.2.25
2021-12-06 04:38:02.331005 (Thread-685): handling status request
2021-12-06 04:38:02.331237 (Thread-685): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d780b50>]}
2021-12-06 04:38:02.331649 (Thread-685): sending response (<Response 1549 bytes [200 OK]>) to 10.0.31.30
2021-12-06 04:38:02.359954 (Thread-686): handling status request
2021-12-06 04:38:02.360187 (Thread-686): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d780d30>]}
2021-12-06 04:38:02.360589 (Thread-686): sending response (<Response 1549 bytes [200 OK]>) to 10.0.36.143
2021-12-06 04:38:52.672346 (Thread-687): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 04:38:52.672688 (Thread-687): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 04:38:52.678145 (Thread-687): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d50abe0>]}
2021-12-06 04:38:53.463170 (Thread-688): handling status request
2021-12-06 04:38:53.463492 (Thread-688): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d50ae50>]}
2021-12-06 04:38:53.463972 (Thread-688): sending response (<Response 1212 bytes [200 OK]>) to 10.0.6.71
2021-12-06 04:38:53.537143 (Thread-689): handling status request
2021-12-06 04:38:53.537388 (Thread-689): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d50a8e0>]}
2021-12-06 04:38:53.537812 (Thread-689): sending response (<Response 1212 bytes [200 OK]>) to 10.0.37.206
2021-12-06 04:40:28.225682 (Thread-690): handling status request
2021-12-06 04:40:28.227877 (Thread-690): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d50abb0>]}
2021-12-06 04:40:28.228404 (Thread-690): sending response (<Response 1212 bytes [200 OK]>) to 10.0.6.71
2021-12-06 04:40:31.425152 (Thread-691): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 04:40:31.425490 (Thread-691): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 04:40:31.430691 (Thread-691): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d4b3880>]}
2021-12-06 04:40:32.351969 (Thread-692): handling status request
2021-12-06 04:40:32.352286 (Thread-692): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d4e2f40>]}
2021-12-06 04:40:32.352758 (Thread-692): sending response (<Response 1212 bytes [200 OK]>) to 10.0.36.143
2021-12-06 04:40:32.357769 (Thread-693): handling status request
2021-12-06 04:40:32.358012 (Thread-693): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d4e2ca0>]}
2021-12-06 04:40:32.358391 (Thread-693): sending response (<Response 1212 bytes [200 OK]>) to 10.0.30.196
2021-12-06 04:51:55.910139 (Thread-694): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 04:51:55.912017 (Thread-694): Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
2021-12-06 04:51:55.964494 (Thread-694): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d405e80>]}
2021-12-06 04:51:56.997309 (Thread-695): handling status request
2021-12-06 04:51:56.997624 (Thread-695): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d466f40>]}
2021-12-06 04:51:56.998147 (Thread-695): sending response (<Response 1243 bytes [200 OK]>) to 10.0.31.30
2021-12-06 04:51:57.022800 (Thread-696): handling status request
2021-12-06 04:51:57.023028 (Thread-696): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d466ca0>]}
2021-12-06 04:51:57.043725 (Thread-696): sending response (<Response 1243 bytes [200 OK]>) to 10.0.30.196
2021-12-06 04:52:47.006326 (Thread-697): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 04:52:47.006655 (Thread-697): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
2021-12-06 04:52:47.060830 (Thread-697): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d3f6eb0>]}
2021-12-06 04:52:47.796530 (Thread-698): handling status request
2021-12-06 04:52:47.796848 (Thread-698): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d4fc850>]}
2021-12-06 04:52:47.797350 (Thread-698): sending response (<Response 1251 bytes [200 OK]>) to 10.0.6.10
2021-12-06 04:52:47.852943 (Thread-699): handling status request
2021-12-06 04:52:47.853155 (Thread-699): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d4fc5b0>]}
2021-12-06 04:52:47.853574 (Thread-699): sending response (<Response 1251 bytes [200 OK]>) to 10.0.0.217
2021-12-06 04:53:24.429654 (Thread-700): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 04:53:24.430004 (Thread-700): Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_customers.sql
2021-12-06 04:53:24.433320 (Thread-700): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 04:53:24.485115 (Thread-700): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d388f40>]}
2021-12-06 04:53:25.453861 (Thread-701): handling status request
2021-12-06 04:53:25.454200 (Thread-701): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d3df070>]}
2021-12-06 04:53:25.454687 (Thread-701): sending response (<Response 1546 bytes [200 OK]>) to 10.0.31.30
2021-12-06 04:53:25.524368 (Thread-702): handling status request
2021-12-06 04:53:25.524674 (Thread-702): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d3d6d60>]}
2021-12-06 04:53:25.525145 (Thread-702): sending response (<Response 1546 bytes [200 OK]>) to 10.0.36.143
2021-12-06 04:54:43.586759 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 04:54:43.694319 (Thread-703): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 04:54:43.694649 (Thread-703): Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_orders.sql
2021-12-06 04:54:43.698006 (Thread-703): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 04:54:43.759554 (Thread-703): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d2f5ac0>]}
2021-12-06 04:54:44.487464 (Thread-704): handling status request
2021-12-06 04:54:44.487789 (Thread-704): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d3df490>]}
2021-12-06 04:54:44.488312 (Thread-704): sending response (<Response 1540 bytes [200 OK]>) to 10.0.19.103
2021-12-06 04:54:44.513996 (Thread-705): handling status request
2021-12-06 04:54:44.514206 (Thread-705): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d4c33a0>]}
2021-12-06 04:54:44.514577 (Thread-705): sending response (<Response 1540 bytes [200 OK]>) to 10.0.13.223
2021-12-06 04:55:10.226833 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 04:55:10.318784 (Thread-706): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 04:55:10.319129 (Thread-706): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 04:55:10.324197 (Thread-706): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d2932e0>]}
2021-12-06 04:55:11.075369 (Thread-707): handling status request
2021-12-06 04:55:11.075672 (Thread-707): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d363100>]}
2021-12-06 04:55:11.076131 (Thread-707): sending response (<Response 1212 bytes [200 OK]>) to 10.0.24.86
2021-12-06 04:55:11.136620 (Thread-708): handling status request
2021-12-06 04:55:11.140374 (Thread-708): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d3636a0>]}
2021-12-06 04:55:11.140778 (Thread-708): sending response (<Response 1212 bytes [200 OK]>) to 10.0.0.217
2021-12-06 04:55:26.874601 (Thread-709): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 04:55:26.874924 (Thread-709): Partial parsing: added file: jaffle_shop://models/staging/stripe/src_stripe.yml
2021-12-06 04:55:26.922691 (Thread-709): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d22e6d0>]}
2021-12-06 04:55:27.698300 (Thread-710): handling status request
2021-12-06 04:55:27.698613 (Thread-710): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d317430>]}
2021-12-06 04:55:27.699110 (Thread-710): sending response (<Response 1233 bytes [200 OK]>) to 10.0.37.206
2021-12-06 04:55:27.712316 (Thread-711): handling status request
2021-12-06 04:55:27.712516 (Thread-711): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d317b80>]}
2021-12-06 04:55:27.712865 (Thread-711): sending response (<Response 1233 bytes [200 OK]>) to 10.0.30.196
2021-12-06 04:57:13.899939 (Thread-712): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 04:57:13.901858 (Thread-712): Partial parsing: update schema file: jaffle_shop://models/staging/stripe/src_stripe.yml
2021-12-06 04:57:13.953150 (Thread-712): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d1decd0>]}
2021-12-06 04:57:14.718065 (Thread-713): handling status request
2021-12-06 04:57:14.718410 (Thread-713): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d21bee0>]}
2021-12-06 04:57:14.718911 (Thread-713): sending response (<Response 1241 bytes [200 OK]>) to 10.0.38.70
2021-12-06 04:57:14.732416 (Thread-714): handling status request
2021-12-06 04:57:14.732633 (Thread-714): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d21bc40>]}
2021-12-06 04:57:14.733005 (Thread-714): sending response (<Response 1241 bytes [200 OK]>) to 10.0.6.71
2021-12-06 04:57:34.626608 (Thread-715): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 04:57:34.626992 (Thread-715): Partial parsing: updated file: jaffle_shop://models/staging/stripe/stg_payments.sql
2021-12-06 04:57:34.630531 (Thread-715): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 04:57:34.690569 (Thread-715): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d19ffa0>]}
2021-12-06 04:57:35.422208 (Thread-716): handling status request
2021-12-06 04:57:35.422539 (Thread-716): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d22c790>]}
2021-12-06 04:57:35.423025 (Thread-716): sending response (<Response 1539 bytes [200 OK]>) to 10.0.3.73
2021-12-06 04:57:35.534315 (Thread-717): handling status request
2021-12-06 04:57:35.534582 (Thread-717): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d251370>]}
2021-12-06 04:57:35.535019 (Thread-717): sending response (<Response 1539 bytes [200 OK]>) to 10.0.6.71
2021-12-06 05:01:33.819757 (Thread-718): handling status request
2021-12-06 05:01:33.821844 (Thread-718): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d22e7c0>]}
2021-12-06 05:01:33.822391 (Thread-718): sending response (<Response 1539 bytes [200 OK]>) to 10.0.22.219
2021-12-06 05:01:34.247885 (Thread-719): handling status request
2021-12-06 05:01:34.248166 (Thread-719): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d251370>]}
2021-12-06 05:01:34.248615 (Thread-719): sending response (<Response 1539 bytes [200 OK]>) to 10.0.36.143
2021-12-06 05:01:34.259910 (Thread-720): handling cli_args request
2021-12-06 05:01:34.260119 (Thread-720): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d22ecd0>]}
2021-12-06 05:01:34.270081 (Thread-720): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 05:01:36.188919 (Thread-720): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.86
2021-12-06 05:01:36.225017 (MainThread): Partial parsing not enabled
2021-12-06 05:01:36.325924 (MainThread): Parsing macros/catalog.sql
2021-12-06 05:01:36.327862 (MainThread): Parsing macros/adapters.sql
2021-12-06 05:01:36.361873 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 05:01:36.365457 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 05:01:36.368466 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 05:01:36.372662 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 05:01:36.373878 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 05:01:36.382023 (MainThread): Parsing macros/core.sql
2021-12-06 05:01:36.385501 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 05:01:36.391740 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 05:01:36.401031 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 05:01:36.407726 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 05:01:36.411401 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 05:01:36.432715 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 05:01:36.448763 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 05:01:36.450296 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 05:01:36.479333 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 05:01:36.486174 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 05:01:36.499153 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 05:01:36.517606 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 05:01:36.527185 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 05:01:36.528824 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 05:01:36.530174 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 05:01:36.537977 (MainThread): Parsing macros/etc/query.sql
2021-12-06 05:01:36.538923 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 05:01:36.540532 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 05:01:36.541967 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 05:01:36.544271 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 05:01:36.545619 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 05:01:36.597437 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 05:01:36.599509 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 05:01:36.600582 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 05:01:36.602080 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 05:01:36.726700 (Thread-721): handling poll request
2021-12-06 05:01:36.726992 (Thread-721): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d3631f0>]}
2021-12-06 05:01:36.728067 (Thread-721): sending response (<Response 9686 bytes [200 OK]>) to 10.0.30.196
2021-12-06 05:01:36.782796 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:01:36.794826 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:01:36.798020 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:01:36.801400 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:01:36.804936 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:01:36.817098 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 05:01:36.966762 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63da0318-09f0-4a77-9651-0447dd0d117d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d03e9af0>]}
2021-12-06 05:01:36.994495 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63da0318-09f0-4a77-9651-0447dd0d117d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d03ed910>]}
2021-12-06 05:01:36.994684 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 05:01:36.996259 (MainThread): 
2021-12-06 05:01:36.996453 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 05:01:36.997292 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 05:01:37.008572 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 05:01:37.008641 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 05:01:37.008694 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 05:01:38.237132 (Thread-722): handling poll request
2021-12-06 05:01:38.237459 (Thread-722): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d1a5c40>]}
2021-12-06 05:01:38.238138 (Thread-722): sending response (<Response 5276 bytes [200 OK]>) to 10.0.36.143
2021-12-06 05:01:38.505669 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.50 seconds
2021-12-06 05:01:38.507479 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 05:01:38.967027 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:01:38.973983 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:01:38.974085 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 05:01:38.974149 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 05:01:39.762913 (Thread-723): handling poll request
2021-12-06 05:01:39.763268 (Thread-723): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d1a5c70>]}
2021-12-06 05:01:39.763848 (Thread-723): sending response (<Response 2263 bytes [200 OK]>) to 10.0.6.71
2021-12-06 05:01:40.391816 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.42 seconds
2021-12-06 05:01:40.393251 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 05:01:40.839445 (MainThread): 05:01:40 | Concurrency: 4 threads (target='default')
2021-12-06 05:01:40.839587 (MainThread): 05:01:40 | 
2021-12-06 05:01:40.841552 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 05:01:40.841842 (Thread-1): 05:01:40 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 05:01:40.842108 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:01:40.842216 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 05:01:40.843096 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 05:01:40.843318 (Thread-2): 05:01:40 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 05:01:40.843542 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:01:40.843611 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 05:01:40.845818 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 05:01:40.847811 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 05:01:40.847997 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 05:01:40.848209 (Thread-3): 05:01:40 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 05:01:40.848424 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:01:40.848491 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 05:01:40.850421 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 05:01:40.868892 (Thread-3): finished collecting timing info
2021-12-06 05:01:40.873982 (Thread-1): finished collecting timing info
2021-12-06 05:01:40.884297 (Thread-2): finished collecting timing info
2021-12-06 05:01:40.909004 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 05:01:40.909279 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 05:01:40.910888 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 05:01:40.933008 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:01:40.933090 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 05:01:40.933148 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 05:01:40.934315 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:01:40.934388 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 05:01:40.934445 (Thread-3): Opening a new connection, currently in state init
2021-12-06 05:01:40.935528 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:01:40.935602 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 05:01:40.935657 (Thread-2): Opening a new connection, currently in state init
2021-12-06 05:01:41.218612 (Thread-724): handling poll request
2021-12-06 05:01:41.218895 (Thread-724): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d14c520>]}
2021-12-06 05:01:41.219793 (Thread-724): sending response (<Response 14356 bytes [200 OK]>) to 10.0.2.25
2021-12-06 05:01:42.576112 (Thread-3): SQL status: SUCCESS 1 in 1.64 seconds
2021-12-06 05:01:42.582638 (Thread-3): finished collecting timing info
2021-12-06 05:01:42.582777 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 05:01:42.584320 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-06 05:01:42.585404 (Thread-1): finished collecting timing info
2021-12-06 05:01:42.585516 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 05:01:42.628828 (Thread-2): SQL status: SUCCESS 1 in 1.69 seconds
2021-12-06 05:01:42.629888 (Thread-2): finished collecting timing info
2021-12-06 05:01:42.630039 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 05:01:42.738579 (Thread-725): handling poll request
2021-12-06 05:01:42.738856 (Thread-725): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d14cfd0>]}
2021-12-06 05:01:42.739427 (Thread-725): sending response (<Response 3556 bytes [200 OK]>) to 10.0.30.196
2021-12-06 05:01:43.038897 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da0318-09f0-4a77-9651-0447dd0d117d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cb576b20>]}
2021-12-06 05:01:43.039238 (Thread-1): 05:01:43 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.20s]
2021-12-06 05:01:43.039324 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 05:01:43.040481 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da0318-09f0-4a77-9651-0447dd0d117d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c803d0a0>]}
2021-12-06 05:01:43.040752 (Thread-3): 05:01:43 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.19s]
2021-12-06 05:01:43.040826 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 05:01:43.077483 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da0318-09f0-4a77-9651-0447dd0d117d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c803dac0>]}
2021-12-06 05:01:43.077752 (Thread-2): 05:01:43 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.23s]
2021-12-06 05:01:43.077825 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 05:01:43.078646 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 05:01:43.078849 (Thread-4): 05:01:43 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 05:01:43.079063 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:01:43.079136 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 05:01:43.081340 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 05:01:43.100013 (Thread-4): finished collecting timing info
2021-12-06 05:01:43.116101 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 05:01:43.134764 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:01:43.134847 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 05:01:43.134904 (Thread-4): Opening a new connection, currently in state init
2021-12-06 05:01:44.178197 (Thread-726): handling poll request
2021-12-06 05:01:44.178518 (Thread-726): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d1431f0>]}
2021-12-06 05:01:44.206372 (Thread-726): sending response (<Response 8809 bytes [200 OK]>) to 10.0.26.3
2021-12-06 05:01:45.722499 (Thread-727): handling poll request
2021-12-06 05:01:45.722812 (Thread-727): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d14c4c0>]}
2021-12-06 05:01:45.723306 (Thread-727): sending response (<Response 287 bytes [200 OK]>) to 10.0.37.206
2021-12-06 05:01:45.776161 (Thread-4): SQL status: SUCCESS 1 in 2.64 seconds
2021-12-06 05:01:45.780700 (Thread-4): finished collecting timing info
2021-12-06 05:01:45.780844 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 05:01:46.237251 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da0318-09f0-4a77-9651-0447dd0d117d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d041e4c0>]}
2021-12-06 05:01:46.237612 (Thread-4): 05:01:46 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 3.16s]
2021-12-06 05:01:46.237697 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 05:01:46.238523 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 05:01:46.238764 (Thread-3): 05:01:46 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 05:01:46.238983 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:01:46.239059 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 05:01:46.241467 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 05:01:46.257003 (Thread-3): finished collecting timing info
2021-12-06 05:01:46.259041 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 05:01:46.276015 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:01:46.276098 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 05:01:46.276156 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 05:01:47.270798 (Thread-728): handling poll request
2021-12-06 05:01:47.271118 (Thread-728): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d143ee0>]}
2021-12-06 05:01:47.271825 (Thread-728): sending response (<Response 7709 bytes [200 OK]>) to 10.0.0.217
2021-12-06 05:01:48.607170 (Thread-3): SQL status: SUCCESS 1 in 2.33 seconds
2021-12-06 05:01:48.608580 (Thread-3): finished collecting timing info
2021-12-06 05:01:48.608717 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 05:01:48.766872 (Thread-729): handling poll request
2021-12-06 05:01:48.767180 (Thread-729): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d1431f0>]}
2021-12-06 05:01:48.767705 (Thread-729): sending response (<Response 1380 bytes [200 OK]>) to 10.0.36.143
2021-12-06 05:01:49.063296 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da0318-09f0-4a77-9651-0447dd0d117d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31a7fdbdc0>]}
2021-12-06 05:01:49.063694 (Thread-3): 05:01:49 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.82s]
2021-12-06 05:01:49.063784 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 05:01:49.065291 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 05:01:49.065606 (MainThread): 05:01:49 | 
2021-12-06 05:01:49.065675 (MainThread): 05:01:49 | Finished running 3 view models, 2 table models in 12.07s.
2021-12-06 05:01:49.065723 (MainThread): Connection 'master' was properly closed.
2021-12-06 05:01:49.065763 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 05:01:49.065799 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 05:01:49.065833 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 05:01:49.065866 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 05:01:49.124824 (MainThread): 
2021-12-06 05:01:49.124927 (MainThread): Completed successfully
2021-12-06 05:01:49.124991 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 05:01:50.242541 (Thread-730): handling poll request
2021-12-06 05:01:50.242857 (Thread-730): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d13caf0>]}
2021-12-06 05:01:50.244263 (Thread-730): sending response (<Response 22955 bytes [200 OK]>) to 10.0.39.19
2021-12-06 05:01:51.167486 (Thread-731): handling status request
2021-12-06 05:01:51.167812 (Thread-731): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d13ca30>]}
2021-12-06 05:01:51.168367 (Thread-731): sending response (<Response 1539 bytes [200 OK]>) to 10.0.30.196
2021-12-06 05:01:51.192177 (Thread-732): handling status request
2021-12-06 05:01:51.192377 (Thread-732): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d13cbe0>]}
2021-12-06 05:01:51.192761 (Thread-732): sending response (<Response 1539 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:03:52.187037 (Thread-733): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 05:03:52.188919 (Thread-733): Partial parsing: deleted source source.jaffle_shop.jaffle_shop.customers
2021-12-06 05:03:52.189069 (Thread-733): Partial parsing: deleted source source.jaffle_shop.jaffle_shop.orders
2021-12-06 05:03:52.189159 (Thread-733): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
2021-12-06 05:03:52.194406 (Thread-733): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:03:52.199465 (Thread-733): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:03:52.203673 (Thread-733): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:03:52.207883 (Thread-733): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:03:52.302181 (Thread-733): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0e63d0>]}
2021-12-06 05:03:53.040812 (Thread-734): handling status request
2021-12-06 05:03:53.041125 (Thread-734): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0e1310>]}
2021-12-06 05:03:53.041647 (Thread-734): sending response (<Response 3062 bytes [200 OK]>) to 10.0.37.206
2021-12-06 05:03:53.073218 (Thread-735): handling status request
2021-12-06 05:03:53.073417 (Thread-735): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0e1c70>]}
2021-12-06 05:03:53.073793 (Thread-735): sending response (<Response 3062 bytes [200 OK]>) to 10.0.38.50
2021-12-06 05:05:48.259662 (Thread-736): handling status request
2021-12-06 05:05:48.261639 (Thread-736): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d08bf70>]}
2021-12-06 05:05:48.262229 (Thread-736): sending response (<Response 3062 bytes [200 OK]>) to 10.0.30.196
2021-12-06 05:05:48.647198 (Thread-737): handling status request
2021-12-06 05:05:48.647405 (Thread-737): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d084760>]}
2021-12-06 05:05:48.647834 (Thread-737): sending response (<Response 3062 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:05:48.719832 (Thread-738): handling docs.generate request
2021-12-06 05:05:48.720032 (Thread-738): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0a4a60>]}
2021-12-06 05:05:48.721064 (Thread-738): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 05:05:50.640902 (Thread-738): sending response (<Response 138 bytes [200 OK]>) to 10.0.0.217
2021-12-06 05:05:50.675319 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46f1ce7b-9105-4321-b084-e02d605f5a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95bdcadc70>]}
2021-12-06 05:05:50.675550 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 05:05:50.677438 (MainThread): 
2021-12-06 05:05:50.677552 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 05:05:50.678390 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:05:50.693961 (ThreadPoolExecutor-0_0): Parsing macros/catalog.sql
2021-12-06 05:05:50.697283 (ThreadPoolExecutor-0_0): Parsing macros/adapters.sql
2021-12-06 05:05:50.733887 (ThreadPoolExecutor-0_0): Parsing macros/materializations/merge.sql
2021-12-06 05:05:50.737964 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table.sql
2021-12-06 05:05:50.741334 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed.sql
2021-12-06 05:05:50.745729 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view.sql
2021-12-06 05:05:50.747227 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental.sql
2021-12-06 05:05:50.756702 (ThreadPoolExecutor-0_0): Parsing macros/core.sql
2021-12-06 05:05:50.760719 (ThreadPoolExecutor-0_0): Parsing macros/materializations/test.sql
2021-12-06 05:05:50.767875 (ThreadPoolExecutor-0_0): Parsing macros/materializations/helpers.sql
2021-12-06 05:05:50.777540 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/view.sql
2021-12-06 05:05:50.784470 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 05:05:50.788362 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed/seed.sql
2021-12-06 05:05:50.810360 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 05:05:50.827540 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 05:05:50.829312 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 05:05:50.859035 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table/table.sql
2021-12-06 05:05:50.866228 (ThreadPoolExecutor-0_0): Parsing macros/materializations/common/merge.sql
2021-12-06 05:05:50.879733 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 05:05:50.898945 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 05:05:50.908712 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 05:05:50.910535 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_alias.sql
2021-12-06 05:05:50.912088 (ThreadPoolExecutor-0_0): Parsing macros/etc/datetime.sql
2021-12-06 05:05:50.920334 (ThreadPoolExecutor-0_0): Parsing macros/etc/query.sql
2021-12-06 05:05:50.921388 (ThreadPoolExecutor-0_0): Parsing macros/etc/where_subquery.sql
2021-12-06 05:05:50.923257 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_database.sql
2021-12-06 05:05:50.924899 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_schema.sql
2021-12-06 05:05:50.927361 (ThreadPoolExecutor-0_0): Parsing macros/etc/is_incremental.sql
2021-12-06 05:05:50.929009 (ThreadPoolExecutor-0_0): Parsing macros/adapters/common.sql
2021-12-06 05:05:50.982202 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 05:05:50.984514 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/not_null.sql
2021-12-06 05:05:50.985805 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/relationships.sql
2021-12-06 05:05:50.987565 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/unique.sql
2021-12-06 05:05:51.000622 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:05:51.000710 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: show terse objects in analytics.dbt_pstulnikov
2021-12-06 05:05:51.000768 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 05:05:51.115651 (Thread-739): handling poll request
2021-12-06 05:05:51.115934 (Thread-739): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0e3a00>]}
2021-12-06 05:05:51.117108 (Thread-739): sending response (<Response 12403 bytes [200 OK]>) to 10.0.38.50
2021-12-06 05:05:52.492324 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.49 seconds
2021-12-06 05:05:52.494408 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 05:05:52.645307 (Thread-740): handling poll request
2021-12-06 05:05:52.645619 (Thread-740): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0dc130>]}
2021-12-06 05:05:52.646178 (Thread-740): sending response (<Response 863 bytes [200 OK]>) to 10.0.37.206
2021-12-06 05:05:52.938304 (MainThread): 05:05:52 | Concurrency: 4 threads (target='default')
2021-12-06 05:05:52.938437 (MainThread): 05:05:52 | 
2021-12-06 05:05:52.940531 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 05:05:52.940720 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:05:52.940820 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 05:05:52.941651 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 05:05:52.941806 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:05:52.941871 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 05:05:52.944728 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 05:05:52.945274 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 05:05:52.945429 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:05:52.945497 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 05:05:52.947584 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 05:05:52.947874 (Thread-4): Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
2021-12-06 05:05:52.948025 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f".
2021-12-06 05:05:52.948089 (Thread-4): Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
2021-12-06 05:05:52.957137 (Thread-4): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
2021-12-06 05:05:52.960208 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 05:05:52.968306 (Thread-2): finished collecting timing info
2021-12-06 05:05:52.968456 (Thread-2): finished collecting timing info
2021-12-06 05:05:52.968567 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 05:05:52.968646 (Thread-2): Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
2021-12-06 05:05:52.968719 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13".
2021-12-06 05:05:52.968771 (Thread-2): Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
2021-12-06 05:05:53.016394 (Thread-3): finished collecting timing info
2021-12-06 05:05:53.016522 (Thread-3): finished collecting timing info
2021-12-06 05:05:53.016620 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 05:05:53.016692 (Thread-3): Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
2021-12-06 05:05:53.016777 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e".
2021-12-06 05:05:53.016839 (Thread-3): Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
2021-12-06 05:05:53.024058 (Thread-2): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
2021-12-06 05:05:53.025065 (Thread-3): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
2021-12-06 05:05:53.031601 (Thread-1): finished collecting timing info
2021-12-06 05:05:53.031721 (Thread-1): finished collecting timing info
2021-12-06 05:05:53.031821 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 05:05:53.031900 (Thread-1): Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
2021-12-06 05:05:53.031974 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba".
2021-12-06 05:05:53.032026 (Thread-1): Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
2021-12-06 05:05:53.034881 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
2021-12-06 05:05:53.035440 (Thread-4): finished collecting timing info
2021-12-06 05:05:53.035553 (Thread-4): finished collecting timing info
2021-12-06 05:05:53.035648 (Thread-4): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
2021-12-06 05:05:53.035729 (Thread-4): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 05:05:53.035802 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 05:05:53.035853 (Thread-4): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 05:05:53.040870 (Thread-2): finished collecting timing info
2021-12-06 05:05:53.040978 (Thread-2): finished collecting timing info
2021-12-06 05:05:53.041075 (Thread-2): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
2021-12-06 05:05:53.041142 (Thread-2): Began running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 05:05:53.041216 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 05:05:53.041266 (Thread-2): Compiling test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 05:05:53.042996 (Thread-2): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 05:05:53.046772 (Thread-4): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 05:05:53.051969 (Thread-3): finished collecting timing info
2021-12-06 05:05:53.052082 (Thread-3): finished collecting timing info
2021-12-06 05:05:53.052177 (Thread-3): Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
2021-12-06 05:05:53.052257 (Thread-3): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 05:05:53.052330 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 05:05:53.052381 (Thread-3): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 05:05:53.055029 (Thread-3): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 05:05:53.055275 (Thread-1): finished collecting timing info
2021-12-06 05:05:53.055385 (Thread-1): finished collecting timing info
2021-12-06 05:05:53.055480 (Thread-1): Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
2021-12-06 05:05:53.055555 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 05:05:53.055627 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-12-06 05:05:53.055679 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 05:05:53.062518 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-12-06 05:05:53.068472 (Thread-2): finished collecting timing info
2021-12-06 05:05:53.068587 (Thread-2): finished collecting timing info
2021-12-06 05:05:53.068681 (Thread-2): Finished running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 05:05:53.068757 (Thread-2): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 05:05:53.068829 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 05:05:53.068880 (Thread-2): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 05:05:53.071384 (Thread-2): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 05:05:53.071711 (Thread-4): finished collecting timing info
2021-12-06 05:05:53.071822 (Thread-4): finished collecting timing info
2021-12-06 05:05:53.071917 (Thread-4): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 05:05:53.072593 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 05:05:53.072685 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:05:53.072739 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 05:05:53.074768 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 05:05:53.078593 (Thread-1): finished collecting timing info
2021-12-06 05:05:53.078706 (Thread-1): finished collecting timing info
2021-12-06 05:05:53.078798 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 05:05:53.079023 (Thread-3): finished collecting timing info
2021-12-06 05:05:53.079149 (Thread-3): finished collecting timing info
2021-12-06 05:05:53.079246 (Thread-3): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 05:05:53.087004 (Thread-2): finished collecting timing info
2021-12-06 05:05:53.087122 (Thread-2): finished collecting timing info
2021-12-06 05:05:53.087217 (Thread-2): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 05:05:53.092548 (Thread-4): finished collecting timing info
2021-12-06 05:05:53.092663 (Thread-4): finished collecting timing info
2021-12-06 05:05:53.092755 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 05:05:53.093361 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-12-06 05:05:53.093475 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:05:53.093530 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-12-06 05:05:53.095529 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 05:05:53.109742 (Thread-1): finished collecting timing info
2021-12-06 05:05:53.109849 (Thread-1): finished collecting timing info
2021-12-06 05:05:53.109961 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-12-06 05:05:53.110924 (MainThread): Connection 'master' was properly closed.
2021-12-06 05:05:53.111007 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 05:05:53.111047 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 05:05:53.111081 (MainThread): Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
2021-12-06 05:05:53.111114 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 05:05:53.176056 (MainThread): 05:05:53 | Done.
2021-12-06 05:05:53.228625 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-12-06 05:05:53.228706 (MainThread): 05:05:53 | Building catalog
2021-12-06 05:05:53.230942 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "analytics.information_schema".
2021-12-06 05:05:53.237335 (ThreadPoolExecutor-1_0): Using snowflake connection "analytics.information_schema".
2021-12-06 05:05:53.237406 (ThreadPoolExecutor-1_0): On analytics.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_pstulnikov') or upper("table_schema") = upper('dbt_pstulnikov_dbt_test__audit'))
      order by "column_index"
2021-12-06 05:05:53.237465 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 05:05:53.237985 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "raw.information_schema".
2021-12-06 05:05:53.241088 (ThreadPoolExecutor-1_1): Using snowflake connection "raw.information_schema".
2021-12-06 05:05:53.241159 (ThreadPoolExecutor-1_1): On raw.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from raw.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from raw.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('stripe') or upper("table_schema") = upper('jaffle_shop'))
      order by "column_index"
2021-12-06 05:05:53.241210 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-12-06 05:05:54.102093 (Thread-741): handling poll request
2021-12-06 05:05:54.102392 (Thread-741): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0e1970>]}
2021-12-06 05:05:54.104258 (Thread-741): sending response (<Response 58075 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:05:55.574579 (Thread-742): handling poll request
2021-12-06 05:05:55.574897 (Thread-742): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0e1910>]}
2021-12-06 05:05:55.575395 (Thread-742): sending response (<Response 295 bytes [200 OK]>) to 10.0.0.217
2021-12-06 05:05:55.659025 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 15 in 2.42 seconds
2021-12-06 05:05:55.667805 (ThreadPoolExecutor-1_1): On raw.information_schema: Close
2021-12-06 05:05:55.868957 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 24 in 2.63 seconds
2021-12-06 05:05:55.874767 (ThreadPoolExecutor-1_0): On analytics.information_schema: Close
2021-12-06 05:05:56.396193 (MainThread): 05:05:56 | Catalog written to /usr/src/develop/user-48664/environment-53260/repository-43071/target/catalog.json
2021-12-06 05:05:57.027971 (Thread-743): handling poll request
2021-12-06 05:05:57.028309 (Thread-743): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0e9400>]}
2021-12-06 05:05:57.029299 (Thread-743): sending response (<Response 10876 bytes [200 OK]>) to 10.0.6.10
2021-12-06 05:05:57.903703 (Thread-744): handling status request
2021-12-06 05:05:57.904051 (Thread-744): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0ed880>]}
2021-12-06 05:05:57.904604 (Thread-744): sending response (<Response 3062 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:05:57.983775 (Thread-745): handling status request
2021-12-06 05:05:57.983995 (Thread-745): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0e0910>]}
2021-12-06 05:05:57.984420 (Thread-745): sending response (<Response 3062 bytes [200 OK]>) to 10.0.0.217
2021-12-06 05:05:58.069144 (Thread-746): handling status request
2021-12-06 05:05:58.069377 (Thread-746): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0d62b0>]}
2021-12-06 05:05:58.069817 (Thread-746): sending response (<Response 3062 bytes [200 OK]>) to 10.0.0.217
2021-12-06 05:07:22.362876 (Thread-747): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 05:07:22.364578 (Thread-747): Partial parsing: deleted source source.jaffle_shop.jaffle_shop.customers
2021-12-06 05:07:22.364728 (Thread-747): Partial parsing: deleted source source.jaffle_shop.jaffle_shop.orders
2021-12-06 05:07:22.364826 (Thread-747): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
2021-12-06 05:07:22.368471 (Thread-747): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:07:22.373226 (Thread-747): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:07:22.377025 (Thread-747): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:07:22.380948 (Thread-747): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:07:22.473730 (Thread-747): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d28adf0>]}
2021-12-06 05:07:23.049330 (Thread-748): handling status request
2021-12-06 05:07:23.049650 (Thread-748): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d28ae50>]}
2021-12-06 05:07:23.050242 (Thread-748): sending response (<Response 3062 bytes [200 OK]>) to 10.0.36.143
2021-12-06 05:07:23.076129 (Thread-749): handling status request
2021-12-06 05:07:23.076325 (Thread-749): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d28aca0>]}
2021-12-06 05:07:23.076747 (Thread-749): sending response (<Response 3062 bytes [200 OK]>) to 10.0.38.70
2021-12-06 05:07:26.413912 (Thread-750): handling status request
2021-12-06 05:07:26.414271 (Thread-750): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d4eadf0>]}
2021-12-06 05:07:26.414807 (Thread-750): sending response (<Response 3062 bytes [200 OK]>) to 10.0.3.73
2021-12-06 05:07:26.782639 (Thread-751): handling status request
2021-12-06 05:07:26.782964 (Thread-751): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d4ea460>]}
2021-12-06 05:07:26.783515 (Thread-751): sending response (<Response 3062 bytes [200 OK]>) to 10.0.41.241
2021-12-06 05:07:26.922843 (Thread-752): handling docs.generate request
2021-12-06 05:07:26.923063 (Thread-752): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d466dc0>]}
2021-12-06 05:07:26.924055 (Thread-752): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 05:07:28.828456 (Thread-752): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.30
2021-12-06 05:07:28.864977 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bc0d3e8-2dfc-4481-a066-06581d5aa768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c5ed2b80>]}
2021-12-06 05:07:28.865219 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 05:07:28.867161 (MainThread): 
2021-12-06 05:07:28.867283 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 05:07:28.868127 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:07:28.882687 (ThreadPoolExecutor-0_0): Parsing macros/catalog.sql
2021-12-06 05:07:28.885961 (ThreadPoolExecutor-0_0): Parsing macros/adapters.sql
2021-12-06 05:07:28.921449 (ThreadPoolExecutor-0_0): Parsing macros/materializations/merge.sql
2021-12-06 05:07:28.925392 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table.sql
2021-12-06 05:07:28.928694 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed.sql
2021-12-06 05:07:28.933142 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view.sql
2021-12-06 05:07:28.934638 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental.sql
2021-12-06 05:07:28.943925 (ThreadPoolExecutor-0_0): Parsing macros/core.sql
2021-12-06 05:07:28.947593 (ThreadPoolExecutor-0_0): Parsing macros/materializations/test.sql
2021-12-06 05:07:28.954219 (ThreadPoolExecutor-0_0): Parsing macros/materializations/helpers.sql
2021-12-06 05:07:28.963752 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/view.sql
2021-12-06 05:07:28.970744 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 05:07:28.974538 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed/seed.sql
2021-12-06 05:07:28.996211 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 05:07:29.012517 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 05:07:29.014229 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 05:07:29.050333 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table/table.sql
2021-12-06 05:07:29.057230 (ThreadPoolExecutor-0_0): Parsing macros/materializations/common/merge.sql
2021-12-06 05:07:29.070300 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 05:07:29.088852 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 05:07:29.098456 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 05:07:29.100141 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_alias.sql
2021-12-06 05:07:29.101648 (ThreadPoolExecutor-0_0): Parsing macros/etc/datetime.sql
2021-12-06 05:07:29.109630 (ThreadPoolExecutor-0_0): Parsing macros/etc/query.sql
2021-12-06 05:07:29.110657 (ThreadPoolExecutor-0_0): Parsing macros/etc/where_subquery.sql
2021-12-06 05:07:29.112430 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_database.sql
2021-12-06 05:07:29.114022 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_schema.sql
2021-12-06 05:07:29.116377 (ThreadPoolExecutor-0_0): Parsing macros/etc/is_incremental.sql
2021-12-06 05:07:29.117946 (ThreadPoolExecutor-0_0): Parsing macros/adapters/common.sql
2021-12-06 05:07:29.169439 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 05:07:29.171642 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/not_null.sql
2021-12-06 05:07:29.172884 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/relationships.sql
2021-12-06 05:07:29.174538 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/unique.sql
2021-12-06 05:07:29.187105 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:07:29.187188 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: show terse objects in analytics.dbt_pstulnikov
2021-12-06 05:07:29.187243 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 05:07:29.322824 (Thread-753): handling poll request
2021-12-06 05:07:29.323160 (Thread-753): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d27d910>]}
2021-12-06 05:07:29.324376 (Thread-753): sending response (<Response 12403 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:07:30.657098 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.47 seconds
2021-12-06 05:07:30.659126 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 05:07:30.785105 (Thread-754): handling poll request
2021-12-06 05:07:30.785383 (Thread-754): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d2f3460>]}
2021-12-06 05:07:30.785897 (Thread-754): sending response (<Response 863 bytes [200 OK]>) to 10.0.6.10
2021-12-06 05:07:31.096336 (MainThread): 05:07:31 | Concurrency: 4 threads (target='default')
2021-12-06 05:07:31.096450 (MainThread): 05:07:31 | 
2021-12-06 05:07:31.098532 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 05:07:31.098704 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:07:31.098802 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 05:07:31.099638 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 05:07:31.099788 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:07:31.099859 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 05:07:31.102749 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 05:07:31.103045 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 05:07:31.103191 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:07:31.103256 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 05:07:31.105308 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 05:07:31.106013 (Thread-4): Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
2021-12-06 05:07:31.106154 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f".
2021-12-06 05:07:31.106219 (Thread-4): Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
2021-12-06 05:07:31.115127 (Thread-4): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
2021-12-06 05:07:31.118112 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 05:07:31.124558 (Thread-3): finished collecting timing info
2021-12-06 05:07:31.124709 (Thread-3): finished collecting timing info
2021-12-06 05:07:31.124824 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 05:07:31.124908 (Thread-3): Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
2021-12-06 05:07:31.124985 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13".
2021-12-06 05:07:31.125036 (Thread-3): Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
2021-12-06 05:07:31.173404 (Thread-2): finished collecting timing info
2021-12-06 05:07:31.173533 (Thread-2): finished collecting timing info
2021-12-06 05:07:31.173637 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 05:07:31.173719 (Thread-2): Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
2021-12-06 05:07:31.173796 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e".
2021-12-06 05:07:31.173850 (Thread-2): Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
2021-12-06 05:07:31.181596 (Thread-3): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
2021-12-06 05:07:31.182478 (Thread-2): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
2021-12-06 05:07:31.190612 (Thread-1): finished collecting timing info
2021-12-06 05:07:31.190739 (Thread-1): finished collecting timing info
2021-12-06 05:07:31.190842 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 05:07:31.190925 (Thread-1): Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
2021-12-06 05:07:31.191001 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba".
2021-12-06 05:07:31.191053 (Thread-1): Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
2021-12-06 05:07:31.193914 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
2021-12-06 05:07:31.194070 (Thread-4): finished collecting timing info
2021-12-06 05:07:31.194185 (Thread-4): finished collecting timing info
2021-12-06 05:07:31.194278 (Thread-4): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
2021-12-06 05:07:31.194348 (Thread-4): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 05:07:31.194420 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 05:07:31.194471 (Thread-4): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 05:07:31.203014 (Thread-4): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 05:07:31.211785 (Thread-2): finished collecting timing info
2021-12-06 05:07:31.211909 (Thread-2): finished collecting timing info
2021-12-06 05:07:31.212005 (Thread-2): Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
2021-12-06 05:07:31.212082 (Thread-2): Began running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 05:07:31.212159 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 05:07:31.212212 (Thread-2): Compiling test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 05:07:31.213973 (Thread-2): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 05:07:31.214108 (Thread-3): finished collecting timing info
2021-12-06 05:07:31.214222 (Thread-3): finished collecting timing info
2021-12-06 05:07:31.214315 (Thread-3): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
2021-12-06 05:07:31.214384 (Thread-3): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 05:07:31.214456 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 05:07:31.214506 (Thread-3): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 05:07:31.217120 (Thread-3): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 05:07:31.217548 (Thread-1): finished collecting timing info
2021-12-06 05:07:31.217656 (Thread-1): finished collecting timing info
2021-12-06 05:07:31.217759 (Thread-1): Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
2021-12-06 05:07:31.217838 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 05:07:31.217923 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-12-06 05:07:31.217998 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 05:07:31.224842 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-12-06 05:07:31.231663 (Thread-4): finished collecting timing info
2021-12-06 05:07:31.231774 (Thread-4): finished collecting timing info
2021-12-06 05:07:31.231866 (Thread-4): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 05:07:31.231940 (Thread-4): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 05:07:31.232012 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 05:07:31.232062 (Thread-4): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 05:07:31.234658 (Thread-4): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 05:07:31.235032 (Thread-3): finished collecting timing info
2021-12-06 05:07:31.235142 (Thread-3): finished collecting timing info
2021-12-06 05:07:31.235236 (Thread-3): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 05:07:31.235437 (Thread-2): finished collecting timing info
2021-12-06 05:07:31.235553 (Thread-2): finished collecting timing info
2021-12-06 05:07:31.235650 (Thread-2): Finished running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 05:07:31.236244 (Thread-3): Began running node model.jaffle_shop.fct_orders
2021-12-06 05:07:31.236359 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:07:31.236417 (Thread-3): Compiling model.jaffle_shop.fct_orders
2021-12-06 05:07:31.238310 (Thread-3): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 05:07:31.240908 (Thread-1): finished collecting timing info
2021-12-06 05:07:31.241022 (Thread-1): finished collecting timing info
2021-12-06 05:07:31.241115 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 05:07:31.249724 (Thread-4): finished collecting timing info
2021-12-06 05:07:31.249838 (Thread-4): finished collecting timing info
2021-12-06 05:07:31.249958 (Thread-4): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 05:07:31.253142 (Thread-3): finished collecting timing info
2021-12-06 05:07:31.253259 (Thread-3): finished collecting timing info
2021-12-06 05:07:31.253357 (Thread-3): Finished running node model.jaffle_shop.fct_orders
2021-12-06 05:07:31.253977 (Thread-2): Began running node model.jaffle_shop.dim_customers
2021-12-06 05:07:31.254094 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:07:31.254151 (Thread-2): Compiling model.jaffle_shop.dim_customers
2021-12-06 05:07:31.256201 (Thread-2): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 05:07:31.270974 (Thread-2): finished collecting timing info
2021-12-06 05:07:31.271087 (Thread-2): finished collecting timing info
2021-12-06 05:07:31.271182 (Thread-2): Finished running node model.jaffle_shop.dim_customers
2021-12-06 05:07:31.272202 (MainThread): Connection 'master' was properly closed.
2021-12-06 05:07:31.272283 (MainThread): Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
2021-12-06 05:07:31.272323 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 05:07:31.272358 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 05:07:31.272391 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 05:07:31.348313 (MainThread): 05:07:31 | Done.
2021-12-06 05:07:31.397156 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-12-06 05:07:31.397237 (MainThread): 05:07:31 | Building catalog
2021-12-06 05:07:31.399417 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "analytics.information_schema".
2021-12-06 05:07:31.405842 (ThreadPoolExecutor-1_0): Using snowflake connection "analytics.information_schema".
2021-12-06 05:07:31.405978 (ThreadPoolExecutor-1_0): On analytics.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_pstulnikov_dbt_test__audit') or upper("table_schema") = upper('dbt_pstulnikov'))
      order by "column_index"
2021-12-06 05:07:31.406044 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 05:07:31.407060 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "raw.information_schema".
2021-12-06 05:07:31.410438 (ThreadPoolExecutor-1_1): Using snowflake connection "raw.information_schema".
2021-12-06 05:07:31.410511 (ThreadPoolExecutor-1_1): On raw.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from raw.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from raw.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('stripe') or upper("table_schema") = upper('jaffle_shop'))
      order by "column_index"
2021-12-06 05:07:31.410565 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-12-06 05:07:32.238190 (Thread-755): handling poll request
2021-12-06 05:07:32.238493 (Thread-755): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d2ef970>]}
2021-12-06 05:07:32.240418 (Thread-755): sending response (<Response 58110 bytes [200 OK]>) to 10.0.3.73
2021-12-06 05:07:33.664750 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 24 in 2.26 seconds
2021-12-06 05:07:33.674856 (ThreadPoolExecutor-1_0): On analytics.information_schema: Close
2021-12-06 05:07:33.777599 (Thread-756): handling poll request
2021-12-06 05:07:33.777877 (Thread-756): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d2ef7f0>]}
2021-12-06 05:07:33.806228 (Thread-756): sending response (<Response 864 bytes [200 OK]>) to 10.0.6.71
2021-12-06 05:07:34.074402 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 15 in 2.66 seconds
2021-12-06 05:07:34.080365 (ThreadPoolExecutor-1_1): On raw.information_schema: Close
2021-12-06 05:07:34.610893 (MainThread): 05:07:34 | Catalog written to /usr/src/develop/user-48664/environment-53260/repository-43071/target/catalog.json
2021-12-06 05:07:35.322085 (Thread-757): handling poll request
2021-12-06 05:07:35.322417 (Thread-757): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d22e280>]}
2021-12-06 05:07:35.323415 (Thread-757): sending response (<Response 10306 bytes [200 OK]>) to 10.0.6.10
2021-12-06 05:07:36.272309 (Thread-758): handling status request
2021-12-06 05:07:36.272644 (Thread-758): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d28a730>]}
2021-12-06 05:07:36.273265 (Thread-758): sending response (<Response 3062 bytes [200 OK]>) to 10.0.36.143
2021-12-06 05:07:36.291514 (Thread-759): handling status request
2021-12-06 05:07:36.291708 (Thread-759): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d272730>]}
2021-12-06 05:07:36.292127 (Thread-759): sending response (<Response 3062 bytes [200 OK]>) to 10.0.30.196
2021-12-06 05:07:36.364723 (Thread-760): handling status request
2021-12-06 05:07:36.364914 (Thread-760): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d22ffd0>]}
2021-12-06 05:07:36.365301 (Thread-760): sending response (<Response 3062 bytes [200 OK]>) to 10.0.3.73
2021-12-06 05:14:48.903294 (Thread-761): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 05:14:48.905124 (Thread-761): Partial parsing: deleted source source.jaffle_shop.jaffle_shop.customers
2021-12-06 05:14:48.905304 (Thread-761): Partial parsing: deleted source source.jaffle_shop.jaffle_shop.orders
2021-12-06 05:14:48.905409 (Thread-761): Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
2021-12-06 05:14:48.909370 (Thread-761): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:14:48.913978 (Thread-761): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:14:48.917796 (Thread-761): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:14:48.921856 (Thread-761): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:14:49.006430 (Thread-761): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9463d0>]}
2021-12-06 05:14:49.705297 (Thread-762): handling status request
2021-12-06 05:14:49.705616 (Thread-762): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc71f5e0>]}
2021-12-06 05:14:49.706210 (Thread-762): sending response (<Response 3062 bytes [200 OK]>) to 10.0.26.3
2021-12-06 05:14:50.008720 (Thread-763): handling status request
2021-12-06 05:14:50.009040 (Thread-763): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e03670>]}
2021-12-06 05:14:50.009570 (Thread-763): sending response (<Response 3062 bytes [200 OK]>) to 10.0.2.25
2021-12-06 05:15:04.294742 (Thread-764): handling status request
2021-12-06 05:15:04.295080 (Thread-764): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a430e310>]}
2021-12-06 05:15:04.295588 (Thread-764): sending response (<Response 3062 bytes [200 OK]>) to 10.0.41.241
2021-12-06 05:15:04.624529 (Thread-765): handling status request
2021-12-06 05:15:04.624837 (Thread-765): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d79f6d0>]}
2021-12-06 05:15:04.625347 (Thread-765): sending response (<Response 3062 bytes [200 OK]>) to 10.0.22.219
2021-12-06 05:15:04.787302 (Thread-766): handling cli_args request
2021-12-06 05:15:04.787598 (Thread-766): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5266a0>]}
2021-12-06 05:15:04.799228 (Thread-766): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 05:15:06.791549 (Thread-766): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.50
2021-12-06 05:15:06.828774 (MainThread): Partial parsing not enabled
2021-12-06 05:15:06.900124 (MainThread): Parsing macros/catalog.sql
2021-12-06 05:15:06.902151 (MainThread): Parsing macros/adapters.sql
2021-12-06 05:15:06.936732 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 05:15:06.940320 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 05:15:06.943268 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 05:15:06.947413 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 05:15:06.948650 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 05:15:06.956779 (MainThread): Parsing macros/core.sql
2021-12-06 05:15:06.960235 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 05:15:06.966362 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 05:15:06.975559 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 05:15:06.982330 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 05:15:06.985907 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 05:15:07.007130 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 05:15:07.023072 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 05:15:07.024581 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 05:15:07.053688 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 05:15:07.060542 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 05:15:07.073507 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 05:15:07.091963 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 05:15:07.101452 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 05:15:07.103113 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 05:15:07.104461 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 05:15:07.112308 (MainThread): Parsing macros/etc/query.sql
2021-12-06 05:15:07.113248 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 05:15:07.114874 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 05:15:07.116275 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 05:15:07.118597 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 05:15:07.119924 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 05:15:07.171600 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 05:15:07.173628 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 05:15:07.174706 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 05:15:07.176168 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 05:15:07.355242 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:15:07.367558 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:15:07.370773 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:15:07.374972 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:15:07.381138 (MainThread): 1699: statically parsed marts/core/fct_orders.sql
2021-12-06 05:15:07.381243 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:15:07.384016 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'e7f1e1a0-4c9a-494c-8bce-715f7f28b4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec62a30d00>]}
2021-12-06 05:15:07.393390 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 05:15:07.499563 (Thread-767): handling poll request
2021-12-06 05:15:07.500048 (Thread-767): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d85c190>]}
2021-12-06 05:15:07.501806 (Thread-767): sending response (<Response 12292 bytes [200 OK]>) to 10.0.38.70
2021-12-06 05:15:07.554430 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f1e1a0-4c9a-494c-8bce-715f7f28b4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec62a1abb0>]}
2021-12-06 05:15:07.589525 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f1e1a0-4c9a-494c-8bce-715f7f28b4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec62a1aa60>]}
2021-12-06 05:15:07.589723 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 05:15:07.591946 (MainThread): 
2021-12-06 05:15:07.592149 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 05:15:07.592966 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:15:07.604489 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:15:07.604561 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 05:15:07.604617 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 05:15:08.975687 (Thread-768): handling poll request
2021-12-06 05:15:08.976001 (Thread-768): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d85cac0>]}
2021-12-06 05:15:08.976610 (Thread-768): sending response (<Response 3494 bytes [200 OK]>) to 10.0.38.50
2021-12-06 05:15:09.121660 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.52 seconds
2021-12-06 05:15:09.123775 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 05:15:09.572693 (MainThread): 05:15:09 | Concurrency: 4 threads (target='default')
2021-12-06 05:15:09.572834 (MainThread): 05:15:09 | 
2021-12-06 05:15:09.574799 (Thread-1): Began running node source.jaffle_shop.jaffle_shop.orders
2021-12-06 05:15:09.574968 (Thread-1): 05:15:09 | 1 of 1 START freshness of jaffle_shop.orders......................... [RUN]
2021-12-06 05:15:09.575203 (Thread-1): Acquiring new snowflake connection "source.jaffle_shop.jaffle_shop.orders".
2021-12-06 05:15:09.575314 (Thread-1): finished collecting timing info
2021-12-06 05:15:09.575620 (Thread-1): Acquiring new snowflake connection "source.jaffle_shop.jaffle_shop.orders".
2021-12-06 05:15:09.584330 (Thread-1): Using snowflake connection "source.jaffle_shop.jaffle_shop.orders".
2021-12-06 05:15:09.584420 (Thread-1): On source.jaffle_shop.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "source.jaffle_shop.jaffle_shop.orders"} */
select
      max(_etl_loaded_at) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from raw.jaffle_shop.orders
2021-12-06 05:15:09.584485 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 05:15:10.515962 (Thread-769): handling poll request
2021-12-06 05:15:10.516288 (Thread-769): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d94a4f0>]}
2021-12-06 05:15:10.516974 (Thread-769): sending response (<Response 4940 bytes [200 OK]>) to 10.0.6.10
2021-12-06 05:15:11.050513 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-12-06 05:15:11.051896 (Thread-1): On source.jaffle_shop.jaffle_shop.orders: Close
2021-12-06 05:15:11.502001 (Thread-1): finished collecting timing info
2021-12-06 05:15:11.502304 (Thread-1): 05:15:11 | 1 of 1 ERROR STALE freshness of jaffle_shop.orders................... [ERROR STALE in 1.93s]
2021-12-06 05:15:11.502383 (Thread-1): Finished running node source.jaffle_shop.jaffle_shop.orders
2021-12-06 05:15:11.503827 (MainThread): Connection 'master' was properly closed.
2021-12-06 05:15:11.503917 (MainThread): Connection 'source.jaffle_shop.jaffle_shop.orders' was properly closed.
2021-12-06 05:15:11.554195 (MainThread): 
2021-12-06 05:15:11.554292 (MainThread): 05:15:11 | Done.
2021-12-06 05:15:11.977843 (Thread-770): handling poll request
2021-12-06 05:15:11.978213 (Thread-770): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d94a880>]}
2021-12-06 05:15:11.979172 (Thread-770): sending response (<Response 5384 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:15:13.064257 (Thread-771): handling status request
2021-12-06 05:15:13.064603 (Thread-771): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db47640>]}
2021-12-06 05:15:13.065215 (Thread-771): sending response (<Response 3062 bytes [200 OK]>) to 10.0.26.3
2021-12-06 05:15:13.125358 (Thread-772): handling status request
2021-12-06 05:15:13.125584 (Thread-772): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db473d0>]}
2021-12-06 05:15:13.126048 (Thread-772): sending response (<Response 3062 bytes [200 OK]>) to 10.0.0.217
2021-12-06 05:15:26.986225 (Thread-773): handling status request
2021-12-06 05:15:26.986558 (Thread-773): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db47910>]}
2021-12-06 05:15:26.987095 (Thread-773): sending response (<Response 3062 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:15:27.364055 (Thread-774): handling status request
2021-12-06 05:15:27.364340 (Thread-774): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db47280>]}
2021-12-06 05:15:27.364842 (Thread-774): sending response (<Response 3062 bytes [200 OK]>) to 10.0.37.206
2021-12-06 05:15:27.441413 (Thread-775): handling cli_args request
2021-12-06 05:15:27.441632 (Thread-775): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db472e0>]}
2021-12-06 05:15:29.397062 (Thread-775): sending response (<Response 138 bytes [200 OK]>) to 10.0.0.217
2021-12-06 05:15:29.433507 (MainThread): Partial parsing not enabled
2021-12-06 05:15:29.505063 (MainThread): Parsing macros/catalog.sql
2021-12-06 05:15:29.506984 (MainThread): Parsing macros/adapters.sql
2021-12-06 05:15:29.540672 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 05:15:29.544270 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 05:15:29.547215 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 05:15:29.551343 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 05:15:29.552566 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 05:15:29.560655 (MainThread): Parsing macros/core.sql
2021-12-06 05:15:29.564129 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 05:15:29.570285 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 05:15:29.579473 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 05:15:29.586082 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 05:15:29.589683 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 05:15:29.610829 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 05:15:29.626706 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 05:15:29.628226 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 05:15:29.657107 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 05:15:29.663956 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 05:15:29.676905 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 05:15:29.695218 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 05:15:29.704756 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 05:15:29.706422 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 05:15:29.707751 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 05:15:29.717120 (MainThread): Parsing macros/etc/query.sql
2021-12-06 05:15:29.718498 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 05:15:29.721162 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 05:15:29.722815 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 05:15:29.725152 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 05:15:29.726647 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 05:15:29.778192 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 05:15:29.780244 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 05:15:29.781306 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 05:15:29.782818 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 05:15:29.882739 (Thread-776): handling poll request
2021-12-06 05:15:29.883027 (Thread-776): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db472e0>]}
2021-12-06 05:15:29.884238 (Thread-776): sending response (<Response 9686 bytes [200 OK]>) to 10.0.41.241
2021-12-06 05:15:29.962948 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:15:29.975199 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:15:29.978354 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:15:29.981728 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:15:29.985252 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:15:29.997359 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 05:15:30.159737 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1ba53e4-a414-4024-b2ea-4bba6fa128b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b0377850>]}
2021-12-06 05:15:30.193998 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1ba53e4-a414-4024-b2ea-4bba6fa128b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b036e970>]}
2021-12-06 05:15:30.194242 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 05:15:30.196210 (MainThread): 
2021-12-06 05:15:30.196426 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 05:15:30.197312 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 05:15:30.209193 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 05:15:30.209267 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 05:15:30.209323 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 05:15:31.357773 (Thread-777): handling poll request
2021-12-06 05:15:31.358132 (Thread-777): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d85c7c0>]}
2021-12-06 05:15:31.358792 (Thread-777): sending response (<Response 5276 bytes [200 OK]>) to 10.0.39.19
2021-12-06 05:15:31.676082 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.47 seconds
2021-12-06 05:15:31.677892 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 05:15:32.131398 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:15:32.138350 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:15:32.138448 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 05:15:32.138514 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 05:15:32.811719 (Thread-778): handling poll request
2021-12-06 05:15:32.812077 (Thread-778): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d94a070>]}
2021-12-06 05:15:32.812680 (Thread-778): sending response (<Response 2263 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:15:33.380025 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.24 seconds
2021-12-06 05:15:33.381485 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 05:15:33.833155 (MainThread): 05:15:33 | Concurrency: 4 threads (target='default')
2021-12-06 05:15:33.833286 (MainThread): 05:15:33 | 
2021-12-06 05:15:33.835193 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 05:15:33.835462 (Thread-1): 05:15:33 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 05:15:33.835681 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:15:33.835778 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 05:15:33.836676 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 05:15:33.836884 (Thread-2): 05:15:33 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 05:15:33.837111 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:15:33.837179 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 05:15:33.839462 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 05:15:33.839788 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 05:15:33.839999 (Thread-3): 05:15:33 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 05:15:33.840216 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:15:33.840279 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 05:15:33.842290 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 05:15:33.844705 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 05:15:33.857199 (Thread-2): finished collecting timing info
2021-12-06 05:15:33.862506 (Thread-1): finished collecting timing info
2021-12-06 05:15:33.877872 (Thread-3): finished collecting timing info
2021-12-06 05:15:33.892648 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 05:15:33.896118 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 05:15:33.897414 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 05:15:33.911090 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:15:33.911171 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,

        -- Amount is stored in cents, convert to dollars
        amount / 100 as amount,
        created as created_at

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 05:15:33.911228 (Thread-3): Opening a new connection, currently in state init
2021-12-06 05:15:33.913282 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:15:33.913367 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 05:15:33.913421 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 05:15:33.914467 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:15:33.914543 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 05:15:33.914598 (Thread-2): Opening a new connection, currently in state init
2021-12-06 05:15:34.451426 (Thread-779): handling poll request
2021-12-06 05:15:34.451711 (Thread-779): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ec4610>]}
2021-12-06 05:15:34.452720 (Thread-779): sending response (<Response 14357 bytes [200 OK]>) to 10.0.36.143
2021-12-06 05:15:35.539792 (Thread-2): SQL status: SUCCESS 1 in 1.63 seconds
2021-12-06 05:15:35.546263 (Thread-2): finished collecting timing info
2021-12-06 05:15:35.546399 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 05:15:35.675949 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2021-12-06 05:15:35.677069 (Thread-1): finished collecting timing info
2021-12-06 05:15:35.677186 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 05:15:35.735396 (Thread-3): SQL status: SUCCESS 1 in 1.82 seconds
2021-12-06 05:15:35.736483 (Thread-3): finished collecting timing info
2021-12-06 05:15:35.736591 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 05:15:35.996790 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ba53e4-a414-4024-b2ea-4bba6fa128b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ab387e80>]}
2021-12-06 05:15:35.997206 (Thread-2): 05:15:35 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.16s]
2021-12-06 05:15:35.997299 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 05:15:36.120292 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ba53e4-a414-4024-b2ea-4bba6fa128b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ab443340>]}
2021-12-06 05:15:36.120616 (Thread-1): 05:15:36 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.28s]
2021-12-06 05:15:36.120696 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 05:15:36.187981 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ba53e4-a414-4024-b2ea-4bba6fa128b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a872fe50>]}
2021-12-06 05:15:36.188376 (Thread-3): 05:15:36 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.35s]
2021-12-06 05:15:36.188493 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 05:15:36.189374 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 05:15:36.189598 (Thread-4): 05:15:36 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 05:15:36.189825 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:15:36.189898 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 05:15:36.192309 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 05:15:36.207765 (Thread-4): finished collecting timing info
2021-12-06 05:15:36.224211 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 05:15:36.239840 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:15:36.239922 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments

    group by 1

),


final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount
    
    from orders

    left join order_payments using (order_id)
)

select * from final
      );
2021-12-06 05:15:36.239981 (Thread-4): Opening a new connection, currently in state init
2021-12-06 05:15:36.675812 (Thread-780): handling poll request
2021-12-06 05:15:36.676072 (Thread-780): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd4bdf0>]}
2021-12-06 05:15:36.676910 (Thread-780): sending response (<Response 12081 bytes [200 OK]>) to 10.0.38.50
2021-12-06 05:15:38.610281 (Thread-781): handling poll request
2021-12-06 05:15:38.610624 (Thread-781): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a40d1cd0>]}
2021-12-06 05:15:38.611114 (Thread-781): sending response (<Response 287 bytes [200 OK]>) to 10.0.36.143
2021-12-06 05:15:39.109172 (Thread-4): SQL status: SUCCESS 1 in 2.87 seconds
2021-12-06 05:15:39.113700 (Thread-4): finished collecting timing info
2021-12-06 05:15:39.113842 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 05:15:39.557460 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ba53e4-a414-4024-b2ea-4bba6fa128b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a87329d0>]}
2021-12-06 05:15:39.557871 (Thread-4): 05:15:39 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 3.37s]
2021-12-06 05:15:39.558003 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 05:15:39.558917 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-12-06 05:15:39.559196 (Thread-1): 05:15:39 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 05:15:39.559425 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:15:39.559504 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-12-06 05:15:39.562030 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 05:15:39.577804 (Thread-1): finished collecting timing info
2021-12-06 05:15:39.579975 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 05:15:39.596794 (Thread-1): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:15:39.596877 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 05:15:39.596938 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 05:15:41.157291 (Thread-782): handling poll request
2021-12-06 05:15:41.157625 (Thread-782): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5d0e50>]}
2021-12-06 05:15:41.158392 (Thread-782): sending response (<Response 7709 bytes [200 OK]>) to 10.0.39.19
2021-12-06 05:15:41.724934 (Thread-1): SQL status: SUCCESS 1 in 2.13 seconds
2021-12-06 05:15:41.726407 (Thread-1): finished collecting timing info
2021-12-06 05:15:41.726545 (Thread-1): On model.jaffle_shop.dim_customers: Close
2021-12-06 05:15:42.179163 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ba53e4-a414-4024-b2ea-4bba6fa128b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b0353a60>]}
2021-12-06 05:15:42.179550 (Thread-1): 05:15:42 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.62s]
2021-12-06 05:15:42.179644 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-12-06 05:15:42.181213 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 05:15:42.181511 (MainThread): 05:15:42 | 
2021-12-06 05:15:42.181579 (MainThread): 05:15:42 | Finished running 3 view models, 2 table models in 11.99s.
2021-12-06 05:15:42.181628 (MainThread): Connection 'master' was properly closed.
2021-12-06 05:15:42.181667 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 05:15:42.181702 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 05:15:42.181736 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 05:15:42.181771 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 05:15:42.239669 (MainThread): 
2021-12-06 05:15:42.239778 (MainThread): Completed successfully
2021-12-06 05:15:42.239843 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 05:15:42.623855 (Thread-783): handling poll request
2021-12-06 05:15:42.624185 (Thread-783): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dce19d0>]}
2021-12-06 05:15:42.625768 (Thread-783): sending response (<Response 24049 bytes [200 OK]>) to 10.0.6.10
2021-12-06 05:15:43.490676 (Thread-784): handling status request
2021-12-06 05:15:43.490996 (Thread-784): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dce1640>]}
2021-12-06 05:15:43.491572 (Thread-784): sending response (<Response 3062 bytes [200 OK]>) to 10.0.19.103
2021-12-06 05:15:43.544153 (Thread-785): handling status request
2021-12-06 05:15:43.544400 (Thread-785): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dce18b0>]}
2021-12-06 05:15:43.544876 (Thread-785): sending response (<Response 3062 bytes [200 OK]>) to 10.0.31.30
2021-12-06 05:34:44.092645 (Thread-786): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 05:34:44.094841 (Thread-786): Partial parsing: update schema file: jaffle_shop://models/staging/stripe/src_stripe.yml
2021-12-06 05:34:44.143536 (Thread-786): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b9f40>]}
2021-12-06 05:34:44.936297 (Thread-787): handling status request
2021-12-06 05:34:44.936659 (Thread-787): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4ecbb0>]}
2021-12-06 05:34:44.937190 (Thread-787): sending response (<Response 1241 bytes [200 OK]>) to 10.0.6.10
2021-12-06 05:34:44.979907 (Thread-788): handling status request
2021-12-06 05:34:44.980138 (Thread-788): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4076730>]}
2021-12-06 05:34:44.980551 (Thread-788): sending response (<Response 1241 bytes [200 OK]>) to 10.0.2.25
2021-12-06 05:37:00.136078 (Thread-789): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 05:37:00.138162 (Thread-789): Partial parsing: deleted source source.jaffle_shop.stripe.payment
2021-12-06 05:37:00.138295 (Thread-789): Partial parsing: update schema file: jaffle_shop://models/staging/stripe/src_stripe.yml
2021-12-06 05:37:00.141923 (Thread-789): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:37:00.146428 (Thread-789): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:37:00.150462 (Thread-789): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:37:00.222385 (Thread-789): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0ac280>]}
2021-12-06 05:37:01.131132 (Thread-790): handling status request
2021-12-06 05:37:01.131438 (Thread-790): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d674550>]}
2021-12-06 05:37:01.131946 (Thread-790): sending response (<Response 2443 bytes [200 OK]>) to 10.0.37.206
2021-12-06 05:37:01.218299 (Thread-791): handling status request
2021-12-06 05:37:01.218528 (Thread-791): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4d5c40>]}
2021-12-06 05:37:01.218968 (Thread-791): sending response (<Response 2443 bytes [200 OK]>) to 10.0.37.206
2021-12-06 05:37:23.127572 (Thread-792): handling status request
2021-12-06 05:37:23.127941 (Thread-792): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5c75b0>]}
2021-12-06 05:37:23.128507 (Thread-792): sending response (<Response 2443 bytes [200 OK]>) to 10.0.41.241
2021-12-06 05:37:23.464346 (Thread-793): handling status request
2021-12-06 05:37:23.464561 (Thread-793): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db8fe20>]}
2021-12-06 05:37:23.465024 (Thread-793): sending response (<Response 2443 bytes [200 OK]>) to 10.0.2.25
2021-12-06 05:37:23.604551 (Thread-794): handling cli_args request
2021-12-06 05:37:23.604747 (Thread-794): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d71d790>]}
2021-12-06 05:37:23.614872 (Thread-794): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 05:37:25.521991 (Thread-794): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 05:37:25.557489 (MainThread): Partial parsing not enabled
2021-12-06 05:37:25.626323 (MainThread): Parsing macros/catalog.sql
2021-12-06 05:37:25.628270 (MainThread): Parsing macros/adapters.sql
2021-12-06 05:37:25.663417 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 05:37:25.667161 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 05:37:25.670298 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 05:37:25.674584 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 05:37:25.675859 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 05:37:25.684495 (MainThread): Parsing macros/core.sql
2021-12-06 05:37:25.688062 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 05:37:25.695072 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 05:37:25.704634 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 05:37:25.711563 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 05:37:25.715310 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 05:37:25.737361 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 05:37:25.754068 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 05:37:25.755630 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 05:37:25.785343 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 05:37:25.792395 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 05:37:25.805803 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 05:37:25.824915 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 05:37:25.834949 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 05:37:25.836649 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 05:37:25.838088 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 05:37:25.846295 (MainThread): Parsing macros/etc/query.sql
2021-12-06 05:37:25.847184 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 05:37:25.848846 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 05:37:25.850358 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 05:37:25.852729 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 05:37:25.854189 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 05:37:25.908510 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 05:37:25.910718 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 05:37:25.911853 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 05:37:25.913371 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 05:37:25.970032 (Thread-795): handling poll request
2021-12-06 05:37:25.970324 (Thread-795): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c48c5700>]}
2021-12-06 05:37:25.971468 (Thread-795): sending response (<Response 9708 bytes [200 OK]>) to 10.0.19.103
2021-12-06 05:37:26.101703 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:37:26.114546 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:37:26.117894 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:37:26.121475 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:37:26.125268 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:37:26.137646 (MainThread): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 05:37:26.308757 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d2111c7-766d-45b6-8de5-a54f53057373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd59c904c0>]}
2021-12-06 05:37:26.340029 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d2111c7-766d-45b6-8de5-a54f53057373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd59c90fd0>]}
2021-12-06 05:37:26.340910 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 05:37:26.342595 (MainThread): 
2021-12-06 05:37:26.342799 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 05:37:26.343605 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:37:26.354685 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:37:26.354757 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 05:37:26.354811 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 05:37:27.443533 (Thread-796): handling poll request
2021-12-06 05:37:27.443833 (Thread-796): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d1de340>]}
2021-12-06 05:37:27.444474 (Thread-796): sending response (<Response 5347 bytes [200 OK]>) to 10.0.22.219
2021-12-06 05:37:27.918485 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.56 seconds
2021-12-06 05:37:27.920527 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 05:37:28.373186 (MainThread): 05:37:28 | Concurrency: 4 threads (target='default')
2021-12-06 05:37:28.373314 (MainThread): 05:37:28 | 
2021-12-06 05:37:28.375305 (Thread-1): Began running node source.jaffle_shop.jaffle_shop.orders
2021-12-06 05:37:28.375463 (Thread-1): 05:37:28 | 1 of 2 START freshness of jaffle_shop.orders......................... [RUN]
2021-12-06 05:37:28.375691 (Thread-1): Acquiring new snowflake connection "source.jaffle_shop.jaffle_shop.orders".
2021-12-06 05:37:28.375797 (Thread-1): finished collecting timing info
2021-12-06 05:37:28.376090 (Thread-1): Acquiring new snowflake connection "source.jaffle_shop.jaffle_shop.orders".
2021-12-06 05:37:28.376706 (Thread-2): Began running node source.jaffle_shop.stripe.payment
2021-12-06 05:37:28.376834 (Thread-2): 05:37:28 | 2 of 2 START freshness of stripe.payment............................. [RUN]
2021-12-06 05:37:28.377074 (Thread-2): Acquiring new snowflake connection "source.jaffle_shop.stripe.payment".
2021-12-06 05:37:28.377144 (Thread-2): finished collecting timing info
2021-12-06 05:37:28.377388 (Thread-2): Acquiring new snowflake connection "source.jaffle_shop.stripe.payment".
2021-12-06 05:37:28.385879 (Thread-2): Using snowflake connection "source.jaffle_shop.stripe.payment".
2021-12-06 05:37:28.385979 (Thread-2): On source.jaffle_shop.stripe.payment: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "source.jaffle_shop.stripe.payment"} */
select
      max(_batched_at) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from raw.stripe.payment
2021-12-06 05:37:28.386046 (Thread-2): Opening a new connection, currently in state init
2021-12-06 05:37:28.388310 (Thread-1): Using snowflake connection "source.jaffle_shop.jaffle_shop.orders".
2021-12-06 05:37:28.388394 (Thread-1): On source.jaffle_shop.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "source.jaffle_shop.jaffle_shop.orders"} */
select
      max(_etl_loaded_at) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from raw.jaffle_shop.orders
2021-12-06 05:37:28.388449 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 05:37:28.903941 (Thread-797): handling poll request
2021-12-06 05:37:28.904260 (Thread-797): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0e6100>]}
2021-12-06 05:37:28.905022 (Thread-797): sending response (<Response 8358 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:37:30.345741 (Thread-798): handling poll request
2021-12-06 05:37:30.346089 (Thread-798): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db233d0>]}
2021-12-06 05:37:30.346567 (Thread-798): sending response (<Response 308 bytes [200 OK]>) to 10.0.6.10
2021-12-06 05:37:30.359118 (Thread-1): SQL status: SUCCESS 1 in 1.97 seconds
2021-12-06 05:37:30.360462 (Thread-1): On source.jaffle_shop.jaffle_shop.orders: Close
2021-12-06 05:37:30.540073 (Thread-2): SQL status: SUCCESS 1 in 2.15 seconds
2021-12-06 05:37:30.541173 (Thread-2): On source.jaffle_shop.stripe.payment: Close
2021-12-06 05:37:30.823137 (Thread-1): finished collecting timing info
2021-12-06 05:37:30.823429 (Thread-1): 05:37:30 | 1 of 2 ERROR STALE freshness of jaffle_shop.orders................... [ERROR STALE in 2.45s]
2021-12-06 05:37:30.823510 (Thread-1): Finished running node source.jaffle_shop.jaffle_shop.orders
2021-12-06 05:37:30.986043 (Thread-2): finished collecting timing info
2021-12-06 05:37:30.986292 (Thread-2): 05:37:30 | 2 of 2 ERROR STALE freshness of stripe.payment....................... [ERROR STALE in 2.61s]
2021-12-06 05:37:30.986363 (Thread-2): Finished running node source.jaffle_shop.stripe.payment
2021-12-06 05:37:30.987711 (MainThread): Connection 'master' was properly closed.
2021-12-06 05:37:30.987816 (MainThread): Connection 'source.jaffle_shop.jaffle_shop.orders' was properly closed.
2021-12-06 05:37:30.987862 (MainThread): Connection 'source.jaffle_shop.stripe.payment' was properly closed.
2021-12-06 05:37:31.051430 (MainThread): 
2021-12-06 05:37:31.051525 (MainThread): 
2021-12-06 05:37:31.051584 (MainThread): 05:37:31 | Done.
2021-12-06 05:37:31.782803 (Thread-799): handling poll request
2021-12-06 05:37:31.783132 (Thread-799): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d240c40>]}
2021-12-06 05:37:31.784373 (Thread-799): sending response (<Response 9386 bytes [200 OK]>) to 10.0.24.86
2021-12-06 05:37:32.642453 (Thread-800): handling status request
2021-12-06 05:37:32.642769 (Thread-800): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d240820>]}
2021-12-06 05:37:32.643344 (Thread-800): sending response (<Response 2443 bytes [200 OK]>) to 10.0.2.25
2021-12-06 05:37:32.678387 (Thread-801): handling status request
2021-12-06 05:37:32.678624 (Thread-801): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db23040>]}
2021-12-06 05:37:32.679053 (Thread-801): sending response (<Response 2443 bytes [200 OK]>) to 10.0.22.219
2021-12-06 05:37:52.709902 (Thread-802): handling status request
2021-12-06 05:37:52.710254 (Thread-802): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a423f700>]}
2021-12-06 05:37:52.710762 (Thread-802): sending response (<Response 2443 bytes [200 OK]>) to 10.0.22.219
2021-12-06 05:37:53.098288 (Thread-803): handling status request
2021-12-06 05:37:53.098573 (Thread-803): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc05e490>]}
2021-12-06 05:37:53.099104 (Thread-803): sending response (<Response 2443 bytes [200 OK]>) to 10.0.0.217
2021-12-06 05:37:53.145992 (Thread-804): handling docs.generate request
2021-12-06 05:37:53.146206 (Thread-804): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4ad8e0>]}
2021-12-06 05:37:55.047692 (Thread-804): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.71
2021-12-06 05:37:55.082733 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daecf8d6-16d2-4903-b551-e0228990db33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bacc5de50>]}
2021-12-06 05:37:55.082970 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 05:37:55.084857 (MainThread): 
2021-12-06 05:37:55.084973 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 05:37:55.085766 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:37:55.100558 (ThreadPoolExecutor-0_0): Parsing macros/catalog.sql
2021-12-06 05:37:55.103804 (ThreadPoolExecutor-0_0): Parsing macros/adapters.sql
2021-12-06 05:37:55.137828 (ThreadPoolExecutor-0_0): Parsing macros/materializations/merge.sql
2021-12-06 05:37:55.141632 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table.sql
2021-12-06 05:37:55.144873 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed.sql
2021-12-06 05:37:55.149148 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view.sql
2021-12-06 05:37:55.150581 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental.sql
2021-12-06 05:37:55.159589 (ThreadPoolExecutor-0_0): Parsing macros/core.sql
2021-12-06 05:37:55.163166 (ThreadPoolExecutor-0_0): Parsing macros/materializations/test.sql
2021-12-06 05:37:55.169629 (ThreadPoolExecutor-0_0): Parsing macros/materializations/helpers.sql
2021-12-06 05:37:55.178984 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/view.sql
2021-12-06 05:37:55.185684 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 05:37:55.189416 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed/seed.sql
2021-12-06 05:37:55.210668 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 05:37:55.226778 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 05:37:55.228556 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 05:37:55.257584 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table/table.sql
2021-12-06 05:37:55.264590 (ThreadPoolExecutor-0_0): Parsing macros/materializations/common/merge.sql
2021-12-06 05:37:55.277698 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 05:37:55.296262 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 05:37:55.305700 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 05:37:55.307467 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_alias.sql
2021-12-06 05:37:55.308999 (ThreadPoolExecutor-0_0): Parsing macros/etc/datetime.sql
2021-12-06 05:37:55.316918 (ThreadPoolExecutor-0_0): Parsing macros/etc/query.sql
2021-12-06 05:37:55.317957 (ThreadPoolExecutor-0_0): Parsing macros/etc/where_subquery.sql
2021-12-06 05:37:55.319769 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_database.sql
2021-12-06 05:37:55.321363 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_schema.sql
2021-12-06 05:37:55.323776 (ThreadPoolExecutor-0_0): Parsing macros/etc/is_incremental.sql
2021-12-06 05:37:55.325375 (ThreadPoolExecutor-0_0): Parsing macros/adapters/common.sql
2021-12-06 05:37:55.377638 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 05:37:55.379904 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/not_null.sql
2021-12-06 05:37:55.381166 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/relationships.sql
2021-12-06 05:37:55.382856 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/unique.sql
2021-12-06 05:37:55.395388 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 05:37:55.395475 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: show terse objects in analytics.dbt_pstulnikov
2021-12-06 05:37:55.395529 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 05:37:55.511377 (Thread-805): handling poll request
2021-12-06 05:37:55.511720 (Thread-805): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4a47c0>]}
2021-12-06 05:37:55.513095 (Thread-805): sending response (<Response 12437 bytes [200 OK]>) to 10.0.41.241
2021-12-06 05:37:56.880097 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.48 seconds
2021-12-06 05:37:56.882123 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 05:37:57.002858 (Thread-806): handling poll request
2021-12-06 05:37:57.003136 (Thread-806): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d86d040>]}
2021-12-06 05:37:57.003639 (Thread-806): sending response (<Response 897 bytes [200 OK]>) to 10.0.19.103
2021-12-06 05:37:57.335927 (MainThread): 05:37:57 | Concurrency: 4 threads (target='default')
2021-12-06 05:37:57.336065 (MainThread): 05:37:57 | 
2021-12-06 05:37:57.338243 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 05:37:57.338419 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 05:37:57.338516 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 05:37:57.339484 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 05:37:57.339632 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 05:37:57.339698 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 05:37:57.342515 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 05:37:57.342745 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 05:37:57.342885 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 05:37:57.342949 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 05:37:57.344978 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 05:37:57.347905 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 05:37:57.348140 (Thread-4): Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
2021-12-06 05:37:57.348279 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f".
2021-12-06 05:37:57.348343 (Thread-4): Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
2021-12-06 05:37:57.408183 (Thread-4): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
2021-12-06 05:37:57.410786 (Thread-3): finished collecting timing info
2021-12-06 05:37:57.410934 (Thread-3): finished collecting timing info
2021-12-06 05:37:57.411041 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 05:37:57.411123 (Thread-3): Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
2021-12-06 05:37:57.411199 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13".
2021-12-06 05:37:57.411252 (Thread-3): Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
2021-12-06 05:37:57.414058 (Thread-3): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
2021-12-06 05:37:57.414610 (Thread-2): finished collecting timing info
2021-12-06 05:37:57.414737 (Thread-2): finished collecting timing info
2021-12-06 05:37:57.414835 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 05:37:57.414921 (Thread-2): Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
2021-12-06 05:37:57.414999 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e".
2021-12-06 05:37:57.415050 (Thread-2): Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
2021-12-06 05:37:57.419758 (Thread-1): finished collecting timing info
2021-12-06 05:37:57.419870 (Thread-1): finished collecting timing info
2021-12-06 05:37:57.419965 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 05:37:57.420036 (Thread-1): Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
2021-12-06 05:37:57.420111 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba".
2021-12-06 05:37:57.420162 (Thread-1): Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
2021-12-06 05:37:57.423898 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
2021-12-06 05:37:57.424689 (Thread-2): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
2021-12-06 05:37:57.432335 (Thread-3): finished collecting timing info
2021-12-06 05:37:57.432463 (Thread-3): finished collecting timing info
2021-12-06 05:37:57.432557 (Thread-3): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
2021-12-06 05:37:57.432633 (Thread-3): Began running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 05:37:57.432708 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.assert_total_payments_amount_is_not_negative".
2021-12-06 05:37:57.432760 (Thread-3): Compiling test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 05:37:57.434507 (Thread-3): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_not_negative"
2021-12-06 05:37:57.434648 (Thread-4): finished collecting timing info
2021-12-06 05:37:57.434768 (Thread-4): finished collecting timing info
2021-12-06 05:37:57.434864 (Thread-4): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
2021-12-06 05:37:57.434936 (Thread-4): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 05:37:57.435011 (Thread-4): Acquiring new snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b".
2021-12-06 05:37:57.435064 (Thread-4): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 05:37:57.444412 (Thread-4): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b"
2021-12-06 05:37:57.450942 (Thread-1): finished collecting timing info
2021-12-06 05:37:57.451060 (Thread-1): finished collecting timing info
2021-12-06 05:37:57.451154 (Thread-1): Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
2021-12-06 05:37:57.451230 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 05:37:57.451302 (Thread-1): Acquiring new snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-06 05:37:57.451354 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 05:37:57.453994 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-06 05:37:57.454126 (Thread-2): finished collecting timing info
2021-12-06 05:37:57.454238 (Thread-2): finished collecting timing info
2021-12-06 05:37:57.454329 (Thread-2): Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
2021-12-06 05:37:57.454398 (Thread-2): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 05:37:57.454471 (Thread-2): Acquiring new snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-12-06 05:37:57.454521 (Thread-2): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 05:37:57.459328 (Thread-3): finished collecting timing info
2021-12-06 05:37:57.459440 (Thread-3): finished collecting timing info
2021-12-06 05:37:57.459536 (Thread-3): Finished running node test.jaffle_shop.assert_total_payments_amount_is_not_negative
2021-12-06 05:37:57.459615 (Thread-3): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 05:37:57.459690 (Thread-3): Acquiring new snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-12-06 05:37:57.459741 (Thread-3): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 05:37:57.462428 (Thread-3): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-12-06 05:37:57.464620 (Thread-2): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-12-06 05:37:57.471182 (Thread-4): finished collecting timing info
2021-12-06 05:37:57.471303 (Thread-4): finished collecting timing info
2021-12-06 05:37:57.471398 (Thread-4): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending.8fb5b5184b
2021-12-06 05:37:57.471791 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 05:37:57.471883 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 05:37:57.471936 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 05:37:57.473779 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 05:37:57.474620 (Thread-1): finished collecting timing info
2021-12-06 05:37:57.474737 (Thread-1): finished collecting timing info
2021-12-06 05:37:57.474833 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-06 05:37:57.480766 (Thread-3): finished collecting timing info
2021-12-06 05:37:57.480890 (Thread-3): finished collecting timing info
2021-12-06 05:37:57.480984 (Thread-3): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-12-06 05:37:57.481097 (Thread-2): finished collecting timing info
2021-12-06 05:37:57.481209 (Thread-2): finished collecting timing info
2021-12-06 05:37:57.481302 (Thread-2): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-12-06 05:37:57.488495 (Thread-4): finished collecting timing info
2021-12-06 05:37:57.488612 (Thread-4): finished collecting timing info
2021-12-06 05:37:57.488708 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 05:37:57.489335 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-12-06 05:37:57.489458 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 05:37:57.489516 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-12-06 05:37:57.491545 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 05:37:57.505614 (Thread-1): finished collecting timing info
2021-12-06 05:37:57.505725 (Thread-1): finished collecting timing info
2021-12-06 05:37:57.505815 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-12-06 05:37:57.506727 (MainThread): Connection 'master' was properly closed.
2021-12-06 05:37:57.506805 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 05:37:57.506845 (MainThread): Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
2021-12-06 05:37:57.506881 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
2021-12-06 05:37:57.506915 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 05:37:57.572252 (MainThread): 05:37:57 | Done.
2021-12-06 05:37:57.621184 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-12-06 05:37:57.621268 (MainThread): 05:37:57 | Building catalog
2021-12-06 05:37:57.626099 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "analytics.information_schema".
2021-12-06 05:37:57.632667 (ThreadPoolExecutor-1_0): Using snowflake connection "analytics.information_schema".
2021-12-06 05:37:57.632739 (ThreadPoolExecutor-1_0): On analytics.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_pstulnikov_dbt_test__audit') or upper("table_schema") = upper('dbt_pstulnikov'))
      order by "column_index"
2021-12-06 05:37:57.632846 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 05:37:57.633653 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "raw.information_schema".
2021-12-06 05:37:57.635999 (ThreadPoolExecutor-1_1): Using snowflake connection "raw.information_schema".
2021-12-06 05:37:57.636068 (ThreadPoolExecutor-1_1): On raw.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from raw.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from raw.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('stripe') or upper("table_schema") = upper('jaffle_shop'))
      order by "column_index"
2021-12-06 05:37:57.636121 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-12-06 05:37:58.441621 (Thread-807): handling poll request
2021-12-06 05:37:58.441985 (Thread-807): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8205b0>]}
2021-12-06 05:37:58.444107 (Thread-807): sending response (<Response 58143 bytes [200 OK]>) to 10.0.22.219
2021-12-06 05:37:59.884560 (Thread-808): handling poll request
2021-12-06 05:37:59.884906 (Thread-808): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429db10f40>]}
2021-12-06 05:37:59.885421 (Thread-808): sending response (<Response 330 bytes [200 OK]>) to 10.0.22.219
2021-12-06 05:37:59.942375 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 15 in 2.31 seconds
2021-12-06 05:37:59.951168 (ThreadPoolExecutor-1_1): On raw.information_schema: Close
2021-12-06 05:38:00.227945 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 24 in 2.60 seconds
2021-12-06 05:38:00.234062 (ThreadPoolExecutor-1_0): On analytics.information_schema: Close
2021-12-06 05:38:00.756895 (MainThread): 05:38:00 | Catalog written to /usr/src/develop/user-48664/environment-53260/repository-43071/target/catalog.json
2021-12-06 05:38:01.323082 (Thread-809): handling poll request
2021-12-06 05:38:01.323411 (Thread-809): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e909a0>]}
2021-12-06 05:38:01.324378 (Thread-809): sending response (<Response 10910 bytes [200 OK]>) to 10.0.6.10
2021-12-06 05:38:02.165137 (Thread-810): handling status request
2021-12-06 05:38:02.165462 (Thread-810): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d819460>]}
2021-12-06 05:38:02.166054 (Thread-810): sending response (<Response 2443 bytes [200 OK]>) to 10.0.3.73
2021-12-06 05:38:02.232870 (Thread-811): handling status request
2021-12-06 05:38:02.233145 (Thread-811): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a41cadc0>]}
2021-12-06 05:38:02.233637 (Thread-811): sending response (<Response 2443 bytes [200 OK]>) to 10.0.0.217
2021-12-06 05:38:02.294545 (Thread-812): handling status request
2021-12-06 05:38:02.294801 (Thread-812): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6ec7f0>]}
2021-12-06 05:38:02.295269 (Thread-812): sending response (<Response 2443 bytes [200 OK]>) to 10.0.36.143
2021-12-06 05:39:21.749354 (Thread-813): handling status request
2021-12-06 05:39:21.751809 (Thread-813): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d84f850>]}
2021-12-06 05:39:21.752327 (Thread-813): sending response (<Response 2443 bytes [200 OK]>) to 10.0.6.71
2021-12-06 05:39:26.030159 (Thread-814): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 05:39:26.030510 (Thread-814): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 05:39:26.036123 (Thread-814): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d83c790>]}
2021-12-06 05:39:26.866478 (Thread-815): handling status request
2021-12-06 05:39:26.866806 (Thread-815): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d83c520>]}
2021-12-06 05:39:26.867331 (Thread-815): sending response (<Response 1212 bytes [200 OK]>) to 10.0.13.223
2021-12-06 05:39:26.905102 (Thread-816): handling status request
2021-12-06 05:39:26.905307 (Thread-816): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d83c310>]}
2021-12-06 05:39:26.927362 (Thread-816): sending response (<Response 1212 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:03:01.879590 (Thread-817): handling status request
2021-12-06 07:03:01.879911 (Thread-817): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd8b880>]}
2021-12-06 07:03:01.880382 (Thread-817): sending response (<Response 1212 bytes [200 OK]>) to 10.0.13.223
2021-12-06 07:03:01.904429 (Thread-818): handling status request
2021-12-06 07:03:01.904665 (Thread-818): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd8bee0>]}
2021-12-06 07:03:01.905076 (Thread-818): sending response (<Response 1212 bytes [200 OK]>) to 10.0.31.30
2021-12-06 07:03:01.909635 (Thread-819): handling status request
2021-12-06 07:03:01.909841 (Thread-819): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd8b2e0>]}
2021-12-06 07:03:01.910228 (Thread-819): sending response (<Response 1212 bytes [200 OK]>) to 10.0.22.219
2021-12-06 07:03:01.914814 (Thread-820): handling ps request
2021-12-06 07:03:01.915000 (Thread-820): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd8be20>]}
2021-12-06 07:03:01.917178 (Thread-820): sending response (<Response 24328 bytes [200 OK]>) to 10.0.38.70
2021-12-06 07:03:03.188530 (Thread-821): handling poll request
2021-12-06 07:03:03.188842 (Thread-821): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd8bf40>]}
2021-12-06 07:03:03.191594 (Thread-821): sending response (<Response 81405 bytes [200 OK]>) to 10.0.13.223
2021-12-06 07:03:04.056621 (Thread-822): handling status request
2021-12-06 07:03:04.056935 (Thread-822): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d8bb460>]}
2021-12-06 07:03:04.057402 (Thread-822): sending response (<Response 1212 bytes [200 OK]>) to 10.0.24.86
2021-12-06 07:03:04.108598 (Thread-823): handling status request
2021-12-06 07:03:04.108853 (Thread-823): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d83cfd0>]}
2021-12-06 07:03:04.109279 (Thread-823): sending response (<Response 1212 bytes [200 OK]>) to 10.0.36.143
2021-12-06 07:04:18.857782 (Thread-824): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 07:04:18.859316 (Thread-824): Partial parsing: added file: jaffle_shop://models/marts/core/int_orders_pivot.sql
2021-12-06 07:04:18.863271 (Thread-824): Acquiring new snowflake connection "model.jaffle_shop.int_orders_pivot".
2021-12-06 07:04:18.927209 (Thread-824): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d61fa00>]}
2021-12-06 07:04:19.767240 (Thread-825): handling status request
2021-12-06 07:04:19.767559 (Thread-825): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc9d790>]}
2021-12-06 07:04:19.768077 (Thread-825): sending response (<Response 1541 bytes [200 OK]>) to 10.0.0.217
2021-12-06 07:04:19.899521 (Thread-826): handling status request
2021-12-06 07:04:19.899831 (Thread-826): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc9d700>]}
2021-12-06 07:04:19.900364 (Thread-826): sending response (<Response 1541 bytes [200 OK]>) to 10.0.37.206
2021-12-06 07:09:07.632447 (Thread-827): handling status request
2021-12-06 07:09:07.634512 (Thread-827): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd85760>]}
2021-12-06 07:09:07.635043 (Thread-827): sending response (<Response 1541 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:09:08.068641 (Thread-828): handling compile_sql request
2021-12-06 07:09:08.068939 (Thread-828): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd85820>]}
2021-12-06 07:09:08.070142 (Thread-828): Connection 'model.jaffle_shop.int_orders_pivot' was properly closed.
2021-12-06 07:09:10.011997 (Thread-828): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-06 07:09:10.023419 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:09:10.040728 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94ec085d-5972-4b83-9768-2f482a1701ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6ecb30a0>]}
2021-12-06 07:09:10.040979 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:09:10.041352 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:09:10.041455 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:09:10.044170 (Thread-1): finished collecting timing info
2021-12-06 07:09:10.044284 (Thread-1): finished collecting timing info
2021-12-06 07:09:10.577327 (Thread-829): handling poll request
2021-12-06 07:09:10.577688 (Thread-829): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9a8c70>]}
2021-12-06 07:09:10.579017 (Thread-829): sending response (<Response 6987 bytes [200 OK]>) to 10.0.13.223
2021-12-06 07:09:49.532752 (Thread-830): handling status request
2021-12-06 07:09:49.533071 (Thread-830): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9a82e0>]}
2021-12-06 07:09:49.533634 (Thread-830): sending response (<Response 1541 bytes [200 OK]>) to 10.0.38.50
2021-12-06 07:09:50.000100 (Thread-831): handling compile_sql request
2021-12-06 07:09:50.000414 (Thread-831): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d9a8cd0>]}
2021-12-06 07:09:51.910046 (Thread-831): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 07:09:51.921159 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:09:51.935735 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c27e6dfd-01e4-46e9-beba-af44917bc8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554d746340>]}
2021-12-06 07:09:51.935968 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:09:51.936348 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:09:51.936454 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:09:51.939208 (Thread-1): finished collecting timing info
2021-12-06 07:09:51.939326 (Thread-1): finished collecting timing info
2021-12-06 07:09:52.431183 (Thread-832): handling poll request
2021-12-06 07:09:52.431578 (Thread-832): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dd32310>]}
2021-12-06 07:09:52.432773 (Thread-832): sending response (<Response 6993 bytes [200 OK]>) to 10.0.2.25
2021-12-06 07:09:55.961678 (Thread-833): handling status request
2021-12-06 07:09:55.962020 (Thread-833): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d7595e0>]}
2021-12-06 07:09:55.962558 (Thread-833): sending response (<Response 1541 bytes [200 OK]>) to 10.0.2.25
2021-12-06 07:09:56.476502 (Thread-834): handling run_sql request
2021-12-06 07:09:56.476808 (Thread-834): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0ac850>]}
2021-12-06 07:09:58.391933 (Thread-834): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.143
2021-12-06 07:09:58.403015 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:09:58.418318 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47c87172-2449-47aa-87e2-0e66dd8946ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc852962d60>]}
2021-12-06 07:09:58.418564 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:09:58.419051 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:09:58.419160 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:09:58.421865 (Thread-1): finished collecting timing info
2021-12-06 07:09:58.422877 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:09:58.422942 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

pivoted as (

    select
        order_id

        

        
        , sum(case when payment_method = 'bank transfer' then amount) as bank transfer_amount

        
        , sum(case when payment_method = 'coupon' then amount) as coupon_amount

        
        , sum(case when payment_method = 'credit card' then amount) as credit card_amount

        
        , sum(case when payment_method = 'gift card' then amount) as gift card_amount

        

    from payments
    
    where status = 'success'

    group by 1
)
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 07:09:58.422996 (Thread-1): Opening a new connection, currently in state init
2021-12-06 07:09:58.901033 (Thread-835): handling poll request
2021-12-06 07:09:58.901396 (Thread-835): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dc9d910>]}
2021-12-06 07:09:58.902344 (Thread-835): sending response (<Response 3979 bytes [200 OK]>) to 10.0.41.241
2021-12-06 07:09:59.909292 (Thread-1): Snowflake query id: 01a0c30d-3200-95c3-0000-00008ef91ead
2021-12-06 07:09:59.909478 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 68 unexpected ')'.
syntax error line 13 at position 78 unexpected 'transfer_amount'.
syntax error line 16 at position 19 unexpected 'when'.
syntax error line 16 at position 66 unexpected 'coupon_amount'.
syntax error line 19 at position 8 unexpected ','.
syntax error line 19 at position 19 unexpected 'when'.
syntax error line 19 at position 71 unexpected 'credit'.
syntax error line 19 at position 78 unexpected 'card_amount'.
syntax error line 22 at position 19 unexpected 'when'.
syntax error line 22 at position 69 unexpected 'gift'.
syntax error line 22 at position 74 unexpected 'card_amount'.
2021-12-06 07:09:59.909605 (Thread-1): finished collecting timing info
2021-12-06 07:09:59.909752 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 07:10:00.352894 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 68 unexpected ')'.
  syntax error line 13 at position 78 unexpected 'transfer_amount'.
  syntax error line 16 at position 19 unexpected 'when'.
  syntax error line 16 at position 66 unexpected 'coupon_amount'.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 19 at position 19 unexpected 'when'.
  syntax error line 19 at position 71 unexpected 'credit'.
  syntax error line 19 at position 78 unexpected 'card_amount'.
  syntax error line 22 at position 19 unexpected 'when'.
  syntax error line 22 at position 69 unexpected 'gift'.
  syntax error line 22 at position 74 unexpected 'card_amount'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 68 unexpected ')'.
syntax error line 13 at position 78 unexpected 'transfer_amount'.
syntax error line 16 at position 19 unexpected 'when'.
syntax error line 16 at position 66 unexpected 'coupon_amount'.
syntax error line 19 at position 8 unexpected ','.
syntax error line 19 at position 19 unexpected 'when'.
syntax error line 19 at position 71 unexpected 'credit'.
syntax error line 19 at position 78 unexpected 'card_amount'.
syntax error line 22 at position 19 unexpected 'when'.
syntax error line 22 at position 69 unexpected 'gift'.
syntax error line 22 at position 74 unexpected 'card_amount'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 68 unexpected ')'.
  syntax error line 13 at position 78 unexpected 'transfer_amount'.
  syntax error line 16 at position 19 unexpected 'when'.
  syntax error line 16 at position 66 unexpected 'coupon_amount'.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 19 at position 19 unexpected 'when'.
  syntax error line 19 at position 71 unexpected 'credit'.
  syntax error line 19 at position 78 unexpected 'card_amount'.
  syntax error line 22 at position 19 unexpected 'when'.
  syntax error line 22 at position 69 unexpected 'gift'.
  syntax error line 22 at position 74 unexpected 'card_amount'.
2021-12-06 07:10:00.353867 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 13 at position 68 unexpected ')'.\n  syntax error line 13 at position 78 unexpected 'transfer_amount'.\n  syntax error line 16 at position 19 unexpected 'when'.\n  syntax error line 16 at position 66 unexpected 'coupon_amount'.\n  syntax error line 19 at position 8 unexpected ','.\n  syntax error line 19 at position 19 unexpected 'when'.\n  syntax error line 19 at position 71 unexpected 'credit'.\n  syntax error line 19 at position 78 unexpected 'card_amount'.\n  syntax error line 22 at position 19 unexpected 'when'.\n  syntax error line 22 at position 69 unexpected 'gift'.\n  syntax error line 22 at position 74 unexpected 'card_amount'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id\n\n        {% set payment_methods = ['bank transfer', 'coupon', 'credit card', 'gift card'] %}\n\n        {% for payment_method in payment_methods %}\n        , sum(case when payment_method = '{{ payment_method }}' then amount) as {{ payment_method }}_amount\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id\n\n        \n\n        \n        , sum(case when payment_method = 'bank transfer' then amount) as bank transfer_amount\n\n        \n        , sum(case when payment_method = 'coupon' then amount) as coupon_amount\n\n        \n        , sum(case when payment_method = 'credit card' then amount) as credit card_amount\n\n        \n        , sum(case when payment_method = 'gift card' then amount) as gift card_amount\n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 13 at position 68 unexpected ')'.\n  syntax error line 13 at position 78 unexpected 'transfer_amount'.\n  syntax error line 16 at position 19 unexpected 'when'.\n  syntax error line 16 at position 66 unexpected 'coupon_amount'.\n  syntax error line 19 at position 8 unexpected ','.\n  syntax error line 19 at position 19 unexpected 'when'.\n  syntax error line 19 at position 71 unexpected 'credit'.\n  syntax error line 19 at position 78 unexpected 'card_amount'.\n  syntax error line 22 at position 19 unexpected 'when'.\n  syntax error line 22 at position 69 unexpected 'gift'.\n  syntax error line 22 at position 74 unexpected 'card_amount'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id\n\n        {% set payment_methods = ['bank transfer', 'coupon', 'credit card', 'gift card'] %}\n\n        {% for payment_method in payment_methods %}\n        , sum(case when payment_method = '{{ payment_method }}' then amount) as {{ payment_method }}_amount\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id\n\n        \n\n        \n        , sum(case when payment_method = 'bank transfer' then amount) as bank transfer_amount\n\n        \n        , sum(case when payment_method = 'coupon' then amount) as coupon_amount\n\n        \n        , sum(case when payment_method = 'credit card' then amount) as credit card_amount\n\n        \n        , sum(case when payment_method = 'gift card' then amount) as gift card_amount\n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2021-12-06 07:10:00.373295 (Thread-836): handling poll request
2021-12-06 07:10:00.373580 (Thread-836): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0acee0>]}
2021-12-06 07:10:00.374234 (Thread-836): sending response (<Response 12184 bytes [200 OK]>) to 10.0.38.50
2021-12-06 07:10:01.847608 (Thread-837): handling poll request
2021-12-06 07:10:01.847949 (Thread-837): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0ac130>]}
2021-12-06 07:10:01.848668 (Thread-837): sending response (<Response 17549 bytes [200 OK]>) to 10.0.38.70
2021-12-06 07:10:22.491374 (Thread-838): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 07:10:22.491743 (Thread-838): Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders_pivot.sql
2021-12-06 07:10:22.495479 (Thread-838): Acquiring new snowflake connection "model.jaffle_shop.int_orders_pivot".
2021-12-06 07:10:22.540356 (Thread-838): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6d68b0>]}
2021-12-06 07:10:23.303364 (Thread-839): handling status request
2021-12-06 07:10:23.303686 (Thread-839): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6d64f0>]}
2021-12-06 07:10:23.304227 (Thread-839): sending response (<Response 1543 bytes [200 OK]>) to 10.0.38.70
2021-12-06 07:10:23.335456 (Thread-840): handling status request
2021-12-06 07:10:23.335680 (Thread-840): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6d65e0>]}
2021-12-06 07:10:23.336088 (Thread-840): sending response (<Response 1543 bytes [200 OK]>) to 10.0.36.143
2021-12-06 07:10:24.359680 (Thread-841): handling status request
2021-12-06 07:10:24.360010 (Thread-841): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6d69d0>]}
2021-12-06 07:10:24.360514 (Thread-841): sending response (<Response 1543 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:10:24.910373 (Thread-842): handling run_sql request
2021-12-06 07:10:24.910648 (Thread-842): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d6d6730>]}
2021-12-06 07:10:24.911833 (Thread-842): Connection 'model.jaffle_shop.int_orders_pivot' was properly closed.
2021-12-06 07:10:26.824353 (Thread-842): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 07:10:26.835454 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:10:26.850115 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e71e292-9165-47c7-90eb-95bfac3c1e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dad87a340>]}
2021-12-06 07:10:26.850347 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:10:26.850726 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:10:26.850830 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:10:26.853503 (Thread-1): finished collecting timing info
2021-12-06 07:10:26.854526 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:10:26.854592 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

pivoted as (

    select
        order_id

        

        
        , sum(case when payment_method = 'bank transfer' then amount else 0 end) as bank transfer_amount

        
        , sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount

        
        , sum(case when payment_method = 'credit card' then amount else 0 end) as credit card_amount

        
        , sum(case when payment_method = 'gift card' then amount else 0 end) as gift card_amount

        

    from payments
    
    where status = 'success'

    group by 1
)
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 07:10:26.854646 (Thread-1): Opening a new connection, currently in state init
2021-12-06 07:10:27.348685 (Thread-843): handling poll request
2021-12-06 07:10:27.349023 (Thread-843): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d205d60>]}
2021-12-06 07:10:27.349956 (Thread-843): sending response (<Response 4023 bytes [200 OK]>) to 10.0.30.196
2021-12-06 07:10:28.353314 (Thread-1): Snowflake query id: 01a0c30e-3200-95c3-0000-00008ef91eb1
2021-12-06 07:10:28.353510 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 89 unexpected 'transfer_amount'.
syntax error line 16 at position 19 unexpected 'when'.
syntax error line 16 at position 77 unexpected 'coupon_amount'.
syntax error line 19 at position 8 unexpected ','.
syntax error line 19 at position 19 unexpected 'when'.
syntax error line 19 at position 82 unexpected 'credit'.
syntax error line 19 at position 89 unexpected 'card_amount'.
syntax error line 22 at position 19 unexpected 'when'.
syntax error line 22 at position 80 unexpected 'gift'.
syntax error line 22 at position 85 unexpected 'card_amount'.
2021-12-06 07:10:28.353641 (Thread-1): finished collecting timing info
2021-12-06 07:10:28.353796 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 07:10:28.781083 (Thread-844): handling poll request
2021-12-06 07:10:28.781399 (Thread-844): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d34d0d0>]}
2021-12-06 07:10:28.782018 (Thread-844): sending response (<Response 2244 bytes [200 OK]>) to 10.0.26.3
2021-12-06 07:10:28.815170 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 89 unexpected 'transfer_amount'.
  syntax error line 16 at position 19 unexpected 'when'.
  syntax error line 16 at position 77 unexpected 'coupon_amount'.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 19 at position 19 unexpected 'when'.
  syntax error line 19 at position 82 unexpected 'credit'.
  syntax error line 19 at position 89 unexpected 'card_amount'.
  syntax error line 22 at position 19 unexpected 'when'.
  syntax error line 22 at position 80 unexpected 'gift'.
  syntax error line 22 at position 85 unexpected 'card_amount'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 89 unexpected 'transfer_amount'.
syntax error line 16 at position 19 unexpected 'when'.
syntax error line 16 at position 77 unexpected 'coupon_amount'.
syntax error line 19 at position 8 unexpected ','.
syntax error line 19 at position 19 unexpected 'when'.
syntax error line 19 at position 82 unexpected 'credit'.
syntax error line 19 at position 89 unexpected 'card_amount'.
syntax error line 22 at position 19 unexpected 'when'.
syntax error line 22 at position 80 unexpected 'gift'.
syntax error line 22 at position 85 unexpected 'card_amount'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 89 unexpected 'transfer_amount'.
  syntax error line 16 at position 19 unexpected 'when'.
  syntax error line 16 at position 77 unexpected 'coupon_amount'.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 19 at position 19 unexpected 'when'.
  syntax error line 19 at position 82 unexpected 'credit'.
  syntax error line 19 at position 89 unexpected 'card_amount'.
  syntax error line 22 at position 19 unexpected 'when'.
  syntax error line 22 at position 80 unexpected 'gift'.
  syntax error line 22 at position 85 unexpected 'card_amount'.
2021-12-06 07:10:28.816155 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 13 at position 89 unexpected 'transfer_amount'.\n  syntax error line 16 at position 19 unexpected 'when'.\n  syntax error line 16 at position 77 unexpected 'coupon_amount'.\n  syntax error line 19 at position 8 unexpected ','.\n  syntax error line 19 at position 19 unexpected 'when'.\n  syntax error line 19 at position 82 unexpected 'credit'.\n  syntax error line 19 at position 89 unexpected 'card_amount'.\n  syntax error line 22 at position 19 unexpected 'when'.\n  syntax error line 22 at position 80 unexpected 'gift'.\n  syntax error line 22 at position 85 unexpected 'card_amount'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id\n\n        {% set payment_methods = ['bank transfer', 'coupon', 'credit card', 'gift card'] %}\n\n        {% for payment_method in payment_methods %}\n        , sum(case when payment_method = '{{ payment_method }}' then amount else 0 end) as {{ payment_method }}_amount\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id\n\n        \n\n        \n        , sum(case when payment_method = 'bank transfer' then amount else 0 end) as bank transfer_amount\n\n        \n        , sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount\n\n        \n        , sum(case when payment_method = 'credit card' then amount else 0 end) as credit card_amount\n\n        \n        , sum(case when payment_method = 'gift card' then amount else 0 end) as gift card_amount\n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 13 at position 89 unexpected 'transfer_amount'.\n  syntax error line 16 at position 19 unexpected 'when'.\n  syntax error line 16 at position 77 unexpected 'coupon_amount'.\n  syntax error line 19 at position 8 unexpected ','.\n  syntax error line 19 at position 19 unexpected 'when'.\n  syntax error line 19 at position 82 unexpected 'credit'.\n  syntax error line 19 at position 89 unexpected 'card_amount'.\n  syntax error line 22 at position 19 unexpected 'when'.\n  syntax error line 22 at position 80 unexpected 'gift'.\n  syntax error line 22 at position 85 unexpected 'card_amount'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id\n\n        {% set payment_methods = ['bank transfer', 'coupon', 'credit card', 'gift card'] %}\n\n        {% for payment_method in payment_methods %}\n        , sum(case when payment_method = '{{ payment_method }}' then amount else 0 end) as {{ payment_method }}_amount\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id\n\n        \n\n        \n        , sum(case when payment_method = 'bank transfer' then amount else 0 end) as bank transfer_amount\n\n        \n        , sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount\n\n        \n        , sum(case when payment_method = 'credit card' then amount else 0 end) as credit card_amount\n\n        \n        , sum(case when payment_method = 'gift card' then amount else 0 end) as gift card_amount\n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2021-12-06 07:10:30.303375 (Thread-845): handling poll request
2021-12-06 07:10:30.303696 (Thread-845): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d33f2e0>]}
2021-12-06 07:10:30.304335 (Thread-845): sending response (<Response 17375 bytes [200 OK]>) to 10.0.31.30
2021-12-06 07:12:08.924761 (Thread-846): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 07:12:08.926448 (Thread-846): Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders_pivot.sql
2021-12-06 07:12:08.930347 (Thread-846): Acquiring new snowflake connection "model.jaffle_shop.int_orders_pivot".
2021-12-06 07:12:08.983311 (Thread-846): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5f40d0>]}
2021-12-06 07:12:09.691964 (Thread-847): handling status request
2021-12-06 07:12:09.692283 (Thread-847): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5f8d30>]}
2021-12-06 07:12:09.692812 (Thread-847): sending response (<Response 1543 bytes [200 OK]>) to 10.0.19.103
2021-12-06 07:12:09.797089 (Thread-848): handling status request
2021-12-06 07:12:09.797389 (Thread-848): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5f8a00>]}
2021-12-06 07:12:09.797865 (Thread-848): sending response (<Response 1543 bytes [200 OK]>) to 10.0.22.219
2021-12-06 07:12:11.894321 (Thread-849): handling status request
2021-12-06 07:12:11.894639 (Thread-849): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5f8670>]}
2021-12-06 07:12:11.895106 (Thread-849): sending response (<Response 1543 bytes [200 OK]>) to 10.0.24.86
2021-12-06 07:12:12.367297 (Thread-850): handling compile_sql request
2021-12-06 07:12:12.367595 (Thread-850): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5f82b0>]}
2021-12-06 07:12:12.368798 (Thread-850): Connection 'model.jaffle_shop.int_orders_pivot' was properly closed.
2021-12-06 07:12:14.267105 (Thread-850): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.70
2021-12-06 07:12:14.278298 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:12:14.293395 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c481dca5-b896-47d8-8498-62e1df1d850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfa549f10>]}
2021-12-06 07:12:14.293624 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:12:14.294002 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:12:14.294100 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:12:14.297125 (Thread-1): finished collecting timing info
2021-12-06 07:12:14.297247 (Thread-1): finished collecting timing info
2021-12-06 07:12:14.700522 (Thread-851): handling poll request
2021-12-06 07:12:14.700889 (Thread-851): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5c9a30>]}
2021-12-06 07:12:14.702218 (Thread-851): sending response (<Response 7541 bytes [200 OK]>) to 10.0.6.71
2021-12-06 07:12:17.260216 (Thread-852): handling status request
2021-12-06 07:12:17.260515 (Thread-852): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5c9130>]}
2021-12-06 07:12:17.261022 (Thread-852): sending response (<Response 1543 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:12:17.694837 (Thread-853): handling run_sql request
2021-12-06 07:12:17.695124 (Thread-853): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5c9220>]}
2021-12-06 07:12:19.651037 (Thread-853): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.30
2021-12-06 07:12:19.661982 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:12:19.676939 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '073f250d-3f68-4357-81a4-96cf40cd84f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe683c6ba60>]}
2021-12-06 07:12:19.677168 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:12:19.677532 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:12:19.677642 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:12:19.680712 (Thread-1): finished collecting timing info
2021-12-06 07:12:19.681782 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:12:19.681843 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

pivoted as (

    select
        order_id,

        

        

        sum(case when payment_method = 'bank transfer' then amount else 0 end) as bank transfer_amount
        
        
        ,
        

        

        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount
        
        
        ,
        

        

        sum(case when payment_method = 'credit card' then amount else 0 end) as credit card_amount
        
        
        ,
        

        

        sum(case when payment_method = 'gift card' then amount else 0 end) as gift card_amount
        
        

        

    from payments
    
    where status = 'success'

    group by 1
)
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 07:12:19.681896 (Thread-1): Opening a new connection, currently in state init
2021-12-06 07:12:20.124019 (Thread-854): handling poll request
2021-12-06 07:12:20.124407 (Thread-854): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d442130>]}
2021-12-06 07:12:20.125323 (Thread-854): sending response (<Response 4167 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:12:21.165119 (Thread-1): Snowflake query id: 01a0c310-3200-95c3-0000-00008ef91eb5
2021-12-06 07:12:21.165371 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 87 unexpected 'transfer_amount'.
syntax error line 22 at position 17 unexpected 'when'.
syntax error line 22 at position 75 unexpected 'coupon_amount'.
syntax error line 25 at position 8 unexpected ','.
syntax error line 30 at position 17 unexpected 'when'.
syntax error line 30 at position 80 unexpected 'credit'.
syntax error line 30 at position 87 unexpected 'card_amount'.
syntax error line 38 at position 17 unexpected 'when'.
syntax error line 38 at position 78 unexpected 'gift'.
syntax error line 38 at position 83 unexpected 'card_amount'.
2021-12-06 07:12:21.165543 (Thread-1): finished collecting timing info
2021-12-06 07:12:21.165737 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 07:12:21.556614 (Thread-855): handling poll request
2021-12-06 07:12:21.556929 (Thread-855): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d442cd0>]}
2021-12-06 07:12:21.557494 (Thread-855): sending response (<Response 2244 bytes [200 OK]>) to 10.0.30.196
2021-12-06 07:12:21.623733 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 87 unexpected 'transfer_amount'.
  syntax error line 22 at position 17 unexpected 'when'.
  syntax error line 22 at position 75 unexpected 'coupon_amount'.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 30 at position 17 unexpected 'when'.
  syntax error line 30 at position 80 unexpected 'credit'.
  syntax error line 30 at position 87 unexpected 'card_amount'.
  syntax error line 38 at position 17 unexpected 'when'.
  syntax error line 38 at position 78 unexpected 'gift'.
  syntax error line 38 at position 83 unexpected 'card_amount'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 14 at position 87 unexpected 'transfer_amount'.
syntax error line 22 at position 17 unexpected 'when'.
syntax error line 22 at position 75 unexpected 'coupon_amount'.
syntax error line 25 at position 8 unexpected ','.
syntax error line 30 at position 17 unexpected 'when'.
syntax error line 30 at position 80 unexpected 'credit'.
syntax error line 30 at position 87 unexpected 'card_amount'.
syntax error line 38 at position 17 unexpected 'when'.
syntax error line 38 at position 78 unexpected 'gift'.
syntax error line 38 at position 83 unexpected 'card_amount'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 87 unexpected 'transfer_amount'.
  syntax error line 22 at position 17 unexpected 'when'.
  syntax error line 22 at position 75 unexpected 'coupon_amount'.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 30 at position 17 unexpected 'when'.
  syntax error line 30 at position 80 unexpected 'credit'.
  syntax error line 30 at position 87 unexpected 'card_amount'.
  syntax error line 38 at position 17 unexpected 'when'.
  syntax error line 38 at position 78 unexpected 'gift'.
  syntax error line 38 at position 83 unexpected 'card_amount'.
2021-12-06 07:12:21.624682 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 14 at position 87 unexpected 'transfer_amount'.\n  syntax error line 22 at position 17 unexpected 'when'.\n  syntax error line 22 at position 75 unexpected 'coupon_amount'.\n  syntax error line 25 at position 8 unexpected ','.\n  syntax error line 30 at position 17 unexpected 'when'.\n  syntax error line 30 at position 80 unexpected 'credit'.\n  syntax error line 30 at position 87 unexpected 'card_amount'.\n  syntax error line 38 at position 17 unexpected 'when'.\n  syntax error line 38 at position 78 unexpected 'gift'.\n  syntax error line 38 at position 83 unexpected 'card_amount'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        {% set payment_methods = ['bank transfer', 'coupon', 'credit card', 'gift card'] %}\n\n        {% for payment_method in payment_methods %}\n\n        sum(case when payment_method = '{{ payment_method }}' then amount else 0 end) as {{ payment_method }}_amount\n        \n        {% if not loop.last %}\n        ,\n        {% endif %}\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        \n\n        \n\n        sum(case when payment_method = 'bank transfer' then amount else 0 end) as bank transfer_amount\n        \n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount\n        \n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'credit card' then amount else 0 end) as credit card_amount\n        \n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'gift card' then amount else 0 end) as gift card_amount\n        \n        \n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 14 at position 87 unexpected 'transfer_amount'.\n  syntax error line 22 at position 17 unexpected 'when'.\n  syntax error line 22 at position 75 unexpected 'coupon_amount'.\n  syntax error line 25 at position 8 unexpected ','.\n  syntax error line 30 at position 17 unexpected 'when'.\n  syntax error line 30 at position 80 unexpected 'credit'.\n  syntax error line 30 at position 87 unexpected 'card_amount'.\n  syntax error line 38 at position 17 unexpected 'when'.\n  syntax error line 38 at position 78 unexpected 'gift'.\n  syntax error line 38 at position 83 unexpected 'card_amount'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        {% set payment_methods = ['bank transfer', 'coupon', 'credit card', 'gift card'] %}\n\n        {% for payment_method in payment_methods %}\n\n        sum(case when payment_method = '{{ payment_method }}' then amount else 0 end) as {{ payment_method }}_amount\n        \n        {% if not loop.last %}\n        ,\n        {% endif %}\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        \n\n        \n\n        sum(case when payment_method = 'bank transfer' then amount else 0 end) as bank transfer_amount\n        \n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount\n        \n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'credit card' then amount else 0 end) as credit card_amount\n        \n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'gift card' then amount else 0 end) as gift card_amount\n        \n        \n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2021-12-06 07:12:22.992547 (Thread-856): handling poll request
2021-12-06 07:12:22.992879 (Thread-856): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d442be0>]}
2021-12-06 07:12:22.993574 (Thread-856): sending response (<Response 18222 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:14:27.739488 (Thread-857): handling status request
2021-12-06 07:14:27.741008 (Thread-857): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d3b9ca0>]}
2021-12-06 07:14:27.741551 (Thread-857): sending response (<Response 1521 bytes [200 OK]>) to 10.0.26.110
2021-12-06 07:14:27.743099 (Thread-858): handling status request
2021-12-06 07:14:27.743947 (Thread-858): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d442c70>]}
2021-12-06 07:14:27.744356 (Thread-858): sending response (<Response 1521 bytes [200 OK]>) to 10.0.26.110
2021-12-06 07:14:27.747365 (Thread-859): handling list request
2021-12-06 07:14:27.747554 (Thread-859): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '86307d15-4c45-4f3e-866e-c269afd2eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d442280>]}
2021-12-06 07:14:27.757057 (Thread-860): handling list request
2021-12-06 07:14:27.757404 (Thread-860): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0a935bc4-01d6-4140-b31d-a2efe6b50e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5d7b80>]}
2021-12-06 07:14:27.789373 (Thread-859): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fba4ab8-4973-4cb9-86df-3765f9b84af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0037f0>]}
2021-12-06 07:14:27.789600 (Thread-859): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:14:27.790215 (Thread-860): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fba4ab8-4973-4cb9-86df-3765f9b84af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5c7640>]}
2021-12-06 07:14:27.790436 (Thread-860): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:14:27.798381 (Thread-860): sending response (<Response 2695 bytes [200 OK]>) to 10.0.26.110
2021-12-06 07:14:27.801740 (Thread-859): sending response (<Response 5543 bytes [200 OK]>) to 10.0.26.110
2021-12-06 07:14:28.143744 (Thread-861): handling status request
2021-12-06 07:14:28.144035 (Thread-861): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0fba4ab8-4973-4cb9-86df-3765f9b84af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5d78e0>]}
2021-12-06 07:14:28.144452 (Thread-861): sending response (<Response 1521 bytes [200 OK]>) to 10.0.26.110
2021-12-06 07:14:28.149588 (Thread-862): handling list request
2021-12-06 07:14:28.149790 (Thread-862): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0fba4ab8-4973-4cb9-86df-3765f9b84af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5c7160>]}
2021-12-06 07:14:28.180486 (Thread-862): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d4420d0>]}
2021-12-06 07:14:28.180708 (Thread-862): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:14:28.182548 (Thread-862): sending response (<Response 1704 bytes [200 OK]>) to 10.0.26.110
2021-12-06 07:14:33.629052 (Thread-863): handling status request
2021-12-06 07:14:33.629388 (Thread-863): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7c0250>]}
2021-12-06 07:14:33.629870 (Thread-863): sending response (<Response 1543 bytes [200 OK]>) to 10.0.31.30
2021-12-06 07:14:34.156873 (Thread-864): handling compile_sql request
2021-12-06 07:14:34.157128 (Thread-864): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7c0790>]}
2021-12-06 07:14:36.095328 (Thread-864): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.50
2021-12-06 07:14:36.106209 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:14:36.121626 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae3bdf46-3f68-4f7e-9717-983e225ba3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45ca621c10>]}
2021-12-06 07:14:36.121868 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:14:36.122276 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:14:36.122377 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:14:36.125381 (Thread-1): finished collecting timing info
2021-12-06 07:14:36.125494 (Thread-1): finished collecting timing info
2021-12-06 07:14:36.653752 (Thread-865): handling poll request
2021-12-06 07:14:36.654196 (Thread-865): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7dd790>]}
2021-12-06 07:14:36.655339 (Thread-865): sending response (<Response 7540 bytes [200 OK]>) to 10.0.38.70
2021-12-06 07:14:58.155430 (Thread-866): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 07:14:58.155786 (Thread-866): Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders_pivot.sql
2021-12-06 07:14:58.159555 (Thread-866): Acquiring new snowflake connection "model.jaffle_shop.int_orders_pivot".
2021-12-06 07:14:58.204264 (Thread-866): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7f88e0>]}
2021-12-06 07:14:58.928602 (Thread-867): handling status request
2021-12-06 07:14:58.928915 (Thread-867): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7f88b0>]}
2021-12-06 07:14:58.929426 (Thread-867): sending response (<Response 1543 bytes [200 OK]>) to 10.0.30.196
2021-12-06 07:14:58.960558 (Thread-868): handling status request
2021-12-06 07:14:58.960767 (Thread-868): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7f8580>]}
2021-12-06 07:14:58.961137 (Thread-868): sending response (<Response 1543 bytes [200 OK]>) to 10.0.22.219
2021-12-06 07:15:00.541851 (Thread-869): handling status request
2021-12-06 07:15:00.542199 (Thread-869): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7f8dc0>]}
2021-12-06 07:15:00.542687 (Thread-869): sending response (<Response 1543 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:15:01.076579 (Thread-870): handling run_sql request
2021-12-06 07:15:01.076831 (Thread-870): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7f3820>]}
2021-12-06 07:15:01.078008 (Thread-870): Connection 'model.jaffle_shop.int_orders_pivot' was properly closed.
2021-12-06 07:15:02.994728 (Thread-870): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-06 07:15:03.005317 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:15:03.020507 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d9fa1c6-62b7-4f7c-bb2b-eecde2c35608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4d06545e0>]}
2021-12-06 07:15:03.020763 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:15:03.021161 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:15:03.021268 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:15:03.024623 (Thread-1): finished collecting timing info
2021-12-06 07:15:03.025851 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:15:03.025924 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

pivoted as (

    select
        order_id,

        

        

        sum(case when payment_method = 'bank transfer' then amount else 0 end) as bank transfer_amount

        
        ,
        

        

        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount

        
        ,
        

        

        sum(case when payment_method = 'credit card' then amount else 0 end) as credit card_amount

        
        ,
        

        

        sum(case when payment_method = 'gift card' then amount else 0 end) as gift card_amount

        

        

    from payments
    
    where status = 'success'

    group by 1
),


select * from pivoted
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 07:15:03.026008 (Thread-1): Opening a new connection, currently in state init
2021-12-06 07:15:03.532987 (Thread-871): handling poll request
2021-12-06 07:15:03.533353 (Thread-871): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c735130>]}
2021-12-06 07:15:03.534249 (Thread-871): sending response (<Response 4163 bytes [200 OK]>) to 10.0.22.219
2021-12-06 07:15:04.525457 (Thread-1): Snowflake query id: 01a0c313-3200-95c3-0000-00008ef91eb9
2021-12-06 07:15:04.525659 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 87 unexpected 'transfer_amount'.
syntax error line 22 at position 17 unexpected 'when'.
syntax error line 22 at position 75 unexpected 'coupon_amount'.
syntax error line 25 at position 8 unexpected ','.
syntax error line 30 at position 17 unexpected 'when'.
syntax error line 30 at position 80 unexpected 'credit'.
syntax error line 30 at position 87 unexpected 'card_amount'.
syntax error line 38 at position 17 unexpected 'when'.
syntax error line 38 at position 78 unexpected 'gift'.
syntax error line 38 at position 83 unexpected 'card_amount'.
syntax error line 52 at position 0 unexpected 'select'.
2021-12-06 07:15:04.525797 (Thread-1): finished collecting timing info
2021-12-06 07:15:04.525976 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 07:15:04.968296 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 87 unexpected 'transfer_amount'.
  syntax error line 22 at position 17 unexpected 'when'.
  syntax error line 22 at position 75 unexpected 'coupon_amount'.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 30 at position 17 unexpected 'when'.
  syntax error line 30 at position 80 unexpected 'credit'.
  syntax error line 30 at position 87 unexpected 'card_amount'.
  syntax error line 38 at position 17 unexpected 'when'.
  syntax error line 38 at position 78 unexpected 'gift'.
  syntax error line 38 at position 83 unexpected 'card_amount'.
  syntax error line 52 at position 0 unexpected 'select'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 14 at position 87 unexpected 'transfer_amount'.
syntax error line 22 at position 17 unexpected 'when'.
syntax error line 22 at position 75 unexpected 'coupon_amount'.
syntax error line 25 at position 8 unexpected ','.
syntax error line 30 at position 17 unexpected 'when'.
syntax error line 30 at position 80 unexpected 'credit'.
syntax error line 30 at position 87 unexpected 'card_amount'.
syntax error line 38 at position 17 unexpected 'when'.
syntax error line 38 at position 78 unexpected 'gift'.
syntax error line 38 at position 83 unexpected 'card_amount'.
syntax error line 52 at position 0 unexpected 'select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 87 unexpected 'transfer_amount'.
  syntax error line 22 at position 17 unexpected 'when'.
  syntax error line 22 at position 75 unexpected 'coupon_amount'.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 30 at position 17 unexpected 'when'.
  syntax error line 30 at position 80 unexpected 'credit'.
  syntax error line 30 at position 87 unexpected 'card_amount'.
  syntax error line 38 at position 17 unexpected 'when'.
  syntax error line 38 at position 78 unexpected 'gift'.
  syntax error line 38 at position 83 unexpected 'card_amount'.
  syntax error line 52 at position 0 unexpected 'select'.
2021-12-06 07:15:04.969337 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 14 at position 87 unexpected 'transfer_amount'.\n  syntax error line 22 at position 17 unexpected 'when'.\n  syntax error line 22 at position 75 unexpected 'coupon_amount'.\n  syntax error line 25 at position 8 unexpected ','.\n  syntax error line 30 at position 17 unexpected 'when'.\n  syntax error line 30 at position 80 unexpected 'credit'.\n  syntax error line 30 at position 87 unexpected 'card_amount'.\n  syntax error line 38 at position 17 unexpected 'when'.\n  syntax error line 38 at position 78 unexpected 'gift'.\n  syntax error line 38 at position 83 unexpected 'card_amount'.\n  syntax error line 52 at position 0 unexpected 'select'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        {% set payment_methods = ['bank transfer', 'coupon', 'credit card', 'gift card'] %}\n\n        {% for payment_method in payment_methods %}\n\n        sum(case when payment_method = '{{ payment_method }}' then amount else 0 end) as {{ payment_method }}_amount\n\n        {% if not loop.last %}\n        ,\n        {% endif %}\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n),\n\n\nselect * from pivoted\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        \n\n        \n\n        sum(case when payment_method = 'bank transfer' then amount else 0 end) as bank transfer_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'credit card' then amount else 0 end) as credit card_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'gift card' then amount else 0 end) as gift card_amount\n\n        \n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n),\n\n\nselect * from pivoted\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 14 at position 87 unexpected 'transfer_amount'.\n  syntax error line 22 at position 17 unexpected 'when'.\n  syntax error line 22 at position 75 unexpected 'coupon_amount'.\n  syntax error line 25 at position 8 unexpected ','.\n  syntax error line 30 at position 17 unexpected 'when'.\n  syntax error line 30 at position 80 unexpected 'credit'.\n  syntax error line 30 at position 87 unexpected 'card_amount'.\n  syntax error line 38 at position 17 unexpected 'when'.\n  syntax error line 38 at position 78 unexpected 'gift'.\n  syntax error line 38 at position 83 unexpected 'card_amount'.\n  syntax error line 52 at position 0 unexpected 'select'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        {% set payment_methods = ['bank transfer', 'coupon', 'credit card', 'gift card'] %}\n\n        {% for payment_method in payment_methods %}\n\n        sum(case when payment_method = '{{ payment_method }}' then amount else 0 end) as {{ payment_method }}_amount\n\n        {% if not loop.last %}\n        ,\n        {% endif %}\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n),\n\n\nselect * from pivoted\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        \n\n        \n\n        sum(case when payment_method = 'bank transfer' then amount else 0 end) as bank transfer_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'credit card' then amount else 0 end) as credit card_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'gift card' then amount else 0 end) as gift card_amount\n\n        \n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n),\n\n\nselect * from pivoted\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2021-12-06 07:15:05.066605 (Thread-872): handling poll request
2021-12-06 07:15:05.066917 (Thread-872): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7355e0>]}
2021-12-06 07:15:05.067525 (Thread-872): sending response (<Response 12846 bytes [200 OK]>) to 10.0.37.206
2021-12-06 07:15:06.505686 (Thread-873): handling poll request
2021-12-06 07:15:06.506064 (Thread-873): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c735670>]}
2021-12-06 07:15:06.530837 (Thread-873): sending response (<Response 18689 bytes [200 OK]>) to 10.0.31.30
2021-12-06 07:15:20.490459 (Thread-874): handling status request
2021-12-06 07:15:20.490793 (Thread-874): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7163a0>]}
2021-12-06 07:15:20.491314 (Thread-874): sending response (<Response 1543 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:15:20.957583 (Thread-875): handling compile_sql request
2021-12-06 07:15:20.957912 (Thread-875): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c6ff940>]}
2021-12-06 07:15:22.866589 (Thread-875): sending response (<Response 138 bytes [200 OK]>) to 10.0.0.217
2021-12-06 07:15:22.877078 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:15:22.892175 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33c87d7e-8d28-41e1-8d74-c6a87b8696dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd8dca610>]}
2021-12-06 07:15:22.892419 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:15:22.892822 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:15:22.892941 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:15:22.896553 (Thread-1): finished collecting timing info
2021-12-06 07:15:22.896673 (Thread-1): finished collecting timing info
2021-12-06 07:15:23.431470 (Thread-876): handling poll request
2021-12-06 07:15:23.431834 (Thread-876): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7f31c0>]}
2021-12-06 07:15:23.433028 (Thread-876): sending response (<Response 7573 bytes [200 OK]>) to 10.0.37.206
2021-12-06 07:16:00.469578 (Thread-877): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 07:16:00.469953 (Thread-877): Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders_pivot.sql
2021-12-06 07:16:00.473567 (Thread-877): Acquiring new snowflake connection "model.jaffle_shop.int_orders_pivot".
2021-12-06 07:16:00.520078 (Thread-877): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c6c6f70>]}
2021-12-06 07:16:01.243356 (Thread-878): handling status request
2021-12-06 07:16:01.243651 (Thread-878): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c7cee20>]}
2021-12-06 07:16:01.244152 (Thread-878): sending response (<Response 1543 bytes [200 OK]>) to 10.0.24.86
2021-12-06 07:16:01.387522 (Thread-879): handling status request
2021-12-06 07:16:01.387807 (Thread-879): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c713c10>]}
2021-12-06 07:16:01.388230 (Thread-879): sending response (<Response 1543 bytes [200 OK]>) to 10.0.6.71
2021-12-06 07:16:04.391119 (Thread-880): handling status request
2021-12-06 07:16:04.391454 (Thread-880): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c6ca370>]}
2021-12-06 07:16:04.391991 (Thread-880): sending response (<Response 1543 bytes [200 OK]>) to 10.0.26.3
2021-12-06 07:16:04.827405 (Thread-881): handling run_sql request
2021-12-06 07:16:04.827738 (Thread-881): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c6ca3a0>]}
2021-12-06 07:16:04.828902 (Thread-881): Connection 'model.jaffle_shop.int_orders_pivot' was properly closed.
2021-12-06 07:16:06.734106 (Thread-881): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-06 07:16:06.744810 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:16:06.759808 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23943031-afb7-4ab1-9ddb-25d7e8cb843a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd21749160>]}
2021-12-06 07:16:06.760041 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:16:06.760400 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:16:06.760504 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:16:06.763547 (Thread-1): finished collecting timing info
2021-12-06 07:16:06.764627 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:16:06.764690 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

pivoted as (

    select
        order_id,

        

        

        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount

        
        ,
        

        

        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount

        
        ,
        

        

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount

        
        ,
        

        

        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount

        

        

    from payments
    
    where status = 'success'

    group by 1
),


select * from pivoted
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 07:16:06.764743 (Thread-1): Opening a new connection, currently in state init
2021-12-06 07:16:07.222737 (Thread-882): handling poll request
2021-12-06 07:16:07.223026 (Thread-882): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c6db3d0>]}
2021-12-06 07:16:07.223877 (Thread-882): sending response (<Response 4163 bytes [200 OK]>) to 10.0.24.86
2021-12-06 07:16:08.248326 (Thread-1): Snowflake query id: 01a0c314-3200-95c4-0000-00008ef92e0d
2021-12-06 07:16:08.248530 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 52 at position 0 unexpected 'select'.
2021-12-06 07:16:08.248661 (Thread-1): finished collecting timing info
2021-12-06 07:16:08.248818 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 07:16:08.671516 (Thread-883): handling poll request
2021-12-06 07:16:08.671836 (Thread-883): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c6db7c0>]}
2021-12-06 07:16:08.672374 (Thread-883): sending response (<Response 1709 bytes [200 OK]>) to 10.0.6.10
2021-12-06 07:16:08.695182 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 0 unexpected 'select'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 52 at position 0 unexpected 'select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 0 unexpected 'select'.
2021-12-06 07:16:08.696123 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 52 at position 0 unexpected 'select'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        {% set payment_methods = ['bank_transfer', 'coupon', 'credit_card', 'gift_card'] %}\n\n        {% for payment_method in payment_methods %}\n\n        sum(case when payment_method = '{{ payment_method }}' then amount else 0 end) as {{ payment_method }}_amount\n\n        {% if not loop.last %}\n        ,\n        {% endif %}\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n),\n\n\nselect * from pivoted\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        \n\n        \n\n        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount\n\n        \n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n),\n\n\nselect * from pivoted\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 52 at position 0 unexpected 'select'.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments') }}\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        {% set payment_methods = ['bank_transfer', 'coupon', 'credit_card', 'gift_card'] %}\n\n        {% for payment_method in payment_methods %}\n\n        sum(case when payment_method = '{{ payment_method }}' then amount else 0 end) as {{ payment_method }}_amount\n\n        {% if not loop.last %}\n        ,\n        {% endif %}\n\n        {% endfor %}\n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n),\n\n\nselect * from pivoted\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\npivoted as (\n\n    select\n        order_id,\n\n        \n\n        \n\n        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount\n\n        \n        ,\n        \n\n        \n\n        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount\n\n        \n\n        \n\n    from payments\n    \n    where status = 'success'\n\n    group by 1\n),\n\n\nselect * from pivoted\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2021-12-06 07:16:10.111801 (Thread-884): handling poll request
2021-12-06 07:16:10.112130 (Thread-884): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c6db880>]}
2021-12-06 07:16:10.112756 (Thread-884): sending response (<Response 14425 bytes [200 OK]>) to 10.0.31.30
2021-12-06 07:17:07.833951 (Thread-885): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 07:17:07.834393 (Thread-885): Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders_pivot.sql
2021-12-06 07:17:07.838471 (Thread-885): Acquiring new snowflake connection "model.jaffle_shop.int_orders_pivot".
2021-12-06 07:17:07.890648 (Thread-885): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5d4b80>]}
2021-12-06 07:17:08.617717 (Thread-886): handling status request
2021-12-06 07:17:08.618048 (Thread-886): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5d47f0>]}
2021-12-06 07:17:08.618558 (Thread-886): sending response (<Response 1543 bytes [200 OK]>) to 10.0.22.219
2021-12-06 07:17:08.798641 (Thread-887): handling status request
2021-12-06 07:17:08.798951 (Thread-887): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5d4550>]}
2021-12-06 07:17:08.799456 (Thread-887): sending response (<Response 1543 bytes [200 OK]>) to 10.0.36.143
2021-12-06 07:18:53.643112 (Thread-888): handling status request
2021-12-06 07:18:53.644532 (Thread-888): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5d4520>]}
2021-12-06 07:18:53.645000 (Thread-888): sending response (<Response 1543 bytes [200 OK]>) to 10.0.39.19
2021-12-06 07:18:54.101968 (Thread-889): handling compile_sql request
2021-12-06 07:18:54.102283 (Thread-889): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5d5a30>]}
2021-12-06 07:18:54.103432 (Thread-889): Connection 'model.jaffle_shop.int_orders_pivot' was properly closed.
2021-12-06 07:18:56.019761 (Thread-889): sending response (<Response 138 bytes [200 OK]>) to 10.0.13.223
2021-12-06 07:18:56.030484 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:18:56.047666 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cedc669-6aa8-4214-9c54-7c48bf0fc4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66e2c68e0>]}
2021-12-06 07:18:56.047926 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:18:56.048319 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:18:56.048428 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:18:56.051641 (Thread-1): finished collecting timing info
2021-12-06 07:18:56.051759 (Thread-1): finished collecting timing info
2021-12-06 07:18:56.475707 (Thread-890): handling poll request
2021-12-06 07:18:56.476061 (Thread-890): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c600340>]}
2021-12-06 07:18:56.477229 (Thread-890): sending response (<Response 7089 bytes [200 OK]>) to 10.0.24.86
2021-12-06 07:19:13.935411 (Thread-891): handling status request
2021-12-06 07:19:13.935760 (Thread-891): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c600430>]}
2021-12-06 07:19:13.936296 (Thread-891): sending response (<Response 1543 bytes [200 OK]>) to 10.0.13.223
2021-12-06 07:19:14.381454 (Thread-892): handling compile_sql request
2021-12-06 07:19:14.381701 (Thread-892): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c600760>]}
2021-12-06 07:19:16.289317 (Thread-892): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-06 07:19:16.299937 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:19:16.314872 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '730b6370-e2f7-402c-a3c6-b896bcef7657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66c4e5d460>]}
2021-12-06 07:19:16.315107 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:19:16.315463 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:19:16.315565 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:19:16.318558 (Thread-1): finished collecting timing info
2021-12-06 07:19:16.318671 (Thread-1): finished collecting timing info
2021-12-06 07:19:16.767136 (Thread-893): handling poll request
2021-12-06 07:19:16.767497 (Thread-893): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c66a8b0>]}
2021-12-06 07:19:16.768650 (Thread-893): sending response (<Response 7108 bytes [200 OK]>) to 10.0.22.219
2021-12-06 07:19:34.399429 (Thread-894): handling status request
2021-12-06 07:19:34.399736 (Thread-894): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c66a9a0>]}
2021-12-06 07:19:34.400243 (Thread-894): sending response (<Response 1543 bytes [200 OK]>) to 10.0.37.206
2021-12-06 07:19:34.836414 (Thread-895): handling compile_sql request
2021-12-06 07:19:34.836731 (Thread-895): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c66acd0>]}
2021-12-06 07:19:36.746719 (Thread-895): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:19:36.757320 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:19:36.772290 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f174f11-a62e-4c87-820a-fa8d9f231968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9608789e80>]}
2021-12-06 07:19:36.772521 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:19:36.772880 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:19:36.772985 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:19:36.775999 (Thread-1): finished collecting timing info
2021-12-06 07:19:36.776111 (Thread-1): finished collecting timing info
2021-12-06 07:19:37.220348 (Thread-896): handling poll request
2021-12-06 07:19:37.220704 (Thread-896): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5d4e80>]}
2021-12-06 07:19:37.221838 (Thread-896): sending response (<Response 7109 bytes [200 OK]>) to 10.0.22.219
2021-12-06 07:20:00.155804 (Thread-897): handling status request
2021-12-06 07:20:00.156132 (Thread-897): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5d4fd0>]}
2021-12-06 07:20:00.156642 (Thread-897): sending response (<Response 1543 bytes [200 OK]>) to 10.0.6.71
2021-12-06 07:20:00.681046 (Thread-898): handling compile_sql request
2021-12-06 07:20:00.681327 (Thread-898): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c6401c0>]}
2021-12-06 07:20:02.616351 (Thread-898): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:20:02.627668 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:20:02.645262 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fce1539-819f-4d35-a35d-58b782b22dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6d4084460>]}
2021-12-06 07:20:02.645492 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:20:02.645864 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:20:02.645987 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:20:02.648958 (Thread-1): finished collecting timing info
2021-12-06 07:20:02.649070 (Thread-1): finished collecting timing info
2021-12-06 07:20:03.216663 (Thread-899): handling poll request
2021-12-06 07:20:03.217018 (Thread-899): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5c8370>]}
2021-12-06 07:20:03.218191 (Thread-899): sending response (<Response 7122 bytes [200 OK]>) to 10.0.6.71
2021-12-06 07:20:11.803312 (Thread-900): handling status request
2021-12-06 07:20:11.803629 (Thread-900): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5c8460>]}
2021-12-06 07:20:11.804143 (Thread-900): sending response (<Response 1543 bytes [200 OK]>) to 10.0.24.86
2021-12-06 07:20:12.242755 (Thread-901): handling compile_sql request
2021-12-06 07:20:12.243059 (Thread-901): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5c8790>]}
2021-12-06 07:20:14.165230 (Thread-901): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.86
2021-12-06 07:20:14.176389 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:20:14.191491 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f99278ec-0ca8-42ba-abdb-43b12e6abff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3068fa0>]}
2021-12-06 07:20:14.191724 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:20:14.192096 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:20:14.192199 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:20:14.195168 (Thread-1): finished collecting timing info
2021-12-06 07:20:14.195280 (Thread-1): finished collecting timing info
2021-12-06 07:20:14.606754 (Thread-902): handling poll request
2021-12-06 07:20:14.607118 (Thread-902): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5c98e0>]}
2021-12-06 07:20:14.608265 (Thread-902): sending response (<Response 7200 bytes [200 OK]>) to 10.0.6.10
2021-12-06 07:20:22.498644 (Thread-903): handling status request
2021-12-06 07:20:22.498975 (Thread-903): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5c99d0>]}
2021-12-06 07:20:22.528025 (Thread-903): sending response (<Response 1543 bytes [200 OK]>) to 10.0.13.223
2021-12-06 07:20:23.057586 (Thread-904): handling compile_sql request
2021-12-06 07:20:23.057917 (Thread-904): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5c9a00>]}
2021-12-06 07:20:24.998046 (Thread-904): sending response (<Response 138 bytes [200 OK]>) to 10.0.30.196
2021-12-06 07:20:25.009244 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:20:25.024236 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ff50d3f-cd8f-42ad-863e-62c2de7c280b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69ca857400>]}
2021-12-06 07:20:25.024469 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:20:25.024862 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:20:25.024966 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:20:25.027975 (Thread-1): finished collecting timing info
2021-12-06 07:20:25.028091 (Thread-1): finished collecting timing info
2021-12-06 07:20:25.443176 (Thread-905): handling poll request
2021-12-06 07:20:25.443531 (Thread-905): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5e4820>]}
2021-12-06 07:20:25.444720 (Thread-905): sending response (<Response 7179 bytes [200 OK]>) to 10.0.13.223
2021-12-06 07:21:43.686581 (Thread-906): handling status request
2021-12-06 07:21:43.687955 (Thread-906): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5e49a0>]}
2021-12-06 07:21:43.688507 (Thread-906): sending response (<Response 1543 bytes [200 OK]>) to 10.0.0.217
2021-12-06 07:21:44.281869 (Thread-907): handling compile_sql request
2021-12-06 07:21:44.282221 (Thread-907): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5e4be0>]}
2021-12-06 07:21:46.205843 (Thread-907): sending response (<Response 138 bytes [200 OK]>) to 10.0.13.223
2021-12-06 07:21:46.216910 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:21:46.234472 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '329733e2-c890-4e2c-b245-fe0eab9fcb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99782888b0>]}
2021-12-06 07:21:46.234705 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:21:46.235057 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:21:46.235160 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:21:46.238169 (Thread-1): finished collecting timing info
2021-12-06 07:21:46.238283 (Thread-1): finished collecting timing info
2021-12-06 07:21:46.646253 (Thread-908): handling poll request
2021-12-06 07:21:46.646607 (Thread-908): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5e3d00>]}
2021-12-06 07:21:46.647742 (Thread-908): sending response (<Response 7201 bytes [200 OK]>) to 10.0.24.86
2021-12-06 07:21:54.577657 (Thread-909): handling status request
2021-12-06 07:21:54.577980 (Thread-909): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5e3df0>]}
2021-12-06 07:21:54.578492 (Thread-909): sending response (<Response 1543 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:21:55.105994 (Thread-910): handling compile_sql request
2021-12-06 07:21:55.106281 (Thread-910): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5d9100>]}
2021-12-06 07:21:57.056152 (Thread-910): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.241
2021-12-06 07:21:57.067513 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:21:57.082731 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f05f84f6-7714-4972-8e73-ad96996a458b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effaebc85b0>]}
2021-12-06 07:21:57.082962 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:21:57.083326 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:21:57.083428 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:21:57.086405 (Thread-1): finished collecting timing info
2021-12-06 07:21:57.086517 (Thread-1): finished collecting timing info
2021-12-06 07:21:57.552012 (Thread-911): handling poll request
2021-12-06 07:21:57.552352 (Thread-911): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5d95b0>]}
2021-12-06 07:21:57.553426 (Thread-911): sending response (<Response 7193 bytes [200 OK]>) to 10.0.38.50
2021-12-06 07:22:11.049772 (Thread-912): handling status request
2021-12-06 07:22:11.050124 (Thread-912): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5e3ac0>]}
2021-12-06 07:22:11.050659 (Thread-912): sending response (<Response 1543 bytes [200 OK]>) to 10.0.41.241
2021-12-06 07:22:11.485112 (Thread-913): handling compile_sql request
2021-12-06 07:22:11.485343 (Thread-913): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5e4430>]}
2021-12-06 07:22:13.409726 (Thread-913): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.71
2021-12-06 07:22:13.421273 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:22:13.436510 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b34c1b3c-13f5-404c-a155-f3a255e9f41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f174accbe50>]}
2021-12-06 07:22:13.436745 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:22:13.437129 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:22:13.437230 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:22:13.440203 (Thread-1): finished collecting timing info
2021-12-06 07:22:13.440313 (Thread-1): finished collecting timing info
2021-12-06 07:22:13.931037 (Thread-914): handling poll request
2021-12-06 07:22:13.931401 (Thread-914): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c5e8af0>]}
2021-12-06 07:22:13.932637 (Thread-914): sending response (<Response 7217 bytes [200 OK]>) to 10.0.0.217
2021-12-06 07:22:20.145851 (Thread-915): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 07:22:20.146256 (Thread-915): Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders_pivot.sql
2021-12-06 07:22:20.150011 (Thread-915): Acquiring new snowflake connection "model.jaffle_shop.int_orders_pivot".
2021-12-06 07:22:20.199710 (Thread-915): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c54eaf0>]}
2021-12-06 07:22:20.949844 (Thread-916): handling status request
2021-12-06 07:22:20.950224 (Thread-916): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c6aa2b0>]}
2021-12-06 07:22:20.950787 (Thread-916): sending response (<Response 1543 bytes [200 OK]>) to 10.0.6.10
2021-12-06 07:22:21.194658 (Thread-917): handling status request
2021-12-06 07:22:21.194954 (Thread-917): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c54e6a0>]}
2021-12-06 07:22:21.195430 (Thread-917): sending response (<Response 1543 bytes [200 OK]>) to 10.0.3.73
2021-12-06 07:22:24.502706 (Thread-918): handling status request
2021-12-06 07:22:24.503023 (Thread-918): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c54ea60>]}
2021-12-06 07:22:24.503500 (Thread-918): sending response (<Response 1543 bytes [200 OK]>) to 10.0.22.219
2021-12-06 07:22:24.937808 (Thread-919): handling run_sql request
2021-12-06 07:22:24.938094 (Thread-919): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c54e130>]}
2021-12-06 07:22:24.939246 (Thread-919): Connection 'model.jaffle_shop.int_orders_pivot' was properly closed.
2021-12-06 07:22:26.849271 (Thread-919): sending response (<Response 138 bytes [200 OK]>) to 10.0.30.196
2021-12-06 07:22:26.860512 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:22:26.875590 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dde1adb2-d093-4909-be5a-a42bfd479b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9576f89460>]}
2021-12-06 07:22:26.875825 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-12-06 07:22:26.876185 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:22:26.876288 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 07:22:26.879960 (Thread-1): finished collecting timing info
2021-12-06 07:22:26.880974 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 07:22:26.881036 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

pivoted as (

    select
    
        order_id,
        
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount

    from payments
    
    where status = 'success'

    group by 1
)


select * from pivoted
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 07:22:26.881089 (Thread-1): Opening a new connection, currently in state init
2021-12-06 07:22:27.280946 (Thread-920): handling poll request
2021-12-06 07:22:27.281312 (Thread-920): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c51d9d0>]}
2021-12-06 07:22:27.282232 (Thread-920): sending response (<Response 3990 bytes [200 OK]>) to 10.0.26.3
2021-12-06 07:22:28.723101 (Thread-921): handling poll request
2021-12-06 07:22:28.723410 (Thread-921): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c51dac0>]}
2021-12-06 07:22:28.723890 (Thread-921): sending response (<Response 400 bytes [200 OK]>) to 10.0.6.71
2021-12-06 07:22:28.909799 (Thread-1): SQL status: SUCCESS 99 in 2.03 seconds
2021-12-06 07:22:28.926043 (Thread-1): finished collecting timing info
2021-12-06 07:22:28.926209 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 07:22:30.174939 (Thread-922): handling poll request
2021-12-06 07:22:30.175257 (Thread-922): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c4aa190>]}
2021-12-06 07:22:30.176612 (Thread-922): sending response (<Response 8661 bytes [200 OK]>) to 10.0.13.223
2021-12-06 07:22:51.907489 (Thread-923): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 07:22:51.907850 (Thread-923): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 07:22:51.913409 (Thread-923): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c4d2850>]}
2021-12-06 07:22:52.719566 (Thread-924): handling status request
2021-12-06 07:22:52.719875 (Thread-924): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c4d2ee0>]}
2021-12-06 07:22:52.720380 (Thread-924): sending response (<Response 1212 bytes [200 OK]>) to 10.0.22.219
2021-12-06 07:22:52.889841 (Thread-925): handling status request
2021-12-06 07:22:52.890149 (Thread-925): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c4d2910>]}
2021-12-06 07:22:52.890593 (Thread-925): sending response (<Response 1212 bytes [200 OK]>) to 10.0.2.25
2021-12-06 07:23:12.001408 (Thread-926): handling status request
2021-12-06 07:23:12.001718 (Thread-926): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ecfe4f1b-cc61-45d9-aadf-25bbae047624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429c4d2f70>]}
2021-12-06 07:23:12.002227 (Thread-926): sending response (<Response 1212 bytes [200 OK]>) to 10.0.30.196
