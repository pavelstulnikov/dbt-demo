2021-12-03 23:28:12.743016 (MainThread): Running with dbt=0.21.0
2021-12-03 23:28:13.125556 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-12-03 23:28:13.140509 (MainThread): Tracking: tracking
2021-12-03 23:28:13.140686 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c29abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a7c8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a77fc70>]}
2021-12-03 23:28:13.140980 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=24
2021-12-03 23:28:13.141197 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2021-12-03 23:28:13.141340 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-12-03 23:28:13.143841 (Thread-12): Unable to do partial parsing because target/partial_parse.msgpack not found
2021-12-03 23:28:13.144063 (Thread-12): Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a7c8eb0>]}
2021-12-03 23:28:13.174530 (Thread-12): Parsing macros/catalog.sql
2021-12-03 23:28:13.176765 (Thread-12): Parsing macros/adapters.sql
2021-12-03 23:28:13.211435 (Thread-12): Parsing macros/materializations/merge.sql
2021-12-03 23:28:13.215260 (Thread-12): Parsing macros/materializations/table.sql
2021-12-03 23:28:13.218446 (Thread-12): Parsing macros/materializations/seed.sql
2021-12-03 23:28:13.222628 (Thread-12): Parsing macros/materializations/view.sql
2021-12-03 23:28:13.223946 (Thread-12): Parsing macros/materializations/incremental.sql
2021-12-03 23:28:13.232117 (Thread-12): Parsing macros/core.sql
2021-12-03 23:28:13.235679 (Thread-12): Parsing macros/materializations/test.sql
2021-12-03 23:28:13.242029 (Thread-12): Parsing macros/materializations/helpers.sql
2021-12-03 23:28:13.251512 (Thread-12): Parsing macros/materializations/view/view.sql
2021-12-03 23:28:13.258243 (Thread-12): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-03 23:28:13.262021 (Thread-12): Parsing macros/materializations/seed/seed.sql
2021-12-03 23:28:13.283418 (Thread-12): Parsing macros/materializations/snapshot/strategies.sql
2021-12-03 23:28:13.299985 (Thread-12): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-03 23:28:13.301601 (Thread-12): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-03 23:28:13.331136 (Thread-12): Parsing macros/materializations/table/table.sql
2021-12-03 23:28:13.338031 (Thread-12): Parsing macros/materializations/common/merge.sql
2021-12-03 23:28:13.351060 (Thread-12): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-03 23:28:13.369596 (Thread-12): Parsing macros/materializations/incremental/incremental.sql
2021-12-03 23:28:13.379129 (Thread-12): Parsing macros/materializations/incremental/helpers.sql
2021-12-03 23:28:13.380807 (Thread-12): Parsing macros/etc/get_custom_alias.sql
2021-12-03 23:28:13.382284 (Thread-12): Parsing macros/etc/datetime.sql
2021-12-03 23:28:13.390923 (Thread-12): Parsing macros/etc/query.sql
2021-12-03 23:28:13.392094 (Thread-12): Parsing macros/etc/where_subquery.sql
2021-12-03 23:28:13.392945 (Thread-13): handling status request
2021-12-03 23:28:13.394868 (Thread-12): Parsing macros/etc/get_custom_database.sql
2021-12-03 23:28:13.395170 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a755190>]}
2021-12-03 23:28:13.396783 (Thread-12): Parsing macros/etc/get_custom_schema.sql
2021-12-03 23:28:13.397428 (Thread-13): sending response (<Response 185 bytes [200 OK]>) to 10.0.19.103
2021-12-03 23:28:13.400470 (Thread-12): Parsing macros/etc/is_incremental.sql
2021-12-03 23:28:13.402595 (Thread-12): Parsing macros/adapters/common.sql
2021-12-03 23:28:13.448719 (Thread-14): handling status request
2021-12-03 23:28:13.457473 (Thread-12): Parsing macros/schema_tests/accepted_values.sql
2021-12-03 23:28:13.457795 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a712df0>]}
2021-12-03 23:28:13.460079 (Thread-12): Parsing macros/schema_tests/not_null.sql
2021-12-03 23:28:13.460553 (Thread-14): sending response (<Response 185 bytes [200 OK]>) to 10.0.2.25
2021-12-03 23:28:13.461818 (Thread-12): Parsing macros/schema_tests/relationships.sql
2021-12-03 23:28:13.463749 (Thread-12): Parsing macros/schema_tests/unique.sql
2021-12-03 23:28:13.500316 (Thread-15): handling status request
2021-12-03 23:28:13.520910 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a71cd90>]}
2021-12-03 23:28:13.526421 (Thread-15): sending response (<Response 163 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:13.633740 (Thread-16): handling status request
2021-12-03 23:28:13.649322 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a72d220>]}
2021-12-03 23:28:13.653241 (Thread-12): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-03 23:28:13.653735 (Thread-16): sending response (<Response 163 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:13.668266 (Thread-12): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-03 23:28:13.729060 (Thread-17): handling status request
2021-12-03 23:28:13.729263 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a758df0>]}
2021-12-03 23:28:13.729634 (Thread-17): sending response (<Response 163 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:13.743390 (Thread-12): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a750310>]}
2021-12-03 23:28:13.786003 (Thread-18): handling status request
2021-12-03 23:28:13.786201 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a65c640>]}
2021-12-03 23:28:13.786811 (Thread-18): sending response (<Response 11003 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:13.792666 (Thread-19): handling list request
2021-12-03 23:28:13.792848 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '361dab0c-b968-481a-b523-26adc9b15799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a65cd00>]}
2021-12-03 23:28:13.825739 (Thread-19): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a6a7310>]}
2021-12-03 23:28:13.825970 (Thread-19): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:28:13.829942 (Thread-19): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:28:13.830099 (Thread-19): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:28:13.830173 (Thread-19): No nodes selected!
2021-12-03 23:28:13.831557 (Thread-19): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:14.854312 (Thread-20): handling status request
2021-12-03 23:28:14.854604 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a73d370>]}
2021-12-03 23:28:14.855511 (Thread-20): sending response (<Response 11025 bytes [200 OK]>) to 10.0.3.73
2021-12-03 23:28:14.908141 (Thread-21): handling status request
2021-12-03 23:28:14.908354 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a757340>]}
2021-12-03 23:28:14.908925 (Thread-21): sending response (<Response 11025 bytes [200 OK]>) to 10.0.2.25
2021-12-03 23:28:40.932825 (Thread-22): handling status request
2021-12-03 23:28:40.933152 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a6d9c10>]}
2021-12-03 23:28:40.933893 (Thread-22): sending response (<Response 11003 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:40.942358 (Thread-23): handling list request
2021-12-03 23:28:40.942541 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0faa9f37-0e19-44c1-ad15-edb718a91b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca7f716d0>]}
2021-12-03 23:28:40.976965 (Thread-23): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a64d100>]}
2021-12-03 23:28:40.977185 (Thread-23): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:28:40.980649 (Thread-23): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:28:40.980804 (Thread-23): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:28:40.980875 (Thread-23): No nodes selected!
2021-12-03 23:28:40.982252 (Thread-23): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:54.215376 (Thread-24): handling status request
2021-12-03 23:28:54.217160 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a64d970>]}
2021-12-03 23:28:54.217919 (Thread-24): sending response (<Response 11025 bytes [200 OK]>) to 10.0.31.30
2021-12-03 23:28:56.552246 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-03 23:28:56.597376 (Thread-25): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-03 23:28:56.597677 (Thread-25): Partial parsing enabled, no changes found, skipping parsing
2021-12-03 23:28:56.602392 (Thread-25): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687e1b80>]}
2021-12-03 23:28:57.558141 (Thread-26): handling status request
2021-12-03 23:28:57.558423 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687e1b50>]}
2021-12-03 23:28:57.558877 (Thread-26): sending response (<Response 1209 bytes [200 OK]>) to 10.0.31.30
2021-12-03 23:28:57.612991 (Thread-27): handling status request
2021-12-03 23:28:57.613210 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687e1dc0>]}
2021-12-03 23:28:57.613615 (Thread-27): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:57.619674 (Thread-28): handling list request
2021-12-03 23:28:57.619868 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '094291d9-0a23-4eb2-a817-ae2aeb84cfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687cc160>]}
2021-12-03 23:28:57.651413 (Thread-28): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f174848-0115-4ff2-82cb-54b15fa6ae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a65c7c0>]}
2021-12-03 23:28:57.651633 (Thread-28): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:28:57.652351 (Thread-28): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:28:57.652503 (Thread-28): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:28:57.652575 (Thread-28): No nodes selected!
2021-12-03 23:28:57.653986 (Thread-28): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:28:57.711351 (Thread-29): handling status request
2021-12-03 23:28:57.711535 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3f174848-0115-4ff2-82cb-54b15fa6ae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687ccbb0>]}
2021-12-03 23:28:57.711881 (Thread-29): sending response (<Response 1209 bytes [200 OK]>) to 10.0.22.219
2021-12-03 23:29:08.391184 (Thread-30): handling status request
2021-12-03 23:29:08.393063 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3f174848-0115-4ff2-82cb-54b15fa6ae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a3190>]}
2021-12-03 23:29:08.393514 (Thread-30): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:29:08.401139 (Thread-31): handling list request
2021-12-03 23:29:08.401319 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3f174848-0115-4ff2-82cb-54b15fa6ae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a3370>]}
2021-12-03 23:29:08.433854 (Thread-31): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48db3141-2bfa-490e-afc3-322094d1824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a3e80>]}
2021-12-03 23:29:08.434066 (Thread-31): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:29:08.434809 (Thread-31): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:29:08.434951 (Thread-31): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:29:08.435022 (Thread-31): No nodes selected!
2021-12-03 23:29:08.436410 (Thread-31): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:32:26.541980 (Thread-32): handling status request
2021-12-03 23:32:26.544028 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '48db3141-2bfa-490e-afc3-322094d1824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a85e0>]}
2021-12-03 23:32:26.544507 (Thread-32): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:32:26.554329 (Thread-33): handling list request
2021-12-03 23:32:26.554525 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '48db3141-2bfa-490e-afc3-322094d1824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a8850>]}
2021-12-03 23:32:26.593093 (Thread-33): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88d4fe9b-8aca-4762-bf0a-868e04cf8452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687cccd0>]}
2021-12-03 23:32:26.593310 (Thread-33): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:32:26.597446 (Thread-33): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:32:26.597602 (Thread-33): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:32:26.597674 (Thread-33): No nodes selected!
2021-12-03 23:32:26.598998 (Thread-33): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:33:44.395738 (Thread-34): handling status request
2021-12-03 23:33:44.397754 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '88d4fe9b-8aca-4762-bf0a-868e04cf8452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a757610>]}
2021-12-03 23:33:44.422305 (Thread-34): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:33:44.427989 (Thread-35): handling list request
2021-12-03 23:33:44.428181 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '88d4fe9b-8aca-4762-bf0a-868e04cf8452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687ac2e0>]}
2021-12-03 23:33:44.461957 (Thread-35): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5423059-348c-4a08-be32-61775a04b1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687ae070>]}
2021-12-03 23:33:44.462176 (Thread-35): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:33:44.465949 (Thread-35): The selection criterion '+1638574075532/__unsaved/Statement' does not match any nodes
2021-12-03 23:33:44.466105 (Thread-35): The selection criterion '1.sql+' does not match any nodes
2021-12-03 23:33:44.466179 (Thread-35): No nodes selected!
2021-12-03 23:33:44.467474 (Thread-35): sending response (<Response 2287 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:33:52.892417 (Thread-36): handling status request
2021-12-03 23:33:52.892713 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f5423059-348c-4a08-be32-61775a04b1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687e1ee0>]}
2021-12-03 23:33:52.893180 (Thread-36): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:33:52.898620 (Thread-37): handling list request
2021-12-03 23:33:52.898814 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f5423059-348c-4a08-be32-61775a04b1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687a3d60>]}
2021-12-03 23:33:52.927914 (Thread-37): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc437f71-348c-4589-bb61-177f0dc91327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687ae850>]}
2021-12-03 23:33:52.928136 (Thread-37): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:33:52.935003 (Thread-37): sending response (<Response 5009 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:34:32.850961 (Thread-38): handling status request
2021-12-03 23:34:32.851241 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bc437f71-348c-4589-bb61-177f0dc91327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b2040>]}
2021-12-03 23:34:32.851688 (Thread-38): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:34:32.866348 (Thread-39): handling list request
2021-12-03 23:34:32.866549 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bc437f71-348c-4589-bb61-177f0dc91327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b23d0>]}
2021-12-03 23:34:32.906388 (Thread-39): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '480ef9b4-5de6-4a8e-843a-c9509ca63ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687aed60>]}
2021-12-03 23:34:32.906616 (Thread-39): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:34:32.910470 (Thread-39): sending response (<Response 5009 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:34:33.380606 (Thread-40): handling status request
2021-12-03 23:34:33.380883 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '480ef9b4-5de6-4a8e-843a-c9509ca63ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b2f10>]}
2021-12-03 23:34:33.381329 (Thread-40): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:34:33.386148 (Thread-41): handling list request
2021-12-03 23:34:33.386341 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '480ef9b4-5de6-4a8e-843a-c9509ca63ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b20a0>]}
2021-12-03 23:34:33.415877 (Thread-41): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '111df46b-e6e6-47a8-bf70-c34951c31ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68747ac0>]}
2021-12-03 23:34:33.416106 (Thread-41): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:34:33.420040 (Thread-41): sending response (<Response 5009 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:35:00.084725 (Thread-42): handling status request
2021-12-03 23:35:00.085017 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '111df46b-e6e6-47a8-bf70-c34951c31ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b20a0>]}
2021-12-03 23:35:00.085458 (Thread-42): sending response (<Response 1187 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:35:00.091269 (Thread-43): handling list request
2021-12-03 23:35:00.091456 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '111df46b-e6e6-47a8-bf70-c34951c31ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687b2dc0>]}
2021-12-03 23:35:00.126233 (Thread-43): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68755730>]}
2021-12-03 23:35:00.126457 (Thread-43): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:35:00.136896 (Thread-43): sending response (<Response 5009 bytes [200 OK]>) to 10.0.12.207
2021-12-03 23:35:02.635347 (Thread-44): handling status request
2021-12-03 23:35:02.635613 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758040>]}
2021-12-03 23:35:02.636125 (Thread-44): sending response (<Response 1209 bytes [200 OK]>) to 10.0.0.217
2021-12-03 23:35:03.090817 (Thread-45): handling compile_sql request
2021-12-03 23:35:03.091111 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758310>]}
2021-12-03 23:35:05.056708 (Thread-45): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-03 23:35:05.067890 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:05.081554 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e215f1a-390d-4f43-a170-5595d40c487e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdfad1e80>]}
2021-12-03 23:35:05.081819 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:35:05.082186 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:05.082288 (Thread-1): Compiling rpc.my_new_project.request
2021-12-03 23:35:05.084009 (Thread-1): finished collecting timing info
2021-12-03 23:35:05.084133 (Thread-1): finished collecting timing info
2021-12-03 23:35:05.510240 (Thread-46): handling poll request
2021-12-03 23:35:05.510580 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687586a0>]}
2021-12-03 23:35:05.511686 (Thread-46): sending response (<Response 5279 bytes [200 OK]>) to 10.0.13.223
2021-12-03 23:35:22.999247 (Thread-47): handling status request
2021-12-03 23:35:22.999538 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758a90>]}
2021-12-03 23:35:23.000021 (Thread-47): sending response (<Response 1209 bytes [200 OK]>) to 10.0.26.3
2021-12-03 23:35:23.431194 (Thread-48): handling run_sql request
2021-12-03 23:35:23.431503 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758d60>]}
2021-12-03 23:35:25.382907 (Thread-48): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-03 23:35:25.394068 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:25.407830 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a027f31-611d-445a-9a95-6ae3b8665b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37ced1f70>]}
2021-12-03 23:35:25.408067 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:35:25.408465 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:25.408604 (Thread-1): Compiling rpc.my_new_project.request
2021-12-03 23:35:25.410369 (Thread-1): finished collecting timing info
2021-12-03 23:35:25.411027 (Thread-1): Using snowflake connection "rpc.my_new_project.request".
2021-12-03 23:35:25.411094 (Thread-1): On rpc.my_new_project.request: -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
limit 500
/* limit added automatically by dbt cloud */
2021-12-03 23:35:25.411149 (Thread-1): Opening a new connection, currently in state init
2021-12-03 23:35:25.805093 (Thread-49): handling poll request
2021-12-03 23:35:25.805376 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6876ed30>]}
2021-12-03 23:35:25.806195 (Thread-49): sending response (<Response 3477 bytes [200 OK]>) to 10.0.22.219
2021-12-03 23:35:26.962568 (Thread-1): Snowflake query id: 01a0b607-3200-95c3-0000-00008ef9191d
2021-12-03 23:35:26.962761 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.
2021-12-03 23:35:26.962895 (Thread-1): finished collecting timing info
2021-12-03 23:35:26.963045 (Thread-1): On rpc.my_new_project.request: Close
2021-12-03 23:35:27.271088 (Thread-50): handling poll request
2021-12-03 23:35:27.271431 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6876ea00>]}
2021-12-03 23:35:27.271936 (Thread-50): sending response (<Response 1714 bytes [200 OK]>) to 10.0.37.206
2021-12-03 23:35:27.442978 (Thread-1): Got an exception: Database Error
  002003 (02000): SQL compilation error:
  Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (02000): SQL compilation error:
  Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.
2021-12-03 23:35:27.443941 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.", 'raw_sql': "-- Use the `ref` function to select from other models\n\nselect *\nfrom {{ ref('my_first_dbt_model') }}\nwhere id = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': '-- Use the `ref` function to select from other models\n\nselect *\nfrom raw.dbt_pstulnikov.my_first_dbt_model\nwhere id = 1\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'RAW.DBT_PSTULNIKOV' does not exist or not authorized.", 'raw_sql': "-- Use the `ref` function to select from other models\n\nselect *\nfrom {{ ref('my_first_dbt_model') }}\nwhere id = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': '-- Use the `ref` function to select from other models\n\nselect *\nfrom raw.dbt_pstulnikov.my_first_dbt_model\nwhere id = 1\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-12-03 23:35:28.745239 (Thread-51): handling poll request
2021-12-03 23:35:28.745549 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687772e0>]}
2021-12-03 23:35:28.746169 (Thread-51): sending response (<Response 10159 bytes [200 OK]>) to 10.0.36.143
2021-12-03 23:39:58.001601 (Thread-52): handling status request
2021-12-03 23:39:58.003466 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68777760>]}
2021-12-03 23:39:58.004032 (Thread-52): sending response (<Response 1209 bytes [200 OK]>) to 10.0.26.3
2021-12-03 23:39:58.527367 (Thread-53): handling compile_sql request
2021-12-03 23:39:58.527648 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc687779d0>]}
2021-12-03 23:40:00.478384 (Thread-53): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-03 23:40:00.488926 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:40:00.506156 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7414be6b-c40f-4667-a54f-66feacf8df67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10baa4de20>]}
2021-12-03 23:40:00.506388 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-03 23:40:00.506763 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-03 23:40:00.506865 (Thread-1): Compiling rpc.my_new_project.request
2021-12-03 23:40:00.508589 (Thread-1): finished collecting timing info
2021-12-03 23:40:00.508701 (Thread-1): finished collecting timing info
2021-12-03 23:40:00.922741 (Thread-54): handling poll request
2021-12-03 23:40:00.923041 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '354c1c0c-8f6f-4a78-b66c-33e0c9672e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68758040>]}
2021-12-03 23:40:00.924074 (Thread-54): sending response (<Response 5279 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:43:04.130980 (MainThread): Running with dbt=0.21.0
2021-12-05 22:43:04.490266 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-12-05 22:43:04.498802 (MainThread): Tracking: tracking
2021-12-05 22:43:04.499041 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fe626580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7207a8f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c92ec6a0>]}
2021-12-05 22:43:04.500216 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2021-12-05 22:43:04.504571 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2021-12-05 22:43:04.504725 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-12-05 22:43:04.554010 (Thread-12): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-05 22:43:04.554302 (Thread-12): Partial parsing enabled, no changes found, skipping parsing
2021-12-05 22:43:04.560095 (Thread-12): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c92a4d30>]}
2021-12-05 22:43:07.841226 (Thread-13): handling status request
2021-12-05 22:43:07.841526 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922a400>]}
2021-12-05 22:43:07.842123 (Thread-13): sending response (<Response 1209 bytes [200 OK]>) to 10.0.2.25
2021-12-05 22:43:07.852532 (Thread-14): handling status request
2021-12-05 22:43:07.855363 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922a670>]}
2021-12-05 22:43:07.855736 (Thread-14): sending response (<Response 1209 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:43:07.902324 (Thread-15): handling status request
2021-12-05 22:43:07.902535 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922a850>]}
2021-12-05 22:43:07.902884 (Thread-15): sending response (<Response 1209 bytes [200 OK]>) to 10.0.6.10
2021-12-05 22:43:07.907981 (Thread-16): handling ps request
2021-12-05 22:43:07.908171 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922a640>]}
2021-12-05 22:43:07.908528 (Thread-16): sending response (<Response 105 bytes [200 OK]>) to 10.0.0.217
2021-12-05 22:43:09.567763 (Thread-17): handling status request
2021-12-05 22:43:09.568068 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922aa30>]}
2021-12-05 22:43:09.568539 (Thread-17): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:43:09.574462 (Thread-18): handling list request
2021-12-05 22:43:09.574664 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b35eb01-5f05-4c4c-ad44-e826cc327a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c922aa90>]}
2021-12-05 22:43:09.644219 (Thread-21): sending response (<Response 7310 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:43:09.645235 (Thread-22): sending response (<Response 214 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:43:10.997650 (Thread-23): handling status request
2021-12-05 22:43:10.997949 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f8f8dbf4-5270-4f1a-8f54-2c63aff9fe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c9256370>]}
2021-12-05 22:43:10.998423 (Thread-23): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:43:11.004059 (Thread-24): handling list request
2021-12-05 22:43:11.004257 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f8f8dbf4-5270-4f1a-8f54-2c63aff9fe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81c98b0>]}
2021-12-05 22:43:11.036537 (Thread-24): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5e85ce6-e2da-4ad1-9672-e48d8f9f74a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81d75e0>]}
2021-12-05 22:43:11.036768 (Thread-24): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:43:11.040886 (Thread-24): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:44:55.556751 (Thread-25): handling status request
2021-12-05 22:44:55.559266 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd5e85ce6-e2da-4ad1-9672-e48d8f9f74a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81991f0>]}
2021-12-05 22:44:55.559730 (Thread-25): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:44:55.571459 (Thread-26): handling list request
2021-12-05 22:44:55.571655 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd5e85ce6-e2da-4ad1-9672-e48d8f9f74a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81994c0>]}
2021-12-05 22:44:55.607174 (Thread-26): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb82495d-5468-4e69-8f40-fba5379126b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81998b0>]}
2021-12-05 22:44:55.607408 (Thread-26): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:44:55.617365 (Thread-26): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:00.653820 (Thread-27): handling status request
2021-12-05 22:45:00.654121 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bb82495d-5468-4e69-8f40-fba5379126b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81d7ca0>]}
2021-12-05 22:45:00.654571 (Thread-27): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:00.664436 (Thread-28): handling list request
2021-12-05 22:45:00.664672 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bb82495d-5468-4e69-8f40-fba5379126b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81d7f40>]}
2021-12-05 22:45:00.697074 (Thread-28): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57b04557-6659-4417-9f43-cbc4655e370c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81b05b0>]}
2021-12-05 22:45:00.697317 (Thread-28): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:00.701477 (Thread-28): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:25.455191 (Thread-29): handling status request
2021-12-05 22:45:25.455489 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '57b04557-6659-4417-9f43-cbc4655e370c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81c9e50>]}
2021-12-05 22:45:25.455950 (Thread-29): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:25.462065 (Thread-30): handling list request
2021-12-05 22:45:25.462264 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '57b04557-6659-4417-9f43-cbc4655e370c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8199f40>]}
2021-12-05 22:45:25.502703 (Thread-30): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11085b92-60d5-4b56-aaa7-8201d34a26df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bc040>]}
2021-12-05 22:45:25.502949 (Thread-30): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:25.506920 (Thread-30): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:30.357136 (Thread-31): handling status request
2021-12-05 22:45:30.357474 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11085b92-60d5-4b56-aaa7-8201d34a26df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bca60>]}
2021-12-05 22:45:30.357961 (Thread-31): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:30.364777 (Thread-32): handling list request
2021-12-05 22:45:30.365017 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11085b92-60d5-4b56-aaa7-8201d34a26df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bcc70>]}
2021-12-05 22:45:30.396345 (Thread-32): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '019abfb7-96e0-45db-8a98-1c2228421193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bc640>]}
2021-12-05 22:45:30.429746 (Thread-32): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:30.432940 (Thread-32): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:39.218786 (Thread-33): handling status request
2021-12-05 22:45:39.221043 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '019abfb7-96e0-45db-8a98-1c2228421193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81b0670>]}
2021-12-05 22:45:39.221523 (Thread-33): sending response (<Response 1187 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:39.227743 (Thread-34): handling list request
2021-12-05 22:45:39.227944 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '019abfb7-96e0-45db-8a98-1c2228421193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c814cd60>]}
2021-12-05 22:45:39.255802 (Thread-34): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8156460>]}
2021-12-05 22:45:39.256146 (Thread-34): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:39.261789 (Thread-34): sending response (<Response 5009 bytes [200 OK]>) to 10.0.20.115
2021-12-05 22:45:41.326649 (Thread-35): handling status request
2021-12-05 22:45:41.326939 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bc8b0>]}
2021-12-05 22:45:41.327383 (Thread-35): sending response (<Response 1209 bytes [200 OK]>) to 10.0.6.71
2021-12-05 22:45:41.757858 (Thread-36): handling run_sql request
2021-12-05 22:45:41.758161 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bcaf0>]}
2021-12-05 22:45:43.698967 (Thread-36): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:45:43.710015 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 22:45:43.722934 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68ed090a-4200-40f6-8919-6f1d1144ce30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6b37efa0>]}
2021-12-05 22:45:43.723168 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:45:43.723526 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 22:45:43.723627 (Thread-1): Compiling rpc.my_new_project.request
2021-12-05 22:45:43.724569 (Thread-1): finished collecting timing info
2021-12-05 22:45:43.725060 (Thread-1): Using snowflake connection "rpc.my_new_project.request".
2021-12-05 22:45:43.725120 (Thread-1): On rpc.my_new_project.request: select * from raw.stripe.payment
limit 500
/* limit added automatically by dbt cloud */
2021-12-05 22:45:43.725174 (Thread-1): Opening a new connection, currently in state init
2021-12-05 22:45:44.142245 (Thread-37): handling poll request
2021-12-05 22:45:44.142553 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81642e0>]}
2021-12-05 22:45:44.143375 (Thread-37): sending response (<Response 3385 bytes [200 OK]>) to 10.0.2.25
2021-12-05 22:45:45.650185 (Thread-38): handling poll request
2021-12-05 22:45:45.650501 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81643d0>]}
2021-12-05 22:45:45.650969 (Thread-38): sending response (<Response 399 bytes [200 OK]>) to 10.0.38.50
2021-12-05 22:45:46.084078 (Thread-1): SQL status: SUCCESS 120 in 2.36 seconds
2021-12-05 22:45:46.088882 (Thread-1): finished collecting timing info
2021-12-05 22:45:46.089073 (Thread-1): On rpc.my_new_project.request: Close
2021-12-05 22:45:47.143012 (Thread-39): handling poll request
2021-12-05 22:45:47.143327 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8164bb0>]}
2021-12-05 22:45:47.144996 (Thread-39): sending response (<Response 14398 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:45:57.244744 (Thread-40): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 22:45:57.245090 (Thread-40): Partial parsing: updated file: my_new_project://models/example/my_first_dbt_model.sql
2021-12-05 22:45:57.255181 (Thread-40): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:45:57.338506 (Thread-40): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8126550>]}
2021-12-05 22:45:58.031248 (Thread-41): handling status request
2021-12-05 22:45:58.031565 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c80be130>]}
2021-12-05 22:45:58.032103 (Thread-41): sending response (<Response 1546 bytes [200 OK]>) to 10.0.38.50
2021-12-05 22:45:58.038441 (Thread-42): handling status request
2021-12-05 22:45:58.038639 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c92ed310>]}
2021-12-05 22:45:58.039015 (Thread-42): sending response (<Response 1546 bytes [200 OK]>) to 10.0.3.73
2021-12-05 22:46:29.441069 (Thread-43): handling status request
2021-12-05 22:46:29.443467 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81262e0>]}
2021-12-05 22:46:29.443971 (Thread-43): sending response (<Response 1546 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:46:29.810187 (Thread-44): handling status request
2021-12-05 22:46:29.810431 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8126520>]}
2021-12-05 22:46:29.810872 (Thread-44): sending response (<Response 1546 bytes [200 OK]>) to 10.0.38.70
2021-12-05 22:46:29.883834 (Thread-45): handling cli_args request
2021-12-05 22:46:29.884057 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81268e0>]}
2021-12-05 22:46:29.895236 (Thread-45): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:46:31.814347 (Thread-45): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-05 22:46:31.850296 (MainThread): Partial parsing not enabled
2021-12-05 22:46:31.897789 (MainThread): Parsing macros/catalog.sql
2021-12-05 22:46:31.899714 (MainThread): Parsing macros/adapters.sql
2021-12-05 22:46:31.934128 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 22:46:31.937782 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 22:46:31.940986 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 22:46:31.945260 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 22:46:31.946499 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 22:46:31.954602 (MainThread): Parsing macros/core.sql
2021-12-05 22:46:31.958137 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 22:46:31.964425 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 22:46:31.973944 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 22:46:31.980597 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 22:46:31.984282 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 22:46:32.005768 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 22:46:32.021992 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 22:46:32.023533 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 22:46:32.053144 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 22:46:32.060075 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 22:46:32.073245 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 22:46:32.091855 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 22:46:32.101385 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 22:46:32.103050 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 22:46:32.104425 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 22:46:32.112343 (MainThread): Parsing macros/etc/query.sql
2021-12-05 22:46:32.113316 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 22:46:32.114949 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 22:46:32.116381 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 22:46:32.118740 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 22:46:32.120103 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 22:46:32.172675 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 22:46:32.174758 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 22:46:32.175836 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 22:46:32.177358 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 22:46:32.295373 (Thread-46): handling poll request
2021-12-05 22:46:32.295664 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8042400>]}
2021-12-05 22:46:32.296725 (Thread-46): sending response (<Response 9652 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:46:32.361464 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:46:32.373894 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:46:32.452080 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '494035c8-8b8a-4026-a2f5-c84f8f2d7aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbdb46280>]}
2021-12-05 22:46:32.483436 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '494035c8-8b8a-4026-a2f5-c84f8f2d7aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbdb464c0>]}
2021-12-05 22:46:32.483637 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:46:32.484763 (MainThread): 
2021-12-05 22:46:32.484965 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:46:32.485709 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 22:46:32.497621 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 22:46:32.497692 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 22:46:32.497747 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 22:46:33.899110 (Thread-47): handling poll request
2021-12-05 22:46:33.899437 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c807c400>]}
2021-12-05 22:46:33.900016 (Thread-47): sending response (<Response 4009 bytes [200 OK]>) to 10.0.26.3
2021-12-05 22:46:34.023082 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.53 seconds
2021-12-05 22:46:34.024954 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 22:46:34.477672 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:46:34.484444 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:46:34.484558 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 22:46:34.484625 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 22:46:35.380173 (Thread-48): handling poll request
2021-12-05 22:46:35.380484 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c807cb50>]}
2021-12-05 22:46:35.381030 (Thread-48): sending response (<Response 2221 bytes [200 OK]>) to 10.0.41.241
2021-12-05 22:46:35.887881 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.40 seconds
2021-12-05 22:46:35.889072 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 22:46:36.339771 (MainThread): 22:46:36 | Concurrency: 4 threads (target='default')
2021-12-05 22:46:36.339916 (MainThread): 22:46:36 | 
2021-12-05 22:46:36.341863 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 22:46:36.342140 (Thread-1): 22:46:36 | 1 of 2 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 22:46:36.342366 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:46:36.342466 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 22:46:36.345006 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:46:36.384669 (Thread-1): finished collecting timing info
2021-12-05 22:46:36.405055 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:46:36.446795 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:46:36.446875 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment;
2021-12-05 22:46:36.446936 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 22:46:36.874488 (Thread-49): handling poll request
2021-12-05 22:46:36.874779 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c80771c0>]}
2021-12-05 22:46:36.875385 (Thread-49): sending response (<Response 5643 bytes [200 OK]>) to 10.0.39.19
2021-12-05 22:46:37.713105 (Thread-1): Snowflake query id: 01a0c116-3200-95c4-0000-00008ef92959
2021-12-05 22:46:37.713237 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 2 at position 36 unexpected ';'.
2021-12-05 22:46:37.713372 (Thread-1): finished collecting timing info
2021-12-05 22:46:37.713479 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 22:46:38.243834 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 36 unexpected ';'.
  compiled SQL at target/run/my_new_project/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 36 unexpected ';'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 36 unexpected ';'.
  compiled SQL at target/run/my_new_project/models/example/my_first_dbt_model.sql
2021-12-05 22:46:38.244714 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494035c8-8b8a-4026-a2f5-c84f8f2d7aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbcd28130>]}
2021-12-05 22:46:38.245059 (Thread-1): 22:46:38 | 1 of 2 ERROR creating view model dbt_pstulnikov.my_first_dbt_model... [ERROR in 1.90s]
2021-12-05 22:46:38.245146 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 22:46:38.246243 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 22:46:38.246408 (Thread-3): 22:46:38 | 2 of 2 SKIP relation dbt_pstulnikov.my_second_dbt_model.............. [SKIP]
2021-12-05 22:46:38.246488 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 22:46:38.247704 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:46:38.247983 (MainThread): 22:46:38 | 
2021-12-05 22:46:38.248049 (MainThread): 22:46:38 | Finished running 2 view models in 5.76s.
2021-12-05 22:46:38.248096 (MainThread): Connection 'master' was properly closed.
2021-12-05 22:46:38.248135 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:46:38.300448 (MainThread): 
2021-12-05 22:46:38.300568 (MainThread): Completed with 1 error and 0 warnings:
2021-12-05 22:46:38.300625 (MainThread): 
2021-12-05 22:46:38.300676 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-12-05 22:46:38.300718 (MainThread):   001003 (42000): SQL compilation error:
2021-12-05 22:46:38.300754 (MainThread):   syntax error line 2 at position 36 unexpected ';'.
2021-12-05 22:46:38.300790 (MainThread):   compiled SQL at target/run/my_new_project/models/example/my_first_dbt_model.sql
2021-12-05 22:46:38.300833 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-12-05 22:46:38.389216 (Thread-50): handling poll request
2021-12-05 22:46:38.389522 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7c2c40>]}
2021-12-05 22:46:38.390264 (Thread-50): sending response (<Response 15551 bytes [200 OK]>) to 10.0.38.50
2021-12-05 22:46:39.917285 (Thread-51): handling poll request
2021-12-05 22:46:39.917608 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7c2be0>]}
2021-12-05 22:46:39.918560 (Thread-51): sending response (<Response 4340 bytes [200 OK]>) to 10.0.2.25
2021-12-05 22:46:40.810011 (Thread-52): handling status request
2021-12-05 22:46:40.810320 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7c2d00>]}
2021-12-05 22:46:40.810818 (Thread-52): sending response (<Response 1546 bytes [200 OK]>) to 10.0.3.73
2021-12-05 22:46:40.868720 (Thread-53): handling status request
2021-12-05 22:46:40.868959 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7c90d0>]}
2021-12-05 22:46:40.869366 (Thread-53): sending response (<Response 1546 bytes [200 OK]>) to 10.0.41.241
2021-12-05 22:46:56.982568 (Thread-54): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 22:46:56.982960 (Thread-54): Partial parsing: updated file: my_new_project://models/example/my_first_dbt_model.sql
2021-12-05 22:46:56.986706 (Thread-54): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:46:57.038384 (Thread-54): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6fff10>]}
2021-12-05 22:46:57.780284 (Thread-55): handling status request
2021-12-05 22:46:57.780647 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8199d00>]}
2021-12-05 22:46:57.781140 (Thread-55): sending response (<Response 1546 bytes [200 OK]>) to 10.0.0.217
2021-12-05 22:46:57.844244 (Thread-56): handling status request
2021-12-05 22:46:57.844477 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7aff10>]}
2021-12-05 22:46:57.844947 (Thread-56): sending response (<Response 1546 bytes [200 OK]>) to 10.0.39.19
2021-12-05 22:47:00.747125 (Thread-57): handling status request
2021-12-05 22:47:00.747448 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7afee0>]}
2021-12-05 22:47:00.747933 (Thread-57): sending response (<Response 1546 bytes [200 OK]>) to 10.0.38.70
2021-12-05 22:47:01.104209 (Thread-58): handling status request
2021-12-05 22:47:01.104553 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7af340>]}
2021-12-05 22:47:01.105052 (Thread-58): sending response (<Response 1546 bytes [200 OK]>) to 10.0.6.10
2021-12-05 22:47:01.183659 (Thread-59): handling cli_args request
2021-12-05 22:47:01.183904 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc7af8e0>]}
2021-12-05 22:47:01.195135 (Thread-59): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:47:03.137299 (Thread-59): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.3
2021-12-05 22:47:03.175639 (MainThread): Partial parsing not enabled
2021-12-05 22:47:03.211345 (MainThread): Parsing macros/catalog.sql
2021-12-05 22:47:03.213309 (MainThread): Parsing macros/adapters.sql
2021-12-05 22:47:03.247353 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 22:47:03.250968 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 22:47:03.254206 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 22:47:03.258519 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 22:47:03.259747 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 22:47:03.267969 (MainThread): Parsing macros/core.sql
2021-12-05 22:47:03.271552 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 22:47:03.277877 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 22:47:03.287374 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 22:47:03.294138 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 22:47:03.297733 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 22:47:03.319701 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 22:47:03.336040 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 22:47:03.337597 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 22:47:03.367190 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 22:47:03.374148 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 22:47:03.387258 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 22:47:03.405771 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 22:47:03.415282 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 22:47:03.416997 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 22:47:03.418349 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 22:47:03.426261 (MainThread): Parsing macros/etc/query.sql
2021-12-05 22:47:03.427233 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 22:47:03.428877 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 22:47:03.430311 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 22:47:03.432673 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 22:47:03.434068 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 22:47:03.486819 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 22:47:03.488906 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 22:47:03.489982 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 22:47:03.491475 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 22:47:03.614659 (Thread-60): handling poll request
2021-12-05 22:47:03.614999 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc76c790>]}
2021-12-05 22:47:03.616055 (Thread-60): sending response (<Response 9652 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:47:03.675608 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:47:03.688584 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:47:03.767356 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90247053-ae40-4076-9a0a-64b8fad42b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83877c8a00>]}
2021-12-05 22:47:03.796627 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90247053-ae40-4076-9a0a-64b8fad42b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838c069070>]}
2021-12-05 22:47:03.796832 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:47:03.797909 (MainThread): 
2021-12-05 22:47:03.798118 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:47:03.798908 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 22:47:03.810884 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 22:47:03.810955 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 22:47:03.811011 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 22:47:05.097623 (Thread-61): handling poll request
2021-12-05 22:47:05.097938 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc773c10>]}
2021-12-05 22:47:05.126647 (Thread-61): sending response (<Response 4009 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:47:05.336302 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.53 seconds
2021-12-05 22:47:05.338213 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 22:47:05.797376 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:47:05.804397 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:47:05.804523 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 22:47:05.804593 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 22:47:06.597176 (Thread-62): handling poll request
2021-12-05 22:47:06.597536 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c8119ac0>]}
2021-12-05 22:47:06.598080 (Thread-62): sending response (<Response 2221 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:47:07.094843 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.29 seconds
2021-12-05 22:47:07.096058 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 22:47:07.549925 (MainThread): 22:47:07 | Concurrency: 4 threads (target='default')
2021-12-05 22:47:07.550071 (MainThread): 22:47:07 | 
2021-12-05 22:47:07.552041 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 22:47:07.552328 (Thread-1): 22:47:07 | 1 of 2 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 22:47:07.552581 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:47:07.552683 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 22:47:07.555214 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:47:07.571712 (Thread-1): finished collecting timing info
2021-12-05 22:47:07.592218 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:47:07.608917 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:47:07.609004 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment
  );
2021-12-05 22:47:07.609063 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 22:47:08.156071 (Thread-63): handling poll request
2021-12-05 22:47:08.156385 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc726dc0>]}
2021-12-05 22:47:08.157055 (Thread-63): sending response (<Response 5648 bytes [200 OK]>) to 10.0.38.70
2021-12-05 22:47:09.138274 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2021-12-05 22:47:09.144905 (Thread-1): finished collecting timing info
2021-12-05 22:47:09.145041 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 22:47:09.606377 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90247053-ae40-4076-9a0a-64b8fad42b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838c05ab50>]}
2021-12-05 22:47:09.606817 (Thread-1): 22:47:09 | 1 of 2 OK created view model dbt_pstulnikov.my_first_dbt_model....... [SUCCESS 1 in 2.05s]
2021-12-05 22:47:09.606907 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 22:47:09.607794 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 22:47:09.608022 (Thread-3): 22:47:09 | 2 of 2 START view model dbt_pstulnikov.my_second_dbt_model........... [RUN]
2021-12-05 22:47:09.608271 (Thread-3): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:47:09.608347 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2021-12-05 22:47:09.611080 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 22:47:09.614076 (Thread-64): handling poll request
2021-12-05 22:47:09.614305 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc707be0>]}
2021-12-05 22:47:09.614880 (Thread-64): sending response (<Response 4882 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:47:09.621670 (Thread-3): finished collecting timing info
2021-12-05 22:47:09.623285 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 22:47:09.634657 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:47:09.634738 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
  );
2021-12-05 22:47:09.634797 (Thread-3): Opening a new connection, currently in state init
2021-12-05 22:47:11.027182 (Thread-3): SQL status: SUCCESS 1 in 1.39 seconds
2021-12-05 22:47:11.028607 (Thread-3): finished collecting timing info
2021-12-05 22:47:11.028749 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2021-12-05 22:47:11.049153 (Thread-65): handling poll request
2021-12-05 22:47:11.049435 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc765040>]}
2021-12-05 22:47:11.050021 (Thread-65): sending response (<Response 3649 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:47:11.488116 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90247053-ae40-4076-9a0a-64b8fad42b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8386948d30>]}
2021-12-05 22:47:11.488534 (Thread-3): 22:47:11 | 2 of 2 OK created view model dbt_pstulnikov.my_second_dbt_model...... [SUCCESS 1 in 1.88s]
2021-12-05 22:47:11.488626 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 22:47:11.490152 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:47:11.490435 (MainThread): 22:47:11 | 
2021-12-05 22:47:11.490502 (MainThread): 22:47:11 | Finished running 2 view models in 7.69s.
2021-12-05 22:47:11.490550 (MainThread): Connection 'master' was properly closed.
2021-12-05 22:47:11.490590 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:47:11.490625 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-12-05 22:47:11.547988 (MainThread): 
2021-12-05 22:47:11.548098 (MainThread): Completed successfully
2021-12-05 22:47:11.548160 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-12-05 22:47:12.487895 (Thread-66): handling poll request
2021-12-05 22:47:12.488208 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc765e20>]}
2021-12-05 22:47:12.489275 (Thread-66): sending response (<Response 9458 bytes [200 OK]>) to 10.0.6.71
2021-12-05 22:47:13.417524 (Thread-67): handling status request
2021-12-05 22:47:13.417850 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc766eb0>]}
2021-12-05 22:47:13.427676 (Thread-67): sending response (<Response 1546 bytes [200 OK]>) to 10.0.30.196
2021-12-05 22:47:13.459489 (Thread-68): handling status request
2021-12-05 22:47:13.459739 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc766fd0>]}
2021-12-05 22:47:13.460189 (Thread-68): sending response (<Response 1546 bytes [200 OK]>) to 10.0.3.73
2021-12-05 22:56:17.072861 (Thread-69): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-05 22:56:17.074922 (Thread-69): Partial parsing: added file: my_new_project://models/dim_customers.sql
2021-12-05 22:56:17.078484 (Thread-69): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:56:17.121262 (Thread-69): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc72efd0>]}
2021-12-05 22:56:18.112791 (Thread-70): handling status request
2021-12-05 22:56:18.113084 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc72ee50>]}
2021-12-05 22:56:18.113560 (Thread-70): sending response (<Response 1526 bytes [200 OK]>) to 10.0.30.196
2021-12-05 22:56:18.140045 (Thread-71): handling status request
2021-12-05 22:56:18.140245 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b6340>]}
2021-12-05 22:56:18.140627 (Thread-71): sending response (<Response 1526 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:56:44.460888 (Thread-72): handling status request
2021-12-05 22:56:44.461184 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b6520>]}
2021-12-05 22:56:44.461641 (Thread-72): sending response (<Response 1526 bytes [200 OK]>) to 10.0.2.25
2021-12-05 22:56:44.908827 (Thread-73): handling run_sql request
2021-12-05 22:56:44.909140 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b6970>]}
2021-12-05 22:56:44.910553 (Thread-73): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 22:56:46.863946 (Thread-73): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-05 22:56:46.874992 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 22:56:46.888038 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47d84076-8232-4bef-a0c9-8910d7f45637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5279a5730>]}
2021-12-05 22:56:46.888283 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:56:46.888670 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 22:56:46.888775 (Thread-1): Compiling rpc.my_new_project.request
2021-12-05 22:56:46.889719 (Thread-1): finished collecting timing info
2021-12-05 22:56:46.891021 (Thread-1): Using snowflake connection "rpc.my_new_project.request".
2021-12-05 22:56:46.891086 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-05 22:56:46.891142 (Thread-1): Opening a new connection, currently in state init
2021-12-05 22:56:47.307137 (Thread-74): handling poll request
2021-12-05 22:56:47.307491 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b6e80>]}
2021-12-05 22:56:47.308391 (Thread-74): sending response (<Response 4291 bytes [200 OK]>) to 10.0.3.73
2021-12-05 22:56:48.572604 (Thread-1): SQL status: SUCCESS 100 in 1.68 seconds
2021-12-05 22:56:48.576641 (Thread-1): finished collecting timing info
2021-12-05 22:56:48.576838 (Thread-1): On rpc.my_new_project.request: Close
2021-12-05 22:56:48.786577 (Thread-75): handling poll request
2021-12-05 22:56:48.786897 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b40d0>]}
2021-12-05 22:56:48.787440 (Thread-75): sending response (<Response 1333 bytes [200 OK]>) to 10.0.37.206
2021-12-05 22:56:50.264609 (Thread-76): handling poll request
2021-12-05 22:56:50.264930 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc6b44f0>]}
2021-12-05 22:56:50.266224 (Thread-76): sending response (<Response 11265 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:57:11.737818 (Thread-77): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 22:57:11.738140 (Thread-77): Partial parsing: updated file: my_new_project://models/dim_customers.sql
2021-12-05 22:57:11.742297 (Thread-77): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:57:11.787215 (Thread-77): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f47f0>]}
2021-12-05 22:57:12.541430 (Thread-78): handling status request
2021-12-05 22:57:12.541741 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f4940>]}
2021-12-05 22:57:12.542237 (Thread-78): sending response (<Response 1528 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:57:12.573084 (Thread-79): handling status request
2021-12-05 22:57:12.573338 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f44f0>]}
2021-12-05 22:57:12.573805 (Thread-79): sending response (<Response 1528 bytes [200 OK]>) to 10.0.39.19
2021-12-05 22:57:47.829256 (Thread-80): handling status request
2021-12-05 22:57:47.829590 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f4ca0>]}
2021-12-05 22:57:47.830052 (Thread-80): sending response (<Response 1528 bytes [200 OK]>) to 10.0.0.217
2021-12-05 22:57:48.183306 (Thread-81): handling status request
2021-12-05 22:57:48.183560 (Thread-81): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f48e0>]}
2021-12-05 22:57:48.184008 (Thread-81): sending response (<Response 1528 bytes [200 OK]>) to 10.0.38.70
2021-12-05 22:57:48.284957 (Thread-82): handling cli_args request
2021-12-05 22:57:48.285388 (Thread-82): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc639610>]}
2021-12-05 22:57:48.295523 (Thread-82): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 22:57:50.232424 (Thread-82): sending response (<Response 138 bytes [200 OK]>) to 10.0.13.223
2021-12-05 22:57:50.269871 (MainThread): Partial parsing not enabled
2021-12-05 22:57:50.309314 (MainThread): Parsing macros/catalog.sql
2021-12-05 22:57:50.311230 (MainThread): Parsing macros/adapters.sql
2021-12-05 22:57:50.345164 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 22:57:50.348774 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 22:57:50.351905 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 22:57:50.356083 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 22:57:50.357341 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 22:57:50.365502 (MainThread): Parsing macros/core.sql
2021-12-05 22:57:50.369015 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 22:57:50.375268 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 22:57:50.384703 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 22:57:50.391331 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 22:57:50.394992 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 22:57:50.416557 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 22:57:50.432736 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 22:57:50.434285 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 22:57:50.463760 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 22:57:50.470653 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 22:57:50.483724 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 22:57:50.502213 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 22:57:50.511630 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 22:57:50.513299 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 22:57:50.514665 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 22:57:50.522513 (MainThread): Parsing macros/etc/query.sql
2021-12-05 22:57:50.523446 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 22:57:50.525097 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 22:57:50.526529 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 22:57:50.528862 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 22:57:50.530228 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 22:57:50.582532 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 22:57:50.584627 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 22:57:50.585710 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 22:57:50.587207 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 22:57:50.676399 (Thread-83): handling poll request
2021-12-05 22:57:50.676705 (Thread-83): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f4f70>]}
2021-12-05 22:57:50.677736 (Thread-83): sending response (<Response 9652 bytes [200 OK]>) to 10.0.19.103
2021-12-05 22:57:50.769069 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:57:50.780668 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:57:50.784156 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:57:50.867075 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8225eca00>]}
2021-12-05 22:57:50.898261 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc822596ac0>]}
2021-12-05 22:57:50.898460 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 22:57:50.899590 (MainThread): 
2021-12-05 22:57:50.899792 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:57:50.900589 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 22:57:50.912225 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 22:57:50.912294 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 22:57:50.912348 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 22:57:52.234436 (Thread-84): handling poll request
2021-12-05 22:57:52.234757 (Thread-84): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f21f0>]}
2021-12-05 22:57:52.235341 (Thread-84): sending response (<Response 4316 bytes [200 OK]>) to 10.0.0.217
2021-12-05 22:57:52.417579 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.51 seconds
2021-12-05 22:57:52.419430 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 22:57:52.879514 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:57:52.886498 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 22:57:52.886603 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 22:57:52.886668 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 22:57:53.673719 (Thread-85): handling poll request
2021-12-05 22:57:53.674044 (Thread-85): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5f2dc0>]}
2021-12-05 22:57:53.674568 (Thread-85): sending response (<Response 2221 bytes [200 OK]>) to 10.0.22.219
2021-12-05 22:57:54.300281 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.41 seconds
2021-12-05 22:57:54.301699 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 22:57:54.757623 (MainThread): 22:57:54 | Concurrency: 4 threads (target='default')
2021-12-05 22:57:54.757759 (MainThread): 22:57:54 | 
2021-12-05 22:57:54.759681 (Thread-1): Began running node model.my_new_project.dim_customers
2021-12-05 22:57:54.759970 (Thread-1): 22:57:54 | 1 of 3 START view model dbt_pstulnikov.dim_customers................. [RUN]
2021-12-05 22:57:54.760202 (Thread-1): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:57:54.760304 (Thread-1): Compiling model.my_new_project.dim_customers
2021-12-05 22:57:54.761158 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 22:57:54.761374 (Thread-2): 22:57:54 | 2 of 3 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 22:57:54.761600 (Thread-2): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:57:54.761671 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 22:57:54.762767 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:57:54.763939 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 22:57:54.773849 (Thread-1): finished collecting timing info
2021-12-05 22:57:54.784281 (Thread-2): finished collecting timing info
2021-12-05 22:57:54.804052 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 22:57:54.805489 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 22:57:54.817619 (Thread-1): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 22:57:54.817702 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */

  create or replace  view raw.dbt_pstulnikov.dim_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
2021-12-05 22:57:54.817762 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 22:57:54.823131 (Thread-2): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 22:57:54.823215 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment
  );
2021-12-05 22:57:54.823270 (Thread-2): Opening a new connection, currently in state init
2021-12-05 22:57:55.122824 (Thread-86): handling poll request
2021-12-05 22:57:55.123101 (Thread-86): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5efe20>]}
2021-12-05 22:57:55.123835 (Thread-86): sending response (<Response 10684 bytes [200 OK]>) to 10.0.6.10
2021-12-05 22:57:56.317788 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-12-05 22:57:56.324385 (Thread-1): finished collecting timing info
2021-12-05 22:57:56.324537 (Thread-1): On model.my_new_project.dim_customers: Close
2021-12-05 22:57:56.326252 (Thread-2): SQL status: SUCCESS 1 in 1.50 seconds
2021-12-05 22:57:56.327307 (Thread-2): finished collecting timing info
2021-12-05 22:57:56.327413 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 22:57:56.597161 (Thread-87): handling poll request
2021-12-05 22:57:56.597529 (Thread-87): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5efe20>]}
2021-12-05 22:57:56.598093 (Thread-87): sending response (<Response 2514 bytes [200 OK]>) to 10.0.31.30
2021-12-05 22:57:56.772263 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8216d0700>]}
2021-12-05 22:57:56.772711 (Thread-1): 22:57:56 | 1 of 3 OK created view model dbt_pstulnikov.dim_customers............ [SUCCESS 1 in 2.01s]
2021-12-05 22:57:56.772809 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-12-05 22:57:56.780853 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82171b280>]}
2021-12-05 22:57:56.781157 (Thread-2): 22:57:56 | 2 of 3 OK created view model dbt_pstulnikov.my_first_dbt_model....... [SUCCESS 1 in 2.02s]
2021-12-05 22:57:56.781240 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 22:57:56.782060 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 22:57:56.782296 (Thread-4): 22:57:56 | 3 of 3 START view model dbt_pstulnikov.my_second_dbt_model........... [RUN]
2021-12-05 22:57:56.782534 (Thread-4): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:57:56.782628 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2021-12-05 22:57:56.784796 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 22:57:56.799566 (Thread-4): finished collecting timing info
2021-12-05 22:57:56.802135 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 22:57:56.817798 (Thread-4): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 22:57:56.817877 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
  );
2021-12-05 22:57:56.817935 (Thread-4): Opening a new connection, currently in state init
2021-12-05 22:57:58.051992 (Thread-88): handling poll request
2021-12-05 22:57:58.052299 (Thread-88): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5dcd90>]}
2021-12-05 22:57:58.052976 (Thread-88): sending response (<Response 7293 bytes [200 OK]>) to 10.0.24.86
2021-12-05 22:57:58.212699 (Thread-4): SQL status: SUCCESS 1 in 1.39 seconds
2021-12-05 22:57:58.214069 (Thread-4): finished collecting timing info
2021-12-05 22:57:58.214196 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2021-12-05 22:57:58.658077 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce9b4d50-759c-468d-aa48-86afedefc4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8216d4cd0>]}
2021-12-05 22:57:58.658431 (Thread-4): 22:57:58 | 3 of 3 OK created view model dbt_pstulnikov.my_second_dbt_model...... [SUCCESS 1 in 1.88s]
2021-12-05 22:57:58.658514 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 22:57:58.659968 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 22:57:58.660255 (MainThread): 22:57:58 | 
2021-12-05 22:57:58.660325 (MainThread): 22:57:58 | Finished running 3 view models in 7.76s.
2021-12-05 22:57:58.660374 (MainThread): Connection 'master' was properly closed.
2021-12-05 22:57:58.660416 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 22:57:58.660452 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 22:57:58.660508 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-12-05 22:57:58.718787 (MainThread): 
2021-12-05 22:57:58.718894 (MainThread): Completed successfully
2021-12-05 22:57:58.718956 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-05 22:57:59.538962 (Thread-89): handling poll request
2021-12-05 22:57:59.539296 (Thread-89): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc597040>]}
2021-12-05 22:57:59.540707 (Thread-89): sending response (<Response 14695 bytes [200 OK]>) to 10.0.26.3
2021-12-05 22:58:00.463188 (Thread-90): handling status request
2021-12-05 22:58:00.463494 (Thread-90): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5dc2e0>]}
2021-12-05 22:58:00.464012 (Thread-90): sending response (<Response 1528 bytes [200 OK]>) to 10.0.36.143
2021-12-05 22:58:00.775545 (Thread-91): handling status request
2021-12-05 22:58:00.775830 (Thread-91): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5ef5b0>]}
2021-12-05 22:58:00.798753 (Thread-91): sending response (<Response 1528 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:01:15.637033 (Thread-92): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 23:01:15.638903 (Thread-92): Partial parsing: updated file: my_new_project://models/dim_customers.sql
2021-12-05 23:01:15.642499 (Thread-92): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:15.693240 (Thread-92): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc553a30>]}
2021-12-05 23:01:16.433388 (Thread-93): handling status request
2021-12-05 23:01:16.433713 (Thread-93): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4ff340>]}
2021-12-05 23:01:16.434244 (Thread-93): sending response (<Response 1528 bytes [200 OK]>) to 10.0.6.71
2021-12-05 23:01:16.477420 (Thread-94): handling status request
2021-12-05 23:01:16.477638 (Thread-94): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4fff40>]}
2021-12-05 23:01:16.478056 (Thread-94): sending response (<Response 1528 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:01:18.429138 (Thread-95): handling status request
2021-12-05 23:01:18.429457 (Thread-95): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4ffdf0>]}
2021-12-05 23:01:18.429933 (Thread-95): sending response (<Response 1528 bytes [200 OK]>) to 10.0.30.196
2021-12-05 23:01:18.869527 (Thread-96): handling run_sql request
2021-12-05 23:01:18.870059 (Thread-96): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5964f0>]}
2021-12-05 23:01:18.871191 (Thread-96): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:01:20.808211 (Thread-96): sending response (<Response 138 bytes [200 OK]>) to 10.0.30.196
2021-12-05 23:01:20.819098 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 23:01:20.832838 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e5e712d-7afd-477c-a33a-3ce2d263b7c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5881eca2e0>]}
2021-12-05 23:01:20.833077 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:01:20.833507 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 23:01:20.833639 (Thread-1): Compiling rpc.my_new_project.request
2021-12-05 23:01:20.835422 (Thread-1): finished collecting timing info
2021-12-05 23:01:20.836875 (Thread-1): Using snowflake connection "rpc.my_new_project.request".
2021-12-05 23:01:20.836943 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-05 23:01:20.836996 (Thread-1): Opening a new connection, currently in state init
2021-12-05 23:01:21.282098 (Thread-97): handling poll request
2021-12-05 23:01:21.282434 (Thread-97): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc5352b0>]}
2021-12-05 23:01:21.283304 (Thread-97): sending response (<Response 4291 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:01:22.322596 (Thread-1): SQL status: SUCCESS 100 in 1.49 seconds
2021-12-05 23:01:22.327810 (Thread-1): finished collecting timing info
2021-12-05 23:01:22.328067 (Thread-1): On rpc.my_new_project.request: Close
2021-12-05 23:01:22.727777 (Thread-98): handling poll request
2021-12-05 23:01:22.728080 (Thread-98): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535670>]}
2021-12-05 23:01:22.728634 (Thread-98): sending response (<Response 1333 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:01:24.170344 (Thread-99): handling poll request
2021-12-05 23:01:24.170649 (Thread-99): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535a60>]}
2021-12-05 23:01:24.171926 (Thread-99): sending response (<Response 11392 bytes [200 OK]>) to 10.0.22.219
2021-12-05 23:01:38.802447 (Thread-100): handling status request
2021-12-05 23:01:38.802760 (Thread-100): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535820>]}
2021-12-05 23:01:38.803264 (Thread-100): sending response (<Response 1528 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:01:39.347949 (Thread-101): handling status request
2021-12-05 23:01:39.348304 (Thread-101): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535eb0>]}
2021-12-05 23:01:39.348795 (Thread-101): sending response (<Response 1528 bytes [200 OK]>) to 10.0.26.3
2021-12-05 23:01:39.389721 (Thread-102): handling cli_args request
2021-12-05 23:01:39.389970 (Thread-102): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc535dc0>]}
2021-12-05 23:01:41.334640 (Thread-102): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:01:41.371742 (MainThread): Partial parsing not enabled
2021-12-05 23:01:41.407980 (MainThread): Parsing macros/catalog.sql
2021-12-05 23:01:41.409972 (MainThread): Parsing macros/adapters.sql
2021-12-05 23:01:41.444077 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 23:01:41.447726 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 23:01:41.450969 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 23:01:41.455232 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 23:01:41.456484 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 23:01:41.464570 (MainThread): Parsing macros/core.sql
2021-12-05 23:01:41.468077 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 23:01:41.474345 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 23:01:41.483786 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 23:01:41.490403 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:01:41.494104 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:01:41.515534 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:01:41.531694 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:01:41.533245 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:01:41.562524 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 23:01:41.569451 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 23:01:41.582582 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:01:41.601098 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:01:41.610491 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:01:41.612139 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:01:41.613512 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 23:01:41.621364 (MainThread): Parsing macros/etc/query.sql
2021-12-05 23:01:41.622297 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 23:01:41.623929 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:01:41.625380 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:01:41.627685 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 23:01:41.629058 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 23:01:41.681754 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:01:41.683838 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:01:41.684940 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:01:41.686442 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 23:01:41.859015 (Thread-103): handling poll request
2021-12-05 23:01:41.859357 (Thread-103): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4db730>]}
2021-12-05 23:01:41.860409 (Thread-103): sending response (<Response 9652 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:01:41.868614 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:41.881086 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:01:41.884275 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:01:41.966824 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1982b8fd0>]}
2021-12-05 23:01:42.000948 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1982bd0d0>]}
2021-12-05 23:01:42.001246 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:01:42.002961 (MainThread): 
2021-12-05 23:01:42.003263 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:01:42.004297 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 23:01:42.016455 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 23:01:42.016560 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 23:01:42.016619 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:01:43.537732 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.52 seconds
2021-12-05 23:01:43.539678 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 23:01:43.578017 (Thread-104): handling poll request
2021-12-05 23:01:43.578327 (Thread-104): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4d41c0>]}
2021-12-05 23:01:43.578956 (Thread-104): sending response (<Response 4862 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:01:43.995595 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:01:44.002572 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:01:44.002676 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 23:01:44.002742 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 23:01:45.029858 (Thread-105): handling poll request
2021-12-05 23:01:45.030189 (Thread-105): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc52b940>]}
2021-12-05 23:01:45.030733 (Thread-105): sending response (<Response 1674 bytes [200 OK]>) to 10.0.31.30
2021-12-05 23:01:45.444725 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.44 seconds
2021-12-05 23:01:45.446158 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 23:01:45.900514 (MainThread): 23:01:45 | Concurrency: 4 threads (target='default')
2021-12-05 23:01:45.900664 (MainThread): 23:01:45 | 
2021-12-05 23:01:45.902652 (Thread-1): Began running node model.my_new_project.dim_customers
2021-12-05 23:01:45.902954 (Thread-1): 23:01:45 | 1 of 3 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-05 23:01:45.903186 (Thread-1): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:45.903287 (Thread-1): Compiling model.my_new_project.dim_customers
2021-12-05 23:01:45.904163 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 23:01:45.904399 (Thread-2): 23:01:45 | 2 of 3 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 23:01:45.904653 (Thread-2): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:01:45.904729 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 23:01:45.905867 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 23:01:45.907958 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:01:45.930012 (Thread-1): finished collecting timing info
2021-12-05 23:01:45.940472 (Thread-2): finished collecting timing info
2021-12-05 23:01:45.950037 (Thread-1): Dropping relation "RAW"."DBT_PSTULNIKOV"."DIM_CUSTOMERS" because it is of type view
2021-12-05 23:01:45.960675 (Thread-1): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:45.960762 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */
drop view if exists "RAW"."DBT_PSTULNIKOV"."DIM_CUSTOMERS" cascade
2021-12-05 23:01:45.960822 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 23:01:45.968079 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 23:01:45.985634 (Thread-2): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:01:45.985717 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment
  );
2021-12-05 23:01:45.985776 (Thread-2): Opening a new connection, currently in state init
2021-12-05 23:01:46.741858 (Thread-106): handling poll request
2021-12-05 23:01:46.742167 (Thread-106): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4c3e20>]}
2021-12-05 23:01:46.742880 (Thread-106): sending response (<Response 9750 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:01:47.378101 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-12-05 23:01:47.388282 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:01:47.405030 (Thread-1): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:01:47.405141 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


      create or replace transient table raw.dbt_pstulnikov.dim_customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-05 23:01:47.511259 (Thread-2): SQL status: SUCCESS 1 in 1.53 seconds
2021-12-05 23:01:47.517726 (Thread-2): finished collecting timing info
2021-12-05 23:01:47.517868 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 23:01:47.980134 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193475c40>]}
2021-12-05 23:01:47.980593 (Thread-2): 23:01:47 | 2 of 3 OK created view model dbt_pstulnikov.my_first_dbt_model....... [SUCCESS 1 in 2.08s]
2021-12-05 23:01:47.980688 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 23:01:47.981379 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 23:01:47.981613 (Thread-4): 23:01:47 | 3 of 3 START view model dbt_pstulnikov.my_second_dbt_model........... [RUN]
2021-12-05 23:01:47.981862 (Thread-4): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:01:47.981936 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2021-12-05 23:01:47.984842 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 23:01:48.001990 (Thread-4): finished collecting timing info
2021-12-05 23:01:48.003774 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 23:01:48.018930 (Thread-4): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:01:48.019016 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
  );
2021-12-05 23:01:48.019076 (Thread-4): Opening a new connection, currently in state init
2021-12-05 23:01:48.236281 (Thread-107): handling poll request
2021-12-05 23:01:48.236633 (Thread-107): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4dbbb0>]}
2021-12-05 23:01:48.237349 (Thread-107): sending response (<Response 9675 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:01:48.455821 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-12-05 23:01:48.460336 (Thread-1): finished collecting timing info
2021-12-05 23:01:48.460511 (Thread-1): On model.my_new_project.dim_customers: Close
2021-12-05 23:01:48.949957 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1982bda30>]}
2021-12-05 23:01:48.950341 (Thread-1): 23:01:48 | 1 of 3 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 3.05s]
2021-12-05 23:01:48.950431 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-12-05 23:01:49.449073 (Thread-4): SQL status: SUCCESS 1 in 1.43 seconds
2021-12-05 23:01:49.450439 (Thread-4): finished collecting timing info
2021-12-05 23:01:49.450562 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2021-12-05 23:01:49.841584 (Thread-108): handling poll request
2021-12-05 23:01:49.841922 (Thread-108): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4dbee0>]}
2021-12-05 23:01:49.842556 (Thread-108): sending response (<Response 3817 bytes [200 OK]>) to 10.0.22.219
2021-12-05 23:01:49.903778 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e0d184-941e-4f00-80c9-b16e171df51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1934752e0>]}
2021-12-05 23:01:49.904304 (Thread-4): 23:01:49 | 3 of 3 OK created view model dbt_pstulnikov.my_second_dbt_model...... [SUCCESS 1 in 1.92s]
2021-12-05 23:01:49.904413 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 23:01:49.905953 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:01:49.906251 (MainThread): 23:01:49 | 
2021-12-05 23:01:49.906318 (MainThread): 23:01:49 | Finished running 2 view models, 1 table model in 7.90s.
2021-12-05 23:01:49.906367 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:01:49.906406 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:01:49.906442 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 23:01:49.906477 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-12-05 23:01:49.968199 (MainThread): 
2021-12-05 23:01:49.968306 (MainThread): Completed successfully
2021-12-05 23:01:49.968367 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-05 23:01:51.296179 (Thread-109): handling poll request
2021-12-05 23:01:51.296527 (Thread-109): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f040>]}
2021-12-05 23:01:51.297673 (Thread-109): sending response (<Response 13746 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:01:52.396016 (Thread-110): handling status request
2021-12-05 23:01:52.396346 (Thread-110): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f130>]}
2021-12-05 23:01:52.396913 (Thread-110): sending response (<Response 1528 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:01:52.549429 (Thread-111): handling status request
2021-12-05 23:01:52.549868 (Thread-111): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f460>]}
2021-12-05 23:01:52.550547 (Thread-111): sending response (<Response 1528 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:02:59.214417 (Thread-112): handling status request
2021-12-05 23:02:59.216347 (Thread-112): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f670>]}
2021-12-05 23:02:59.216864 (Thread-112): sending response (<Response 1528 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:02:59.579392 (Thread-113): handling status request
2021-12-05 23:02:59.579710 (Thread-113): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47f850>]}
2021-12-05 23:02:59.580207 (Thread-113): sending response (<Response 1528 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:02:59.697542 (Thread-114): handling cli_args request
2021-12-05 23:02:59.697768 (Thread-114): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47fa30>]}
2021-12-05 23:03:01.684874 (Thread-114): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:03:01.721765 (MainThread): Partial parsing not enabled
2021-12-05 23:03:01.768429 (MainThread): Parsing macros/catalog.sql
2021-12-05 23:03:01.770393 (MainThread): Parsing macros/adapters.sql
2021-12-05 23:03:01.804580 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 23:03:01.808215 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 23:03:01.811381 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 23:03:01.815595 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 23:03:01.816849 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 23:03:01.824966 (MainThread): Parsing macros/core.sql
2021-12-05 23:03:01.828462 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 23:03:01.834718 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 23:03:01.844149 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 23:03:01.850805 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:03:01.854440 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:03:01.876086 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:03:01.892293 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:03:01.893856 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:03:01.923417 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 23:03:01.930404 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 23:03:01.943602 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:03:01.962183 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:03:01.971712 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:03:01.973415 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:03:01.974786 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 23:03:01.982700 (MainThread): Parsing macros/etc/query.sql
2021-12-05 23:03:01.983676 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 23:03:01.985339 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:03:01.986781 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:03:01.989132 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 23:03:01.990506 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 23:03:02.043405 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:03:02.045545 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:03:02.046636 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:03:02.048128 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 23:03:02.190120 (Thread-115): handling poll request
2021-12-05 23:03:02.190473 (Thread-115): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc522ee0>]}
2021-12-05 23:03:02.191541 (Thread-115): sending response (<Response 9675 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:03:02.233379 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:03:02.246106 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:03:02.249467 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:03:02.331171 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be7243d5-4332-42ef-9ec7-9fb0e12dfe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854bfbdeb0>]}
2021-12-05 23:03:02.366067 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be7243d5-4332-42ef-9ec7-9fb0e12dfe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854bfbc550>]}
2021-12-05 23:03:02.366320 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:03:02.367402 (MainThread): 
2021-12-05 23:03:02.367655 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:03:02.368442 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 23:03:02.380877 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 23:03:02.380956 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 23:03:02.381015 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:03:03.691049 (Thread-116): handling poll request
2021-12-05 23:03:03.691362 (Thread-116): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc52bc70>]}
2021-12-05 23:03:03.691965 (Thread-116): sending response (<Response 4339 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:03:03.924969 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.54 seconds
2021-12-05 23:03:03.926906 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 23:03:04.382945 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:03:04.389907 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:03:04.390013 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 23:03:04.390077 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 23:03:05.279428 (Thread-117): handling poll request
2021-12-05 23:03:05.279748 (Thread-117): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc47a5b0>]}
2021-12-05 23:03:05.280319 (Thread-117): sending response (<Response 2244 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:03:05.645129 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-12-05 23:03:05.646540 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 23:03:06.088530 (MainThread): 23:03:06 | Concurrency: 4 threads (target='default')
2021-12-05 23:03:06.088687 (MainThread): 23:03:06 | 
2021-12-05 23:03:06.090725 (Thread-1): Began running node model.my_new_project.dim_customers
2021-12-05 23:03:06.091006 (Thread-1): 23:03:06 | 1 of 1 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-05 23:03:06.091234 (Thread-1): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:03:06.091333 (Thread-1): Compiling model.my_new_project.dim_customers
2021-12-05 23:03:06.094073 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:03:06.115532 (Thread-1): finished collecting timing info
2021-12-05 23:03:06.138718 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:03:06.160296 (Thread-1): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:03:06.160374 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


      create or replace transient table raw.dbt_pstulnikov.dim_customers  as
      (

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-05 23:03:06.160433 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 23:03:06.765400 (Thread-118): handling poll request
2021-12-05 23:03:06.765720 (Thread-118): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4c3430>]}
2021-12-05 23:03:06.766357 (Thread-118): sending response (<Response 6498 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:03:08.275376 (Thread-119): handling poll request
2021-12-05 23:03:08.275695 (Thread-119): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4c3d60>]}
2021-12-05 23:03:08.276187 (Thread-119): sending response (<Response 309 bytes [200 OK]>) to 10.0.24.86
2021-12-05 23:03:08.295744 (Thread-1): SQL status: SUCCESS 1 in 2.14 seconds
2021-12-05 23:03:08.304916 (Thread-1): finished collecting timing info
2021-12-05 23:03:08.305052 (Thread-1): On model.my_new_project.dim_customers: Close
2021-12-05 23:03:08.757884 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7243d5-4332-42ef-9ec7-9fb0e12dfe32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854b20bc10>]}
2021-12-05 23:03:08.758301 (Thread-1): 23:03:08 | 1 of 1 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.67s]
2021-12-05 23:03:08.758394 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-12-05 23:03:08.759957 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:03:08.760252 (MainThread): 23:03:08 | 
2021-12-05 23:03:08.760325 (MainThread): 23:03:08 | Finished running 1 table model in 6.39s.
2021-12-05 23:03:08.760374 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:03:08.760414 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:03:08.822791 (MainThread): 
2021-12-05 23:03:08.822894 (MainThread): Completed successfully
2021-12-05 23:03:08.822955 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-12-05 23:03:09.750659 (Thread-120): handling poll request
2021-12-05 23:03:09.750983 (Thread-120): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc4ccb80>]}
2021-12-05 23:03:09.751939 (Thread-120): sending response (<Response 9398 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:03:10.671366 (Thread-121): handling status request
2021-12-05 23:03:10.671683 (Thread-121): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc51d790>]}
2021-12-05 23:03:10.693524 (Thread-121): sending response (<Response 1528 bytes [200 OK]>) to 10.0.26.3
2021-12-05 23:03:10.720306 (Thread-122): handling status request
2021-12-05 23:03:10.720534 (Thread-122): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc51d8b0>]}
2021-12-05 23:03:10.720957 (Thread-122): sending response (<Response 1528 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:08:35.019186 (Thread-123): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-05 23:08:35.020951 (Thread-123): Partial parsing enabled, no changes found, skipping parsing
2021-12-05 23:08:35.026220 (Thread-123): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc446b80>]}
2021-12-05 23:08:35.818964 (Thread-124): handling status request
2021-12-05 23:08:35.819273 (Thread-124): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc522340>]}
2021-12-05 23:08:35.819743 (Thread-124): sending response (<Response 1212 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:08:35.867305 (Thread-125): handling status request
2021-12-05 23:08:35.867563 (Thread-125): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc446d30>]}
2021-12-05 23:08:35.867991 (Thread-125): sending response (<Response 1212 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:09:26.347605 (Thread-126): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-05 23:09:26.347911 (Thread-126): Partial parsing: added file: my_new_project://models/stg_customers.sql
2021-12-05 23:09:26.351516 (Thread-126): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:09:26.402459 (Thread-126): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc427040>]}
2021-12-05 23:09:27.221326 (Thread-127): handling status request
2021-12-05 23:09:27.221641 (Thread-127): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc51adf0>]}
2021-12-05 23:09:27.222123 (Thread-127): sending response (<Response 1530 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:09:27.238745 (Thread-128): handling status request
2021-12-05 23:09:27.238959 (Thread-128): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc51a280>]}
2021-12-05 23:09:27.239337 (Thread-128): sending response (<Response 1530 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:14:21.027550 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-12-05 23:14:21.097528 (Thread-129): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 23:14:21.097864 (Thread-129): Partial parsing: updated file: my_new_project://models/stg_customers.sql
2021-12-05 23:14:21.101275 (Thread-129): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:14:21.148695 (Thread-129): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3fb6a0>]}
2021-12-05 23:14:21.898760 (Thread-130): handling status request
2021-12-05 23:14:21.899095 (Thread-130): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc37afd0>]}
2021-12-05 23:14:21.899597 (Thread-130): sending response (<Response 1532 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:14:21.938576 (Thread-131): handling status request
2021-12-05 23:14:21.938846 (Thread-131): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc37a820>]}
2021-12-05 23:14:21.939305 (Thread-131): sending response (<Response 1532 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:14:39.444562 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-12-05 23:14:39.501782 (Thread-132): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-05 23:14:39.502068 (Thread-132): Partial parsing: added file: my_new_project://models/stg_orders.sql
2021-12-05 23:14:39.505470 (Thread-132): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:14:39.550184 (Thread-132): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc2fbac0>]}
2021-12-05 23:14:40.356388 (Thread-133): handling status request
2021-12-05 23:14:40.356735 (Thread-133): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc399b20>]}
2021-12-05 23:14:40.357222 (Thread-133): sending response (<Response 1524 bytes [200 OK]>) to 10.0.13.223
2021-12-05 23:14:40.409563 (Thread-134): handling status request
2021-12-05 23:14:40.409796 (Thread-134): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3ac3a0>]}
2021-12-05 23:14:40.410212 (Thread-134): sending response (<Response 1524 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:15:19.951818 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:15:20.009354 (Thread-135): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 23:15:20.009659 (Thread-135): Partial parsing: updated file: my_new_project://models/stg_orders.sql
2021-12-05 23:15:20.012973 (Thread-135): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:15:20.060842 (Thread-135): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc319640>]}
2021-12-05 23:15:20.790487 (Thread-136): handling status request
2021-12-05 23:15:20.790796 (Thread-136): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc377c40>]}
2021-12-05 23:15:20.791280 (Thread-136): sending response (<Response 1526 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:15:20.851325 (Thread-137): handling status request
2021-12-05 23:15:20.851574 (Thread-137): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3774c0>]}
2021-12-05 23:15:20.852042 (Thread-137): sending response (<Response 1526 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:15:40.422646 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:15:40.601669 (Thread-138): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-05 23:15:40.602003 (Thread-138): Partial parsing enabled, no changes found, skipping parsing
2021-12-05 23:15:40.607187 (Thread-138): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc38a4f0>]}
2021-12-05 23:15:41.312573 (Thread-139): handling status request
2021-12-05 23:15:41.312896 (Thread-139): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc300790>]}
2021-12-05 23:15:41.313379 (Thread-139): sending response (<Response 1212 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:15:41.393253 (Thread-140): handling status request
2021-12-05 23:15:41.393503 (Thread-140): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc300130>]}
2021-12-05 23:15:41.393941 (Thread-140): sending response (<Response 1212 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:18:00.807609 (Thread-141): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-05 23:18:00.809657 (Thread-141): Partial parsing: updated file: my_new_project://models/dim_customers.sql
2021-12-05 23:18:00.813065 (Thread-141): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:18:00.866415 (Thread-141): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81569a0>]}
2021-12-05 23:18:01.584741 (Thread-142): handling status request
2021-12-05 23:18:01.585061 (Thread-142): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3981f0>]}
2021-12-05 23:18:01.585546 (Thread-142): sending response (<Response 1532 bytes [200 OK]>) to 10.0.6.71
2021-12-05 23:18:01.848406 (Thread-143): handling status request
2021-12-05 23:18:01.848741 (Thread-143): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3983d0>]}
2021-12-05 23:18:01.849201 (Thread-143): sending response (<Response 1532 bytes [200 OK]>) to 10.0.26.3
2021-12-05 23:18:13.731208 (Thread-144): handling status request
2021-12-05 23:18:13.731530 (Thread-144): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc398b20>]}
2021-12-05 23:18:13.732011 (Thread-144): sending response (<Response 1532 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:18:14.205122 (Thread-145): handling compile_sql request
2021-12-05 23:18:14.205414 (Thread-145): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3980a0>]}
2021-12-05 23:18:14.206504 (Thread-145): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:18:16.140968 (Thread-145): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:18:16.151900 (MainThread): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 23:18:16.166334 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde71eb8-5f22-4191-89eb-969a87710148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c9a3ebb0>]}
2021-12-05 23:18:16.166574 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:18:16.166949 (Thread-1): Acquiring new snowflake connection "rpc.my_new_project.request".
2021-12-05 23:18:16.167054 (Thread-1): Compiling rpc.my_new_project.request
2021-12-05 23:18:16.169485 (Thread-1): finished collecting timing info
2021-12-05 23:18:16.169599 (Thread-1): finished collecting timing info
2021-12-05 23:18:16.634243 (Thread-146): handling poll request
2021-12-05 23:18:16.634596 (Thread-146): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3a7640>]}
2021-12-05 23:18:16.635766 (Thread-146): sending response (<Response 8060 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:19:05.365139 (Thread-147): handling status request
2021-12-05 23:19:05.365454 (Thread-147): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3a7400>]}
2021-12-05 23:19:05.365959 (Thread-147): sending response (<Response 1532 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:19:05.743682 (Thread-148): handling status request
2021-12-05 23:19:05.743977 (Thread-148): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc3a73d0>]}
2021-12-05 23:19:05.744442 (Thread-148): sending response (<Response 1532 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:19:05.808000 (Thread-149): handling cli_args request
2021-12-05 23:19:05.808218 (Thread-149): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71bc305310>]}
2021-12-05 23:19:07.769780 (Thread-149): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:19:07.807385 (MainThread): Partial parsing not enabled
2021-12-05 23:19:07.863186 (MainThread): Parsing macros/catalog.sql
2021-12-05 23:19:07.865365 (MainThread): Parsing macros/adapters.sql
2021-12-05 23:19:07.899941 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 23:19:07.903614 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 23:19:07.906819 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 23:19:07.911038 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 23:19:07.912283 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 23:19:07.920411 (MainThread): Parsing macros/core.sql
2021-12-05 23:19:07.923951 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 23:19:07.930227 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 23:19:07.939693 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 23:19:07.946453 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:19:07.950030 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:19:07.971898 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:19:07.988117 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:19:07.989681 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:19:08.019123 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 23:19:08.026011 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 23:19:08.039069 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:19:08.057677 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:19:08.067100 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:19:08.068811 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:19:08.070176 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 23:19:08.078071 (MainThread): Parsing macros/etc/query.sql
2021-12-05 23:19:08.079021 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 23:19:08.080646 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:19:08.082085 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:19:08.084423 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 23:19:08.085820 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 23:19:08.138551 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:19:08.140706 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:19:08.141799 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:19:08.143307 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 23:19:08.246749 (Thread-150): handling poll request
2021-12-05 23:19:08.247111 (Thread-150): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb365dc0>]}
2021-12-05 23:19:08.248536 (Thread-150): sending response (<Response 9652 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:19:08.325888 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:19:08.337647 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:19:08.341354 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:19:08.343940 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:19:08.347157 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:19:08.456464 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c3efbfd0>]}
2021-12-05 23:19:08.481762 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c3efa550>]}
2021-12-05 23:19:08.481982 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:19:08.484217 (MainThread): 
2021-12-05 23:19:08.484458 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:19:08.485417 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_raw".
2021-12-05 23:19:08.545184 (ThreadPoolExecutor-0_0): Using snowflake connection "list_raw".
2021-12-05 23:19:08.545275 (ThreadPoolExecutor-0_0): On list_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw"} */

    show terse schemas in database raw
    limit 10000
2021-12-05 23:19:08.545334 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:19:09.772755 (Thread-151): handling poll request
2021-12-05 23:19:09.773072 (Thread-151): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c9365700>]}
2021-12-05 23:19:09.799308 (Thread-151): sending response (<Response 4927 bytes [200 OK]>) to 10.0.22.219
2021-12-05 23:19:10.089632 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.54 seconds
2021-12-05 23:19:10.091574 (ThreadPoolExecutor-0_0): On list_raw: Close
2021-12-05 23:19:10.548665 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:19:10.556039 (ThreadPoolExecutor-1_0): Using snowflake connection "list_raw_dbt_pstulnikov".
2021-12-05 23:19:10.556147 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_raw_dbt_pstulnikov"} */

    show terse objects in raw.dbt_pstulnikov
2021-12-05 23:19:10.556213 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 23:19:11.250824 (Thread-152): handling poll request
2021-12-05 23:19:11.251131 (Thread-152): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c81bcc10>]}
2021-12-05 23:19:11.251684 (Thread-152): sending response (<Response 2221 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:19:11.815687 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-12-05 23:19:11.817222 (ThreadPoolExecutor-1_0): On list_raw_dbt_pstulnikov: Close
2021-12-05 23:19:12.271966 (MainThread): 23:19:12 | Concurrency: 4 threads (target='default')
2021-12-05 23:19:12.272117 (MainThread): 23:19:12 | 
2021-12-05 23:19:12.274188 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-12-05 23:19:12.274486 (Thread-1): 23:19:12 | 1 of 5 START view model dbt_pstulnikov.my_first_dbt_model............ [RUN]
2021-12-05 23:19:12.274719 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:19:12.274818 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-12-05 23:19:12.275698 (Thread-2): Began running node model.my_new_project.stg_customers
2021-12-05 23:19:12.275908 (Thread-2): 23:19:12 | 2 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-05 23:19:12.276129 (Thread-2): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:19:12.276199 (Thread-2): Compiling model.my_new_project.stg_customers
2021-12-05 23:19:12.277314 (Thread-2): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:19:12.278200 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 23:19:12.278369 (Thread-3): Began running node model.my_new_project.stg_orders
2021-12-05 23:19:12.278571 (Thread-3): 23:19:12 | 3 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-05 23:19:12.278795 (Thread-3): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:19:12.278865 (Thread-3): Compiling model.my_new_project.stg_orders
2021-12-05 23:19:12.279952 (Thread-3): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:19:12.290874 (Thread-3): finished collecting timing info
2021-12-05 23:19:12.296187 (Thread-2): finished collecting timing info
2021-12-05 23:19:12.324468 (Thread-2): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:19:12.324868 (Thread-3): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:19:12.330763 (Thread-1): finished collecting timing info
2021-12-05 23:19:12.332413 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-12-05 23:19:12.338281 (Thread-2): Using snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:19:12.338363 (Thread-2): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view raw.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-05 23:19:12.338422 (Thread-2): Opening a new connection, currently in state init
2021-12-05 23:19:12.342263 (Thread-3): Using snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:19:12.342347 (Thread-3): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view raw.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-05 23:19:12.342404 (Thread-3): Opening a new connection, currently in state init
2021-12-05 23:19:12.348318 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:19:12.348404 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_first_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_first_dbt_model  as (
    select * from raw.stripe.payment
  );
2021-12-05 23:19:12.348462 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 23:19:12.681296 (Thread-153): handling poll request
2021-12-05 23:19:12.681604 (Thread-153): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb365f10>]}
2021-12-05 23:19:12.682448 (Thread-153): sending response (<Response 14112 bytes [200 OK]>) to 10.0.26.3
2021-12-05 23:19:13.915471 (Thread-3): SQL status: SUCCESS 1 in 1.57 seconds
2021-12-05 23:19:13.922454 (Thread-3): finished collecting timing info
2021-12-05 23:19:13.922599 (Thread-3): On model.my_new_project.stg_orders: Close
2021-12-05 23:19:13.978206 (Thread-2): SQL status: SUCCESS 1 in 1.64 seconds
2021-12-05 23:19:13.979452 (Thread-2): finished collecting timing info
2021-12-05 23:19:13.979574 (Thread-2): On model.my_new_project.stg_customers: Close
2021-12-05 23:19:14.169292 (Thread-154): handling poll request
2021-12-05 23:19:14.169594 (Thread-154): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb365970>]}
2021-12-05 23:19:14.170149 (Thread-154): sending response (<Response 2482 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:19:14.171032 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-12-05 23:19:14.172328 (Thread-1): finished collecting timing info
2021-12-05 23:19:14.172456 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-12-05 23:19:14.374671 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c313ec10>]}
2021-12-05 23:19:14.375091 (Thread-3): 23:19:14 | 3 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.10s]
2021-12-05 23:19:14.375189 (Thread-3): Finished running node model.my_new_project.stg_orders
2021-12-05 23:19:14.433122 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c03d04f0>]}
2021-12-05 23:19:14.433430 (Thread-2): 23:19:14 | 2 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.16s]
2021-12-05 23:19:14.433517 (Thread-2): Finished running node model.my_new_project.stg_customers
2021-12-05 23:19:14.434163 (Thread-4): Began running node model.my_new_project.dim_customers
2021-12-05 23:19:14.434396 (Thread-4): 23:19:14 | 4 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-05 23:19:14.434630 (Thread-4): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:19:14.434704 (Thread-4): Compiling model.my_new_project.dim_customers
2021-12-05 23:19:14.437359 (Thread-4): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:19:14.454330 (Thread-4): finished collecting timing info
2021-12-05 23:19:14.471066 (Thread-4): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:19:14.488321 (Thread-4): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:19:14.488400 (Thread-4): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


      create or replace transient table raw.dbt_pstulnikov.dim_customers  as
      (

with customers as (
    select * from raw.dbt_pstulnikov.stg_customers
),

orders as (
    select * from raw.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-05 23:19:14.488460 (Thread-4): Opening a new connection, currently in state init
2021-12-05 23:19:14.613225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c03d0c70>]}
2021-12-05 23:19:14.613538 (Thread-1): 23:19:14 | 1 of 5 OK created view model dbt_pstulnikov.my_first_dbt_model....... [SUCCESS 1 in 2.34s]
2021-12-05 23:19:14.613626 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-12-05 23:19:14.614204 (Thread-2): Began running node model.my_new_project.my_second_dbt_model
2021-12-05 23:19:14.614459 (Thread-2): 23:19:14 | 5 of 5 START view model dbt_pstulnikov.my_second_dbt_model........... [RUN]
2021-12-05 23:19:14.614665 (Thread-2): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:19:14.614741 (Thread-2): Compiling model.my_new_project.my_second_dbt_model
2021-12-05 23:19:14.616684 (Thread-2): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 23:19:14.632143 (Thread-2): finished collecting timing info
2021-12-05 23:19:14.633964 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-12-05 23:19:14.649827 (Thread-2): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:19:14.649908 (Thread-2): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view raw.dbt_pstulnikov.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from raw.dbt_pstulnikov.my_first_dbt_model
where id = 1
  );
2021-12-05 23:19:14.649967 (Thread-2): Opening a new connection, currently in state closed
2021-12-05 23:19:15.642014 (Thread-155): handling poll request
2021-12-05 23:19:15.642324 (Thread-155): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb373a00>]}
2021-12-05 23:19:15.643169 (Thread-155): sending response (<Response 14674 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:19:16.016575 (Thread-2): SQL status: SUCCESS 1 in 1.37 seconds
2021-12-05 23:19:16.018001 (Thread-2): finished collecting timing info
2021-12-05 23:19:16.018177 (Thread-2): On model.my_new_project.my_second_dbt_model: Close
2021-12-05 23:19:16.481861 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c30ce5b0>]}
2021-12-05 23:19:16.482258 (Thread-2): 23:19:16 | 5 of 5 OK created view model dbt_pstulnikov.my_second_dbt_model...... [SUCCESS 1 in 1.87s]
2021-12-05 23:19:16.482349 (Thread-2): Finished running node model.my_new_project.my_second_dbt_model
2021-12-05 23:19:17.017019 (Thread-4): SQL status: SUCCESS 1 in 2.53 seconds
2021-12-05 23:19:17.021567 (Thread-4): finished collecting timing info
2021-12-05 23:19:17.021708 (Thread-4): On model.my_new_project.dim_customers: Close
2021-12-05 23:19:17.094865 (Thread-156): handling poll request
2021-12-05 23:19:17.095170 (Thread-156): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb373490>]}
2021-12-05 23:19:17.095768 (Thread-156): sending response (<Response 3842 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:19:17.463655 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5c1ed3-e30c-4636-9b19-689e8edaae80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c038afa0>]}
2021-12-05 23:19:17.464033 (Thread-4): 23:19:17 | 4 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 3.03s]
2021-12-05 23:19:17.464118 (Thread-4): Finished running node model.my_new_project.dim_customers
2021-12-05 23:19:17.465685 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:19:17.465988 (MainThread): 23:19:17 | 
2021-12-05 23:19:17.466058 (MainThread): 23:19:17 | Finished running 4 view models, 1 table model in 8.98s.
2021-12-05 23:19:17.466108 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:19:17.466150 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 23:19:17.466186 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-12-05 23:19:17.466222 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:19:17.466257 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:19:17.520954 (MainThread): 
2021-12-05 23:19:17.521068 (MainThread): Completed successfully
2021-12-05 23:19:17.521135 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-05 23:19:18.532541 (Thread-157): handling poll request
2021-12-05 23:19:18.532855 (Thread-157): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb353760>]}
2021-12-05 23:19:18.534380 (Thread-157): sending response (<Response 18246 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:19:19.395223 (Thread-158): handling status request
2021-12-05 23:19:19.395555 (Thread-158): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c814c940>]}
2021-12-05 23:19:19.396096 (Thread-158): sending response (<Response 1532 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:19:19.676218 (Thread-159): handling status request
2021-12-05 23:19:19.676556 (Thread-159): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a45a4ff8-776f-4870-be32-571bb394caec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cb372460>]}
2021-12-05 23:19:19.677048 (Thread-159): sending response (<Response 1532 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:22:15.958002 (MainThread): Running with dbt=0.21.0
2021-12-05 23:22:16.303373 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-12-05 23:22:16.311748 (MainThread): Tracking: tracking
2021-12-05 23:22:16.311972 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42f4267130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c498b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4998880>]}
2021-12-05 23:22:16.312301 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2021-12-05 23:22:16.313403 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2021-12-05 23:22:16.317617 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-12-05 23:22:16.336327 (Thread-12): Unable to do partial parsing because profile has changed
2021-12-05 23:22:16.336558 (Thread-12): Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4998e20>]}
2021-12-05 23:22:16.380655 (Thread-12): Parsing macros/catalog.sql
2021-12-05 23:22:16.382681 (Thread-12): Parsing macros/adapters.sql
2021-12-05 23:22:16.417699 (Thread-12): Parsing macros/materializations/merge.sql
2021-12-05 23:22:16.421439 (Thread-12): Parsing macros/materializations/table.sql
2021-12-05 23:22:16.424380 (Thread-12): Parsing macros/materializations/seed.sql
2021-12-05 23:22:16.428531 (Thread-12): Parsing macros/materializations/view.sql
2021-12-05 23:22:16.429798 (Thread-12): Parsing macros/materializations/incremental.sql
2021-12-05 23:22:16.437825 (Thread-12): Parsing macros/core.sql
2021-12-05 23:22:16.441287 (Thread-12): Parsing macros/materializations/test.sql
2021-12-05 23:22:16.447401 (Thread-12): Parsing macros/materializations/helpers.sql
2021-12-05 23:22:16.456513 (Thread-12): Parsing macros/materializations/view/view.sql
2021-12-05 23:22:16.463126 (Thread-12): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:22:16.466714 (Thread-12): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:22:16.487861 (Thread-12): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:22:16.503865 (Thread-12): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:22:16.505439 (Thread-12): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:22:16.534502 (Thread-12): Parsing macros/materializations/table/table.sql
2021-12-05 23:22:16.541324 (Thread-12): Parsing macros/materializations/common/merge.sql
2021-12-05 23:22:16.554294 (Thread-12): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:22:16.572572 (Thread-12): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:22:16.581977 (Thread-12): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:22:16.583561 (Thread-12): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:22:16.584929 (Thread-12): Parsing macros/etc/datetime.sql
2021-12-05 23:22:16.592606 (Thread-12): Parsing macros/etc/query.sql
2021-12-05 23:22:16.593514 (Thread-12): Parsing macros/etc/where_subquery.sql
2021-12-05 23:22:16.595191 (Thread-12): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:22:16.596679 (Thread-12): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:22:16.598944 (Thread-12): Parsing macros/etc/is_incremental.sql
2021-12-05 23:22:16.600351 (Thread-12): Parsing macros/adapters/common.sql
2021-12-05 23:22:16.651427 (Thread-12): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:22:16.653512 (Thread-12): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:22:16.654667 (Thread-12): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:22:16.656206 (Thread-12): Parsing macros/schema_tests/unique.sql
2021-12-05 23:22:16.834304 (Thread-12): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:22:16.846729 (Thread-12): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:22:16.850793 (Thread-12): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:22:16.853334 (Thread-12): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-12-05 23:22:16.856951 (Thread-12): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-12-05 23:22:16.939676 (Thread-12): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4875910>]}
2021-12-05 23:22:21.043843 (Thread-13): handling status request
2021-12-05 23:22:21.044207 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c482dca0>]}
2021-12-05 23:22:21.045103 (Thread-13): sending response (<Response 11918 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:22:21.264335 (Thread-14): handling status request
2021-12-05 23:22:21.264621 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c487c5b0>]}
2021-12-05 23:22:21.265362 (Thread-14): sending response (<Response 11918 bytes [200 OK]>) to 10.0.6.71
2021-12-05 23:22:21.271841 (Thread-15): handling ps request
2021-12-05 23:22:21.272038 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4899e50>]}
2021-12-05 23:22:21.272387 (Thread-15): sending response (<Response 105 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:22:21.309198 (Thread-16): handling status request
2021-12-05 23:22:21.309402 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49bdc10>]}
2021-12-05 23:22:21.310084 (Thread-16): sending response (<Response 11918 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:22:40.079866 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-12-05 23:22:40.143013 (Thread-17): Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
2021-12-05 23:22:40.143376 (Thread-17): Partial parsing: deleted file: my_new_project://models/example/my_second_dbt_model.sql
2021-12-05 23:22:40.143492 (Thread-17): Partial parsing: deleted file: my_new_project://models/example/my_first_dbt_model.sql
2021-12-05 23:22:40.176556 (Thread-17): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-05 23:22:40.180972 (Thread-17): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4070>]}
2021-12-05 23:22:41.185873 (Thread-18): handling status request
2021-12-05 23:22:41.186211 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd45e0>]}
2021-12-05 23:22:41.186711 (Thread-18): sending response (<Response 1983 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:22:41.253970 (Thread-19): handling status request
2021-12-05 23:22:41.254179 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4940>]}
2021-12-05 23:22:41.254579 (Thread-19): sending response (<Response 1983 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:22:53.153225 (Thread-20): handling status request
2021-12-05 23:22:53.153519 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4c40>]}
2021-12-05 23:22:53.154009 (Thread-20): sending response (<Response 1983 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:22:53.543508 (Thread-21): handling status request
2021-12-05 23:22:53.545089 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4490>]}
2021-12-05 23:22:53.545508 (Thread-21): sending response (<Response 1983 bytes [200 OK]>) to 10.0.39.19
2021-12-05 23:22:53.805108 (Thread-22): handling cli_args request
2021-12-05 23:22:53.805389 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4ca0>]}
2021-12-05 23:22:55.713770 (Thread-22): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:22:55.749456 (MainThread): Partial parsing not enabled
2021-12-05 23:22:55.788266 (MainThread): Parsing macros/catalog.sql
2021-12-05 23:22:55.790193 (MainThread): Parsing macros/adapters.sql
2021-12-05 23:22:55.823837 (MainThread): Parsing macros/materializations/merge.sql
2021-12-05 23:22:55.827419 (MainThread): Parsing macros/materializations/table.sql
2021-12-05 23:22:55.830550 (MainThread): Parsing macros/materializations/seed.sql
2021-12-05 23:22:55.834650 (MainThread): Parsing macros/materializations/view.sql
2021-12-05 23:22:55.835858 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-05 23:22:55.843831 (MainThread): Parsing macros/core.sql
2021-12-05 23:22:55.847358 (MainThread): Parsing macros/materializations/test.sql
2021-12-05 23:22:55.853515 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-05 23:22:55.862869 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-05 23:22:55.869773 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:22:55.873388 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:22:55.894757 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:22:55.919851 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:22:55.922262 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:22:55.951521 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-05 23:22:55.958369 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-05 23:22:55.971238 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:22:55.989630 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:22:55.998972 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:22:56.000638 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:22:56.001997 (MainThread): Parsing macros/etc/datetime.sql
2021-12-05 23:22:56.009782 (MainThread): Parsing macros/etc/query.sql
2021-12-05 23:22:56.010749 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-05 23:22:56.012344 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:22:56.013754 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:22:56.016060 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-05 23:22:56.017405 (MainThread): Parsing macros/adapters/common.sql
2021-12-05 23:22:56.069272 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:22:56.071399 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:22:56.072476 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:22:56.073968 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-05 23:22:56.252991 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:22:56.264286 (MainThread): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:22:56.267827 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:22:56.314735 (Thread-23): handling poll request
2021-12-05 23:22:56.315008 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4fa0>]}
2021-12-05 23:22:56.316071 (Thread-23): sending response (<Response 10570 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:22:56.317530 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-05 23:22:56.321422 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd0194eb0>]}
2021-12-05 23:22:56.339793 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd02a3460>]}
2021-12-05 23:22:56.339994 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:22:56.340989 (MainThread): 
2021-12-05 23:22:56.341180 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:22:56.341917 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-05 23:22:56.353017 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-05 23:22:56.353089 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-05 23:22:56.353144 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:22:57.902915 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.55 seconds
2021-12-05 23:22:57.904702 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-05 23:22:58.351552 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_pstulnikov".
2021-12-05 23:22:58.351743 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_pstulnikov".
2021-12-05 23:22:58.351930 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt_pstulnikov"
2021-12-05 23:22:58.357243 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_pstulnikov".
2021-12-05 23:22:58.357328 (ThreadPoolExecutor-0_0): On create_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "create_analytics_dbt_pstulnikov"} */
create schema if not exists analytics.dbt_pstulnikov
2021-12-05 23:22:58.357390 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-12-05 23:22:58.387954 (Thread-24): handling poll request
2021-12-05 23:22:58.388221 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfa9070>]}
2021-12-05 23:22:58.388857 (Thread-24): sending response (<Response 6433 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:22:59.835573 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.48 seconds
2021-12-05 23:22:59.836456 (ThreadPoolExecutor-0_0): On create_analytics_dbt_pstulnikov: Close
2021-12-05 23:22:59.864356 (Thread-25): handling poll request
2021-12-05 23:22:59.864622 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfa9790>]}
2021-12-05 23:22:59.865103 (Thread-25): sending response (<Response 854 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:23:00.293513 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-05 23:23:00.300065 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-05 23:23:00.300170 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-05 23:23:00.300228 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-05 23:23:01.421949 (Thread-26): handling poll request
2021-12-05 23:23:01.422250 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfdc220>]}
2021-12-05 23:23:01.422749 (Thread-26): sending response (<Response 1704 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:23:01.556875 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.26 seconds
2021-12-05 23:23:01.558107 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-05 23:23:02.009467 (MainThread): 23:23:02 | Concurrency: 4 threads (target='default')
2021-12-05 23:23:02.009613 (MainThread): 23:23:02 | 
2021-12-05 23:23:02.011567 (Thread-1): Began running node model.my_new_project.stg_customers
2021-12-05 23:23:02.011874 (Thread-1): 23:23:02 | 1 of 3 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-05 23:23:02.012122 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:23:02.012239 (Thread-1): Compiling model.my_new_project.stg_customers
2021-12-05 23:23:02.013116 (Thread-2): Began running node model.my_new_project.stg_orders
2021-12-05 23:23:02.013327 (Thread-2): 23:23:02 | 2 of 3 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-05 23:23:02.013546 (Thread-2): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:23:02.013614 (Thread-2): Compiling model.my_new_project.stg_orders
2021-12-05 23:23:02.014741 (Thread-2): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:23:02.016036 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:23:02.029281 (Thread-2): finished collecting timing info
2021-12-05 23:23:02.034603 (Thread-1): finished collecting timing info
2021-12-05 23:23:02.064724 (Thread-2): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:23:02.067293 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:23:02.089766 (Thread-2): Using snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:23:02.089878 (Thread-2): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-05 23:23:02.089971 (Thread-2): Opening a new connection, currently in state init
2021-12-05 23:23:02.091181 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:23:02.091260 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-05 23:23:02.091318 (Thread-1): Opening a new connection, currently in state closed
2021-12-05 23:23:02.867716 (Thread-27): handling poll request
2021-12-05 23:23:02.868030 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf89160>]}
2021-12-05 23:23:02.868761 (Thread-27): sending response (<Response 9907 bytes [200 OK]>) to 10.0.30.196
2021-12-05 23:23:03.585377 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-12-05 23:23:03.592058 (Thread-1): finished collecting timing info
2021-12-05 23:23:03.592194 (Thread-1): On model.my_new_project.stg_customers: Close
2021-12-05 23:23:03.607556 (Thread-2): SQL status: SUCCESS 1 in 1.52 seconds
2021-12-05 23:23:03.608611 (Thread-2): finished collecting timing info
2021-12-05 23:23:03.608713 (Thread-2): On model.my_new_project.stg_orders: Close
2021-12-05 23:23:04.045025 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fca632e80>]}
2021-12-05 23:23:04.045634 (Thread-1): 23:23:04 | 1 of 3 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.03s]
2021-12-05 23:23:04.045790 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-12-05 23:23:04.049099 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fca643280>]}
2021-12-05 23:23:04.049407 (Thread-2): 23:23:04 | 2 of 3 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.04s]
2021-12-05 23:23:04.049496 (Thread-2): Finished running node model.my_new_project.stg_orders
2021-12-05 23:23:04.050449 (Thread-4): Began running node model.my_new_project.dim_customers
2021-12-05 23:23:04.050666 (Thread-4): 23:23:04 | 3 of 3 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-05 23:23:04.050890 (Thread-4): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:23:04.050966 (Thread-4): Compiling model.my_new_project.dim_customers
2021-12-05 23:23:04.053565 (Thread-4): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:23:04.069882 (Thread-4): finished collecting timing info
2021-12-05 23:23:04.086194 (Thread-4): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:23:04.101283 (Thread-4): Using snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:23:04.101364 (Thread-4): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (

with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-05 23:23:04.101423 (Thread-4): Opening a new connection, currently in state init
2021-12-05 23:23:04.393045 (Thread-28): handling poll request
2021-12-05 23:23:04.393348 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf89d30>]}
2021-12-05 23:23:04.394076 (Thread-28): sending response (<Response 10061 bytes [200 OK]>) to 10.0.38.70
2021-12-05 23:23:05.841225 (Thread-29): handling poll request
2021-12-05 23:23:05.841533 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf89e20>]}
2021-12-05 23:23:05.842064 (Thread-29): sending response (<Response 287 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:23:06.310940 (Thread-4): SQL status: SUCCESS 1 in 2.21 seconds
2021-12-05 23:23:06.315481 (Thread-4): finished collecting timing info
2021-12-05 23:23:06.315620 (Thread-4): On model.my_new_project.dim_customers: Close
2021-12-05 23:23:06.766886 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88d17f6e-d122-4007-88cc-9b5487142530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fcaa82ac0>]}
2021-12-05 23:23:06.767228 (Thread-4): 23:23:06 | 3 of 3 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.72s]
2021-12-05 23:23:06.767314 (Thread-4): Finished running node model.my_new_project.dim_customers
2021-12-05 23:23:06.768789 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:23:06.769079 (MainThread): 23:23:06 | 
2021-12-05 23:23:06.769147 (MainThread): 23:23:06 | Finished running 2 view models, 1 table model in 10.43s.
2021-12-05 23:23:06.769197 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:23:06.769237 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-12-05 23:23:06.769272 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:23:06.769306 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:23:06.822851 (MainThread): 
2021-12-05 23:23:06.822961 (MainThread): Completed successfully
2021-12-05 23:23:06.823031 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-05 23:23:07.284040 (Thread-30): handling poll request
2021-12-05 23:23:07.284367 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4ca0>]}
2021-12-05 23:23:07.285489 (Thread-30): sending response (<Response 14304 bytes [200 OK]>) to 10.0.6.10
2021-12-05 23:23:08.221652 (Thread-31): handling status request
2021-12-05 23:23:08.222010 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfab190>]}
2021-12-05 23:23:08.222549 (Thread-31): sending response (<Response 1983 bytes [200 OK]>) to 10.0.3.73
2021-12-05 23:23:08.237477 (Thread-32): handling status request
2021-12-05 23:23:08.237689 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfab820>]}
2021-12-05 23:23:08.238127 (Thread-32): sending response (<Response 1983 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:25:04.270383 (Thread-33): handling status request
2021-12-05 23:25:04.272500 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfaba30>]}
2021-12-05 23:25:04.273030 (Thread-33): sending response (<Response 1983 bytes [200 OK]>) to 10.0.37.206
2021-12-05 23:25:04.571123 (Thread-34): handling status request
2021-12-05 23:25:04.571475 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfabc10>]}
2021-12-05 23:25:04.572016 (Thread-34): sending response (<Response 1983 bytes [200 OK]>) to 10.0.22.219
2021-12-05 23:25:04.741700 (Thread-35): handling docs.generate request
2021-12-05 23:25:04.742010 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfabdf0>]}
2021-12-05 23:25:06.669798 (Thread-35): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.143
2021-12-05 23:25:06.693822 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7da2f32a-4a01-46b2-915f-d0e528786892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d329c7070>]}
2021-12-05 23:25:06.694097 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-05 23:25:06.695256 (MainThread): 
2021-12-05 23:25:06.695373 (MainThread): Acquiring new snowflake connection "master".
2021-12-05 23:25:06.695972 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-05 23:25:06.710161 (ThreadPoolExecutor-0_0): Parsing macros/catalog.sql
2021-12-05 23:25:06.713321 (ThreadPoolExecutor-0_0): Parsing macros/adapters.sql
2021-12-05 23:25:06.747071 (ThreadPoolExecutor-0_0): Parsing macros/materializations/merge.sql
2021-12-05 23:25:06.750827 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table.sql
2021-12-05 23:25:06.753963 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed.sql
2021-12-05 23:25:06.758124 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view.sql
2021-12-05 23:25:06.759502 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental.sql
2021-12-05 23:25:06.768451 (ThreadPoolExecutor-0_0): Parsing macros/core.sql
2021-12-05 23:25:06.772008 (ThreadPoolExecutor-0_0): Parsing macros/materializations/test.sql
2021-12-05 23:25:06.778694 (ThreadPoolExecutor-0_0): Parsing macros/materializations/helpers.sql
2021-12-05 23:25:06.787879 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/view.sql
2021-12-05 23:25:06.794575 (ThreadPoolExecutor-0_0): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-05 23:25:06.798258 (ThreadPoolExecutor-0_0): Parsing macros/materializations/seed/seed.sql
2021-12-05 23:25:06.819300 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/strategies.sql
2021-12-05 23:25:06.835258 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-05 23:25:06.836945 (ThreadPoolExecutor-0_0): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-05 23:25:06.866003 (ThreadPoolExecutor-0_0): Parsing macros/materializations/table/table.sql
2021-12-05 23:25:06.872885 (ThreadPoolExecutor-0_0): Parsing macros/materializations/common/merge.sql
2021-12-05 23:25:06.885956 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-05 23:25:06.904384 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/incremental.sql
2021-12-05 23:25:06.914014 (ThreadPoolExecutor-0_0): Parsing macros/materializations/incremental/helpers.sql
2021-12-05 23:25:06.915709 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_alias.sql
2021-12-05 23:25:06.917208 (ThreadPoolExecutor-0_0): Parsing macros/etc/datetime.sql
2021-12-05 23:25:06.925125 (ThreadPoolExecutor-0_0): Parsing macros/etc/query.sql
2021-12-05 23:25:06.926153 (ThreadPoolExecutor-0_0): Parsing macros/etc/where_subquery.sql
2021-12-05 23:25:06.927917 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_database.sql
2021-12-05 23:25:06.929505 (ThreadPoolExecutor-0_0): Parsing macros/etc/get_custom_schema.sql
2021-12-05 23:25:06.931914 (ThreadPoolExecutor-0_0): Parsing macros/etc/is_incremental.sql
2021-12-05 23:25:06.933479 (ThreadPoolExecutor-0_0): Parsing macros/adapters/common.sql
2021-12-05 23:25:06.984890 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/accepted_values.sql
2021-12-05 23:25:06.987105 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/not_null.sql
2021-12-05 23:25:06.988330 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/relationships.sql
2021-12-05 23:25:06.989981 (ThreadPoolExecutor-0_0): Parsing macros/schema_tests/unique.sql
2021-12-05 23:25:07.002413 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-05 23:25:07.002495 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: show terse objects in analytics.dbt_pstulnikov
2021-12-05 23:25:07.002550 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-05 23:25:07.114774 (Thread-36): handling poll request
2021-12-05 23:25:07.115053 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc73fca0>]}
2021-12-05 23:25:07.116069 (Thread-36): sending response (<Response 12362 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:25:08.528873 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.53 seconds
2021-12-05 23:25:08.530867 (ThreadPoolExecutor-0_0): On list_analytics_dbt_pstulnikov: Close
2021-12-05 23:25:08.556972 (Thread-37): handling poll request
2021-12-05 23:25:08.557230 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc73ff10>]}
2021-12-05 23:25:08.557713 (Thread-37): sending response (<Response 862 bytes [200 OK]>) to 10.0.19.103
2021-12-05 23:25:08.976698 (MainThread): 23:25:08 | Concurrency: 4 threads (target='default')
2021-12-05 23:25:08.976896 (MainThread): 23:25:08 | 
2021-12-05 23:25:08.978968 (Thread-1): Began running node model.my_new_project.stg_customers
2021-12-05 23:25:08.979149 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-05 23:25:08.979250 (Thread-1): Compiling model.my_new_project.stg_customers
2021-12-05 23:25:08.980153 (Thread-2): Began running node model.my_new_project.stg_orders
2021-12-05 23:25:08.980313 (Thread-2): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-05 23:25:08.980384 (Thread-2): Compiling model.my_new_project.stg_orders
2021-12-05 23:25:08.981677 (Thread-2): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-12-05 23:25:08.983055 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-12-05 23:25:09.001084 (Thread-1): finished collecting timing info
2021-12-05 23:25:09.001395 (Thread-1): finished collecting timing info
2021-12-05 23:25:09.001526 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-12-05 23:25:09.002754 (Thread-2): finished collecting timing info
2021-12-05 23:25:09.002873 (Thread-2): finished collecting timing info
2021-12-05 23:25:09.002972 (Thread-2): Finished running node model.my_new_project.stg_orders
2021-12-05 23:25:09.003652 (Thread-4): Began running node model.my_new_project.dim_customers
2021-12-05 23:25:09.003808 (Thread-4): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-05 23:25:09.003877 (Thread-4): Compiling model.my_new_project.dim_customers
2021-12-05 23:25:09.006614 (Thread-4): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-12-05 23:25:09.022508 (Thread-4): finished collecting timing info
2021-12-05 23:25:09.022632 (Thread-4): finished collecting timing info
2021-12-05 23:25:09.022734 (Thread-4): Finished running node model.my_new_project.dim_customers
2021-12-05 23:25:09.023793 (MainThread): Connection 'master' was properly closed.
2021-12-05 23:25:09.023871 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-12-05 23:25:09.023911 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-12-05 23:25:09.023946 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-05 23:25:09.081490 (MainThread): 23:25:09 | Done.
2021-12-05 23:25:09.123233 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-12-05 23:25:09.123311 (MainThread): 23:25:09 | Building catalog
2021-12-05 23:25:09.124096 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "analytics.information_schema".
2021-12-05 23:25:09.131535 (ThreadPoolExecutor-1_0): Using snowflake connection "analytics.information_schema".
2021-12-05 23:25:09.131602 (ThreadPoolExecutor-1_0): On analytics.information_schema: with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_pstulnikov'))
      order by "column_index"
2021-12-05 23:25:09.131663 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-05 23:25:09.996385 (Thread-38): handling poll request
2021-12-05 23:25:09.996692 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfa9070>]}
2021-12-05 23:25:09.997488 (Thread-38): sending response (<Response 15437 bytes [200 OK]>) to 10.0.30.196
2021-12-05 23:25:11.446258 (Thread-39): handling poll request
2021-12-05 23:25:11.446552 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfae610>]}
2021-12-05 23:25:11.470857 (Thread-39): sending response (<Response 296 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:25:11.509545 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 13 in 2.38 seconds
2021-12-05 23:25:11.518177 (ThreadPoolExecutor-1_0): On analytics.information_schema: Close
2021-12-05 23:25:12.016621 (MainThread): 23:25:12 | Catalog written to /usr/src/develop/user-48664/environment-53260/repository-43071/target/catalog.json
2021-12-05 23:25:12.957237 (Thread-40): handling poll request
2021-12-05 23:25:12.957527 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc750cd0>]}
2021-12-05 23:25:12.958243 (Thread-40): sending response (<Response 4200 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:25:13.890924 (Thread-41): handling status request
2021-12-05 23:25:13.891232 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc750dc0>]}
2021-12-05 23:25:13.891784 (Thread-41): sending response (<Response 1983 bytes [200 OK]>) to 10.0.2.25
2021-12-05 23:25:13.962318 (Thread-42): handling status request
2021-12-05 23:25:13.962535 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc750e20>]}
2021-12-05 23:25:13.962956 (Thread-42): sending response (<Response 1983 bytes [200 OK]>) to 10.0.41.241
2021-12-05 23:25:14.017894 (Thread-43): handling status request
2021-12-05 23:25:14.018144 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc74f250>]}
2021-12-05 23:25:14.018555 (Thread-43): sending response (<Response 1983 bytes [200 OK]>) to 10.0.38.50
2021-12-05 23:51:40.796717 (Thread-44): handling status request
2021-12-05 23:51:40.798715 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc74f610>]}
2021-12-05 23:51:40.799222 (Thread-44): sending response (<Response 1983 bytes [200 OK]>) to 10.0.6.71
2021-12-05 23:51:44.243532 (Thread-45): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-05 23:51:44.243841 (Thread-45): Partial parsing enabled, no changes found, skipping parsing
2021-12-05 23:51:44.244304 (Thread-45): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-05 23:51:44.248871 (Thread-45): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc71fc40>]}
2021-12-05 23:51:45.174730 (Thread-46): handling status request
2021-12-05 23:51:45.175045 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc71feb0>]}
2021-12-05 23:51:45.175522 (Thread-46): sending response (<Response 1639 bytes [200 OK]>) to 10.0.0.217
2021-12-05 23:51:45.176463 (Thread-47): handling status request
2021-12-05 23:51:45.176808 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c491e460>]}
2021-12-05 23:51:45.177236 (Thread-47): sending response (<Response 1639 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:02:56.092098 (Thread-48): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:02:56.093917 (Thread-48): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:02:56.094382 (Thread-48): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:02:56.098882 (Thread-48): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc690d00>]}
2021-12-06 00:02:56.917529 (Thread-49): handling status request
2021-12-06 00:02:56.917851 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc76dfd0>]}
2021-12-06 00:02:56.918363 (Thread-49): sending response (<Response 1639 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:02:56.979116 (Thread-50): handling status request
2021-12-06 00:02:56.979336 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc76dd60>]}
2021-12-06 00:02:56.979751 (Thread-50): sending response (<Response 1639 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:03:09.271898 (Thread-51): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:03:09.272222 (Thread-51): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:03:09.272639 (Thread-51): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:03:09.277102 (Thread-51): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6fd790>]}
2021-12-06 00:03:10.035617 (Thread-52): handling status request
2021-12-06 00:03:10.035920 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6ed160>]}
2021-12-06 00:03:10.036390 (Thread-52): sending response (<Response 1639 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:03:10.060978 (Thread-53): handling status request
2021-12-06 00:03:10.061183 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6ed130>]}
2021-12-06 00:03:10.061557 (Thread-53): sending response (<Response 1639 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:03:14.998032 (Thread-54): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:03:14.998366 (Thread-54): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:03:14.998793 (Thread-54): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:03:15.003384 (Thread-54): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63bbe0>]}
2021-12-06 00:03:15.781692 (Thread-55): handling status request
2021-12-06 00:03:15.782041 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6580d0>]}
2021-12-06 00:03:15.782556 (Thread-55): sending response (<Response 1639 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:03:15.831753 (Thread-56): handling status request
2021-12-06 00:03:15.831952 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc658040>]}
2021-12-06 00:03:15.832352 (Thread-56): sending response (<Response 1639 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:03:41.272521 (Thread-57): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:03:41.272844 (Thread-57): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:03:41.273292 (Thread-57): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:03:41.277624 (Thread-57): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc7786a0>]}
2021-12-06 00:03:42.388727 (Thread-58): handling status request
2021-12-06 00:03:42.389047 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc717d60>]}
2021-12-06 00:03:42.389555 (Thread-58): sending response (<Response 1639 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:03:42.396585 (Thread-59): handling status request
2021-12-06 00:03:42.396791 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc7179d0>]}
2021-12-06 00:03:42.397160 (Thread-59): sending response (<Response 1639 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:04:12.860250 (Thread-60): Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2021-12-06 00:04:12.860559 (Thread-60): Partial parsing: added file: my_new_project://models/staging/jaffle_shop/stg_customers.sql
2021-12-06 00:04:12.860687 (Thread-60): Partial parsing: deleted file: my_new_project://models/stg_customers.sql
2021-12-06 00:04:12.864217 (Thread-60): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-12-06 00:04:12.866775 (Thread-60): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-06 00:04:12.903913 (Thread-60): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:04:12.908181 (Thread-60): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc71f220>]}
2021-12-06 00:04:13.620584 (Thread-61): handling status request
2021-12-06 00:04:13.620897 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6fb6d0>]}
2021-12-06 00:04:13.621451 (Thread-61): sending response (<Response 2584 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:04:13.647768 (Thread-62): handling status request
2021-12-06 00:04:13.647970 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6fba30>]}
2021-12-06 00:04:13.648405 (Thread-62): sending response (<Response 2584 bytes [200 OK]>) to 10.0.6.71
2021-12-06 00:04:31.285780 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-06 00:04:31.347213 (Thread-63): Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2021-12-06 00:04:31.347482 (Thread-63): Partial parsing: added file: my_new_project://models/staging/jaffle_shop/stg_orders.sql
2021-12-06 00:04:31.347600 (Thread-63): Partial parsing: deleted file: my_new_project://models/stg_orders.sql
2021-12-06 00:04:31.350864 (Thread-63): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-12-06 00:04:31.353393 (Thread-63): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-06 00:04:31.396858 (Thread-63): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:04:31.401215 (Thread-63): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc610eb0>]}
2021-12-06 00:04:32.094671 (Thread-64): handling status request
2021-12-06 00:04:32.094982 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc610eb0>]}
2021-12-06 00:04:32.095508 (Thread-64): sending response (<Response 2575 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:04:32.128530 (Thread-65): handling status request
2021-12-06 00:04:32.128753 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc766610>]}
2021-12-06 00:04:32.129184 (Thread-65): sending response (<Response 2575 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:05:15.352603 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-06 00:05:15.419055 (Thread-66): Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2021-12-06 00:05:15.419330 (Thread-66): Partial parsing: added file: my_new_project://models/marts/core/dim_customers.sql
2021-12-06 00:05:15.419449 (Thread-66): Partial parsing: deleted file: my_new_project://models/dim_customers.sql
2021-12-06 00:05:15.422765 (Thread-66): Acquiring new snowflake connection "model.my_new_project.dim_customers".
2021-12-06 00:05:15.462926 (Thread-66): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-12-06 00:05:15.467179 (Thread-66): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5e1be0>]}
2021-12-06 00:05:16.171179 (Thread-67): handling status request
2021-12-06 00:05:16.171485 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5e1820>]}
2021-12-06 00:05:16.171977 (Thread-67): sending response (<Response 2270 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:05:16.180991 (Thread-68): handling status request
2021-12-06 00:05:16.181187 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5e1910>]}
2021-12-06 00:05:16.181543 (Thread-68): sending response (<Response 2270 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:17:36.738806 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-12-06 00:17:36.763689 (Thread-69): Unable to do partial parsing because a project dependency has been added
2021-12-06 00:17:36.763944 (Thread-69): Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc64ee50>]}
2021-12-06 00:17:36.839292 (Thread-69): Parsing macros/catalog.sql
2021-12-06 00:17:36.841232 (Thread-69): Parsing macros/adapters.sql
2021-12-06 00:17:36.874101 (Thread-69): Parsing macros/materializations/merge.sql
2021-12-06 00:17:36.877665 (Thread-69): Parsing macros/materializations/table.sql
2021-12-06 00:17:36.880725 (Thread-69): Parsing macros/materializations/seed.sql
2021-12-06 00:17:36.884822 (Thread-69): Parsing macros/materializations/view.sql
2021-12-06 00:17:36.886109 (Thread-69): Parsing macros/materializations/incremental.sql
2021-12-06 00:17:36.894023 (Thread-69): Parsing macros/core.sql
2021-12-06 00:17:36.897419 (Thread-69): Parsing macros/materializations/test.sql
2021-12-06 00:17:36.903565 (Thread-69): Parsing macros/materializations/helpers.sql
2021-12-06 00:17:36.913069 (Thread-69): Parsing macros/materializations/view/view.sql
2021-12-06 00:17:36.919540 (Thread-69): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:17:36.923183 (Thread-69): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:17:36.944262 (Thread-69): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:17:36.960121 (Thread-69): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:17:36.961709 (Thread-69): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:17:36.990743 (Thread-69): Parsing macros/materializations/table/table.sql
2021-12-06 00:17:36.997527 (Thread-69): Parsing macros/materializations/common/merge.sql
2021-12-06 00:17:37.010457 (Thread-69): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:17:37.028732 (Thread-69): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:17:37.038003 (Thread-69): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:17:37.039685 (Thread-69): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:17:37.041183 (Thread-69): Parsing macros/etc/datetime.sql
2021-12-06 00:17:37.049052 (Thread-69): Parsing macros/etc/query.sql
2021-12-06 00:17:37.049989 (Thread-69): Parsing macros/etc/where_subquery.sql
2021-12-06 00:17:37.051657 (Thread-69): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:17:37.053167 (Thread-69): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:17:37.055495 (Thread-69): Parsing macros/etc/is_incremental.sql
2021-12-06 00:17:37.056892 (Thread-69): Parsing macros/adapters/common.sql
2021-12-06 00:17:37.108140 (Thread-69): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:17:37.110264 (Thread-69): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:17:37.111438 (Thread-69): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:17:37.112976 (Thread-69): Parsing macros/schema_tests/unique.sql
2021-12-06 00:17:37.286014 (Thread-69): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:17:37.288873 (Thread-69): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:17:37.291553 (Thread-69): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:17:37.387152 (Thread-69): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc49fa90>]}
2021-12-06 00:17:37.581527 (Thread-70): handling status request
2021-12-06 00:17:37.581846 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5baf40>]}
2021-12-06 00:17:37.582664 (Thread-70): sending response (<Response 11304 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:17:37.626541 (Thread-71): handling status request
2021-12-06 00:17:37.626772 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5bac10>]}
2021-12-06 00:17:37.627484 (Thread-71): sending response (<Response 11304 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:17:45.174665 (Thread-72): handling status request
2021-12-06 00:17:45.174974 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5baa90>]}
2021-12-06 00:17:45.175729 (Thread-72): sending response (<Response 11304 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:17:45.524775 (Thread-73): handling status request
2021-12-06 00:17:45.525027 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5ba7c0>]}
2021-12-06 00:17:45.525770 (Thread-73): sending response (<Response 11304 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:17:45.663124 (Thread-74): handling cli_args request
2021-12-06 00:17:45.663330 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5ba5e0>]}
2021-12-06 00:17:45.673418 (Thread-74): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:17:47.635001 (Thread-74): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:17:47.657826 (MainThread): Partial parsing not enabled
2021-12-06 00:17:47.696956 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:17:47.699057 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:17:47.735455 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:17:47.739214 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:17:47.742560 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:17:47.746908 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:17:47.748169 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:17:47.756652 (MainThread): Parsing macros/core.sql
2021-12-06 00:17:47.760213 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:17:47.766807 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:17:47.776463 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:17:47.783408 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:17:47.787148 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:17:47.809420 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:17:47.826313 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:17:47.827885 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:17:47.858301 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:17:47.865414 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:17:47.878904 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:17:47.897995 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:17:47.907765 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:17:47.909510 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:17:47.910967 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:17:47.919186 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:17:47.920098 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:17:47.921753 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:17:47.923282 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:17:47.925673 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:17:47.927126 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:17:47.982046 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:17:47.984180 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:17:47.985287 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:17:47.986878 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:17:48.119815 (Thread-75): handling poll request
2021-12-06 00:17:48.120124 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc766fa0>]}
2021-12-06 00:17:48.121220 (Thread-75): sending response (<Response 9652 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:17:48.176826 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:17:48.188561 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:17:48.191039 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:17:48.248883 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33cc136df0>]}
2021-12-06 00:17:48.265769 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33cc136e20>]}
2021-12-06 00:17:48.265994 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:17:48.266989 (MainThread): 
2021-12-06 00:17:48.267189 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:17:48.267951 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:17:48.279223 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:17:48.279292 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:17:48.279345 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:17:49.604494 (Thread-76): handling poll request
2021-12-06 00:17:49.604805 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4a4b20>]}
2021-12-06 00:17:49.605417 (Thread-76): sending response (<Response 4323 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:17:49.820526 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.54 seconds
2021-12-06 00:17:49.822366 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:17:50.273308 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:17:50.280368 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:17:50.280477 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:17:50.280542 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:17:51.048053 (Thread-77): handling poll request
2021-12-06 00:17:51.048365 (Thread-77): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4a4730>]}
2021-12-06 00:17:51.048913 (Thread-77): sending response (<Response 2257 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:17:51.545302 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-12-06 00:17:51.546727 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:17:52.001850 (MainThread): 00:17:51 | Concurrency: 4 threads (target='default')
2021-12-06 00:17:52.002016 (MainThread): 00:17:51 | 
2021-12-06 00:17:52.003916 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:17:52.004189 (Thread-1): 00:17:51 | 1 of 3 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:17:52.004411 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:17:52.004506 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:17:52.005322 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:17:52.005540 (Thread-2): 00:17:51 | 2 of 3 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:17:52.005772 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:17:52.005841 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:17:52.006951 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:17:52.007807 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:17:52.044624 (Thread-2): finished collecting timing info
2021-12-06 00:17:52.049946 (Thread-1): finished collecting timing info
2021-12-06 00:17:52.077577 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:17:52.078733 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:17:52.115104 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:17:52.115183 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:17:52.115240 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:17:52.119223 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:17:52.119305 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:17:52.119361 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:17:52.513741 (Thread-78): handling poll request
2021-12-06 00:17:52.514057 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5d06a0>]}
2021-12-06 00:17:52.514806 (Thread-78): sending response (<Response 9839 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:17:53.656068 (Thread-2): SQL status: SUCCESS 1 in 1.54 seconds
2021-12-06 00:17:53.662881 (Thread-2): finished collecting timing info
2021-12-06 00:17:53.663018 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:17:53.663726 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-12-06 00:17:53.664819 (Thread-1): finished collecting timing info
2021-12-06 00:17:53.664927 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:17:53.975205 (Thread-79): handling poll request
2021-12-06 00:17:53.975503 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5d0ac0>]}
2021-12-06 00:17:53.976033 (Thread-79): sending response (<Response 2458 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:17:54.111223 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33cc9fa190>]}
2021-12-06 00:17:54.111629 (Thread-2): 00:17:54 | 2 of 3 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.11s]
2021-12-06 00:17:54.111728 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:17:54.126865 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c71b1fd0>]}
2021-12-06 00:17:54.127158 (Thread-1): 00:17:54 | 1 of 3 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.12s]
2021-12-06 00:17:54.127236 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:17:54.127968 (Thread-4): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:17:54.128172 (Thread-4): 00:17:54 | 3 of 3 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:17:54.128405 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:17:54.128478 (Thread-4): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:17:54.131112 (Thread-4): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:17:54.158508 (Thread-4): finished collecting timing info
2021-12-06 00:17:54.174661 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:17:54.201525 (Thread-4): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:17:54.201608 (Thread-4): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (

with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:17:54.201667 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:17:55.423809 (Thread-80): handling poll request
2021-12-06 00:17:55.424121 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b9310>]}
2021-12-06 00:17:55.424786 (Thread-80): sending response (<Response 7789 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:17:57.009021 (Thread-4): SQL status: SUCCESS 1 in 2.81 seconds
2021-12-06 00:17:57.013607 (Thread-4): finished collecting timing info
2021-12-06 00:17:57.013741 (Thread-4): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:17:57.052105 (Thread-81): handling poll request
2021-12-06 00:17:57.052380 (Thread-81): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b9610>]}
2021-12-06 00:17:57.052909 (Thread-81): sending response (<Response 1378 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:17:57.470881 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87da79c-070b-4e47-adfb-9ae5ef170d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ccae3a00>]}
2021-12-06 00:17:57.471239 (Thread-4): 00:17:57 | 3 of 3 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 3.34s]
2021-12-06 00:17:57.471331 (Thread-4): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:17:57.472789 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:17:57.473096 (MainThread): 00:17:57 | 
2021-12-06 00:17:57.473169 (MainThread): 00:17:57 | Finished running 2 view models, 1 table model in 9.21s.
2021-12-06 00:17:57.473219 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:17:57.473260 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:17:57.473297 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:17:57.473333 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:17:57.527014 (MainThread): 
2021-12-06 00:17:57.527124 (MainThread): Completed successfully
2021-12-06 00:17:57.527189 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-06 00:17:58.498627 (Thread-82): handling poll request
2021-12-06 00:17:58.498953 (Thread-82): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5d08e0>]}
2021-12-06 00:17:58.500048 (Thread-82): sending response (<Response 13443 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:17:59.464845 (Thread-83): handling status request
2021-12-06 00:17:59.465166 (Thread-83): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6876a0>]}
2021-12-06 00:17:59.466056 (Thread-83): sending response (<Response 11304 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:17:59.519230 (Thread-84): handling status request
2021-12-06 00:17:59.519465 (Thread-84): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5453d0>]}
2021-12-06 00:17:59.520169 (Thread-84): sending response (<Response 11304 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:18:08.375458 (Thread-85): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:18:08.375764 (Thread-85): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 00:18:08.379344 (Thread-85): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:18:08.423159 (Thread-85): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4e7130>]}
2021-12-06 00:18:09.160768 (Thread-86): handling status request
2021-12-06 00:18:09.161094 (Thread-86): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5c1160>]}
2021-12-06 00:18:09.161602 (Thread-86): sending response (<Response 1533 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:18:09.193386 (Thread-87): handling status request
2021-12-06 00:18:09.193610 (Thread-87): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4e7d30>]}
2021-12-06 00:18:09.194065 (Thread-87): sending response (<Response 1533 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:18:12.362366 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:18:12.422417 (Thread-88): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:18:12.422706 (Thread-88): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:18:12.427193 (Thread-88): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52b820>]}
2021-12-06 00:18:13.098062 (Thread-89): handling status request
2021-12-06 00:18:13.098369 (Thread-89): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52ae50>]}
2021-12-06 00:18:13.098847 (Thread-89): sending response (<Response 1209 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:18:13.139500 (Thread-90): handling status request
2021-12-06 00:18:13.139707 (Thread-90): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc4d04f0>]}
2021-12-06 00:18:13.140100 (Thread-90): sending response (<Response 1209 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:16.253264 (Thread-91): handling status request
2021-12-06 00:18:16.253576 (Thread-91): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b29a0>]}
2021-12-06 00:18:16.254057 (Thread-91): sending response (<Response 1209 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:18:16.555660 (Thread-92): handling status request
2021-12-06 00:18:16.555940 (Thread-92): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b2790>]}
2021-12-06 00:18:16.556382 (Thread-92): sending response (<Response 1209 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:18:16.737898 (Thread-93): handling cli_args request
2021-12-06 00:18:16.738142 (Thread-93): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5b2520>]}
2021-12-06 00:18:18.676638 (Thread-93): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:18.713053 (MainThread): Partial parsing not enabled
2021-12-06 00:18:18.752333 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:18:18.754319 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:18:18.789032 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:18:18.792733 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:18:18.795927 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:18:18.800189 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:18:18.801435 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:18:18.809746 (MainThread): Parsing macros/core.sql
2021-12-06 00:18:18.813266 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:18:18.819633 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:18:18.829378 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:18:18.836287 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:18:18.839959 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:18:18.861914 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:18:18.878632 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:18:18.880197 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:18:18.910201 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:18:18.917254 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:18:18.930659 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:18:18.949558 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:18:18.959358 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:18:18.961056 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:18:18.962487 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:18:18.970690 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:18:18.971571 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:18:18.973213 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:18:18.974740 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:18:18.977102 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:18:18.978536 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:18:19.031829 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:18:19.033961 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:18:19.035086 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:18:19.036604 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:18:19.148441 (Thread-94): handling poll request
2021-12-06 00:18:19.148741 (Thread-94): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b8be0>]}
2021-12-06 00:18:19.149787 (Thread-94): sending response (<Response 9652 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:19.223699 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:18:19.235427 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:18:19.237841 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:18:19.294427 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5280081b20>]}
2021-12-06 00:18:19.313001 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5280081ee0>]}
2021-12-06 00:18:19.313199 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:18:19.314257 (MainThread): 
2021-12-06 00:18:19.314456 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:18:19.322324 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:18:19.334126 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:18:19.334201 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:18:19.334255 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:18:20.593240 (Thread-95): handling poll request
2021-12-06 00:18:20.593550 (Thread-95): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc55e820>]}
2021-12-06 00:18:20.594174 (Thread-95): sending response (<Response 4323 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:18:20.942196 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.61 seconds
2021-12-06 00:18:20.943968 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:18:21.392172 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:18:21.399137 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:18:21.399241 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:18:21.399305 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:18:22.091556 (Thread-96): handling poll request
2021-12-06 00:18:22.091860 (Thread-96): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc49fbe0>]}
2021-12-06 00:18:22.092397 (Thread-96): sending response (<Response 2257 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:18:22.647379 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.25 seconds
2021-12-06 00:18:22.648795 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:18:23.103696 (MainThread): 00:18:23 | Concurrency: 4 threads (target='default')
2021-12-06 00:18:23.103839 (MainThread): 00:18:23 | 
2021-12-06 00:18:23.105721 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:18:23.106026 (Thread-1): 00:18:23 | 1 of 3 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:18:23.106251 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:18:23.106351 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:18:23.107178 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:18:23.107395 (Thread-2): 00:18:23 | 2 of 3 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:18:23.107616 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:18:23.107683 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:18:23.108747 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:18:23.109605 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:18:23.124837 (Thread-2): finished collecting timing info
2021-12-06 00:18:23.130024 (Thread-1): finished collecting timing info
2021-12-06 00:18:23.157727 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:18:23.159703 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:18:23.176636 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:18:23.176713 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:18:23.176768 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:18:23.178700 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:18:23.178782 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:18:23.178836 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:18:23.537528 (Thread-97): handling poll request
2021-12-06 00:18:23.537772 (Thread-97): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc5d6f10>]}
2021-12-06 00:18:23.538528 (Thread-97): sending response (<Response 9839 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:18:24.716122 (Thread-2): SQL status: SUCCESS 1 in 1.54 seconds
2021-12-06 00:18:24.722516 (Thread-2): finished collecting timing info
2021-12-06 00:18:24.722644 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:18:24.853072 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2021-12-06 00:18:24.854256 (Thread-1): finished collecting timing info
2021-12-06 00:18:24.854363 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:18:25.010935 (Thread-98): handling poll request
2021-12-06 00:18:25.011219 (Thread-98): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a2e50>]}
2021-12-06 00:18:25.039362 (Thread-98): sending response (<Response 2458 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:25.180706 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f528010d5e0>]}
2021-12-06 00:18:25.181093 (Thread-2): 00:18:25 | 2 of 3 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.07s]
2021-12-06 00:18:25.181178 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:18:25.305320 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527b19e430>]}
2021-12-06 00:18:25.305631 (Thread-1): 00:18:25 | 1 of 3 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.20s]
2021-12-06 00:18:25.305728 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:18:25.306653 (Thread-4): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:18:25.306869 (Thread-4): 00:18:25 | 3 of 3 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:18:25.307096 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:18:25.307167 (Thread-4): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:18:25.309542 (Thread-4): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:18:25.324394 (Thread-4): finished collecting timing info
2021-12-06 00:18:25.340457 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:18:25.356891 (Thread-4): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:18:25.356970 (Thread-4): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:18:25.357029 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:18:26.524497 (Thread-99): handling poll request
2021-12-06 00:18:26.524801 (Thread-99): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc49f580>]}
2021-12-06 00:18:26.525477 (Thread-99): sending response (<Response 7784 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:18:27.474354 (Thread-4): SQL status: SUCCESS 1 in 2.12 seconds
2021-12-06 00:18:27.478912 (Thread-4): finished collecting timing info
2021-12-06 00:18:27.479048 (Thread-4): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:18:27.938868 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79957867-9ae6-4eb9-83b5-86e477ee0272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5280aa39a0>]}
2021-12-06 00:18:27.939247 (Thread-4): 00:18:27 | 3 of 3 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.63s]
2021-12-06 00:18:27.939334 (Thread-4): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:18:27.940821 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:18:27.941105 (MainThread): 00:18:27 | 
2021-12-06 00:18:27.941176 (MainThread): 00:18:27 | Finished running 2 view models, 1 table model in 8.63s.
2021-12-06 00:18:27.941226 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:18:27.941264 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:18:27.941300 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:18:27.941333 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:18:27.997066 (MainThread): 
2021-12-06 00:18:27.997173 (MainThread): Completed successfully
2021-12-06 00:18:27.997238 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-06 00:18:28.365554 (Thread-100): handling poll request
2021-12-06 00:18:28.365851 (Thread-100): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a56d0>]}
2021-12-06 00:18:28.366993 (Thread-100): sending response (<Response 14485 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:18:29.338636 (Thread-101): handling status request
2021-12-06 00:18:29.338968 (Thread-101): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a58b0>]}
2021-12-06 00:18:29.339494 (Thread-101): sending response (<Response 1209 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:18:29.369370 (Thread-102): handling status request
2021-12-06 00:18:29.369591 (Thread-102): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a5f70>]}
2021-12-06 00:18:29.370031 (Thread-102): sending response (<Response 1209 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:18:56.531594 (Thread-103): handling status request
2021-12-06 00:18:56.531900 (Thread-103): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a5eb0>]}
2021-12-06 00:18:56.532355 (Thread-103): sending response (<Response 1209 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:19:00.668515 (Thread-104): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:19:00.668814 (Thread-104): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:19:00.674290 (Thread-104): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63b940>]}
2021-12-06 00:19:01.506642 (Thread-105): handling status request
2021-12-06 00:19:01.506961 (Thread-105): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63b100>]}
2021-12-06 00:19:01.507441 (Thread-105): sending response (<Response 1212 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:19:01.528460 (Thread-106): handling status request
2021-12-06 00:19:01.528679 (Thread-106): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63b3a0>]}
2021-12-06 00:19:01.529074 (Thread-106): sending response (<Response 1212 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:24:42.951754 (Thread-107): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:24:42.953505 (Thread-107): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:24:42.958167 (Thread-107): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf8a310>]}
2021-12-06 00:24:43.858950 (Thread-108): handling status request
2021-12-06 00:24:43.859268 (Thread-108): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc7178e0>]}
2021-12-06 00:24:43.859774 (Thread-108): sending response (<Response 1212 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:24:43.861013 (Thread-109): handling status request
2021-12-06 00:24:43.861211 (Thread-109): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc717d90>]}
2021-12-06 00:24:43.861552 (Thread-109): sending response (<Response 1212 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:24:59.525430 (Thread-110): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 00:24:59.525760 (Thread-110): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 00:24:59.530527 (Thread-110): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c48fd400>]}
2021-12-06 00:25:00.582113 (Thread-111): handling status request
2021-12-06 00:25:00.582435 (Thread-111): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc723b20>]}
2021-12-06 00:25:00.582916 (Thread-111): sending response (<Response 1212 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:25:00.603004 (Thread-112): handling status request
2021-12-06 00:25:00.603217 (Thread-112): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc723e20>]}
2021-12-06 00:25:00.603572 (Thread-112): sending response (<Response 1212 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:27:38.453297 (Thread-113): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 00:27:38.455210 (Thread-113): Partial parsing: added file: jaffle_shop://models/staging/stripe/stg_payments.sql
2021-12-06 00:27:38.459016 (Thread-113): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:27:38.500722 (Thread-113): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c48cc760>]}
2021-12-06 00:27:39.257280 (Thread-114): handling status request
2021-12-06 00:27:39.257589 (Thread-114): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfbc6a0>]}
2021-12-06 00:27:39.258126 (Thread-114): sending response (<Response 1537 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:27:39.275183 (Thread-115): handling status request
2021-12-06 00:27:39.275394 (Thread-115): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfbcac0>]}
2021-12-06 00:27:39.275774 (Thread-115): sending response (<Response 1537 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:29:20.346227 (Thread-116): handling status request
2021-12-06 00:29:20.348091 (Thread-116): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfbcb20>]}
2021-12-06 00:29:20.348579 (Thread-116): sending response (<Response 1537 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:29:20.829642 (Thread-117): handling run_sql request
2021-12-06 00:29:20.829981 (Thread-117): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfbcd00>]}
2021-12-06 00:29:20.832166 (Thread-117): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:29:22.740177 (Thread-117): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:29:22.751107 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:22.766863 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ff749a7-8779-45f5-a477-0a94ee3a5701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042659be20>]}
2021-12-06 00:29:22.767103 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:29:22.767463 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:22.767565 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:29:22.768484 (Thread-1): finished collecting timing info
2021-12-06 00:29:22.769072 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:22.769134 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payments

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 00:29:22.769187 (Thread-1): Opening a new connection, currently in state init
2021-12-06 00:29:23.194234 (Thread-118): handling poll request
2021-12-06 00:29:23.194550 (Thread-118): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcf8a490>]}
2021-12-06 00:29:23.195413 (Thread-118): sending response (<Response 3478 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:29:24.251846 (Thread-1): Snowflake query id: 01a0c17d-3200-95c4-0000-00008ef92b15
2021-12-06 00:29:24.252041 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
2021-12-06 00:29:24.252172 (Thread-1): finished collecting timing info
2021-12-06 00:29:24.252323 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 00:29:24.656088 (Thread-119): handling poll request
2021-12-06 00:29:24.656373 (Thread-119): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc647730>]}
2021-12-06 00:29:24.656951 (Thread-119): sending response (<Response 1712 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:29:24.702595 (Thread-1): Got an exception: Database Error
  002003 (42S02): SQL compilation error:
  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (42S02): SQL compilation error:
  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
2021-12-06 00:29:24.703543 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.", 'raw_sql': 'with payments as (\n    select\n        orderid as order_id,\n        amount\n\n    from raw.stripe.payments\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with payments as (\n    select\n        orderid as order_id,\n        amount\n\n    from raw.stripe.payments\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.", 'raw_sql': 'with payments as (\n    select\n        orderid as order_id,\n        amount\n\n    from raw.stripe.payments\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with payments as (\n    select\n        orderid as order_id,\n        amount\n\n    from raw.stripe.payments\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-12-06 00:29:26.143868 (Thread-120): handling poll request
2021-12-06 00:29:26.144205 (Thread-120): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b8700>]}
2021-12-06 00:29:26.144878 (Thread-120): sending response (<Response 10294 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:29:46.753523 (Thread-121): handling status request
2021-12-06 00:29:46.753844 (Thread-121): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52baf0>]}
2021-12-06 00:29:46.754412 (Thread-121): sending response (<Response 1537 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:29:47.210726 (Thread-122): handling run_sql request
2021-12-06 00:29:47.211003 (Thread-122): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52bb20>]}
2021-12-06 00:29:49.138372 (Thread-122): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:29:49.149345 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:49.162225 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04f4b3d0-ecfc-4dc4-be0d-329ac9868852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d79477d90>]}
2021-12-06 00:29:49.162453 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:29:49.162830 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:49.162928 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:29:49.163836 (Thread-1): finished collecting timing info
2021-12-06 00:29:49.164420 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:29:49.164479 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 00:29:49.164531 (Thread-1): Opening a new connection, currently in state init
2021-12-06 00:29:49.578760 (Thread-123): handling poll request
2021-12-06 00:29:49.579091 (Thread-123): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52b880>]}
2021-12-06 00:29:49.579898 (Thread-123): sending response (<Response 3477 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:29:50.706074 (Thread-1): SQL status: SUCCESS 120 in 1.54 seconds
2021-12-06 00:29:50.709085 (Thread-1): finished collecting timing info
2021-12-06 00:29:50.709277 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 00:29:51.137035 (Thread-124): handling poll request
2021-12-06 00:29:51.137336 (Thread-124): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfd4910>]}
2021-12-06 00:29:51.137879 (Thread-124): sending response (<Response 1344 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:29:52.694855 (Thread-125): handling poll request
2021-12-06 00:29:52.695194 (Thread-125): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc56ddf0>]}
2021-12-06 00:29:52.696431 (Thread-125): sending response (<Response 4730 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:30:12.228072 (Thread-126): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:30:12.228392 (Thread-126): Partial parsing: updated file: jaffle_shop://models/staging/stripe/stg_payments.sql
2021-12-06 00:30:12.232884 (Thread-126): 1699: statically parsed staging/stripe/stg_payments.sql
2021-12-06 00:30:12.233090 (Thread-126): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:30:12.235041 (Thread-126): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6b6b50>]}
2021-12-06 00:30:12.277015 (Thread-126): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51d8460>]}
2021-12-06 00:30:12.974040 (Thread-127): handling status request
2021-12-06 00:30:12.974352 (Thread-127): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51d86d0>]}
2021-12-06 00:30:13.000030 (Thread-127): sending response (<Response 2272 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:30:13.459956 (Thread-128): handling status request
2021-12-06 00:30:13.460369 (Thread-128): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51d8910>]}
2021-12-06 00:30:13.461046 (Thread-128): sending response (<Response 2272 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:31:32.300310 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:31:32.382333 (Thread-129): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2021-12-06 00:31:32.382595 (Thread-129): Partial parsing: added file: jaffle_shop://models/marts/core/fct_orders.sql
2021-12-06 00:31:32.385894 (Thread-129): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:31:32.426647 (Thread-129): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc48f970>]}
2021-12-06 00:31:33.244945 (Thread-130): handling status request
2021-12-06 00:31:33.245256 (Thread-130): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49bd910>]}
2021-12-06 00:31:33.245739 (Thread-130): sending response (<Response 1529 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:31:33.255899 (Thread-131): handling status request
2021-12-06 00:31:33.256117 (Thread-131): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c49bd760>]}
2021-12-06 00:31:33.256487 (Thread-131): sending response (<Response 1529 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:37:57.089990 (Thread-132): handling status request
2021-12-06 00:37:57.092075 (Thread-132): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4939670>]}
2021-12-06 00:37:57.092557 (Thread-132): sending response (<Response 1529 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:37:57.643751 (Thread-133): handling run_sql request
2021-12-06 00:37:57.644052 (Thread-133): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4939640>]}
2021-12-06 00:37:57.645160 (Thread-133): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:37:59.580582 (Thread-133): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:37:59.591565 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:37:59.608589 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fad98b19-8068-449c-9e07-e44b216296a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27890b0d0>]}
2021-12-06 00:37:59.608843 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:37:59.609218 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:37:59.609322 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:37:59.611323 (Thread-1): finished collecting timing info
2021-12-06 00:37:59.612227 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:37:59.612294 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 00:37:59.612348 (Thread-1): Opening a new connection, currently in state init
2021-12-06 00:38:00.085611 (Thread-134): handling poll request
2021-12-06 00:38:00.086015 (Thread-134): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63b4f0>]}
2021-12-06 00:38:00.086916 (Thread-134): sending response (<Response 3684 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:38:01.082390 (Thread-1): Snowflake query id: 01a0c186-3200-95c4-0000-00008ef92b21
2021-12-06 00:38:01.082575 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.
2021-12-06 00:38:01.082701 (Thread-1): finished collecting timing info
2021-12-06 00:38:01.082845 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 00:38:01.544591 (Thread-1): Got an exception: Database Error
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.
2021-12-06 00:38:01.545572 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments')}}\n),\n\norders as (\n    select * from {{ ref('stg_orders')}}\n),\n\n\nfinal as (\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n    \n    from orders\n\n    left join payments using (order_id)\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\norders as (\n    select * from analytics.dbt_pstulnikov.stg_orders\n),\n\n\nfinal as (\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n    \n    from orders\n\n    left join payments using (order_id)\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'ANALYTICS.DBT_PSTULNIKOV.STG_PAYMENTS' does not exist or not authorized.", 'raw_sql': "with payments as (\n    select * from {{ ref('stg_payments')}}\n),\n\norders as (\n    select * from {{ ref('stg_orders')}}\n),\n\n\nfinal as (\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n    \n    from orders\n\n    left join payments using (order_id)\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with payments as (\n    select * from analytics.dbt_pstulnikov.stg_payments\n),\n\norders as (\n    select * from analytics.dbt_pstulnikov.stg_orders\n),\n\n\nfinal as (\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n    \n    from orders\n\n    left join payments using (order_id)\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-12-06 00:38:01.588126 (Thread-135): handling poll request
2021-12-06 00:38:01.588450 (Thread-135): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc690c40>]}
2021-12-06 00:38:01.589069 (Thread-135): sending response (<Response 7814 bytes [200 OK]>) to 10.0.6.71
2021-12-06 00:38:03.035456 (Thread-136): handling poll request
2021-12-06 00:38:03.035789 (Thread-136): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc690a60>]}
2021-12-06 00:38:03.036414 (Thread-136): sending response (<Response 11882 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:38:22.343796 (Thread-137): handling status request
2021-12-06 00:38:22.344198 (Thread-137): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6b65e0>]}
2021-12-06 00:38:22.344802 (Thread-137): sending response (<Response 1529 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:38:22.648710 (Thread-138): handling status request
2021-12-06 00:38:22.649017 (Thread-138): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6a5640>]}
2021-12-06 00:38:22.649521 (Thread-138): sending response (<Response 1529 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:38:22.795378 (Thread-139): handling cli_args request
2021-12-06 00:38:22.795586 (Thread-139): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc52baf0>]}
2021-12-06 00:38:24.705854 (Thread-139): sending response (<Response 138 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:38:24.741160 (MainThread): Partial parsing not enabled
2021-12-06 00:38:24.799163 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:38:24.801076 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:38:24.834483 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:38:24.838060 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:38:24.841120 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:38:24.845239 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:38:24.846471 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:38:24.854509 (MainThread): Parsing macros/core.sql
2021-12-06 00:38:24.857919 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:38:24.864068 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:38:24.873473 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:38:24.880004 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:38:24.883577 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:38:24.904674 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:38:24.920562 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:38:24.922091 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:38:24.950972 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:38:24.957726 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:38:24.970632 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:38:24.988984 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:38:24.998328 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:38:24.999957 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:38:25.001291 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:38:25.009073 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:38:25.010029 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:38:25.011619 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:38:25.013027 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:38:25.015300 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:38:25.016640 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:38:25.068360 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:38:25.070420 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:38:25.071481 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:38:25.072943 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:38:25.156183 (Thread-140): handling poll request
2021-12-06 00:38:25.156738 (Thread-140): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63e220>]}
2021-12-06 00:38:25.157683 (Thread-140): sending response (<Response 9652 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:38:25.251779 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:38:25.263500 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:38:25.265855 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:38:25.268297 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:38:25.271930 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:38:25.327174 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8738f72550>]}
2021-12-06 00:38:25.352598 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8738f72df0>]}
2021-12-06 00:38:25.352807 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:38:25.353839 (MainThread): 
2021-12-06 00:38:25.354049 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:38:25.354865 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:38:25.368903 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:38:25.369003 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:38:25.369083 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:38:26.711252 (Thread-141): handling poll request
2021-12-06 00:38:26.711575 (Thread-141): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51d8310>]}
2021-12-06 00:38:26.712186 (Thread-141): sending response (<Response 4927 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:38:26.906790 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.54 seconds
2021-12-06 00:38:26.908604 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:38:27.366596 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:38:27.374050 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:38:27.374156 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:38:27.374230 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:38:28.198624 (Thread-142): handling poll request
2021-12-06 00:38:28.198932 (Thread-142): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc48ffa0>]}
2021-12-06 00:38:28.199496 (Thread-142): sending response (<Response 2257 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:38:28.641271 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.27 seconds
2021-12-06 00:38:28.642793 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:38:29.099611 (MainThread): 00:38:29 | Concurrency: 4 threads (target='default')
2021-12-06 00:38:29.099759 (MainThread): 00:38:29 | 
2021-12-06 00:38:29.101731 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:38:29.102056 (Thread-1): 00:38:29 | 1 of 4 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:38:29.102298 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:38:29.102398 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:38:29.103233 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:38:29.103455 (Thread-2): 00:38:29 | 2 of 4 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:38:29.103688 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:38:29.103756 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:38:29.104821 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:38:29.105688 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:38:29.105866 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:38:29.106088 (Thread-3): 00:38:29 | 3 of 4 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:38:29.106309 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:38:29.106372 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:38:29.107417 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:38:29.128906 (Thread-2): finished collecting timing info
2021-12-06 00:38:29.134042 (Thread-1): finished collecting timing info
2021-12-06 00:38:29.162385 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:38:29.162564 (Thread-3): finished collecting timing info
2021-12-06 00:38:29.164121 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:38:29.166077 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:38:29.183980 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:38:29.184059 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:38:29.184117 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:38:29.186088 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:38:29.186172 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:38:29.186227 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:38:29.187197 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:38:29.187266 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:38:29.187319 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:38:29.786651 (Thread-143): handling poll request
2021-12-06 00:38:29.786984 (Thread-143): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6f0880>]}
2021-12-06 00:38:29.787811 (Thread-143): sending response (<Response 14013 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:38:30.805283 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-12-06 00:38:30.811659 (Thread-1): finished collecting timing info
2021-12-06 00:38:30.811797 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:38:30.827068 (Thread-3): SQL status: SUCCESS 1 in 1.64 seconds
2021-12-06 00:38:30.828119 (Thread-3): finished collecting timing info
2021-12-06 00:38:30.828226 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:38:30.989104 (Thread-2): SQL status: SUCCESS 1 in 1.80 seconds
2021-12-06 00:38:30.990186 (Thread-2): finished collecting timing info
2021-12-06 00:38:30.990286 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:38:31.266572 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87380fc4f0>]}
2021-12-06 00:38:31.266902 (Thread-1): 00:38:31 | 1 of 4 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.16s]
2021-12-06 00:38:31.266984 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:38:31.268541 (Thread-144): handling poll request
2021-12-06 00:38:31.268789 (Thread-144): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6776d0>]}
2021-12-06 00:38:31.269357 (Thread-144): sending response (<Response 4835 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:38:31.268968 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873820d430>]}
2021-12-06 00:38:31.269349 (Thread-3): 00:38:31 | 3 of 4 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.16s]
2021-12-06 00:38:31.269432 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:38:31.441879 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8738096a00>]}
2021-12-06 00:38:31.442223 (Thread-2): 00:38:31 | 2 of 4 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.34s]
2021-12-06 00:38:31.442307 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:38:31.443179 (Thread-4): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:38:31.443423 (Thread-4): 00:38:31 | 4 of 4 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:38:31.443651 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:38:31.443722 (Thread-4): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:38:31.446084 (Thread-4): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:38:31.463214 (Thread-4): finished collecting timing info
2021-12-06 00:38:31.480181 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:38:31.500367 (Thread-4): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:38:31.500483 (Thread-4): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:38:31.500577 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:38:32.744617 (Thread-145): handling poll request
2021-12-06 00:38:32.744932 (Thread-145): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc677dc0>]}
2021-12-06 00:38:32.745577 (Thread-145): sending response (<Response 7781 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:38:33.614819 (Thread-4): SQL status: SUCCESS 1 in 2.11 seconds
2021-12-06 00:38:33.619453 (Thread-4): finished collecting timing info
2021-12-06 00:38:33.619592 (Thread-4): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:38:34.067766 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08166de7-00e8-4662-ada2-3b063c28abcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8728b72b50>]}
2021-12-06 00:38:34.068145 (Thread-4): 00:38:34 | 4 of 4 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.62s]
2021-12-06 00:38:34.068236 (Thread-4): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:38:34.069958 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:38:34.070284 (MainThread): 00:38:34 | 
2021-12-06 00:38:34.070355 (MainThread): 00:38:34 | Finished running 3 view models, 1 table model in 8.72s.
2021-12-06 00:38:34.070403 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:38:34.070442 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:38:34.070477 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:38:34.070511 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:38:34.070543 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:38:34.130228 (MainThread): 
2021-12-06 00:38:34.130332 (MainThread): Completed successfully
2021-12-06 00:38:34.130395 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-12-06 00:38:34.246993 (Thread-146): handling poll request
2021-12-06 00:38:34.247327 (Thread-146): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc61e4c0>]}
2021-12-06 00:38:34.247963 (Thread-146): sending response (<Response 6190 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:38:35.786840 (Thread-147): handling poll request
2021-12-06 00:38:35.787178 (Thread-147): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc61e460>]}
2021-12-06 00:38:35.790390 (Thread-147): sending response (<Response 11154 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:38:36.795944 (Thread-148): handling status request
2021-12-06 00:38:36.796254 (Thread-148): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6772e0>]}
2021-12-06 00:38:36.796744 (Thread-148): sending response (<Response 1529 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:38:36.864918 (Thread-149): handling status request
2021-12-06 00:38:36.865143 (Thread-149): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc63e100>]}
2021-12-06 00:38:36.865537 (Thread-149): sending response (<Response 1529 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:38:39.580076 (Thread-150): handling status request
2021-12-06 00:38:39.580404 (Thread-150): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc690eb0>]}
2021-12-06 00:38:39.580892 (Thread-150): sending response (<Response 1529 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:38:40.021326 (Thread-151): handling run_sql request
2021-12-06 00:38:40.021606 (Thread-151): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bcfb0370>]}
2021-12-06 00:38:41.947831 (Thread-151): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:38:41.959115 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:38:41.973018 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a135c2b-b0d9-4d46-ae54-c9af045c6877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7b951e1c0>]}
2021-12-06 00:38:41.973256 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:38:41.973616 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:38:41.973717 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:38:41.975702 (Thread-1): finished collecting timing info
2021-12-06 00:38:41.976609 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:38:41.976673 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 00:38:41.976726 (Thread-1): Opening a new connection, currently in state init
2021-12-06 00:38:42.479750 (Thread-152): handling poll request
2021-12-06 00:38:42.480125 (Thread-152): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6f09d0>]}
2021-12-06 00:38:42.481039 (Thread-152): sending response (<Response 3695 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:38:43.826405 (Thread-1): SQL status: SUCCESS 120 in 1.85 seconds
2021-12-06 00:38:43.829695 (Thread-1): finished collecting timing info
2021-12-06 00:38:43.829889 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 00:38:43.997112 (Thread-153): handling poll request
2021-12-06 00:38:43.997405 (Thread-153): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6f0d60>]}
2021-12-06 00:38:43.997957 (Thread-153): sending response (<Response 1341 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:38:45.537154 (Thread-154): handling poll request
2021-12-06 00:38:45.537495 (Thread-154): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6cb790>]}
2021-12-06 00:38:45.538840 (Thread-154): sending response (<Response 6351 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:47:40.071349 (Thread-155): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:47:40.073276 (Thread-155): Partial parsing: updated file: jaffle_shop://models/marts/core/fct_orders.sql
2021-12-06 00:47:40.076941 (Thread-155): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:47:40.121081 (Thread-155): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6089a0>]}
2021-12-06 00:47:41.022869 (Thread-156): handling status request
2021-12-06 00:47:41.023177 (Thread-156): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6086d0>]}
2021-12-06 00:47:41.023671 (Thread-156): sending response (<Response 1531 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:47:41.094912 (Thread-157): handling status request
2021-12-06 00:47:41.095129 (Thread-157): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6087f0>]}
2021-12-06 00:47:41.115967 (Thread-157): sending response (<Response 1531 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:49:31.504703 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:49:31.593905 (Thread-158): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:49:31.594204 (Thread-158): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 00:49:31.597480 (Thread-158): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:49:31.641438 (Thread-158): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc05ea90>]}
2021-12-06 00:49:32.367892 (Thread-159): handling status request
2021-12-06 00:49:32.368212 (Thread-159): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9ca0>]}
2021-12-06 00:49:32.377829 (Thread-159): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.71
2021-12-06 00:49:32.421130 (Thread-160): handling status request
2021-12-06 00:49:32.421328 (Thread-160): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9a30>]}
2021-12-06 00:49:32.421690 (Thread-160): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:49:34.193736 (Thread-161): handling status request
2021-12-06 00:49:34.194107 (Thread-161): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9850>]}
2021-12-06 00:49:34.194632 (Thread-161): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:49:34.522185 (Thread-162): handling status request
2021-12-06 00:49:34.522455 (Thread-162): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9670>]}
2021-12-06 00:49:34.522908 (Thread-162): sending response (<Response 1537 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:49:34.671824 (Thread-163): handling cli_args request
2021-12-06 00:49:34.672037 (Thread-163): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5fb9490>]}
2021-12-06 00:49:34.682581 (Thread-163): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:49:36.589646 (Thread-163): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:49:36.625527 (MainThread): Partial parsing not enabled
2021-12-06 00:49:36.674427 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:49:36.676305 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:49:36.709711 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:49:36.713299 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:49:36.716370 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:49:36.720499 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:49:36.721711 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:49:36.729594 (MainThread): Parsing macros/core.sql
2021-12-06 00:49:36.733040 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:49:36.739148 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:49:36.748456 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:49:36.754943 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:49:36.758548 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:49:36.779620 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:49:36.795417 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:49:36.796926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:49:36.826259 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:49:36.833073 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:49:36.846017 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:49:36.864264 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:49:36.873611 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:49:36.875277 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:49:36.876603 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:49:36.884351 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:49:36.885286 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:49:36.886889 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:49:36.888295 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:49:36.890593 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:49:36.891926 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:49:36.943619 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:49:36.945649 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:49:36.946730 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:49:36.948206 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:49:37.067538 (Thread-164): handling poll request
2021-12-06 00:49:37.067829 (Thread-164): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc61e8e0>]}
2021-12-06 00:49:37.068857 (Thread-164): sending response (<Response 9686 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:49:37.126076 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:49:37.137357 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:49:37.139744 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:49:37.142207 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:49:37.146056 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:49:37.202553 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7800fbb20>]}
2021-12-06 00:49:37.233219 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7800fb970>]}
2021-12-06 00:49:37.233413 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:49:37.234548 (MainThread): 
2021-12-06 00:49:37.234743 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:49:37.235583 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:49:37.246687 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:49:37.246756 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:49:37.246810 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:49:38.517042 (Thread-165): handling poll request
2021-12-06 00:49:38.517373 (Thread-165): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b7730>]}
2021-12-06 00:49:38.518010 (Thread-165): sending response (<Response 4941 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:49:38.770644 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.52 seconds
2021-12-06 00:49:38.772417 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:49:39.214888 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:49:39.221960 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:49:39.222066 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:49:39.222141 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:49:39.975780 (Thread-166): handling poll request
2021-12-06 00:49:39.976088 (Thread-166): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6b6760>]}
2021-12-06 00:49:39.976637 (Thread-166): sending response (<Response 2263 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:49:40.478241 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.26 seconds
2021-12-06 00:49:40.480497 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:49:40.922695 (MainThread): 00:49:40 | Concurrency: 4 threads (target='default')
2021-12-06 00:49:40.922833 (MainThread): 00:49:40 | 
2021-12-06 00:49:40.924795 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:49:40.925077 (Thread-1): 00:49:40 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:49:40.925305 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:49:40.925404 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:49:40.926249 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:49:40.926456 (Thread-2): 00:49:40 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:49:40.926676 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:49:40.926745 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:49:40.927799 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:49:40.928662 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:49:40.928844 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:49:40.929052 (Thread-3): 00:49:40 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:49:40.929275 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:49:40.929341 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:49:40.930406 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:49:40.946010 (Thread-3): finished collecting timing info
2021-12-06 00:49:40.951097 (Thread-1): finished collecting timing info
2021-12-06 00:49:40.981232 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:49:40.981391 (Thread-2): finished collecting timing info
2021-12-06 00:49:40.982984 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:49:40.985393 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:49:40.998747 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:49:40.998831 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:49:40.998891 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:49:41.004628 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:49:41.004712 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:49:41.004768 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:49:41.005783 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:49:41.005857 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:49:41.005912 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:49:41.619522 (Thread-167): handling poll request
2021-12-06 00:49:41.619803 (Thread-167): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6534f0>]}
2021-12-06 00:49:41.620621 (Thread-167): sending response (<Response 14047 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:49:42.676369 (Thread-2): SQL status: SUCCESS 1 in 1.67 seconds
2021-12-06 00:49:42.682866 (Thread-2): finished collecting timing info
2021-12-06 00:49:42.683000 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:49:42.731733 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-12-06 00:49:42.732887 (Thread-1): finished collecting timing info
2021-12-06 00:49:42.732996 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:49:42.845564 (Thread-3): SQL status: SUCCESS 1 in 1.85 seconds
2021-12-06 00:49:42.846660 (Thread-3): finished collecting timing info
2021-12-06 00:49:42.846762 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:49:43.123233 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77aad8e50>]}
2021-12-06 00:49:43.123577 (Thread-2): 00:49:43 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.20s]
2021-12-06 00:49:43.123659 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:49:43.125274 (Thread-168): handling poll request
2021-12-06 00:49:43.125507 (Thread-168): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6bc700>]}
2021-12-06 00:49:43.126092 (Thread-168): sending response (<Response 4835 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:49:43.217854 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77a9fed30>]}
2021-12-06 00:49:43.218161 (Thread-1): 00:49:43 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.29s]
2021-12-06 00:49:43.218241 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:49:43.289120 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77a521d30>]}
2021-12-06 00:49:43.289379 (Thread-3): 00:49:43 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.36s]
2021-12-06 00:49:43.289453 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:49:43.290262 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 00:49:43.290461 (Thread-4): 00:49:43 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 00:49:43.290678 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:49:43.290751 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 00:49:43.292985 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:49:43.304384 (Thread-4): finished collecting timing info
2021-12-06 00:49:43.320518 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:49:43.333114 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:49:43.333194 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 00:49:43.333250 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:49:44.601208 (Thread-169): handling poll request
2021-12-06 00:49:44.601515 (Thread-169): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6bc9a0>]}
2021-12-06 00:49:44.602450 (Thread-169): sending response (<Response 7299 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:49:45.863388 (Thread-4): SQL status: SUCCESS 1 in 2.53 seconds
2021-12-06 00:49:45.868136 (Thread-4): finished collecting timing info
2021-12-06 00:49:45.868294 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 00:49:46.081208 (Thread-170): handling poll request
2021-12-06 00:49:46.081486 (Thread-170): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc6bcbb0>]}
2021-12-06 00:49:46.082019 (Thread-170): sending response (<Response 1369 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:49:46.307609 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77aa630d0>]}
2021-12-06 00:49:46.307973 (Thread-4): 00:49:46 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 3.02s]
2021-12-06 00:49:46.308056 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 00:49:46.308889 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:49:46.309138 (Thread-1): 00:49:46 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:49:46.309366 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:49:46.309445 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:49:46.312070 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:49:46.328457 (Thread-1): finished collecting timing info
2021-12-06 00:49:46.330481 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:49:46.348563 (Thread-1): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:49:46.348645 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
)

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:49:46.348705 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:49:47.526637 (Thread-171): handling poll request
2021-12-06 00:49:47.526957 (Thread-171): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc61e520>]}
2021-12-06 00:49:47.527616 (Thread-171): sending response (<Response 6855 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:49:47.627595 (Thread-1): Snowflake query id: 01a0c191-3200-95c3-0000-00008ef91c49
2021-12-06 00:49:47.627728 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 0 unexpected 'customer_orders'.
syntax error line 23 at position 24 unexpected 'as'.
2021-12-06 00:49:47.627848 (Thread-1): finished collecting timing info
2021-12-06 00:49:47.627952 (Thread-1): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:49:48.070330 (Thread-1): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 0 unexpected 'customer_orders'.
  syntax error line 23 at position 24 unexpected 'as'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 18 at position 0 unexpected 'customer_orders'.
syntax error line 23 at position 24 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 0 unexpected 'customer_orders'.
  syntax error line 23 at position 24 unexpected 'as'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:49:48.071206 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3b2f39-40e1-483a-9fc7-7b6b41c39982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7784ecb80>]}
2021-12-06 00:49:48.071537 (Thread-1): 00:49:48 | 5 of 5 ERROR creating table model dbt_pstulnikov.dim_customers....... [ERROR in 1.76s]
2021-12-06 00:49:48.071623 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:49:48.073282 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:49:48.073589 (MainThread): 00:49:48 | 
2021-12-06 00:49:48.073658 (MainThread): 00:49:48 | Finished running 3 view models, 2 table models in 10.84s.
2021-12-06 00:49:48.073706 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:49:48.073745 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:49:48.073783 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:49:48.073818 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:49:48.073851 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:49:48.140544 (MainThread): 
2021-12-06 00:49:48.140646 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 00:49:48.140702 (MainThread): 
2021-12-06 00:49:48.140754 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-12-06 00:49:48.140797 (MainThread):   001003 (42000): SQL compilation error:
2021-12-06 00:49:48.140834 (MainThread):   syntax error line 18 at position 0 unexpected 'customer_orders'.
2021-12-06 00:49:48.140869 (MainThread):   syntax error line 23 at position 24 unexpected 'as'.
2021-12-06 00:49:48.140904 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:49:48.140952 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-12-06 00:49:49.008763 (Thread-172): handling poll request
2021-12-06 00:49:49.009146 (Thread-172): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b9370>]}
2021-12-06 00:49:49.010773 (Thread-172): sending response (<Response 29030 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:49:49.922113 (Thread-173): handling status request
2021-12-06 00:49:49.922425 (Thread-173): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b90a0>]}
2021-12-06 00:49:49.922925 (Thread-173): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:49:49.957366 (Thread-174): handling status request
2021-12-06 00:49:49.957589 (Thread-174): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b9310>]}
2021-12-06 00:49:49.958016 (Thread-174): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:50:36.455243 (Thread-175): handling status request
2021-12-06 00:50:36.455556 (Thread-175): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b33d0>]}
2021-12-06 00:50:36.456005 (Thread-175): sending response (<Response 1537 bytes [200 OK]>) to 10.0.30.196
2021-12-06 00:50:36.901921 (Thread-176): handling compile_sql request
2021-12-06 00:50:36.902201 (Thread-176): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b3a90>]}
2021-12-06 00:50:38.831841 (Thread-176): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:50:38.843004 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:50:38.857055 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f664d17e-2273-4959-83bf-629ac0a2a4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c751c40>]}
2021-12-06 00:50:38.857287 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:50:38.857647 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:50:38.857748 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:50:38.860030 (Thread-1): finished collecting timing info
2021-12-06 00:50:38.860254 (Thread-1): finished collecting timing info
2021-12-06 00:50:39.373219 (Thread-177): handling poll request
2021-12-06 00:50:39.373598 (Thread-177): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c51b3cd0>]}
2021-12-06 00:50:39.375159 (Thread-177): sending response (<Response 9220 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:51:12.891202 (Thread-178): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:51:12.891514 (Thread-178): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 00:51:12.895144 (Thread-178): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:51:12.938024 (Thread-178): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067910>]}
2021-12-06 00:51:13.712159 (Thread-179): handling status request
2021-12-06 00:51:13.712465 (Thread-179): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067580>]}
2021-12-06 00:51:13.712960 (Thread-179): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:51:13.849721 (Thread-180): handling status request
2021-12-06 00:51:13.850097 (Thread-180): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067cd0>]}
2021-12-06 00:51:13.850609 (Thread-180): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:51:15.658170 (Thread-181): handling status request
2021-12-06 00:51:15.658492 (Thread-181): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc0679a0>]}
2021-12-06 00:51:15.658968 (Thread-181): sending response (<Response 1537 bytes [200 OK]>) to 10.0.2.25
2021-12-06 00:51:16.028510 (Thread-182): handling status request
2021-12-06 00:51:16.028781 (Thread-182): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc0677f0>]}
2021-12-06 00:51:16.029247 (Thread-182): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:51:16.130701 (Thread-183): handling cli_args request
2021-12-06 00:51:16.130908 (Thread-183): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067eb0>]}
2021-12-06 00:51:16.140894 (Thread-183): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:51:18.067653 (Thread-183): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:51:18.103837 (MainThread): Partial parsing not enabled
2021-12-06 00:51:18.152114 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:51:18.154036 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:51:18.187578 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:51:18.191331 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:51:18.194565 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:51:18.198693 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:51:18.199915 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:51:18.207920 (MainThread): Parsing macros/core.sql
2021-12-06 00:51:18.211400 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:51:18.217538 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:51:18.226828 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:51:18.233345 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:51:18.236928 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:51:18.258168 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:51:18.274090 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:51:18.275603 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:51:18.304754 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:51:18.311621 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:51:18.324565 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:51:18.342940 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:51:18.352241 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:51:18.353873 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:51:18.355235 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:51:18.362979 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:51:18.363919 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:51:18.365517 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:51:18.366953 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:51:18.369232 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:51:18.370612 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:51:18.422429 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:51:18.424453 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:51:18.425514 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:51:18.427003 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:51:18.607055 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:51:18.621236 (Thread-184): handling poll request
2021-12-06 00:51:18.621525 (Thread-184): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ed9790>]}
2021-12-06 00:51:18.622565 (Thread-184): sending response (<Response 9991 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:51:18.618449 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:51:18.620864 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:51:18.623334 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:51:18.627236 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:51:18.681500 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656dbba970>]}
2021-12-06 00:51:18.707923 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656dbbaa90>]}
2021-12-06 00:51:18.708129 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:51:18.709231 (MainThread): 
2021-12-06 00:51:18.709427 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:51:18.710513 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:51:18.722215 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:51:18.722298 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:51:18.722355 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:51:20.170180 (Thread-185): handling poll request
2021-12-06 00:51:20.170494 (Thread-185): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc067700>]}
2021-12-06 00:51:20.171096 (Thread-185): sending response (<Response 4636 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:51:20.341441 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.62 seconds
2021-12-06 00:51:20.343314 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:51:20.795371 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:51:20.802584 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:51:20.802683 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:51:20.802748 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:51:21.619816 (Thread-186): handling poll request
2021-12-06 00:51:21.620118 (Thread-186): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5f5e700>]}
2021-12-06 00:51:21.620653 (Thread-186): sending response (<Response 2263 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:51:22.222236 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.42 seconds
2021-12-06 00:51:22.223713 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:51:22.677317 (MainThread): 00:51:22 | Concurrency: 4 threads (target='default')
2021-12-06 00:51:22.677457 (MainThread): 00:51:22 | 
2021-12-06 00:51:22.679534 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:51:22.679847 (Thread-1): 00:51:22 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:51:22.680079 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:51:22.680202 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:51:22.681027 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:51:22.681251 (Thread-2): 00:51:22 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:51:22.681478 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:51:22.681546 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:51:22.682691 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:51:22.683014 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:51:22.683225 (Thread-3): 00:51:22 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:51:22.683439 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:51:22.683507 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:51:22.684454 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:51:22.685360 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:51:22.699623 (Thread-1): finished collecting timing info
2021-12-06 00:51:22.704980 (Thread-2): finished collecting timing info
2021-12-06 00:51:22.720240 (Thread-3): finished collecting timing info
2021-12-06 00:51:22.735342 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:51:22.737023 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:51:22.740665 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:51:22.759517 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:51:22.759602 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:51:22.759662 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:51:22.760755 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:51:22.760826 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:51:22.760881 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:51:22.761459 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:51:22.761539 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:51:22.761594 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:51:23.100294 (Thread-187): handling poll request
2021-12-06 00:51:23.100569 (Thread-187): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecf760>]}
2021-12-06 00:51:23.122990 (Thread-187): sending response (<Response 14047 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:51:24.396552 (Thread-2): SQL status: SUCCESS 1 in 1.64 seconds
2021-12-06 00:51:24.402866 (Thread-2): finished collecting timing info
2021-12-06 00:51:24.402997 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:51:24.415661 (Thread-3): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-06 00:51:24.416704 (Thread-3): finished collecting timing info
2021-12-06 00:51:24.416806 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:51:24.475948 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-12-06 00:51:24.476989 (Thread-1): finished collecting timing info
2021-12-06 00:51:24.477089 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:51:24.641830 (Thread-188): handling poll request
2021-12-06 00:51:24.642147 (Thread-188): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecf190>]}
2021-12-06 00:51:24.642709 (Thread-188): sending response (<Response 3556 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:51:24.842491 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656cc99730>]}
2021-12-06 00:51:24.842911 (Thread-2): 00:51:24 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.16s]
2021-12-06 00:51:24.843005 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:51:24.871537 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656dc3c7f0>]}
2021-12-06 00:51:24.871827 (Thread-3): 00:51:24 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.19s]
2021-12-06 00:51:24.871908 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:51:24.872539 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 00:51:24.872777 (Thread-4): 00:51:24 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 00:51:24.873017 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:51:24.873094 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 00:51:24.875479 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:51:24.891011 (Thread-4): finished collecting timing info
2021-12-06 00:51:24.907510 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:51:24.924104 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:51:24.924185 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 00:51:24.924244 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:51:24.983647 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656cca55e0>]}
2021-12-06 00:51:24.983914 (Thread-1): 00:51:24 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.30s]
2021-12-06 00:51:24.983985 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:51:26.128682 (Thread-189): handling poll request
2021-12-06 00:51:26.128987 (Thread-189): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e74820>]}
2021-12-06 00:51:26.129633 (Thread-189): sending response (<Response 8577 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:51:26.944288 (Thread-4): SQL status: SUCCESS 1 in 2.02 seconds
2021-12-06 00:51:26.948896 (Thread-4): finished collecting timing info
2021-12-06 00:51:26.949029 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 00:51:27.418289 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c8201c0>]}
2021-12-06 00:51:27.418655 (Thread-4): 00:51:27 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.55s]
2021-12-06 00:51:27.418739 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 00:51:27.419624 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:51:27.419874 (Thread-3): 00:51:27 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:51:27.420083 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:51:27.420158 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:51:27.422778 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:51:27.437487 (Thread-3): finished collecting timing info
2021-12-06 00:51:27.439412 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:51:27.455200 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:51:27.455277 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:51:27.455334 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 00:51:27.578715 (Thread-190): handling poll request
2021-12-06 00:51:27.578935 (Thread-190): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e800a0>]}
2021-12-06 00:51:27.579554 (Thread-190): sending response (<Response 7940 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:51:28.711474 (Thread-3): Snowflake query id: 01a0c193-3200-95c4-0000-00008ef92b49
2021-12-06 00:51:28.711616 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 63 at position 0 unexpected 'select'.
2021-12-06 00:51:28.711750 (Thread-3): finished collecting timing info
2021-12-06 00:51:28.711857 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:51:29.044751 (Thread-191): handling poll request
2021-12-06 00:51:29.045057 (Thread-191): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e80400>]}
2021-12-06 00:51:29.045571 (Thread-191): sending response (<Response 1923 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:51:29.157706 (Thread-3): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 63 at position 0 unexpected 'select'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 63 at position 0 unexpected 'select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 63 at position 0 unexpected 'select'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:51:29.158526 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f31170-060c-4e74-b9ed-29ef994f4ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655d761c70>]}
2021-12-06 00:51:29.158830 (Thread-3): 00:51:29 | 5 of 5 ERROR creating table model dbt_pstulnikov.dim_customers....... [ERROR in 1.74s]
2021-12-06 00:51:29.158911 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:51:29.160634 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:51:29.160923 (MainThread): 00:51:29 | 
2021-12-06 00:51:29.160989 (MainThread): 00:51:29 | Finished running 3 view models, 2 table models in 10.45s.
2021-12-06 00:51:29.161037 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:51:29.161077 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:51:29.161112 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:51:29.161146 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:51:29.161178 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:51:29.226972 (MainThread): 
2021-12-06 00:51:29.227072 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 00:51:29.227126 (MainThread): 
2021-12-06 00:51:29.227179 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-12-06 00:51:29.227222 (MainThread):   001003 (42000): SQL compilation error:
2021-12-06 00:51:29.227259 (MainThread):   syntax error line 55 at position 8 unexpected 'customer_payments'.
2021-12-06 00:51:29.227295 (MainThread):   syntax error line 59 at position 37 unexpected 'customer_id'.
2021-12-06 00:51:29.227331 (MainThread):   syntax error line 63 at position 0 unexpected 'select'.
2021-12-06 00:51:29.227365 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:51:29.227413 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-12-06 00:51:30.521609 (Thread-192): handling poll request
2021-12-06 00:51:30.521920 (Thread-192): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e74340>]}
2021-12-06 00:51:30.523297 (Thread-192): sending response (<Response 28251 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:51:31.456554 (Thread-193): handling status request
2021-12-06 00:51:31.456862 (Thread-193): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e807f0>]}
2021-12-06 00:51:31.457384 (Thread-193): sending response (<Response 1537 bytes [200 OK]>) to 10.0.19.103
2021-12-06 00:51:32.332838 (Thread-194): handling status request
2021-12-06 00:51:32.333152 (Thread-194): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e80250>]}
2021-12-06 00:51:32.333639 (Thread-194): sending response (<Response 1537 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:52:16.320204 (Thread-195): handling status request
2021-12-06 00:52:16.320522 (Thread-195): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e90340>]}
2021-12-06 00:52:16.320995 (Thread-195): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 00:52:16.820407 (Thread-196): handling compile_sql request
2021-12-06 00:52:16.820724 (Thread-196): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e905b0>]}
2021-12-06 00:52:18.791682 (Thread-196): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:52:18.803071 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:52:18.817427 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8157a2f-f980-4e31-90a9-5fbedfe0a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201ac9d1c0>]}
2021-12-06 00:52:18.817669 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:52:18.818039 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 00:52:18.818142 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 00:52:18.820395 (Thread-1): finished collecting timing info
2021-12-06 00:52:18.820618 (Thread-1): finished collecting timing info
2021-12-06 00:52:19.502672 (Thread-197): handling poll request
2021-12-06 00:52:19.503027 (Thread-197): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e94730>]}
2021-12-06 00:52:19.504195 (Thread-197): sending response (<Response 9224 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:53:21.919531 (Thread-198): handling status request
2021-12-06 00:53:21.919872 (Thread-198): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e94820>]}
2021-12-06 00:53:21.920397 (Thread-198): sending response (<Response 1537 bytes [200 OK]>) to 10.0.24.86
2021-12-06 00:53:22.316447 (Thread-199): handling status request
2021-12-06 00:53:22.316661 (Thread-199): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e94b50>]}
2021-12-06 00:53:22.317044 (Thread-199): sending response (<Response 1537 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:53:22.365912 (Thread-200): handling cli_args request
2021-12-06 00:53:22.366147 (Thread-200): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e94d60>]}
2021-12-06 00:53:24.297601 (Thread-200): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:53:24.333660 (MainThread): Partial parsing not enabled
2021-12-06 00:53:24.392826 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:53:24.394773 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:53:24.428765 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:53:24.432346 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:53:24.435436 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:53:24.439582 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:53:24.440821 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:53:24.448765 (MainThread): Parsing macros/core.sql
2021-12-06 00:53:24.452250 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:53:24.458427 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:53:24.467741 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:53:24.474307 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:53:24.477874 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:53:24.498999 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:53:24.514969 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:53:24.516492 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:53:24.545507 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:53:24.552387 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:53:24.565337 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:53:24.583813 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:53:24.593251 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:53:24.594945 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:53:24.596301 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:53:24.604200 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:53:24.605147 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:53:24.606775 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:53:24.608206 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:53:24.610551 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:53:24.611906 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:53:24.663926 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:53:24.665992 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:53:24.667067 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:53:24.668554 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:53:24.736968 (Thread-201): handling poll request
2021-12-06 00:53:24.737252 (Thread-201): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecd160>]}
2021-12-06 00:53:24.738583 (Thread-201): sending response (<Response 9686 bytes [200 OK]>) to 10.0.6.71
2021-12-06 00:53:24.849464 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:24.860863 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:24.863238 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:24.865663 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:24.869554 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:24.924878 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277bf79490>]}
2021-12-06 00:53:24.952796 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277bf79a90>]}
2021-12-06 00:53:24.952987 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:53:24.954100 (MainThread): 
2021-12-06 00:53:24.954293 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:53:24.955134 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:53:24.966764 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:53:24.966836 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:53:24.966892 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:53:26.265312 (Thread-202): handling poll request
2021-12-06 00:53:26.265635 (Thread-202): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ed9760>]}
2021-12-06 00:53:26.266342 (Thread-202): sending response (<Response 4941 bytes [200 OK]>) to 10.0.39.19
2021-12-06 00:53:26.500637 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.53 seconds
2021-12-06 00:53:26.502469 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:53:26.956280 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:53:26.963389 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:53:26.963491 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:53:26.963556 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:53:27.697769 (Thread-203): handling poll request
2021-12-06 00:53:27.698115 (Thread-203): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5edb6a0>]}
2021-12-06 00:53:27.698658 (Thread-203): sending response (<Response 2263 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:53:28.220671 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.26 seconds
2021-12-06 00:53:28.222143 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:53:28.672292 (MainThread): 00:53:28 | Concurrency: 4 threads (target='default')
2021-12-06 00:53:28.672433 (MainThread): 00:53:28 | 
2021-12-06 00:53:28.674452 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:53:28.674734 (Thread-1): 00:53:28 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:53:28.674959 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:28.675058 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:53:28.675876 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:53:28.676092 (Thread-2): 00:53:28 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:53:28.676311 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:28.676378 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:53:28.677568 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:53:28.678462 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:53:28.678637 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:53:28.678838 (Thread-3): 00:53:28 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:53:28.679050 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:28.679114 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:53:28.680168 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:53:28.705171 (Thread-2): finished collecting timing info
2021-12-06 00:53:28.710302 (Thread-3): finished collecting timing info
2021-12-06 00:53:28.735635 (Thread-1): finished collecting timing info
2021-12-06 00:53:28.740318 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:53:28.741660 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:53:28.745209 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:53:28.762041 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:28.762127 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:53:28.762186 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:53:28.763302 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:28.763376 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:53:28.763429 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:53:28.767156 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:28.767238 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:53:28.767291 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:53:29.171294 (Thread-204): handling poll request
2021-12-06 00:53:29.171601 (Thread-204): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ea0040>]}
2021-12-06 00:53:29.172468 (Thread-204): sending response (<Response 14047 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:53:30.571623 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-06 00:53:30.578297 (Thread-2): finished collecting timing info
2021-12-06 00:53:30.578438 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:53:30.612089 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-12-06 00:53:30.613166 (Thread-1): finished collecting timing info
2021-12-06 00:53:30.613268 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:53:30.638590 (Thread-205): handling poll request
2021-12-06 00:53:30.638841 (Thread-205): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ea0e50>]}
2021-12-06 00:53:30.639369 (Thread-205): sending response (<Response 2464 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:53:30.666968 (Thread-3): SQL status: SUCCESS 1 in 1.90 seconds
2021-12-06 00:53:30.667992 (Thread-3): finished collecting timing info
2021-12-06 00:53:30.668090 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:53:31.022668 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b0679a0>]}
2021-12-06 00:53:31.023003 (Thread-2): 00:53:31 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.35s]
2021-12-06 00:53:31.023083 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:53:31.054973 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b0bea00>]}
2021-12-06 00:53:31.055250 (Thread-1): 00:53:31 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.38s]
2021-12-06 00:53:31.055321 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:53:31.131952 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277bf9a790>]}
2021-12-06 00:53:31.132223 (Thread-3): 00:53:31 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.45s]
2021-12-06 00:53:31.132295 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:53:31.132994 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 00:53:31.133219 (Thread-4): 00:53:31 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 00:53:31.133443 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:31.133516 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 00:53:31.135724 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:53:31.154356 (Thread-4): finished collecting timing info
2021-12-06 00:53:31.170411 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:53:31.194199 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:31.194281 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 00:53:31.194339 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:53:32.074298 (Thread-206): handling poll request
2021-12-06 00:53:32.074622 (Thread-206): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ec9c10>]}
2021-12-06 00:53:32.075348 (Thread-206): sending response (<Response 9670 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:53:33.329592 (Thread-4): SQL status: SUCCESS 1 in 2.14 seconds
2021-12-06 00:53:33.334280 (Thread-4): finished collecting timing info
2021-12-06 00:53:33.334417 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 00:53:33.510279 (Thread-207): handling poll request
2021-12-06 00:53:33.510615 (Thread-207): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ec9790>]}
2021-12-06 00:53:33.511154 (Thread-207): sending response (<Response 1369 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:53:33.776248 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b0bed90>]}
2021-12-06 00:53:33.776576 (Thread-4): 00:53:33 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.64s]
2021-12-06 00:53:33.776659 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 00:53:33.777510 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:53:33.777772 (Thread-1): 00:53:33 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:53:33.778012 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:33.778091 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:53:33.780637 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:53:33.796934 (Thread-1): finished collecting timing info
2021-12-06 00:53:33.798909 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:53:33.815388 (Thread-1): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:33.815468 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
      );
2021-12-06 00:53:33.815526 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:53:34.985000 (Thread-208): handling poll request
2021-12-06 00:53:34.985320 (Thread-208): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ec9ac0>]}
2021-12-06 00:53:34.986029 (Thread-208): sending response (<Response 6856 bytes [200 OK]>) to 10.0.38.50
2021-12-06 00:53:35.090015 (Thread-1): Snowflake query id: 01a0c195-3200-95c3-0000-00008ef91c65
2021-12-06 00:53:35.090145 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 63 at position 0 unexpected 'select'.
2021-12-06 00:53:35.090264 (Thread-1): finished collecting timing info
2021-12-06 00:53:35.090367 (Thread-1): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:53:35.542778 (Thread-1): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 63 at position 0 unexpected 'select'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 63 at position 0 unexpected 'select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 63 at position 0 unexpected 'select'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:53:35.543606 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3cf5eb-fc06-4f5b-9d01-15d0e059c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277b0c02b0>]}
2021-12-06 00:53:35.543941 (Thread-1): 00:53:35 | 5 of 5 ERROR creating table model dbt_pstulnikov.dim_customers....... [ERROR in 1.77s]
2021-12-06 00:53:35.544020 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:53:35.545621 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:53:35.545919 (MainThread): 00:53:35 | 
2021-12-06 00:53:35.546016 (MainThread): 00:53:35 | Finished running 3 view models, 2 table models in 10.59s.
2021-12-06 00:53:35.546066 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:53:35.546108 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:53:35.546143 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:53:35.546177 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 00:53:35.546210 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:53:35.599008 (MainThread): 
2021-12-06 00:53:35.599113 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 00:53:35.599167 (MainThread): 
2021-12-06 00:53:35.599219 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-12-06 00:53:35.599260 (MainThread):   001003 (42000): SQL compilation error:
2021-12-06 00:53:35.599297 (MainThread):   syntax error line 55 at position 8 unexpected 'customer_payments'.
2021-12-06 00:53:35.599332 (MainThread):   syntax error line 59 at position 37 unexpected 'customer_id'.
2021-12-06 00:53:35.599366 (MainThread):   syntax error line 63 at position 0 unexpected 'select'.
2021-12-06 00:53:35.599400 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:53:35.599447 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-12-06 00:53:36.464314 (Thread-209): handling poll request
2021-12-06 00:53:36.464656 (Thread-209): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ec9e20>]}
2021-12-06 00:53:36.466046 (Thread-209): sending response (<Response 29888 bytes [200 OK]>) to 10.0.38.70
2021-12-06 00:53:37.393868 (Thread-210): handling status request
2021-12-06 00:53:37.394235 (Thread-210): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecd370>]}
2021-12-06 00:53:37.394743 (Thread-210): sending response (<Response 1537 bytes [200 OK]>) to 10.0.3.73
2021-12-06 00:53:37.526190 (Thread-211): handling status request
2021-12-06 00:53:37.526487 (Thread-211): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5ecd3a0>]}
2021-12-06 00:53:37.526941 (Thread-211): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:53:45.524375 (Thread-212): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 00:53:45.524740 (Thread-212): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 00:53:45.528460 (Thread-212): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:45.573799 (Thread-212): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e4b1c0>]}
2021-12-06 00:53:46.317526 (Thread-213): handling status request
2021-12-06 00:53:46.317831 (Thread-213): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e4b370>]}
2021-12-06 00:53:46.318344 (Thread-213): sending response (<Response 1537 bytes [200 OK]>) to 10.0.0.217
2021-12-06 00:53:46.347193 (Thread-214): handling status request
2021-12-06 00:53:46.347408 (Thread-214): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e67340>]}
2021-12-06 00:53:46.347788 (Thread-214): sending response (<Response 1537 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:53:48.553689 (Thread-215): handling status request
2021-12-06 00:53:48.554036 (Thread-215): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e67700>]}
2021-12-06 00:53:48.554513 (Thread-215): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:53:48.916481 (Thread-216): handling status request
2021-12-06 00:53:48.916726 (Thread-216): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e671f0>]}
2021-12-06 00:53:48.917170 (Thread-216): sending response (<Response 1537 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:53:48.999068 (Thread-217): handling cli_args request
2021-12-06 00:53:48.999284 (Thread-217): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e67e50>]}
2021-12-06 00:53:49.030612 (Thread-217): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:53:51.005893 (Thread-217): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.30
2021-12-06 00:53:51.042014 (MainThread): Partial parsing not enabled
2021-12-06 00:53:51.091909 (MainThread): Parsing macros/catalog.sql
2021-12-06 00:53:51.093839 (MainThread): Parsing macros/adapters.sql
2021-12-06 00:53:51.127606 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 00:53:51.131225 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 00:53:51.134322 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 00:53:51.138423 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 00:53:51.139632 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 00:53:51.147573 (MainThread): Parsing macros/core.sql
2021-12-06 00:53:51.151042 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 00:53:51.157165 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 00:53:51.166455 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 00:53:51.173063 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 00:53:51.176662 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 00:53:51.198242 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 00:53:51.214481 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 00:53:51.215994 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 00:53:51.245259 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 00:53:51.252294 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 00:53:51.265296 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 00:53:51.283675 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 00:53:51.293048 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 00:53:51.294713 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 00:53:51.296040 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 00:53:51.303848 (MainThread): Parsing macros/etc/query.sql
2021-12-06 00:53:51.304782 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 00:53:51.306401 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 00:53:51.307808 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 00:53:51.310119 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 00:53:51.311460 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 00:53:51.363365 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 00:53:51.365385 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 00:53:51.366485 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 00:53:51.367970 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 00:53:51.455014 (Thread-218): handling poll request
2021-12-06 00:53:51.455324 (Thread-218): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e67b50>]}
2021-12-06 00:53:51.456345 (Thread-218): sending response (<Response 9686 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:53:51.550647 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:51.561992 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:51.564345 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:51.566791 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:53:51.570687 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:51.629639 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce491f87f0>]}
2021-12-06 00:53:51.657048 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce491f8730>]}
2021-12-06 00:53:51.657239 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:53:51.658378 (MainThread): 
2021-12-06 00:53:51.658569 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:53:51.659417 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 00:53:51.670729 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 00:53:51.670799 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 00:53:51.670852 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 00:53:52.942395 (Thread-219): handling poll request
2021-12-06 00:53:52.942708 (Thread-219): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e41280>]}
2021-12-06 00:53:52.943322 (Thread-219): sending response (<Response 4941 bytes [200 OK]>) to 10.0.13.223
2021-12-06 00:53:53.178105 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.51 seconds
2021-12-06 00:53:53.179903 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 00:53:53.626064 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:53:53.632880 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 00:53:53.632971 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 00:53:53.633033 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 00:53:54.441613 (Thread-220): handling poll request
2021-12-06 00:53:54.441953 (Thread-220): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5e41e20>]}
2021-12-06 00:53:54.442493 (Thread-220): sending response (<Response 2263 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:53:55.061662 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.43 seconds
2021-12-06 00:53:55.063170 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 00:53:55.503378 (MainThread): 00:53:55 | Concurrency: 4 threads (target='default')
2021-12-06 00:53:55.503522 (MainThread): 00:53:55 | 
2021-12-06 00:53:55.505509 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 00:53:55.505803 (Thread-1): 00:53:55 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 00:53:55.506078 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:55.506183 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 00:53:55.507037 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 00:53:55.507264 (Thread-2): 00:53:55 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 00:53:55.507499 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:55.507568 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 00:53:55.508637 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:53:55.509504 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:53:55.509684 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 00:53:55.509893 (Thread-3): 00:53:55 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 00:53:55.510141 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:55.510207 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 00:53:55.511250 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:53:55.529745 (Thread-3): finished collecting timing info
2021-12-06 00:53:55.534819 (Thread-2): finished collecting timing info
2021-12-06 00:53:55.539896 (Thread-1): finished collecting timing info
2021-12-06 00:53:55.565057 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 00:53:55.568536 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 00:53:55.572358 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 00:53:55.584993 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 00:53:55.585069 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 00:53:55.585126 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 00:53:55.588827 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 00:53:55.588911 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 00:53:55.588965 (Thread-2): Opening a new connection, currently in state init
2021-12-06 00:53:55.589889 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 00:53:55.589988 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 00:53:55.590043 (Thread-3): Opening a new connection, currently in state init
2021-12-06 00:53:55.962475 (Thread-221): handling poll request
2021-12-06 00:53:55.962815 (Thread-221): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5dd9250>]}
2021-12-06 00:53:55.963666 (Thread-221): sending response (<Response 14047 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:53:57.211747 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2021-12-06 00:53:57.218075 (Thread-1): finished collecting timing info
2021-12-06 00:53:57.218201 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 00:53:57.246356 (Thread-3): SQL status: SUCCESS 1 in 1.66 seconds
2021-12-06 00:53:57.247428 (Thread-3): finished collecting timing info
2021-12-06 00:53:57.247529 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 00:53:57.277396 (Thread-2): SQL status: SUCCESS 1 in 1.69 seconds
2021-12-06 00:53:57.278450 (Thread-2): finished collecting timing info
2021-12-06 00:53:57.278566 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 00:53:57.486630 (Thread-222): handling poll request
2021-12-06 00:53:57.486893 (Thread-222): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d89340>]}
2021-12-06 00:53:57.487438 (Thread-222): sending response (<Response 3556 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:53:57.678836 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4837bd00>]}
2021-12-06 00:53:57.679235 (Thread-1): 00:53:57 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.17s]
2021-12-06 00:53:57.679323 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 00:53:57.699236 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce48070280>]}
2021-12-06 00:53:57.699522 (Thread-3): 00:53:57 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.19s]
2021-12-06 00:53:57.699595 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 00:53:57.726955 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce48066610>]}
2021-12-06 00:53:57.727210 (Thread-2): 00:53:57 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.22s]
2021-12-06 00:53:57.727280 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 00:53:57.728074 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 00:53:57.728374 (Thread-4): 00:53:57 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 00:53:57.728697 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:57.728810 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 00:53:57.732439 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:53:57.748220 (Thread-4): finished collecting timing info
2021-12-06 00:53:57.764707 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 00:53:57.781381 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 00:53:57.781459 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 00:53:57.781516 (Thread-4): Opening a new connection, currently in state init
2021-12-06 00:53:58.962836 (Thread-223): handling poll request
2021-12-06 00:53:58.963145 (Thread-223): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d89c70>]}
2021-12-06 00:53:58.963805 (Thread-223): sending response (<Response 8578 bytes [200 OK]>) to 10.0.41.241
2021-12-06 00:53:59.784255 (Thread-4): SQL status: SUCCESS 1 in 2.00 seconds
2021-12-06 00:53:59.788857 (Thread-4): finished collecting timing info
2021-12-06 00:53:59.789001 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 00:54:00.244074 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4841c9a0>]}
2021-12-06 00:54:00.244450 (Thread-4): 00:54:00 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.52s]
2021-12-06 00:54:00.244536 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 00:54:00.245386 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 00:54:00.245705 (Thread-3): 00:54:00 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 00:54:00.246050 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:54:00.246172 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 00:54:00.249217 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:54:00.263708 (Thread-3): finished collecting timing info
2021-12-06 00:54:00.265682 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 00:54:00.282175 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 00:54:00.282253 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
      );
2021-12-06 00:54:00.282310 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 00:54:00.415606 (Thread-224): handling poll request
2021-12-06 00:54:00.415847 (Thread-224): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d944c0>]}
2021-12-06 00:54:00.416508 (Thread-224): sending response (<Response 7993 bytes [200 OK]>) to 10.0.6.10
2021-12-06 00:54:01.544394 (Thread-3): Snowflake query id: 01a0c196-3200-95c3-0000-00008ef91c79
2021-12-06 00:54:01.544529 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 60 at position 4 unexpected 'left'.
2021-12-06 00:54:01.544651 (Thread-3): finished collecting timing info
2021-12-06 00:54:01.544752 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 00:54:01.861440 (Thread-225): handling poll request
2021-12-06 00:54:01.861739 (Thread-225): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d94820>]}
2021-12-06 00:54:01.862454 (Thread-225): sending response (<Response 1921 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:54:01.998827 (Thread-3): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 60 at position 4 unexpected 'left'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 55 at position 8 unexpected 'customer_payments'.
syntax error line 59 at position 37 unexpected 'customer_id'.
syntax error line 60 at position 4 unexpected 'left'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 8 unexpected 'customer_payments'.
  syntax error line 59 at position 37 unexpected 'customer_id'.
  syntax error line 60 at position 4 unexpected 'left'.
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:54:01.999675 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d536404-2a51-4032-a931-e4bc2cda348d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4841c9a0>]}
2021-12-06 00:54:02.000030 (Thread-3): 00:54:01 | 5 of 5 ERROR creating table model dbt_pstulnikov.dim_customers....... [ERROR in 1.75s]
2021-12-06 00:54:02.000113 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 00:54:02.001734 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 00:54:02.002066 (MainThread): 00:54:01 | 
2021-12-06 00:54:02.002141 (MainThread): 00:54:01 | Finished running 3 view models, 2 table models in 10.34s.
2021-12-06 00:54:02.002190 (MainThread): Connection 'master' was properly closed.
2021-12-06 00:54:02.002228 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 00:54:02.002266 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 00:54:02.002299 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 00:54:02.002331 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 00:54:02.073229 (MainThread): 
2021-12-06 00:54:02.073360 (MainThread): Completed with 1 error and 0 warnings:
2021-12-06 00:54:02.073423 (MainThread): 
2021-12-06 00:54:02.073478 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-12-06 00:54:02.073527 (MainThread):   001003 (42000): SQL compilation error:
2021-12-06 00:54:02.073564 (MainThread):   syntax error line 55 at position 8 unexpected 'customer_payments'.
2021-12-06 00:54:02.073608 (MainThread):   syntax error line 59 at position 37 unexpected 'customer_id'.
2021-12-06 00:54:02.073643 (MainThread):   syntax error line 60 at position 4 unexpected 'left'.
2021-12-06 00:54:02.073686 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-12-06 00:54:02.073741 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-12-06 00:54:03.302099 (Thread-226): handling poll request
2021-12-06 00:54:03.302474 (Thread-226): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d89a30>]}
2021-12-06 00:54:03.303888 (Thread-226): sending response (<Response 28346 bytes [200 OK]>) to 10.0.26.3
2021-12-06 00:54:04.210022 (Thread-227): handling status request
2021-12-06 00:54:04.210332 (Thread-227): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d98310>]}
2021-12-06 00:54:04.210830 (Thread-227): sending response (<Response 1537 bytes [200 OK]>) to 10.0.36.143
2021-12-06 00:54:04.227577 (Thread-228): handling status request
2021-12-06 00:54:04.227781 (Thread-228): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d986d0>]}
2021-12-06 00:54:04.228170 (Thread-228): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 00:59:27.841288 (Thread-229): handling status request
2021-12-06 00:59:27.842104 (Thread-230): handling status request
2021-12-06 00:59:27.843361 (Thread-229): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d988b0>]}
2021-12-06 00:59:27.843629 (Thread-230): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5da3070>]}
2021-12-06 00:59:27.844132 (Thread-229): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:27.844605 (Thread-230): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:27.852487 (Thread-231): handling list request
2021-12-06 00:59:27.852677 (Thread-231): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'd1df786c-0a1e-44f0-95b7-163fd8294cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d98f70>]}
2021-12-06 00:59:27.902478 (Thread-231): sending response (<Response 214 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:27.903772 (Thread-232): sending response (<Response 214 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:28.261563 (Thread-233): handling status request
2021-12-06 00:59:28.261799 (Thread-233): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0f650fbd-11eb-4a91-9a7f-f70cd94e865f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5da5880>]}
2021-12-06 00:59:28.262243 (Thread-233): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:28.267567 (Thread-234): handling list request
2021-12-06 00:59:28.267767 (Thread-234): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0f650fbd-11eb-4a91-9a7f-f70cd94e865f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5dad9a0>]}
2021-12-06 00:59:28.297827 (Thread-234): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '331f19dc-7a13-47df-9998-a9b32d646307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d983a0>]}
2021-12-06 00:59:28.298074 (Thread-234): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:59:28.299602 (Thread-234): sending response (<Response 1757 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:29.279088 (Thread-235): handling status request
2021-12-06 00:59:29.279419 (Thread-235): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '331f19dc-7a13-47df-9998-a9b32d646307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5545100>]}
2021-12-06 00:59:29.279916 (Thread-235): sending response (<Response 1515 bytes [200 OK]>) to 10.0.26.110
2021-12-06 00:59:29.285062 (Thread-236): handling list request
2021-12-06 00:59:29.285259 (Thread-236): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '331f19dc-7a13-47df-9998-a9b32d646307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5545c40>]}
2021-12-06 00:59:29.347463 (Thread-236): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5d98130>]}
2021-12-06 00:59:29.347719 (Thread-236): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 00:59:29.350121 (Thread-236): sending response (<Response 3976 bytes [200 OK]>) to 10.0.26.110
2021-12-06 01:00:28.199306 (Thread-237): handling status request
2021-12-06 01:00:28.199616 (Thread-237): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5545f70>]}
2021-12-06 01:00:28.200110 (Thread-237): sending response (<Response 1537 bytes [200 OK]>) to 10.0.19.103
2021-12-06 01:00:28.643731 (Thread-238): handling compile_sql request
2021-12-06 01:00:28.644024 (Thread-238): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a55458e0>]}
2021-12-06 01:00:30.555412 (Thread-238): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:00:30.566571 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:30.583585 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af33b9d1-8957-44ee-a113-cad0ee402a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c53dcfa0>]}
2021-12-06 01:00:30.583816 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:00:30.584175 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:30.584279 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:00:30.586575 (Thread-1): finished collecting timing info
2021-12-06 01:00:30.586797 (Thread-1): finished collecting timing info
2021-12-06 01:00:31.018753 (Thread-239): handling poll request
2021-12-06 01:00:31.019118 (Thread-239): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d15910>]}
2021-12-06 01:00:31.020250 (Thread-239): sending response (<Response 9436 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:00:47.880878 (Thread-240): handling status request
2021-12-06 01:00:47.881215 (Thread-240): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d15a00>]}
2021-12-06 01:00:47.881760 (Thread-240): sending response (<Response 1537 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:00:48.330198 (Thread-241): handling run_sql request
2021-12-06 01:00:48.330490 (Thread-241): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d15d30>]}
2021-12-06 01:00:50.259766 (Thread-241): sending response (<Response 138 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:00:50.270985 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:50.284755 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c133fa1-69cf-41a9-803a-9ab8fbdbd5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe354f131c0>]}
2021-12-06 01:00:50.284999 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:00:50.285396 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:50.285532 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:00:50.287606 (Thread-1): finished collecting timing info
2021-12-06 01:00:50.288548 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:00:50.288619 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:00:50.288686 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:00:50.803852 (Thread-242): handling poll request
2021-12-06 01:00:50.804193 (Thread-242): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d1fd00>]}
2021-12-06 01:00:50.805022 (Thread-242): sending response (<Response 3695 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:00:52.175679 (Thread-1): SQL status: SUCCESS 120 in 1.89 seconds
2021-12-06 01:00:52.178915 (Thread-1): finished collecting timing info
2021-12-06 01:00:52.179100 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:00:52.282189 (Thread-243): handling poll request
2021-12-06 01:00:52.282442 (Thread-243): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d27040>]}
2021-12-06 01:00:52.306041 (Thread-243): sending response (<Response 1341 bytes [200 OK]>) to 10.0.38.70
2021-12-06 01:00:53.849159 (Thread-244): handling poll request
2021-12-06 01:00:53.849466 (Thread-244): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44b6490>]}
2021-12-06 01:00:53.850689 (Thread-244): sending response (<Response 6350 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:00:58.957670 (Thread-245): handling status request
2021-12-06 01:00:58.958002 (Thread-245): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44b6580>]}
2021-12-06 01:00:58.958502 (Thread-245): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:00:59.435271 (Thread-246): handling run_sql request
2021-12-06 01:00:59.435564 (Thread-246): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44b68b0>]}
2021-12-06 01:01:01.390206 (Thread-246): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:01:01.401070 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:01.414769 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00776b3f-8a40-4707-baf5-8fb3df9bd317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67777eca0>]}
2021-12-06 01:01:01.415035 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:01:01.415494 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:01.415601 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:01:01.416609 (Thread-1): finished collecting timing info
2021-12-06 01:01:01.417222 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:01.417284 (Thread-1): On rpc.jaffle_shop.request: with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:01:01.417340 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:01:01.864455 (Thread-247): handling poll request
2021-12-06 01:01:01.864790 (Thread-247): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d26880>]}
2021-12-06 01:01:01.865607 (Thread-247): sending response (<Response 3486 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:01:02.864121 (Thread-1): SQL status: SUCCESS 120 in 1.45 seconds
2021-12-06 01:01:02.868549 (Thread-1): finished collecting timing info
2021-12-06 01:01:02.868743 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:01:03.328952 (Thread-248): handling poll request
2021-12-06 01:01:03.329245 (Thread-248): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c96a0>]}
2021-12-06 01:01:03.329768 (Thread-248): sending response (<Response 1347 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:01:04.794528 (Thread-249): handling poll request
2021-12-06 01:01:04.794828 (Thread-249): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c9640>]}
2021-12-06 01:01:04.795873 (Thread-249): sending response (<Response 4729 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:01:14.490934 (Thread-250): handling status request
2021-12-06 01:01:14.491235 (Thread-250): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c9850>]}
2021-12-06 01:01:14.491744 (Thread-250): sending response (<Response 1537 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:01:14.924428 (Thread-251): handling run_sql request
2021-12-06 01:01:14.924726 (Thread-251): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c9b50>]}
2021-12-06 01:01:16.841109 (Thread-251): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:01:16.852300 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:16.866403 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eef27197-f2b8-406a-badd-c89055e95190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0d51cc10>]}
2021-12-06 01:01:16.866636 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:01:16.867010 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:16.867112 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:01:16.869481 (Thread-1): finished collecting timing info
2021-12-06 01:01:16.871110 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:01:16.871178 (Thread-1): On rpc.jaffle_shop.request: with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:01:16.871231 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:01:17.313295 (Thread-252): handling poll request
2021-12-06 01:01:17.313608 (Thread-252): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44c9400>]}
2021-12-06 01:01:17.314440 (Thread-252): sending response (<Response 4505 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:01:18.339980 (Thread-1): Snowflake query id: 01a0c19d-3200-95c4-0000-00008ef92b6d
2021-12-06 01:01:18.340179 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 8 unexpected 'customer_payments'.
syntax error line 58 at position 37 unexpected 'customer_id'.
syntax error line 59 at position 4 unexpected 'left'.
2021-12-06 01:01:18.340316 (Thread-1): finished collecting timing info
2021-12-06 01:01:18.340478 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:01:18.783710 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 8 unexpected 'customer_payments'.
  syntax error line 58 at position 37 unexpected 'customer_id'.
  syntax error line 59 at position 4 unexpected 'left'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 54 at position 8 unexpected 'customer_payments'.
syntax error line 58 at position 37 unexpected 'customer_id'.
syntax error line 59 at position 4 unexpected 'left'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 8 unexpected 'customer_payments'.
  syntax error line 58 at position 37 unexpected 'customer_id'.
  syntax error line 59 at position 4 unexpected 'left'.
2021-12-06 01:01:18.784664 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 54 at position 8 unexpected 'customer_payments'.\n  syntax error line 58 at position 37 unexpected 'customer_id'.\n  syntax error line 59 at position 4 unexpected 'left'.", 'raw_sql': "with customers as (\n    select * from {{ ref('stg_customers')}}\n),\n\norders as (\n    select * from {{ ref('stg_orders')}}\n),\n\npayments as (\n    select\n        customer_id,\n        amount\n    \n    from {{ ref('fct_orders')}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        customer_id,\n\n        sum(amount) as lifetime_value\n\n    from payments\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        customer_payments.lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n    select * from analytics.dbt_pstulnikov.stg_customers\n),\n\norders as (\n    select * from analytics.dbt_pstulnikov.stg_orders\n),\n\npayments as (\n    select\n        customer_id,\n        amount\n    \n    from analytics.dbt_pstulnikov.fct_orders\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        customer_id,\n\n        sum(amount) as lifetime_value\n\n    from payments\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        customer_payments.lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 144, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 364, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 54 at position 8 unexpected 'customer_payments'.\n  syntax error line 58 at position 37 unexpected 'customer_id'.\n  syntax error line 59 at position 4 unexpected 'left'.", 'raw_sql': "with customers as (\n    select * from {{ ref('stg_customers')}}\n),\n\norders as (\n    select * from {{ ref('stg_orders')}}\n),\n\npayments as (\n    select\n        customer_id,\n        amount\n    \n    from {{ ref('fct_orders')}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        customer_id,\n\n        sum(amount) as lifetime_value\n\n    from payments\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        customer_payments.lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n    select * from analytics.dbt_pstulnikov.stg_customers\n),\n\norders as (\n    select * from analytics.dbt_pstulnikov.stg_orders\n),\n\npayments as (\n    select\n        customer_id,\n        amount\n    \n    from analytics.dbt_pstulnikov.fct_orders\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        customer_id,\n\n        sum(amount) as lifetime_value\n\n    from payments\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        customer_payments.lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-12-06 01:01:18.874304 (Thread-253): handling poll request
2021-12-06 01:01:18.874620 (Thread-253): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44d0040>]}
2021-12-06 01:01:18.875246 (Thread-253): sending response (<Response 11837 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:01:20.365977 (Thread-254): handling poll request
2021-12-06 01:01:20.366298 (Thread-254): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44d2100>]}
2021-12-06 01:01:20.366933 (Thread-254): sending response (<Response 18430 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:01:42.669384 (Thread-255): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 01:01:42.669720 (Thread-255): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 01:01:42.674753 (Thread-255): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a447ff10>]}
2021-12-06 01:01:43.486657 (Thread-256): handling status request
2021-12-06 01:01:43.486985 (Thread-256): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a447fd60>]}
2021-12-06 01:01:43.487505 (Thread-256): sending response (<Response 1212 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:01:43.526555 (Thread-257): handling status request
2021-12-06 01:01:43.526767 (Thread-257): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44865e0>]}
2021-12-06 01:01:43.527151 (Thread-257): sending response (<Response 1212 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:02:07.704031 (Thread-258): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:02:07.704373 (Thread-258): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 01:02:07.708147 (Thread-258): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:02:07.751992 (Thread-258): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a444ee80>]}
2021-12-06 01:02:08.491549 (Thread-259): handling status request
2021-12-06 01:02:08.491869 (Thread-259): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4447100>]}
2021-12-06 01:02:08.492368 (Thread-259): sending response (<Response 1537 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:02:08.536120 (Thread-260): handling status request
2021-12-06 01:02:08.536326 (Thread-260): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44e5eb0>]}
2021-12-06 01:02:08.536696 (Thread-260): sending response (<Response 1537 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:02:11.743043 (Thread-261): handling status request
2021-12-06 01:02:11.743355 (Thread-261): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44e5d00>]}
2021-12-06 01:02:11.743820 (Thread-261): sending response (<Response 1537 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:02:12.159309 (Thread-262): handling status request
2021-12-06 01:02:12.159630 (Thread-262): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44e5790>]}
2021-12-06 01:02:12.160115 (Thread-262): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:02:12.212132 (Thread-263): handling cli_args request
2021-12-06 01:02:12.212365 (Thread-263): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44e5370>]}
2021-12-06 01:02:12.222550 (Thread-263): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:02:14.122884 (Thread-263): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:02:14.159167 (MainThread): Partial parsing not enabled
2021-12-06 01:02:14.207453 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:02:14.209339 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:02:14.244754 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:02:14.248306 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:02:14.251404 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:02:14.255542 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:02:14.256762 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:02:14.264739 (MainThread): Parsing macros/core.sql
2021-12-06 01:02:14.268224 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:02:14.274419 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:02:14.283774 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:02:14.290322 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:02:14.293865 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:02:14.315125 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:02:14.331109 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:02:14.332622 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:02:14.361705 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:02:14.368556 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:02:14.381525 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:02:14.399902 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:02:14.409222 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:02:14.410885 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:02:14.412224 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:02:14.420042 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:02:14.420984 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:02:14.422619 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:02:14.424035 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:02:14.426328 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:02:14.427674 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:02:14.479465 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:02:14.481523 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:02:14.482615 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:02:14.484089 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:02:14.657824 (Thread-264): handling poll request
2021-12-06 01:02:14.658128 (Thread-264): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5deb310>]}
2021-12-06 01:02:14.659135 (Thread-264): sending response (<Response 9686 bytes [200 OK]>) to 10.0.30.196
2021-12-06 01:02:14.663049 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:02:14.674464 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:02:14.676838 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:02:14.679328 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:02:14.683264 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:02:14.748655 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80c47adf0>]}
2021-12-06 01:02:14.780743 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80c47ac70>]}
2021-12-06 01:02:14.780942 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:02:14.782087 (MainThread): 
2021-12-06 01:02:14.782297 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:02:14.786360 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:02:14.797886 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:02:14.797990 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:02:14.798048 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:02:16.324558 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.53 seconds
2021-12-06 01:02:16.326374 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:02:16.339409 (Thread-265): handling poll request
2021-12-06 01:02:16.339690 (Thread-265): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a5dede20>]}
2021-12-06 01:02:16.340327 (Thread-265): sending response (<Response 5496 bytes [200 OK]>) to 10.0.41.241
2021-12-06 01:02:16.788258 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:02:16.795305 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:02:16.795402 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:02:16.795465 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-06 01:02:17.843953 (Thread-266): handling poll request
2021-12-06 01:02:17.844295 (Thread-266): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44111c0>]}
2021-12-06 01:02:17.844842 (Thread-266): sending response (<Response 1708 bytes [200 OK]>) to 10.0.38.50
2021-12-06 01:02:18.204027 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.41 seconds
2021-12-06 01:02:18.205509 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:02:18.652117 (MainThread): 01:02:18 | Concurrency: 4 threads (target='default')
2021-12-06 01:02:18.652234 (MainThread): 01:02:18 | 
2021-12-06 01:02:18.654144 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:02:18.654415 (Thread-1): 01:02:18 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:02:18.654639 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:02:18.654731 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:02:18.655546 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:02:18.655770 (Thread-2): 01:02:18 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:02:18.655995 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:02:18.656064 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:02:18.657132 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:02:18.658013 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:02:18.658189 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:02:18.658399 (Thread-3): 01:02:18 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:02:18.658617 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:02:18.658685 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:02:18.659779 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:02:18.675430 (Thread-2): finished collecting timing info
2021-12-06 01:02:18.680511 (Thread-3): finished collecting timing info
2021-12-06 01:02:18.690690 (Thread-1): finished collecting timing info
2021-12-06 01:02:18.715565 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:02:18.717832 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:02:18.721270 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:02:18.734849 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:02:18.734928 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:02:18.734987 (Thread-2): Opening a new connection, currently in state init
2021-12-06 01:02:18.741366 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:02:18.741451 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:02:18.741508 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:02:18.742521 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:02:18.742593 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:02:18.742645 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:02:19.349889 (Thread-267): handling poll request
2021-12-06 01:02:19.350239 (Thread-267): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44400a0>]}
2021-12-06 01:02:19.351070 (Thread-267): sending response (<Response 14047 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:02:20.388349 (Thread-2): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-06 01:02:20.394846 (Thread-2): finished collecting timing info
2021-12-06 01:02:20.394979 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:02:20.414373 (Thread-3): SQL status: SUCCESS 1 in 1.67 seconds
2021-12-06 01:02:20.415462 (Thread-3): finished collecting timing info
2021-12-06 01:02:20.415563 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:02:20.448600 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-12-06 01:02:20.449659 (Thread-1): finished collecting timing info
2021-12-06 01:02:20.449761 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:02:20.845982 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80c057f40>]}
2021-12-06 01:02:20.846406 (Thread-2): 01:02:20 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.19s]
2021-12-06 01:02:20.846492 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:02:20.877321 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8070b3130>]}
2021-12-06 01:02:20.877633 (Thread-3): 01:02:20 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.22s]
2021-12-06 01:02:20.877714 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:02:20.878357 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:02:20.878600 (Thread-4): 01:02:20 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:02:20.878834 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:02:20.878915 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:02:20.881331 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:02:20.891144 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8075db130>]}
2021-12-06 01:02:20.891406 (Thread-1): 01:02:20 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.24s]
2021-12-06 01:02:20.891479 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:02:20.896602 (Thread-268): handling poll request
2021-12-06 01:02:20.897105 (Thread-268): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4411f40>]}
2021-12-06 01:02:20.897766 (Thread-268): sending response (<Response 9469 bytes [200 OK]>) to 10.0.31.30
2021-12-06 01:02:20.903082 (Thread-4): finished collecting timing info
2021-12-06 01:02:20.919214 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:02:20.949389 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:02:20.949467 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 01:02:20.949525 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:02:22.365715 (Thread-269): handling poll request
2021-12-06 01:02:22.366044 (Thread-269): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a444ee50>]}
2021-12-06 01:02:22.366586 (Thread-269): sending response (<Response 2666 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:02:23.190456 (Thread-4): SQL status: SUCCESS 1 in 2.24 seconds
2021-12-06 01:02:23.195080 (Thread-4): finished collecting timing info
2021-12-06 01:02:23.195213 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:02:23.639350 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff807586940>]}
2021-12-06 01:02:23.639687 (Thread-4): 01:02:23 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.76s]
2021-12-06 01:02:23.639773 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:02:23.640596 (Thread-3): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:02:23.640823 (Thread-3): 01:02:23 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:02:23.641026 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:02:23.641096 (Thread-3): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:02:23.643637 (Thread-3): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:02:23.660448 (Thread-3): finished collecting timing info
2021-12-06 01:02:23.662476 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:02:23.680580 (Thread-3): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:02:23.680663 (Thread-3): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
      );
2021-12-06 01:02:23.680723 (Thread-3): Opening a new connection, currently in state closed
2021-12-06 01:02:23.814734 (Thread-270): handling poll request
2021-12-06 01:02:23.815003 (Thread-270): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a443c550>]}
2021-12-06 01:02:23.815641 (Thread-270): sending response (<Response 7994 bytes [200 OK]>) to 10.0.24.86
2021-12-06 01:02:25.270211 (Thread-271): handling poll request
2021-12-06 01:02:25.270526 (Thread-271): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a443c430>]}
2021-12-06 01:02:25.271018 (Thread-271): sending response (<Response 287 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:02:25.832210 (Thread-3): SQL status: SUCCESS 1 in 2.15 seconds
2021-12-06 01:02:25.833624 (Thread-3): finished collecting timing info
2021-12-06 01:02:25.833757 (Thread-3): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:02:26.277770 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595a0f8-6e21-4c64-a26a-d9ddc458fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e3fd1130>]}
2021-12-06 01:02:26.278219 (Thread-3): 01:02:26 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.64s]
2021-12-06 01:02:26.278321 (Thread-3): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:02:26.279840 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:02:26.280145 (MainThread): 01:02:26 | 
2021-12-06 01:02:26.280216 (MainThread): 01:02:26 | Finished running 3 view models, 2 table models in 11.50s.
2021-12-06 01:02:26.280262 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:02:26.280301 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:02:26.280337 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-12-06 01:02:26.280370 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:02:26.280403 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:02:26.339491 (MainThread): 
2021-12-06 01:02:26.339597 (MainThread): Completed successfully
2021-12-06 01:02:26.339672 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:02:26.720398 (Thread-272): handling poll request
2021-12-06 01:02:26.720711 (Thread-272): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a447c1f0>]}
2021-12-06 01:02:26.722036 (Thread-272): sending response (<Response 20628 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:02:27.630634 (Thread-273): handling status request
2021-12-06 01:02:27.630954 (Thread-273): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a447c2e0>]}
2021-12-06 01:02:27.650073 (Thread-274): handling status request
2021-12-06 01:02:27.650351 (Thread-274): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a44adaf0>]}
2021-12-06 01:02:27.653721 (Thread-273): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:02:27.654129 (Thread-274): sending response (<Response 1537 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:02:34.976898 (Thread-275): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2021-12-06 01:02:34.977229 (Thread-275): Partial parsing enabled, no changes found, skipping parsing
2021-12-06 01:02:34.982214 (Thread-275): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4386280>]}
2021-12-06 01:02:35.794627 (Thread-276): handling status request
2021-12-06 01:02:35.794987 (Thread-276): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4406e80>]}
2021-12-06 01:02:35.795460 (Thread-276): sending response (<Response 1212 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:02:35.824878 (Thread-277): handling status request
2021-12-06 01:02:35.825104 (Thread-277): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43885e0>]}
2021-12-06 01:02:35.825534 (Thread-277): sending response (<Response 1212 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:02:40.787835 (Thread-278): handling status request
2021-12-06 01:02:40.788151 (Thread-278): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4388d90>]}
2021-12-06 01:02:40.788607 (Thread-278): sending response (<Response 1212 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:02:41.260721 (Thread-279): handling run_sql request
2021-12-06 01:02:41.261010 (Thread-279): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4388f70>]}
2021-12-06 01:02:43.197150 (Thread-279): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:02:43.207965 (MainThread): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:02:43.222471 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fcb8922-b689-460a-a08a-c943f431a1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1355e040>]}
2021-12-06 01:02:43.222710 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:02:43.223064 (Thread-1): Acquiring new snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:02:43.223165 (Thread-1): Compiling rpc.jaffle_shop.request
2021-12-06 01:02:43.225548 (Thread-1): finished collecting timing info
2021-12-06 01:02:43.227057 (Thread-1): Using snowflake connection "rpc.jaffle_shop.request".
2021-12-06 01:02:43.227120 (Thread-1): On rpc.jaffle_shop.request: with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_payments.lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-12-06 01:02:43.227174 (Thread-1): Opening a new connection, currently in state init
2021-12-06 01:02:43.644205 (Thread-280): handling poll request
2021-12-06 01:02:43.644541 (Thread-280): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43884f0>]}
2021-12-06 01:02:43.645416 (Thread-280): sending response (<Response 4506 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:02:45.054128 (Thread-1): SQL status: SUCCESS 100 in 1.83 seconds
2021-12-06 01:02:45.058341 (Thread-1): finished collecting timing info
2021-12-06 01:02:45.058527 (Thread-1): On rpc.jaffle_shop.request: Close
2021-12-06 01:02:45.119616 (Thread-281): handling poll request
2021-12-06 01:02:45.119902 (Thread-281): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a438c2e0>]}
2021-12-06 01:02:45.120417 (Thread-281): sending response (<Response 1343 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:02:46.625843 (Thread-282): handling poll request
2021-12-06 01:02:46.626199 (Thread-282): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a438c820>]}
2021-12-06 01:02:46.627702 (Thread-282): sending response (<Response 12913 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:03:09.650562 (Thread-283): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2021-12-06 01:03:09.650877 (Thread-283): Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
2021-12-06 01:03:09.654577 (Thread-283): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:03:09.698817 (Thread-283): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a440ce80>]}
2021-12-06 01:03:10.482694 (Thread-284): handling status request
2021-12-06 01:03:10.483019 (Thread-284): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a448c7f0>]}
2021-12-06 01:03:10.483592 (Thread-284): sending response (<Response 1537 bytes [200 OK]>) to 10.0.37.206
2021-12-06 01:03:10.484427 (Thread-285): handling status request
2021-12-06 01:03:10.484959 (Thread-285): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43a2250>]}
2021-12-06 01:03:10.485359 (Thread-285): sending response (<Response 1537 bytes [200 OK]>) to 10.0.13.223
2021-12-06 01:03:15.682762 (Thread-286): handling status request
2021-12-06 01:03:15.683093 (Thread-286): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4358340>]}
2021-12-06 01:03:15.683614 (Thread-286): sending response (<Response 1537 bytes [200 OK]>) to 10.0.2.25
2021-12-06 01:03:15.994500 (Thread-287): handling status request
2021-12-06 01:03:15.994763 (Thread-287): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a43586d0>]}
2021-12-06 01:03:15.995212 (Thread-287): sending response (<Response 1537 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:03:16.185765 (Thread-288): handling cli_args request
2021-12-06 01:03:16.186005 (Thread-288): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4358e50>]}
2021-12-06 01:03:16.196108 (Thread-288): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:03:18.104458 (Thread-288): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:03:18.139950 (MainThread): Partial parsing not enabled
2021-12-06 01:03:18.186605 (MainThread): Parsing macros/catalog.sql
2021-12-06 01:03:18.188540 (MainThread): Parsing macros/adapters.sql
2021-12-06 01:03:18.222938 (MainThread): Parsing macros/materializations/merge.sql
2021-12-06 01:03:18.226527 (MainThread): Parsing macros/materializations/table.sql
2021-12-06 01:03:18.229665 (MainThread): Parsing macros/materializations/seed.sql
2021-12-06 01:03:18.233819 (MainThread): Parsing macros/materializations/view.sql
2021-12-06 01:03:18.235068 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-06 01:03:18.243118 (MainThread): Parsing macros/core.sql
2021-12-06 01:03:18.246635 (MainThread): Parsing macros/materializations/test.sql
2021-12-06 01:03:18.252815 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-06 01:03:18.262214 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-06 01:03:18.268767 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-06 01:03:18.272470 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-06 01:03:18.293816 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-06 01:03:18.309850 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-06 01:03:18.311430 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-06 01:03:18.340638 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-06 01:03:18.347502 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-06 01:03:18.360447 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-06 01:03:18.378834 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-06 01:03:18.388185 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-06 01:03:18.389861 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-06 01:03:18.391238 (MainThread): Parsing macros/etc/datetime.sql
2021-12-06 01:03:18.399047 (MainThread): Parsing macros/etc/query.sql
2021-12-06 01:03:18.399991 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-06 01:03:18.401587 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-06 01:03:18.403035 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-06 01:03:18.405310 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-06 01:03:18.406677 (MainThread): Parsing macros/adapters/common.sql
2021-12-06 01:03:18.458645 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-06 01:03:18.460704 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-06 01:03:18.461763 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-06 01:03:18.463265 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-06 01:03:18.559661 (Thread-289): handling poll request
2021-12-06 01:03:18.559949 (Thread-289): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4327400>]}
2021-12-06 01:03:18.560914 (Thread-289): sending response (<Response 9686 bytes [200 OK]>) to 10.0.3.73
2021-12-06 01:03:18.642981 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:03:18.655246 (MainThread): 1699: statically parsed staging/jaffle_shop/stg_orders.sql
2021-12-06 01:03:18.655351 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:03:18.656913 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8191faf0>]}
2021-12-06 01:03:18.657915 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:03:18.660408 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:03:18.664360 (MainThread): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:03:18.717816 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8193d9a0>]}
2021-12-06 01:03:18.748466 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8193d5e0>]}
2021-12-06 01:03:18.748657 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-06 01:03:18.749763 (MainThread): 
2021-12-06 01:03:18.749983 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:03:18.750828 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-06 01:03:18.762098 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-06 01:03:18.762167 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-06 01:03:18.762221 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-06 01:03:20.089165 (Thread-290): handling poll request
2021-12-06 01:03:20.089483 (Thread-290): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a440cdc0>]}
2021-12-06 01:03:20.090131 (Thread-290): sending response (<Response 5681 bytes [200 OK]>) to 10.0.36.143
2021-12-06 01:03:20.319076 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.56 seconds
2021-12-06 01:03:20.320912 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-06 01:03:20.790321 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:03:20.797320 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_pstulnikov".
2021-12-06 01:03:20.797418 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "connection_name": "list_analytics_dbt_pstulnikov"} */

    show terse objects in analytics.dbt_pstulnikov
2021-12-06 01:03:20.797493 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-06 01:03:21.618445 (Thread-291): handling poll request
2021-12-06 01:03:21.618775 (Thread-291): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a432e880>]}
2021-12-06 01:03:21.619330 (Thread-291): sending response (<Response 2261 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:03:22.089351 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.29 seconds
2021-12-06 01:03:22.090854 (ThreadPoolExecutor-1_0): On list_analytics_dbt_pstulnikov: Close
2021-12-06 01:03:22.539710 (MainThread): 01:03:22 | Concurrency: 4 threads (target='default')
2021-12-06 01:03:22.539846 (MainThread): 01:03:22 | 
2021-12-06 01:03:22.541801 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-12-06 01:03:22.542108 (Thread-1): 01:03:22 | 1 of 5 START view model dbt_pstulnikov.stg_customers................. [RUN]
2021-12-06 01:03:22.542335 (Thread-1): Acquiring new snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:03:22.542433 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-12-06 01:03:22.543268 (Thread-2): Began running node model.jaffle_shop.stg_orders
2021-12-06 01:03:22.543483 (Thread-2): 01:03:22 | 2 of 5 START view model dbt_pstulnikov.stg_orders.................... [RUN]
2021-12-06 01:03:22.543688 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:03:22.543756 (Thread-2): Compiling model.jaffle_shop.stg_orders
2021-12-06 01:03:22.544892 (Thread-2): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:03:22.545801 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:03:22.546006 (Thread-3): Began running node model.jaffle_shop.stg_payments
2021-12-06 01:03:22.546215 (Thread-3): 01:03:22 | 3 of 5 START view model dbt_pstulnikov.stg_payments.................. [RUN]
2021-12-06 01:03:22.546433 (Thread-3): Acquiring new snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:03:22.546498 (Thread-3): Compiling model.jaffle_shop.stg_payments
2021-12-06 01:03:22.547558 (Thread-3): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:03:22.562642 (Thread-2): finished collecting timing info
2021-12-06 01:03:22.567988 (Thread-1): finished collecting timing info
2021-12-06 01:03:22.583495 (Thread-3): finished collecting timing info
2021-12-06 01:03:22.598433 (Thread-3): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-12-06 01:03:22.602287 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-12-06 01:03:22.604440 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-12-06 01:03:22.621088 (Thread-3): Using snowflake connection "model.jaffle_shop.stg_payments".
2021-12-06 01:03:22.621166 (Thread-3): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */

  create or replace  view analytics.dbt_pstulnikov.stg_payments  as (
    with payments as (
    select
        orderid as order_id,
        amount

    from raw.stripe.payment

)

select * from payments
  );
2021-12-06 01:03:22.621226 (Thread-3): Opening a new connection, currently in state init
2021-12-06 01:03:22.622369 (Thread-2): Using snowflake connection "model.jaffle_shop.stg_orders".
2021-12-06 01:03:22.622441 (Thread-2): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */

  create or replace  view analytics.dbt_pstulnikov.stg_orders  as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

)

select * from orders
  );
2021-12-06 01:03:22.622497 (Thread-2): Opening a new connection, currently in state closed
2021-12-06 01:03:22.623553 (Thread-1): Using snowflake connection "model.jaffle_shop.stg_customers".
2021-12-06 01:03:22.623625 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */

  create or replace  view analytics.dbt_pstulnikov.stg_customers  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

)

select * from customers
  );
2021-12-06 01:03:22.623679 (Thread-1): Opening a new connection, currently in state closed
2021-12-06 01:03:23.072219 (Thread-292): handling poll request
2021-12-06 01:03:23.072515 (Thread-292): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42b71c0>]}
2021-12-06 01:03:23.073389 (Thread-292): sending response (<Response 14049 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:03:24.266825 (Thread-3): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-06 01:03:24.273273 (Thread-3): finished collecting timing info
2021-12-06 01:03:24.273410 (Thread-3): On model.jaffle_shop.stg_payments: Close
2021-12-06 01:03:24.433036 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-06 01:03:24.434181 (Thread-2): finished collecting timing info
2021-12-06 01:03:24.434291 (Thread-2): On model.jaffle_shop.stg_orders: Close
2021-12-06 01:03:24.436084 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-06 01:03:24.437141 (Thread-1): finished collecting timing info
2021-12-06 01:03:24.437244 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-12-06 01:03:24.569913 (Thread-293): handling poll request
2021-12-06 01:03:24.570172 (Thread-293): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42d8370>]}
2021-12-06 01:03:24.570726 (Thread-293): sending response (<Response 3556 bytes [200 OK]>) to 10.0.26.3
2021-12-06 01:03:24.738264 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e49d68250>]}
2021-12-06 01:03:24.738593 (Thread-3): 01:03:24 | 3 of 5 OK created view model dbt_pstulnikov.stg_payments............. [SUCCESS 1 in 2.19s]
2021-12-06 01:03:24.738679 (Thread-3): Finished running node model.jaffle_shop.stg_payments
2021-12-06 01:03:24.902069 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8196e820>]}
2021-12-06 01:03:24.902342 (Thread-2): 01:03:24 | 2 of 5 OK created view model dbt_pstulnikov.stg_orders............... [SUCCESS 1 in 2.36s]
2021-12-06 01:03:24.902415 (Thread-2): Finished running node model.jaffle_shop.stg_orders
2021-12-06 01:03:24.903098 (Thread-4): Began running node model.jaffle_shop.fct_orders
2021-12-06 01:03:24.903323 (Thread-4): 01:03:24 | 4 of 5 START table model dbt_pstulnikov.fct_orders................... [RUN]
2021-12-06 01:03:24.903545 (Thread-4): Acquiring new snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:03:24.903618 (Thread-4): Compiling model.jaffle_shop.fct_orders
2021-12-06 01:03:24.905867 (Thread-4): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:03:24.906521 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4aa3bd00>]}
2021-12-06 01:03:24.906770 (Thread-1): 01:03:24 | 1 of 5 OK created view model dbt_pstulnikov.stg_customers............ [SUCCESS 1 in 2.36s]
2021-12-06 01:03:24.906839 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-12-06 01:03:24.920558 (Thread-4): finished collecting timing info
2021-12-06 01:03:24.936814 (Thread-4): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-12-06 01:03:24.952137 (Thread-4): Using snowflake connection "model.jaffle_shop.fct_orders".
2021-12-06 01:03:24.952218 (Thread-4): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


      create or replace transient table analytics.dbt_pstulnikov.fct_orders  as
      (with payments as (
    select * from analytics.dbt_pstulnikov.stg_payments
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),


final as (
    select
        orders.order_id,
        orders.customer_id,
        payments.amount
    
    from orders

    left join payments using (order_id)
)

select * from final
      );
2021-12-06 01:03:24.952291 (Thread-4): Opening a new connection, currently in state init
2021-12-06 01:03:26.017154 (Thread-294): handling poll request
2021-12-06 01:03:26.017458 (Thread-294): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42d8cd0>]}
2021-12-06 01:03:26.018141 (Thread-294): sending response (<Response 8578 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:03:26.991523 (Thread-4): SQL status: SUCCESS 1 in 2.04 seconds
2021-12-06 01:03:26.996048 (Thread-4): finished collecting timing info
2021-12-06 01:03:26.996179 (Thread-4): On model.jaffle_shop.fct_orders: Close
2021-12-06 01:03:27.464963 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e49d59b50>]}
2021-12-06 01:03:27.465445 (Thread-4): 01:03:27 | 4 of 5 OK created table model dbt_pstulnikov.fct_orders.............. [SUCCESS 1 in 2.56s]
2021-12-06 01:03:27.468272 (Thread-295): handling poll request
2021-12-06 01:03:27.468520 (Thread-295): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42e20d0>]}
2021-12-06 01:03:27.469020 (Thread-295): sending response (<Response 2246 bytes [200 OK]>) to 10.0.6.10
2021-12-06 01:03:27.465541 (Thread-4): Finished running node model.jaffle_shop.fct_orders
2021-12-06 01:03:27.466308 (Thread-2): Began running node model.jaffle_shop.dim_customers
2021-12-06 01:03:27.466539 (Thread-2): 01:03:27 | 5 of 5 START table model dbt_pstulnikov.dim_customers................ [RUN]
2021-12-06 01:03:27.466762 (Thread-2): Acquiring new snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:03:27.466838 (Thread-2): Compiling model.jaffle_shop.dim_customers
2021-12-06 01:03:27.469412 (Thread-2): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:03:27.484699 (Thread-2): finished collecting timing info
2021-12-06 01:03:27.486719 (Thread-2): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-12-06 01:03:27.503049 (Thread-2): Using snowflake connection "model.jaffle_shop.dim_customers".
2021-12-06 01:03:27.503128 (Thread-2): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


      create or replace transient table analytics.dbt_pstulnikov.dim_customers  as
      (with customers as (
    select * from analytics.dbt_pstulnikov.stg_customers
),

orders as (
    select * from analytics.dbt_pstulnikov.stg_orders
),

payments as (
    select
        customer_id,
        amount
    
    from analytics.dbt_pstulnikov.fct_orders
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        customer_id,

        sum(amount) as lifetime_value

    from payments

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (customer_id)

)

select * from final
      );
2021-12-06 01:03:27.503185 (Thread-2): Opening a new connection, currently in state closed
2021-12-06 01:03:28.913873 (Thread-296): handling poll request
2021-12-06 01:03:28.914224 (Thread-296): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42e5700>]}
2021-12-06 01:03:28.914886 (Thread-296): sending response (<Response 6064 bytes [200 OK]>) to 10.0.6.71
2021-12-06 01:03:29.625563 (Thread-2): SQL status: SUCCESS 1 in 2.12 seconds
2021-12-06 01:03:29.626985 (Thread-2): finished collecting timing info
2021-12-06 01:03:29.627120 (Thread-2): On model.jaffle_shop.dim_customers: Close
2021-12-06 01:03:30.074660 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741ce3a0-118f-4a6f-8416-22995fccfd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8199d3d0>]}
2021-12-06 01:03:30.075021 (Thread-2): 01:03:30 | 5 of 5 OK created table model dbt_pstulnikov.dim_customers........... [SUCCESS 1 in 2.61s]
2021-12-06 01:03:30.075107 (Thread-2): Finished running node model.jaffle_shop.dim_customers
2021-12-06 01:03:30.076629 (MainThread): Acquiring new snowflake connection "master".
2021-12-06 01:03:30.076961 (MainThread): 01:03:30 | 
2021-12-06 01:03:30.077030 (MainThread): 01:03:30 | Finished running 3 view models, 2 table models in 11.33s.
2021-12-06 01:03:30.077081 (MainThread): Connection 'master' was properly closed.
2021-12-06 01:03:30.077121 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-12-06 01:03:30.077158 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-12-06 01:03:30.077193 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-12-06 01:03:30.077232 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-12-06 01:03:30.132832 (MainThread): 
2021-12-06 01:03:30.132944 (MainThread): Completed successfully
2021-12-06 01:03:30.133010 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-06 01:03:30.357788 (Thread-297): handling poll request
2021-12-06 01:03:30.358150 (Thread-297): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a42b7880>]}
2021-12-06 01:03:30.359497 (Thread-297): sending response (<Response 20690 bytes [200 OK]>) to 10.0.22.219
2021-12-06 01:03:31.265627 (Thread-298): handling status request
2021-12-06 01:03:31.266026 (Thread-298): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d04340>]}
2021-12-06 01:03:31.266574 (Thread-298): sending response (<Response 1537 bytes [200 OK]>) to 10.0.0.217
2021-12-06 01:03:31.407069 (Thread-299): handling status request
2021-12-06 01:03:31.407384 (Thread-299): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4358ca0>]}
2021-12-06 01:03:31.407884 (Thread-299): sending response (<Response 1537 bytes [200 OK]>) to 10.0.39.19
2021-12-06 01:03:54.917519 (Thread-300): handling status request
2021-12-06 01:03:54.917898 (Thread-300): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '03466b0e-a348-412f-ad27-a72f9d06352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4327ee0>]}
2021-12-06 01:03:54.918503 (Thread-300): sending response (<Response 1537 bytes [200 OK]>) to 10.0.31.30
